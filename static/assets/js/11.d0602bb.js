(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+t3h":function(e,t,n){},"0nTK":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=f(n("P2sY")),i=f(n("gDS+")),s=f(n("jWXv")),a=f(n("FyfS")),c=f(n("JO7F")),r=f(n("nLf9")),d=f(n("GQeE")),l=f(n("SEkw")),u=n("4ZMo");function f(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n){return t in e?(0,l.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=(0,d.default)(n);"function"==typeof r.default&&(o=o.concat((0,r.default)(n).filter((function(e){return(0,c.default)(n,e).enumerable})))),o.forEach((function(t){M(e,t,n[t])}))}return e}var h=function(e,t,n,o,i,s,a,c,r,d){"boolean"!=typeof a&&(r=c,c=a,a=!1);var l,u="function"==typeof n?n.options:n;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),o&&(u._scopeId=o),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,r(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=l):t&&(l=a?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,c(e))}),l)if(u.functional){var f=u.render;u.render=function(e,t){return l.call(t),f(e,t)}}else{var M=u.beforeCreate;u.beforeCreate=M?[].concat(M,l):[l]}return n},g="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase()),v=document.head||document.getElementsByTagName("head")[0],N={},m=function(e){return function(e,t){return function(e,t){var n=g?t.media||"default":e,o=N[n]||(N[n]={ids:new s.default,styles:[]});if(!o.ids.has(e)){o.ids.add(e);var a=t.source;if(t.map&&(a+="\n/*# sourceURL="+t.map.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent((0,i.default)(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),v.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(a),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{var c=o.ids.size-1,r=document.createTextNode(a),d=o.element.childNodes;d[c]&&o.element.removeChild(d[c]),d.length?o.element.insertBefore(r,d[c]):o.element.appendChild(r)}}}(e,t)}},y=h({render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"palette-panel"},[this._t("palette",[this._m(0)])],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"palette-group"},[t("li",[t("div",{staticClass:"palette-default-item type-a",attrs:{"data-type":"type-a"}},[this._v("A")])]),t("li",[t("div",{staticClass:"palette-default-item type-b",attrs:{"data-type":"type-b"}},[this._v("B")])]),t("li",[t("div",{staticClass:"palette-default-item type-c",attrs:{"data-type":"type-c"}},[this._v("C")])]),t("li",[t("div",{staticClass:"palette-default-item type-d",attrs:{"data-type":"type-d"}},[this._v("D")])])])}]},(function(e){e&&e("data-v-6c6ee110_0",{source:".palette-group{margin:0;padding:0;background:#fcfcfc;text-align:center;list-style:none}.palette-group>li{padding:14px 0}.palette-default-item{display:inline-block;width:40px;height:40px;line-height:40px;font-size:12px;color:#888;border:1px solid #999;border-radius:2px;cursor:pointer;user-select:none}.palette-default-item:hover{box-shadow:0 0 8px rgba(50,50,50,.3)}.type-a{border-radius:50%}.type-b{border-radius:50%;border:4px solid #333}.type-c,.type-d{height:30px;line-height:30px;border:1px solid #999}.type-d{position:relative}.type-d:after{content:'';position:absolute;top:0;right:0;width:5px;height:5px;border-radius:50%;background:#ccc}",map:void 0,media:void 0})}),{name:"PalettePanel",props:["selector"],data:function(){return{}},mounted:function(){this.$emit("registerPaletteEvent")}},void 0,!1,void 0,m,void 0),D=h({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tool-panel"},e._l(e.tools,(function(t,o){return n("div",{key:o,class:["tool-item",t.cls,{actived:"frameSelect"===t.type&&e.isFrameSelecting}],attrs:{title:t.title},on:{click:function(n){return e.onToolClick(t)}}},[e._v("\n        "+e._s(t.name)+"\n    ")])})),0)},staticRenderFns:[]},(function(e){e&&e("data-v-20cba315_0",{source:".tool-item{display:inline-block;margin-right:10px;user-select:none;cursor:pointer}.tool-item:last-child{margin-right:0}.tool-item.actived{color:#3a84ff}",map:void 0,media:void 0})}),{name:"ToolPanel",props:["tools","isFrameSelecting"],data:function(){return{}},methods:{onToolClick:function(e){this.$emit("onToolClick",e)}}},void 0,!1,void 0,m,void 0),w=h({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bk-flow-location",on:{mousedown:function(t){e.moveFlag=!1},mousemove:function(t){e.moveFlag=!0},mouseup:function(t){return e.onNodeClick(e.node,t)}}},["type-a"===e.node.type?n("div",{staticClass:"type-a"},[e._v("start")]):"type-b"===e.node.type?n("div",{staticClass:"type-b"},[e._v("end")]):"type-c"===e.node.type?n("div",{staticClass:"type-c"},[e._v("taskNode")]):"type-d"===e.node.type?n("div",{staticClass:"type-d"},[e._v("subFlow")]):n("div",{staticClass:"node-default"})])},staticRenderFns:[]},(function(e){e&&e("data-v-2d0e3090_0",{source:".bk-flow-location .type-c,.bk-flow-location .type-d{width:120px;height:60px;line-height:60px;border:1px solid #ccc;text-align:center;cursor:pointer}.bk-flow-location .type-c:hover,.bk-flow-location .type-d:hover{border-color:#348aff}.bk-flow-location .type-d{position:relative}.bk-flow-location .type-d:after{content:'';position:absolute;top:0;right:0;width:10px;height:10px;border-radius:50%;background:#ccc}.bk-flow-location .type-a,.bk-flow-location .type-b{width:60px;height:60px;line-height:60px;border-radius:50%;border:1px solid #ccc;text-align:center}.bk-flow-location .type-b{border:4px solid #333}.bk-flow-location .node-default{width:120px;height:80px;line-height:80px;border:1px solid #ccc;border-radius:2px;text-align:center}.bk-flow-location .node-default.selected{border:1px solid #3a84ff}",map:void 0,media:void 0})}),{name:"NodeTemplate",props:{node:{type:Object,default:function(){return{}}}},data:function(){return{moveFlag:!1}},methods:{onNodeClick:function(e,t){this.moveFlag||console.log(e.x,e.y)}}},void 0,!1,void 0,m,void 0);function I(e){return"touches"in e?e.touches[0]:e}function T(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="",n=0;n<7;n++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e+t}var j={showPalette:{type:Boolean,default:!0},showTool:{type:Boolean,default:!0},tools:{type:Array,default:function(){return[{type:"zoomIn",name:"放大",cls:"tool-item"},{type:"zoomOut",name:"缩小",cls:"tool-item"},{type:"resetPosition",name:"重置",cls:"tool-item"},{type:"frameSelect",name:"框选",cls:"tool-item"}]}},editable:{type:Boolean,default:!0},selector:{type:String,default:"palette-default-item"},quickConnect:{type:Boolean,default:!0},data:{type:Object,default:function(){return{nodes:[],lines:[]}}},nodeOptions:{type:Object,default:function(){return{grid:[5,5]}}},connectorOptions:{type:Object,default:function(){return{paintStyle:{fill:"transparent",stroke:"#a9adb6",strokeWidth:2},hoverPaintStyle:{fill:"transparent",stroke:"#3a84ff"}}}},endpointOptions:{type:Object,default:function(){return{endpoint:"Dot",connector:["Flowchart",{stub:[1,6],alwaysRespectStub:!0,gap:8,cornerRadius:2}],connectorOverlays:[["PlainArrow",{width:8,length:6,location:1,id:"arrow"}]],anchor:["Left","Right","Top","Bottom"],isSource:!0,isTarget:!0}}}},x={mousedown:"ontouchstart"in document.documentElement?"touchstart":"mousedown",mousemove:"ontouchmove"in document.documentElement?"touchmove":"mousemove",mouseup:"ontouchend"in document.documentElement?"touchend":"mouseup"},z=h({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"jsflow"},[n("div",{staticClass:"canvas-area"},[e.showTool?n("div",{staticClass:"tool-panel-wrap"},[e._t("toolPanel",[n("tool-panel",{attrs:{tools:e.tools,"is-frame-selecting":e.isFrameSelecting},on:{onToolClick:e.onToolClick}})])],2):e._e(),e.showPalette?n("div",{ref:"palettePanel",staticClass:"palette-panel-wrap"},[e._t("palettePanel",[n("palette-panel",{attrs:{selector:e.selector}})])],2):e._e(),n("div",{ref:"canvasFlowWrap",staticClass:"canvas-flow-wrap",style:e.canvasWrapStyle,on:e._d({},[e.mousedown,e.onCanvasMouseDown,e.mouseup,e.onCanvasMouseUp])},[n("div",{ref:"canvasFlow",staticClass:"canvas-flow",style:e.canvasStyle,attrs:{id:"canvas-flow"}},e._l(e.nodes,(function(t){return n("div",{key:t.id,staticClass:"jsflow-node canvas-node",attrs:{id:t.id},on:{mouseover:function(n){return e.toggleHighLight(t,!0)},mouseout:function(n){return e.toggleHighLight(t,!1)}}},[e._t("nodeTemplate",[n("node-template",{attrs:{node:t}})],{node:t})],2)})),0),e.isFrameSelecting?n("div",{staticClass:"canvas-frame-selector",style:e.frameSelectorStyle}):e._e()]),e.showAddingNode?n("div",{staticClass:"jsflow-node adding-node",style:e.setNodeInitialPos(e.addingNodeConfig)},[e._t("nodeTemplate",[n("node-template",{attrs:{node:e.addingNodeConfig}})],{node:e.addingNodeConfig})],2):e._e()])])},staticRenderFns:[]},(function(e){e&&e("data-v-e853be96_0",{source:".jsflow{height:100%;border:1px solid #ccc}.jsflow .canvas-area{position:relative;height:100%}.jsflow .tool-panel-wrap{position:absolute;top:20px;left:70px;padding:10px 20px;background:#c4c6cc;opacity:.65;border-radius:4px;z-index:4}.jsflow .palette-panel-wrap{float:left;width:60px;height:100%;border-right:1px solid #ccc}.jsflow .canvas-flow-wrap{position:relative;height:100%;overflow:hidden}.jsflow .canvas-flow{position:relative;min-width:100%;min-height:100%}.jsflow .canvas-frame-selector{position:absolute;border:1px solid #3a84ff;background:rgba(58,132,255,.15)}.jsflow .jsflow-node{position:absolute;z-index:1}.jsflow .jtk-endpoint{z-index:1}.jsflow .adding-node{opacity:.8}.jsflow .jtk-endpoint.jtk-dragging{z-index:0}",map:void 0,media:void 0})}),{name:"JsFlow",components:{PalettePanel:y,ToolPanel:D,NodeTemplate:w},model:{prop:"data",event:"change"},props:j,data:function(){var e=this.data;return p({nodes:e.nodes,lines:e.lines,canvasGrabbing:!1,isFrameSelecting:!1,mouseDownPos:{},canvasPos:{x:0,y:0},canvasOffset:{x:0,y:0},frameSelectorPos:{x:0,y:0},frameSelectorRect:{width:0,height:0},selectedNodes:[],showAddingNode:!1,addingNodeConfig:{},addingNodeRect:{},canvasRect:{},paletteRect:{},zoom:1},x)},computed:{canvasWrapStyle:function(){return{cursor:this.isFrameSelecting?"crosshair":this.canvasGrabbing?"-webkit-grabbing":"-webkit-grab"}},canvasStyle:function(){return{left:"".concat(this.canvasOffset.x,"px"),top:"".concat(this.canvasOffset.y,"px")}},frameSelectorStyle:function(){return{left:"".concat(this.frameSelectorPos.x,"px"),top:"".concat(this.frameSelectorPos.y,"px"),width:"".concat(this.frameSelectorRect.width,"px"),height:"".concat(this.frameSelectorRect.height,"px")}}},watch:{data:{handler:function(e){var t=e.nodes,n=e.lines;this.nodes=t,this.lines=n},deep:!0},editable:function(e){var t=this.$el.querySelectorAll(".canvas-node");this.toggleNodeDraggable(t,e)}},mounted:function(){this.initCanvas(),this.registerEvent(),this.renderData(),this.canvasRect=this.$refs.canvasFlow.getBoundingClientRect(),this.$refs.palettePanel&&(this.paletteRect=this.$refs.palettePanel.getBoundingClientRect(),this.registerPaletteEvent())},beforeDestroy:function(){this.$refs.palettePanel&&this.$refs.palettePanel.removeEventListener(this.mousedown,this.nodeCreateHandler),this.$el.removeEventListener(this.mousemove,this.nodeMovingHandler),document.removeEventListener(this.mouseup,this.nodeMoveEndHandler)},methods:{initCanvas:function(){var e={},t=p({},this.endpointOptions,this.connectorOptions);for(var n in t){var o=n[0].toUpperCase();e["".concat(o).concat(n.slice(1))]=t[n]}this.instance=u.jsPlumb.getInstance(p({container:"canvas-flow"},e))},registerEvent:function(){var e=this;this.instance.bind("beforeDrag",(function(t){return!!e.editable&&("function"!=typeof e.$listeners.onBeforeDrag||e.$listeners.onBeforeDrag(t))})),this.instance.bind("beforeDrop",(function(t){return!!e.editable&&("function"!=typeof e.$listeners.onBeforeDrop||e.$listeners.onBeforeDrop(t))})),this.instance.bind("connectionDrag",(function(t){"function"==typeof e.$listeners.connectionDrag&&e.$emit("connectionDrag",t)})),this.instance.bind("connection",(function(t){if("function"==typeof e.$listeners.onConnection)return e.$listeners.onConnection(t)})),this.instance.bind("connectionDragStop",(function(t,n){if(!t.target||!t.target.classList.contains("jsflow-node")){var o=e.getNodeWithEndpoint(n.target);if(o){var i=e.nodes.find((function(e){return o.id===e.id}));if("function"==typeof e.$listeners.onConnectionDragStop){var s={id:t.source.id,arrow:t.endpoints[0].anchor.type};e.$emit("onConnectionDragStop",s,i.id,n)}}}})),this.instance.bind("beforeDetach",(function(t){return"function"!=typeof e.$listeners.onBeforeDetach||e.$listeners.onBeforeDetach(t)})),this.instance.bind("connectionDetached",(function(t,n){var o=e.lines.filter((function(e){return e.source.id!==t.sourceId&&e.target.id!==t.targetId}));e.lines=o,"function"==typeof e.$listeners.onConnectionDetached&&e.$emit("onConnectionDetached",o)})),this.instance.bind("connectionMoved",(function(t,n){"function"==typeof e.$listeners.onConnectionMoved&&e.$emit("onConnectionMoved",lines)})),this.instance.bind("click",(function(t,n){"function"==typeof e.$listeners.onConnectionClick&&e.$emit("onConnectionClick",t,n)})),this.instance.bind("dblclick",(function(t,n){"function"==typeof e.$listeners.onConnectionDbClick&&e.$emit("onConnectionDbClick",t,n)}))},renderData:function(){var e=this;this.instance.batch((function(){e.nodes.forEach((function(t){e.initNode(t)})),e.lines.forEach((function(t){e.createConnector(t,e.connectorOptions)}))}))},createNode:function(e){var t=this;("function"!=typeof this.$listeners.onCreateNodeBefore||this.$listeners.onCreateNodeBefore(e))&&(this.nodes.push(e),this.$nextTick((function(){t.initNode(e)})))},initNode:function(e){var t=document.getElementById(e.id);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px"),this.setNodeDraggable(e,this.nodeOptions),this.setNodeEndPoint(e,this.endpointOptions),"function"==typeof this.$listeners.onCreateNodeAfter&&this.$emit("onCreateNodeAfter",e)},removeNode:function(e){var t=this.nodes.findIndex((function(t){return t.id===e.id}));this.nodes.splice(t,1),this.instance.remove(e.id)},setNodeEndPoint:function(e,t){var n=this;(e.endpoints||["Top","Right","Bottom","Left"]).forEach((function(o){n.instance.addEndpoint(e.id,p({anchor:o,uuid:o+e.id},t))}))},setNodeDraggable:function(e,t){if(this.editable){var n=this;this.instance.draggable(e.id,p({grid:[20,20],drag:function(t){var i=(0,o.default)({},e);n.$emit("onNodeMoving",i,t)},stop:function(t){var i=n.nodes.findIndex((function(t){return t.id===e.id})),s=(0,o.default)({},e),c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,i=!1,s=void 0;try{for(var c,r=(0,a.default)(e);!(o=(c=r.next()).done)&&(n.push(c.value),!t||n.length!==t);o=!0);}catch(e){i=!0,s=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t.pos,2),r=c[0],d=c[1];s.x=r,s.y=d,n.nodes.splice(i,1,s),n.$emit("onNodeMoveStop",s,t)}},t))}},setNodePosition:function(e){var t=document.getElementById(e.id);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px"),this.instance.revalidate(t)},toggleNodeDraggable:function(e,t){this.instance.setDraggable(e,t)},setNodeInitialPos:function(e){return{left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}},createConnector:function(e,t){var n=e.options||{};return this.instance.connect({source:e.source.id,target:e.target.id,uuids:[e.source.arrow+e.source.id,e.target.arrow+e.target.id]},p({},t,n))},getConnectorsByNodeId:function(e){return this.instance.getAllConnections().filter((function(t){return t.sourceId===e||t.targetId===e}))},getNodeWithEndpoint:function(e){var t=e.parentNode;return!(!t||"HTML"===t.nodeName)&&(t.classList.contains("jsflow-node")?t:this.getNodeWithEndpoint(t))},removeConnector:function(e){var t=this;this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){t.instance.deleteConnection(e)}))},addLineOverlay:function(e,t){var n=this;this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){e.addOverlay([t.type,{label:t.name,location:t.location,cssClass:t.cls,id:t.id,events:{click:function(e,t){n.$emit("onOverlayClick",e,t)}}}])}))},removeLineOverlay:function(e,t){this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){e.removeOverlay(t)}))},onCanvasMouseDown:function(e){e=I(e),this.isFrameSelecting?this.frameSelectHandler(e):(this.canvasGrabbing=!0,this.mouseDownPos={x:e.pageX,y:e.pageY},this.$refs.canvasFlowWrap.addEventListener(this.mousemove,this.canvasFlowMoveHandler,!1))},canvasFlowMoveHandler:function(e){e=I(e),this.canvasOffset={x:this.canvasPos.x+e.pageX-this.mouseDownPos.x,y:this.canvasPos.y+e.pageY-this.mouseDownPos.y}},onCanvasMouseUp:function(e){this.isFrameSelecting?this.frameSelectEndHandler(e):(this.canvasGrabbing=!1,this.$refs.canvasFlowWrap.removeEventListener(this.mousemove,this.canvasFlowMoveHandler),this.canvasPos={x:this.canvasOffset.x,y:this.canvasOffset.y})},registerPaletteEvent:function(){this.$refs.palettePanel.addEventListener(this.mousedown,this.nodeCreateHandler,!1)},nodeCreateHandler:function(e){var t=this,n=function e(t,n){return 1===t.nodeType&&t.classList.contains(n)?t:"HTML"!==t.parentNode.nodeName?e(t.parentNode,n):null}(e.target,this.selector);if(!n)return!1;var o=n.dataset.type?n.dataset.type:"",i=n.dataset?n.dataset.config:{};this.showAddingNode=!0,this.addingNodeConfig.id=T("node"),this.addingNodeConfig.type=o,this.$nextTick((function(){var n=t.$el.querySelector(".adding-node");t.addingNodeRect=n.getBoundingClientRect();var s=t.getAddingNodePos(e);t.addingNodeConfig=p({id:T("node"),type:o,x:s.x,y:s.y},i),t.$el.addEventListener(t.mousemove,t.nodeMovingHandler,!1),document.addEventListener(t.mouseup,t.nodeMoveEndHandler,!1)}))},nodeMovingHandler:function(e){var t=this.getAddingNodePos(e);this.$set(this.addingNodeConfig,"x",t.x),this.$set(this.addingNodeConfig,"y",t.y)},nodeMoveEndHandler:function(e){if(this.$el.removeEventListener(this.mousemove,this.nodeMovingHandler),document.removeEventListener(this.mouseup,this.nodeMoveEndHandler),this.showAddingNode=!1,e.pageX>this.paletteRect.left+this.paletteRect.width){var t=this.addingNodeConfig.x-this.paletteRect.width-this.canvasOffset.x,n=this.addingNodeConfig.y-this.canvasOffset.y;this.$set(this.addingNodeConfig,"x",t),this.$set(this.addingNodeConfig,"y",n),this.createNode(this.addingNodeConfig)}this.addingNodeConfig={},this.addingNodeRect={}},getAddingNodePos:function(e){return{x:e.pageX-this.paletteRect.left-this.addingNodeRect.width/2,y:e.pageY-this.paletteRect.top-this.addingNodeRect.height/2}},toggleHighLight:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=(this.instance.getEndpoints(e.id),document.getElementById(e.id));this.instance.selectEndpoints({source:o}).each((function(e){var o=n?t.endpointOptions.hoverPaintStyle:t.endpointOptions.paintStyle;e.setStyle(o)}))},onToolClick:function(e){"function"==typeof this[e.type]&&this[e.type](),this.$emit("onToolClick",e)},setZoom:function(e){this.instance.setContainer("canvas-flow"),this.$refs.canvasFlow.style.transform="matrix("+e+",0,0,"+e+",0,0)",this.$refs.canvasFlow.style.transformOrigin="0 0",this.$refs.canvasFlow.zoom=e,this.zoom=e,this.instance.setZoom(e)},zoomIn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.1;this.setZoom(this.zoom*e)},zoomOut:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.9;this.setZoom(this.zoom*e)},resetPosition:function(){this.setZoom(1),this.setCanvasPosition(0,0)},setCanvasPosition:function(e,t){this.canvasOffset={x:e,y:t},this.canvasPos={x:e,y:t}},frameSelect:function(){this.isFrameSelecting=!0},frameSelectHandler:function(e){this.mouseDownPos={x:e.pageX-this.canvasRect.left,y:e.pageY-this.canvasRect.top},this.$refs.canvasFlowWrap.addEventListener(this.mousemove,this.frameSelectMovingHandler,!1)},frameSelectMovingHandler:function(e){var t=e.pageX-this.mouseDownPos.x-this.canvasRect.left,n=e.pageY-this.mouseDownPos.y-this.canvasRect.top;this.frameSelectorRect={width:Math.abs(t),height:Math.abs(n)},this.frameSelectorPos={x:t>0?this.mouseDownPos.x:this.mouseDownPos.x+t,y:n>0?this.mouseDownPos.y:this.mouseDownPos.y+n}},frameSelectEndHandler:function(e){this.$refs.canvasFlowWrap.removeEventListener(this.mousemove,this.frameSelectMovingHandler),this.$refs.canvasFlowWrap.removeEventListener(this.mouseup,this.frameSelectEndHandler),document.addEventListener("keydown",this.nodeLineCopyhandler,!1),document.addEventListener("keydown",this.nodeLinePastehandler,!1),document.addEventListener("keydown",this.nodeLineDeletehandler,!1),document.addEventListener(this.mousedown,this.cancelFrameSelectorHandler,{capture:!1,once:!0});var t=this.getSelectedNodes(),n=t.map((function(e){return e.id}));this.isFrameSelecting=!1,this.frameSelectorPos={x:0,y:0},this.frameSelectorRect={width:0,height:0},this.selectedNodes=t,this.clearNodesDragSelection(),this.addNodesToDragSelection(n),this.$emit("frameSelectNodes",t.slice(0))},getSelectedNodes:function(){var e=this,t=this.frameSelectorPos,n=t.x,o=t.y,i=this.frameSelectorRect,s=i.width,a=i.height;return this.nodes.filter((function(t){var i=document.querySelector("#".concat(t.id)),c=i.getBoundingClientRect(),r=c.left-e.canvasRect.left,d=c.top-e.canvasRect.top;if(n<r&&n+s>r&&o<d&&o+a>d)return i.classList.add("selected"),!0}))},cancelFrameSelectorHandler:function(e){this.selectedNodes.forEach((function(e){var t=document.querySelector("#".concat(e.id));t&&t.classList.remove("selected")})),this.selectedNodes=[],this.clearNodesDragSelection()},nodeLineCopyhandler:function(e){(e.ctrlKey||e.metaKey)&&67===e.keyCode&&this.$emit("onNodeCopy",this.selectedNodes)},nodeLinePastehandler:function(e){(e.ctrlKey||e.metaKey)&&86===e.keyCode&&this.$emit("onNodePaste")},nodeLineDeletehandler:function(e){var t=this;46!==e.keyCode&&8!==e.keyCode||(this.selectedNodes.forEach((function(e){t.removeNode(e)})),this.cancelFrameSelectorHandler())},addNodesToDragSelection:function(e){this.instance.addToDragSelection(e)},clearNodesDragSelection:function(){this.instance.clearDragSelection()}}},void 0,!1,void 0,m,void 0);"undefined"!=typeof window&&"Vue"in window&&window.Vue.component("js-flow",z),t.default=z},"4HBs":function(e,t,n){"use strict";n.r(t);var o=n("Xetr"),i=n("V77z");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("llfE");var a=n("KHd+"),c=Object(a.a)(i.default,o.a,o.b,!1,null,"1928f59e",null);c.options.__file="src/views/commonComponent/preview/toolPanel.vue",t.default=c.exports},"4nBA":function(e,t,n){"use strict";n.r(t);var o=n("JR+g"),i=n("ilb7");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("K3AT");var a=n("KHd+"),c=Object(a.a)(i.default,o.a,o.b,!1,null,"db91cd4c",null);c.options.__file="src/views/commonComponent/preview/NodeTemplate.vue",t.default=c.exports},"7NNj":function(e,t,n){},"9qga":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1LjIgKDc4MTgxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7lvaLnirY8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0i6aG16Z2iMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IuaVsOaNrui+g+WwkeeahOeKtuaAgSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUyNS4wMDAwMDAsIC0xMzUuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGcgaWQ9IuWKoOi9vSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTI1LjAwMDAwMCwgMTM1LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTEyLjA3NTkzNjMsMy40NjM2OTU4NyBDMTIuMDc1OTM2MywzLjkzMjcxNjM3IDEyLjQ1NjE1MjUsNC4zMTI5MzI2MSAxMi45MjUxNzMsNC4zMTI5MzI2MSBDMTMuMzk0MTkzNSw0LjMxMjkzMjYxIDEzLjc3NDQwOTgsMy45MzI3MTYzNyAxMy43NzQ0MDk4LDMuNDYzNjk1ODcgQzEzLjc3NDQwOTgsMi45OTQ2NzUzOCAxMy4zOTQxOTM1LDIuNjE0NDU5MTQgMTIuOTI1MTczLDIuNjE0NDU5MTQgQzEyLjQ1NjE1MjUsMi42MTQ0NTkxNCAxMi4wNzU5MzYzLDIuOTk0Njc1MzggMTIuMDc1OTM2MywzLjQ2MzY5NTg3IEwxMi4wNzU5MzYzLDMuNDYzNjk1ODcgWiBNMTMuNjUzNDExNyw4LjA1MzEyNDE3IEMxMy42NTMzNjU5LDguNDI3NjUyNDYgMTMuODUzMTQ4MSw4Ljc3Mzc1MDQzIDE0LjE3NzQ5MTUsOC45NjEwMjc3NyBDMTQuNTAxODM0OSw5LjE0ODMwNTExIDE0LjkwMTQ1NTcsOS4xNDgzMDUxMSAxNS4yMjU3OTksOC45NjEwMjc3NyBDMTUuNTUwMTQyNCw4Ljc3Mzc1MDQzIDE1Ljc0OTkyNDYsOC40Mjc2NTI0NiAxNS43NDk4Nzg5LDguMDUzMTI0MTcgQzE1Ljc0OTkyNDYsNy42Nzg1OTU4OSAxNS41NTAxNDI0LDcuMzMyNDk3OTIgMTUuMjI1Nzk5LDcuMTQ1MjIwNTggQzE0LjkwMTQ1NTcsNi45NTc5NDMyMyAxNC41MDE4MzQ5LDYuOTU3OTQzMjMgMTQuMTc3NDkxNSw3LjE0NTIyMDU4IEMxMy44NTMxNDgxLDcuMzMyNDk3OTIgMTMuNjUzMzY1OSw3LjY3ODU5NTg5IDEzLjY1MzQxMTcsOC4wNTMxMjQxNyBMMTMuNjUzNDExNyw4LjA1MzEyNDE3IFogTTExLjczMDk0MTcsMTIuNjY1NTUyMSBDMTEuNzMwOTQxNywxMy4zNDcwNjA4IDEyLjI4MzQxMzcsMTMuODk5NTMyOCAxMi45NjQ5MjI0LDEzLjg5OTUzMjggQzEzLjY0NjQzMTIsMTMuODk5NTMyOCAxNC4xOTg5MDMxLDEzLjM0NzA2MDggMTQuMTk4OTAzMSwxMi42NjU1NTIxIEMxNC4xOTg5MDMxLDEyLjIyNDY5MzIgMTMuOTYzNzA3OCwxMS44MTczMjI4IDEzLjU4MTkxMjgsMTEuNTk2ODkzNCBDMTMuMjAwMTE3OCwxMS4zNzY0NjQgMTIuNzI5NzI3LDExLjM3NjQ2NCAxMi4zNDc5MzIsMTEuNTk2ODkzNCBDMTEuOTY2MTM3MSwxMS44MTczMjI4IDExLjczMDk0MTcsMTIuMjI0NjkzMiAxMS43MzA5NDE3LDEyLjY2NTU1MjEgTDExLjczMDk0MTcsMTIuNjY1NTUyMSBaIE02LjkyNzI2Njc3LDE0LjUxMDAyMzMgQzYuOTI3MjEzMzcsMTUuMDIwNzYyMSA3LjE5OTY1ODU5LDE1LjQ5MjcyNyA3LjY0MTk2MjQ1LDE1Ljc0ODExMTggQzguMDg0MjY2MzEsMTYuMDAzNDk2NiA4LjYyOTIyMjU1LDE2LjAwMzQ5NjYgOS4wNzE1MjY0MSwxNS43NDgxMTE4IEM5LjUxMzgzMDI3LDE1LjQ5MjcyNyA5Ljc4NjI3NTQ5LDE1LjAyMDc2MjEgOS43ODYyMjIwOSwxNC41MTAwMjMzIEM5Ljc4NjI3NTQ5LDEzLjk5OTI4NDUgOS41MTM4MzAyNywxMy41MjczMTk2IDkuMDcxNTI2NDEsMTMuMjcxOTM0OCBDOC42MjkyMjI1NSwxMy4wMTY1NSA4LjA4NDI2NjMxLDEzLjAxNjU1IDcuNjQxOTYyNDUsMTMuMjcxOTM0OCBDNy4xOTk2NTg1OSwxMy41MjczMTk2IDYuOTI3MjEzMzcsMTMuOTk5Mjg0NSA2LjkyNzI2Njc3LDE0LjUxMDAyMzMgTDYuOTI3MjY2NzcsMTQuNTEwMDIzMyBaIE0yLjIxNjg0MDM2LDEyLjU5MzA1MzIgQzIuMjE2ODQwMzYsMTMuMTYxOTAwNSAyLjUyMDMxNjc0LDEzLjY4NzUzNyAzLjAxMjk1MjkyLDEzLjk3MTk2MDcgQzMuNTA1NTg5MDksMTQuMjU2Mzg0MyA0LjExMjU0MTg4LDE0LjI1NjM4NDMgNC42MDUxNzgwNSwxMy45NzE5NjA3IEM1LjA5NzgxNDIzLDEzLjY4NzUzNyA1LjQwMTI5MDYxLDEzLjE2MTkwMDUgNS40MDEyOTA2MSwxMi41OTMwNTMyIEM1LjQwMTI5MDYxLDExLjcxMzY5MTYgNC42ODg0MjcxNCwxMS4wMDA4MjgxIDMuODA5MDY1NDgsMTEuMDAwODI4MSBDMi45Mjk3MDM4MywxMS4wMDA4MjgxIDIuMjE2ODQwMzYsMTEuNzEzNjkxNiAyLjIxNjg0MDM2LDEyLjU5MzA1MzIgWiBNNi42OTk1MjAzMSwxLjY4NTQ3MzY3IEM2LjY5OTUyMDMxLDIuNjE2MTk3MDEgNy40NTQwMjA2NSwzLjM3MDY5NzM0IDguMzg0NzQzOTgsMy4zNzA2OTczNCBDOS4zMTU0NjczMiwzLjM3MDY5NzM0IDEwLjA2OTk2NzcsMi42MTYxOTcwMSAxMC4wNjk5Njc3LDEuNjg1NDczNjcgQzEwLjA2OTk2NzcsMS4wODM0MDEyMyA5Ljc0ODc2NTg1LDAuNTI3MDYzMzU0IDkuMjI3MzU1ODMsMC4yMjYwMjcxMzEgQzguNzA1OTQ1ODEsLTAuMDc1MDA5MDkxMSA4LjA2MzU0MjE2LC0wLjA3NTAwOTA5MTEgNy41NDIxMzIxNCwwLjIyNjAyNzEzMSBDNy4wMjA3MjIxMSwwLjUyNzA2MzM1NCA2LjY5OTUyMDMxLDEuMDgzNDAxMjMgNi42OTk1MjAzMSwxLjY4NTQ3MzY3IFogTTIuMTIzODQxODEsMy41MDM0NDUyNyBDMi4xMjM4NDE4MSw0LjEwNTUxNzcgMi40NDUwNDM2Miw0LjY2MTg1NTU4IDIuOTY2NDUzNjQsNC45NjI4OTE4IEMzLjQ4Nzg2MzY2LDUuMjYzOTI4MDIgNC4xMzAyNjczMSw1LjI2MzkyODAyIDQuNjUxNjc3MzMsNC45NjI4OTE4IEM1LjE3MzA4NzM1LDQuNjYxODU1NTggNS40OTQyODkxNiw0LjEwNTUxNzcgNS40OTQyODkxNiwzLjUwMzQ0NTI3IEM1LjQ5NDI4OTE2LDIuNTcyNzIxOTMgNC43Mzk3ODg4MiwxLjgxODIyMTU5IDMuODA5MDY1NDgsMS44MTgyMjE1OSBDMi44NzgzNDIxNSwxLjgxODIyMTU5IDIuMTIzODQxODEsMi41NzI3MjE5MyAyLjEyMzg0MTgxLDMuNTAzNDQ1MjcgTDIuMTIzODQxODEsMy41MDM0NDUyNyBaIE0wLjQxNjYxODQ4NCw4LjAwMDEyNSBDMC40MTY2MTg0ODQsOC41NzM3OTUyNiAwLjcyMjY2NzkxNCw5LjEwMzg4ODQ1IDEuMjE5NDgwOTMsOS4zOTA3MjM1OSBDMS43MTYyOTM5Niw5LjY3NzU1ODcyIDIuMzI4MzkyODQsOS42Nzc1NTg3MiAyLjgyNTIwNTg2LDkuMzkwNzIzNTkgQzMuMzIyMDE4ODgsOS4xMDM4ODg0NSAzLjYyODA2ODMxLDguNTczNzk1MjYgMy42MjgwNjgzMSw4LjAwMDEyNSBDMy42MjgwNjgzMSw3LjExMzMwNzYyIDIuOTA5MTYwNzgsNi4zOTQ0MDAwOSAyLjAyMjM0MzQsNi4zOTQ0MDAwOSBDMS4xMzU1MjYwMiw2LjM5NDQwMDA5IDAuNDE2NjE4NDg0LDcuMTEzMzA3NjIgMC40MTY2MTg0ODQsOC4wMDAxMjUgTDAuNDE2NjE4NDg0LDguMDAwMTI1IFoiIGlkPSLlvaLnirYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},JHcm:function(e,t,n){},"JR+g":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"bk-flow-location",attrs:{"data-test-id":"node_template_view"},on:{mousedown:e.movdeDoneFn,mousemove:e.moveFn,mouseup:function(t){return e.onNodeClick(e.node,t)}}},["START"===e.node.type?o("div",{staticClass:"startpoint"},[e._v("\n        "+e._s(e.$t('m.treeinfo["开始"]'))+"\n    ")]):e._e(),e._v(" "),"END"===e.node.type?o("div",{staticClass:"endpoint"},[e._v("\n        "+e._s(e.$t('m.treeinfo["结束"]'))+"\n    ")]):e._e(),e._v(" "),e._l(e.typeList,(function(t,i){return e.node.type===t.type?[o("div",{key:i,staticClass:"common-node",class:{"common-auto":"TASK"===t.type}},["WAIT"===e.node.nodeInfo.statusInfo?o("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.$t("m.treeinfo['任务未执行，无法查看']"),expression:"$t(`m.treeinfo['任务未执行，无法查看']`)",modifiers:{top:!0}}],staticClass:"bk-tool-span"}):e._e(),e._v(" "),o("span",{staticClass:"common-auto-icon",class:{"bk-is-draft":e.node.nodeInfo.is_draft,"bk-is-success":"FINISHED"===e.node.nodeInfo.statusInfo,"bk-is-error":"TERMINATED"===e.node.nodeInfo.statusInfo||"FAILED"===e.node.nodeInfo.statusInfo,"bk-is-preview":"WAIT"===e.node.nodeInfo.statusInfo}},["TASK"!==t.type?o("i",{staticClass:"bk-itsm-icon",class:t.iconStyle}):o("span",{staticStyle:{"font-size":"12px","font-weight":"bold"}},[e._v("API")])]),e._v(" "),o("span",{staticClass:"bk-more-word",class:{"bk-more-padding":e.previewInfo.canClick&&"WAIT"!==e.node.nodeInfo.statusInfo,"bk-word-success":"FINISHED"===e.node.nodeInfo.statusInfo,"bk-word-error":"TERMINATED"===e.node.nodeInfo.statusInfo||"FAILED"===e.node.nodeInfo.statusInfo,"bk-word-preview":"WAIT"===e.node.nodeInfo.statusInfo,"bk-word-normal":e.normalColor}},[e._v("\n                "+e._s(e.node.name||e.$t('m.treeinfo["新增节点"]')))]),e._v(" "),e.previewInfo.canClick&&"WAIT"!==e.node.nodeInfo.statusInfo?[o("div",{staticClass:"bk-icon-status",class:{"bk-icon-success":"FINISHED"===e.node.nodeInfo.statusInfo,"bk-icon-error":"TERMINATED"===e.node.nodeInfo.statusInfo||"FAILED"===e.node.nodeInfo.statusInfo}},["FINISHED"===e.node.nodeInfo.statusInfo?o("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.$t("m.treeinfo['已通过']"),expression:"$t(`m.treeinfo['已通过']`)",modifiers:{top:!0}}],staticClass:"bk-icon icon-check-1"}):e._e(),e._v(" "),"TERMINATED"===e.node.nodeInfo.statusInfo||"FAILED"===e.node.nodeInfo.statusInfo?o("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:"TERMINATED"===e.node.nodeInfo.statusInfo?e.$t("m.treeinfo['被终止']"):e.$t("m.treeinfo['失败']"),expression:"node.nodeInfo.statusInfo === 'TERMINATED' ? $t(`m.treeinfo['被终止']`) : $t(`m.treeinfo['失败']`)",modifiers:{top:!0}}],staticClass:"bk-icon icon-close"}):e._e(),e._v(" "),"RUNNING"===e.node.nodeInfo.statusInfo||"SUSPEND"===e.node.nodeInfo.statusInfo?o("img",{staticClass:"bk-rotation",attrs:{src:n("9qga")}}):e._e()])]:e._e()],2)]:e._e()})),e._v(" "),"ROUTER-P"===e.node.type?o("div",{staticClass:"common-branch"},[o("i",{staticClass:"bk-itsm-icon icon-flow-convergence"})]):e._e(),e._v(" "),"COVERAGE"===e.node.type?o("div",{staticClass:"common-branch"},[o("i",{staticClass:"bk-itsm-icon icon-flow-branch"})]):e._e()],2)},i=[];o._withStripped=!0},K3AT:function(e,t,n){"use strict";n("7NNj")},MaN0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"NodeTemplate",props:{node:{type:Object,default:function(){return{}}},previewInfo:{type:Object,default:function(){return{}}},normalColor:{type:Boolean,default:!1}},data:function(){return{moveFlag:!1,typeList:[{type:"NORMAL",iconStyle:"icon-icon-person"},{type:"ROUTER",iconStyle:"icon-icon-person"},{type:"TASK",iconStyle:"icon-api-icon"},{type:"TASK-SOPS",iconStyle:"icon-task-node"},{type:"TASK-DEVOPS",iconStyle:"icon-devops-task-icon"},{type:"SIGN",iconStyle:"icon-sign-node-white"},{type:"APPROVAL",iconStyle:"icon-approval-node"}]}},mounted:function(){},methods:{movdeDoneFn:function(){this.moveFlag=!1},moveFn:function(){this.moveFlag=!0},onNodeClick:function(e,t){if(this.moveFlag)this.$emit("submitNodeValue",e);else{if("START"===e.type||"END"===e.type||"ROUTER-P"===e.type||"COVERAGE"===e.type)return;this.$emit("clickNodeInfo",e)}this.moveFlag=!1}}}},PovW:function(e,t,n){"use strict";n("+t3h")},V77z:function(e,t,n){"use strict";n.r(t);var o=n("nMdP"),i=n.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t.default=i.a},Xetr:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var o=function(){var e=this.$createElement,t=this._self._c||e;return this.fullStatus?t("div",{staticClass:"tools-wrapper"},[t("div",{staticClass:"tool-item",attrs:{"data-test-id":"tools-warpper-ZoomIn",title:this.$t("m.treeinfo['放大']")},on:{click:this.onZoomIn}},[t("i",{staticClass:"bk-itsm-icon icon-order-add icon-cus"})]),this._v(" "),t("div",{staticClass:"tool-item",attrs:{"data-test-id":"tools-warpper-ZoomOut",title:this.$t("m.treeinfo['缩小']")},on:{click:this.onZoomOut}},[t("i",{staticClass:"bk-itsm-icon icon-order-reduce icon-cus"})])]):this._e()},i=[];o._withStripped=!0},"ZI3/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(n("0nTK")),i=a(n("4nBA")),s=a(n("4HBs"));function a(e){return e&&e.__esModule?e:{default:e}}var c={endpoint:"Dot",connector:["Flowchart",{stub:[10,16],alwaysRespectStub:!0,gap:2,cornerRadius:10}],connectorOverlays:[["PlainArrow",{width:8,length:6,location:1,id:"arrow"}]],paintStyle:{fill:"rgba(0, 0, 0, 0)",stroke:"",strokeWidth:1,radius:6},hoverPaintStyle:{fill:"#EE8F62",stroke:"#EE8F62",radius:8},cssClass:"template-canvas-endpoint",hoverClass:"template-canvas-endpoint-hover",isSource:!0,isTarget:!0,maxConnections:-1},r={grid:[5,5]},d={paintStyle:{fill:"transparent",stroke:"#a9adb6",strokeWidth:1},hoverPaintStyle:{fill:"transparent",stroke:"#3a84ff",strokeWidth:2},cssClass:"bk-sops-connector",hoverClass:"bk-sops-connector-hover",detachable:!0};t.default={components:{JsFlow:o.default,NodeTemplate:i.default,toolPanel:s.default},props:{addList:{type:Array,default:function(){return[]}},lineList:{type:Array,default:function(){return[]}},previewInfo:{type:Object,default:function(){return{}}},fullStatus:{type:Boolean,default:function(){return!1}},normalColor:{type:Boolean,default:!1}},data:function(){return{endpointOptions:c,connectorOptions:d,nodeOptions:r,canvasData:{nodes:[],lines:[]},nodeInfo:{},toolLimit:4,currentNode:{}}},computed:{nodeStatus:function(){return this.$store.state.deployCommon.nodeStatus}},created:function(){this.initDate()},mounted:function(){this.addLineOverlay(),this.$refs.previewFlow.zoomOut(this.previewInfo.narrowSize)},methods:{initDate:function(){var e=this;this.addList.forEach((function(t,n){var o=t.axis.x?t.axis.x:165+250*n,i=t.axis.y?t.axis.y:195+(n%2==1?5:0);e.canvasData.nodes.push({id:"node_"+t.id,x:o,y:i,type:t.type,name:t.name,showMore:!1,nodeInfo:t}),e.$set(e.nodeInfo,"node_"+t.id,t)})),this.lineList.forEach((function(t,n){e.canvasData.lines.push({source:{arrow:t.axis.start||"Right",id:"node_"+t.from_state},target:{arrow:t.axis.end||"Left",id:"node_"+t.to_state},lineInfo:t,options:{paintStyle:{fill:"transparent",stroke:"SUCCESS"===t.lineStatus?"#2DCB56":"#a9adb6",strokeWidth:1}}})}))},changeDataStatus:function(){var e=this;this.canvasData.nodes.forEach((function(t){e.addList.forEach((function(e){t.nodeInfo.id===e.id&&(t.nodeInfo=e)}))}))},addLineOverlay:function(){var e=this;this.canvasData.lines.forEach((function(t){var n={id:"label_"+t.lineInfo.id,type:"Label",name:'<span class="bk-label-test-name">'+(t.lineInfo.name||e.$t('m.treeinfo["默认"]'))+"</span>",cls:"label-test",location:.5};"默认"!==t.lineInfo.name&&"Default"!==t.lineInfo.name&&t.lineInfo.name&&e.$refs.previewFlow.addLineOverlay(t,n)}))},onZoomIn:function(){this.toolLimit>9||(this.toolLimit+=1,this.$refs.previewFlow&&this.$refs.previewFlow.zoomIn())},onZoomOut:function(){0!==this.toolLimit&&(this.toolLimit-=1,this.$refs.previewFlow&&this.$refs.previewFlow.zoomOut())},onResetPosition:function(){this.$refs.jsFlow.resetPosition()},handleScroll:function(e){e.deltaY>0?this.onZoomOut():this.onZoomIn()},clickNodeInfo:function(e){this.previewInfo.canClick&&this.$parent.openNodeContent(e)},submitNodeValue:function(e){this.currentNode=e},onNodeMoveStop:function(e,t){e.x===this.currentNode.x&&e.y===this.currentNode.y&&this.$parent.openNodeContent(e)}}}},Zt4X:function(e,t,n){"use strict";n.r(t);var o=n("ZI3/"),i=n.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t.default=i.a},hpsS:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bk-second-flow bk-preview-flow"},[n("js-flow",{ref:"previewFlow",attrs:{selector:"entry-item","endpoint-options":e.endpointOptions,"connector-options":e.connectorOptions,"node-options":e.nodeOptions,"show-palette":!1},on:{onNodeMoveStop:e.onNodeMoveStop},scopedSlots:e._u([{key:"nodeTemplate",fn:function(t){var o=t.node;return[n("node-template",{ref:"templateNode",attrs:{node:o,"canvas-data":e.canvasData,"preview-info":e.previewInfo,"normal-color":e.normalColor},on:{clickNodeInfo:e.clickNodeInfo,submitNodeValue:e.submitNodeValue}})]}}]),model:{value:e.canvasData,callback:function(t){e.canvasData=t},expression:"canvasData"}},[n("template",{slot:"toolPanel"},[n("tool-panel",{attrs:{"full-status":e.fullStatus},on:{onZoomIn:e.onZoomIn,onZoomOut:e.onZoomOut,onResetPosition:e.onResetPosition}})],1)],2)],1)},i=[];o._withStripped=!0},i8o3:function(e,t,n){"use strict";n.r(t);var o=n("hpsS"),i=n("Zt4X");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("PovW");var a=n("KHd+"),c=Object(a.a)(i.default,o.a,o.b,!1,null,"417ce924",null);c.options.__file="src/views/commonComponent/preview/index.vue",t.default=c.exports},ilb7:function(e,t,n){"use strict";n.r(t);var o=n("MaN0"),i=n.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t.default=i.a},llfE:function(e,t,n){"use strict";n("JHcm")},nMdP:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"toolPanel",props:{fullStatus:{type:Boolean,default:function(){return!1}}},data:function(){return{}},methods:{onZoomIn:function(){this.$emit("onZoomIn")},onZoomOut:function(){this.$emit("onZoomOut")},onResetPosition:function(){this.$emit("onResetPosition")}}}}}]);