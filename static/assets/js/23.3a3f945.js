(window.webpackJsonp=window.webpackJsonp||[]).push([[23,7],{"+DAV":function(e,t,i){"use strict";i.r(t);var n=i("E8LH"),o=i("FauL");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("VbbY");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"b7c7f51e",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/signNode.vue",t.default=r.exports},"+QRE":function(e,t,i){"use strict";i.r(t);var n=i("APEn"),o=i("h1eg");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("alqI");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"03c863ba",null);r.options.__file="src/views/commonComponent/fieldComponent/tree.vue",t.default=r.exports},"+VvI":function(e,t,i){},"+fOZ":function(e,t,i){"use strict";i.r(t);var n=i("N3dC"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"+uwX":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-basic-node"},[i("basic-card",{attrs:{"card-label":e.$t("m.treeinfo['基本信息']")}},[i("bk-form",{ref:"nodeInfoForm",staticStyle:{"margin-bottom":"40px"},attrs:{"form-type":"vertical","label-width":150,model:e.formInfo,rules:e.nodeInfoRule}},[i("bk-form-item",{attrs:{"data-test-id":"approveNode-input-nodeName",label:e.$t("m.treeinfo['节点名称：']"),required:!0,property:"name","ext-cls":"bk-form-width"}},[i("bk-input",{attrs:{maxlength:"120"},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"approveNode-input-nodeLabel",label:e.$t("m.treeinfo['节点标签：']"),required:!0,"ext-cls":"bk-form-width"}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:e.formInfo.tag,callback:function(t){e.$set(e.formInfo,"tag",t)},expression:"formInfo.tag"}},e._l(e.nodeTagList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"approveNode-radio-approveMode",label:e.$t("m.treeinfo['审批方式：']"),required:!0,property:"nodeType"}},[i("bk-radio-group",{on:{change:e.handleChangeDispose},model:{value:e.processType,callback:function(t){e.processType=t},expression:"processType"}},[i("bk-radio",{attrs:{value:"multi","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['或签']"))+"\n                        "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['任一处理人完成审批即可。']"),expression:"$t(`m.treeinfo['任一处理人完成审批即可。']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"})]),e._v(" "),i("bk-radio",{attrs:{value:"sequential","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['顺序会签']"))+"\n                        "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['所有处理人按顺序进行审批。']"),expression:"$t(`m.treeinfo['所有处理人按顺序进行审批。']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"})]),e._v(" "),i("bk-radio",{attrs:{value:"random"}},[e._v(e._s(e.$t("m.treeinfo['随机会签']"))+"\n                        "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['所有处理人随机进行审批。']"),expression:"$t(`m.treeinfo['所有处理人随机进行审批。']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"})])],1),e._v(" "),e.isShowSignSwitch?[i("span",{staticClass:"bk-condtion-switch"},[e._v(e._s(e.$t("m.treeinfo['提前结束条件']")))]),e._v(" "),i("bk-switcher",{attrs:{"data-test-id":"approve-switcher-condtion",theme:"primary"},model:{value:e.isShowSignOptions,callback:function(t){e.isShowSignOptions=t},expression:"isShowSignOptions"}}),e._v(" "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['若配置了会签提前结束条件，满足条件，将提前结束']"),expression:"$t(`m.treeinfo['若配置了会签提前结束条件，满足条件，将提前结束']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"}),e._v(" "),e.isShowSignOptions?i("div",{staticClass:"bk-condition-content"},[e._l(e.finishCondition.expressions,(function(t,n){return i("div",{key:n,staticClass:"bk-condition-group"},[i("p",{staticClass:"bk-group-title"},[e._v(e._s(e.$t("m.treeinfo['或-条件组']"))+e._s(n+1))]),e._v(" "),i("div",{class:{"bk-group-content":!0,"bk-group-contents":t.expressions.length>1}},e._l(t.expressions,(function(o,a){return i("bk-form",{key:a,ref:"finishConditionForms",refInFor:!0,attrs:{"label-width":0,rules:e.finishConditionRule,model:o,"form-type":"inline","ext-cls":"bk-condition"}},[i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus",property:"key"}},[t.expressions.length>1?i("div",{staticClass:"bk-left-block"},[i("span",{class:{"left-top-default":!0,"no-left-border":0===a}}),e._v(" "),i("span",{class:{"left-bottom-default":!0,"no-left-border":a===t.expressions.length-1}}),e._v(" "),a!==t.expressions.length-1?i("span",{staticClass:"bk-left-letter"},[e._v(e._s(e.$t("m.common['且']")))]):e._e()]):e._e(),e._v(" "),i("bk-select",{attrs:{"data-test-id":"approve-select-condtionType","font-size":"medium",clearable:!1,"ext-cls":"bk-form-width-long"},on:{selected:function(t){return e.selectCondition(t,o,a,n)}},model:{value:o.key,callback:function(t){e.$set(o,"key",t)},expression:"expression.key"}},e._l(e.allCondition,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus"}},[i("bk-select",{attrs:{"data-test-id":"approve-select-condtion","font-size":"medium",clearable:!1,"ext-cls":"bk-form-width-short"},model:{value:o.condition,callback:function(t){e.$set(o,"condition",t)},expression:"expression.condition"}},e._l(e.betweenList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus",property:"value"}},[i("bk-input",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:o.tooltipInfo,expression:"expression.tooltipInfo"}],attrs:{"data-test-id":"approve-condtion-value","ext-cls":"bk-form-width-long",disabled:!e.$refs.processors.getValue().value&&"INT"===o.meta.unit||!o.key,clearable:!1,type:"number",max:"INT"===o.meta.unit?e.formInfo.processors.length:100,min:0,precision:0},on:{change:function(t){return e.giveTooltip(o)}},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"expression.value"}}),e._v(" "),"PERCENT"===o.meta.unit?i("span",{staticClass:"buttonIcon"},[e._v("%")]):e._e()],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus"}},[i("div",{staticClass:"bk-operate-expression"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add mr10",on:{click:function(i){return e.operateExpression(t)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce mr10",class:{"bk-itsm-icon-disable":1===t.expressions.length},on:{click:function(i){return e.operateExpression(t,"del",a,n,o)}}})])]),e._v(" "),i("i",{staticClass:"bk-icon icon-close bk-delete-group",on:{click:function(t){return e.operateGroup("del",n)}}})],1)})),1)])})),e._v(" "),i("p",{staticClass:"bk-add-group",attrs:{"data-test-id":"approve-condtion-addGroup"},on:{click:e.operateGroup}},[i("i",{staticClass:"bk-itsm-icon icon-add-new mr5"}),e._v("\n                            "+e._s(e.$t("m.treeinfo['添加“或”条件组']")))])],2):e._e()]:e._e()],2),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"approveNode-component-processor",label:e.$t("m.treeinfo['处理人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.processors=!1}}},[i("deal-person",{ref:"processors",attrs:{value:e.processorsInfo,"node-info":e.configur,"exclude-role-type-list":e.excludeProcessor}})],1)]),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"approveNode-input-ticketStatus",label:e.$t("m.treeinfo['设置单据状态：']"),required:!0,"ext-cls":"bk-form-width"}},[i("bk-select",{attrs:{"ext-cls":"inline-form-width",clearable:!1,searchable:"","font-size":"medium"},on:{selected:e.handleTicket},model:{value:e.formInfo.ticket_type,callback:function(t){e.$set(e.formInfo,"ticket_type",t)},expression:"formInfo.ticket_type"}},e._l(e.billStatusList,(function(e){return i("bk-option",{key:e.type,attrs:{id:e.type,name:e.name}})})),1),e._v(" "),"custom"===e.formInfo.ticket_type?[i("bk-select",{attrs:{"ext-cls":"inline-form-width",loading:e.ticketKeyLoading,clearable:!1,searchable:"","font-size":"medium"},model:{value:e.formInfo.ticket_key,callback:function(t){e.$set(e.formInfo,"ticket_key",t)},expression:"formInfo.ticket_key"}},e._l(e.secondLevelList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2),e._v(" "),e.configur.is_builtin?e._e():[i("bk-form-item",{attrs:{"data-test-id":"approveNode-radio-canDeliver",label:e.$t("m.treeinfo['是否可转单：']"),required:!0}},[i("bk-radio-group",{model:{value:e.formInfo.can_deliver,callback:function(t){e.$set(e.formInfo,"can_deliver",t)},expression:"formInfo.can_deliver"}},[i("bk-radio",{attrs:{value:!0,"ext-cls":"mr20"}},[e._v(e._s(e.$t('m.treeinfo["是"]')))]),e._v(" "),i("bk-radio",{attrs:{value:!1}},[e._v(e._s(e.$t('m.treeinfo["否"]')))])],1)],1)],e._v(" "),e.formInfo.can_deliver?[i("bk-form-item",{attrs:{"data-test-id":"approveNode-component-deliver",label:e.$t("m.treeinfo['转单人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.delivers=!1}}},[i("deal-person",{ref:"delivers",attrs:{value:e.deliversInfo,"exclude-role-type-list":e.deliversExclude}})],1)])]:e._e(),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['自动处理']"),required:!0}},[i("bk-checkbox",{attrs:{"true-value":!0,"false-value":!1},model:{value:e.formInfo.is_allow_skip,callback:function(t){e.$set(e.formInfo,"is_allow_skip",t)},expression:"formInfo.is_allow_skip"}},[e._v("\n                    节点处理人为空时，直接跳过且不视为异常\n                ")])],1)],2),e._v(" "),i("field-config",{ref:"field",attrs:{"is-show-title":!0,"flow-info":e.flowInfo,configur:e.configur}}),e._v(" "),i("common-trigger-list",{attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"bk-node-btn"},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"approve-button-submit",title:e.$t("m.treeinfo['确定']"),loading:e.secondClick},on:{click:e.submitNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['确定']"))+"\n            ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"approve-button-close",title:e.$t("m.treeinfo['取消']"),loading:e.secondClick},on:{click:e.closeNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['取消']"))+"\n            ")])],1)],1)],1)},o=[];n._withStripped=!0},"/5i8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("ukIK")),o=r(i("xl+m")),a=r(i("T3vI")),s=r(i("/ojM"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseContent",components:{changeConductor:n.default,sendMessage:o.default,apiCall:a.default,modifyField:s.default},props:{item:{type:Object,default:function(){return{}}},signal:String},data:function(){return{}},computed:{onlyBackendSignals:function(){return this.$store.state.common.configurInfo.only_backend_signals||[]},isShowFrontendTrigger:function(){return!this.onlyBackendSignals.includes(this.signal)}},watch:{isShowFrontendTrigger:{handler:function(e){e||(this.item.performData.runMode="BACKEND")},immediate:!0}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.$set(this.item,"contentStatus",!1),"api"===this.item.wayInfo.key?this.item.wayInfo.field_schema.forEach((function(t){"api_source"===t.key?(e.$set(t,"systemId",""),e.$set(t,"apiId","")):e.$set(t,"apiContent",{})})):this.item.wayInfo.field_schema.forEach((function(t){var i=t.value||"";if("MEMBERS"===t.type||"MULTI_MEMBERS"===t.type)if(i=[],t.value)t.value.forEach((function(e){if(e.value){var t={key:e.value.member_type,value:e.value.members,secondLevelList:[],isLoading:!1};i.push(t)}}));else{i.push({key:"",value:"",secondLevelList:[],isLoading:!1})}e.$set(t,"value",i),"SUBCOMPONENT"===t.type&&t.sub_components&&t.sub_components.length&&t.sub_components.forEach((function(t){t.field_schema.length&&t.field_schema.forEach((function(t){var i=t.value||"";"MEMBERS"!==t.type&&"MULTI_MEMBERS"!==t.type||(i=[],Array.isArray(t.value)?t.value.forEach((function(e){if(e.value){var t={key:e.value.member_type,value:e.value.members,secondLevelList:[],isLoading:!1};i.push(t)}})):i=[{key:"",value:"",secondLevelList:[],isLoading:!1}]),e.$set(t,"value",i)}))}))}))}}}},"/9eO":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("CeR/"),a=i("2Mt+"),s=(n=a)&&n.__esModule?n:{default:n};t.default={name:"apiCall",components:{inputParams:s.default},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{apiSysList:[],apiList:[],apiId:"",isLoading:!1}},mounted:function(){this.getRemoteSystemData(),this.initData()},methods:{initData:function(){var e=this;this.item.wayInfo.field_schema.forEach((function(t){"api_source"===t.key&&t.value&&e.getApiContent(t.value)}))},getRemoteSystemData:function(){var e=this,t={project_key:this.$route.query.project_id};this.$store.dispatch("apiRemote/get_all_remote_system",t).then((function(t){e.apiSysList=t.data.filter((function(e){return e.is_activated}))})).catch((function(t){(0,o.errorHandler)(t,e)})).finally((function(){}))},changeCode:function(){this.getApiTableList(arguments[2].systemId),arguments[2].apiId="",this.apiId=""},getApiTableList:function(e){var t=this,i={remote_system:e||""};this.$store.dispatch("apiRemote/get_remote_api",i).then((function(e){t.apiList=e.data.filter((function(e){return e.is_activated}))})).catch((function(e){(0,o.errorHandler)(e,t)})).finally((function(){}))},changeApi:function(e){var t=arguments,i=this;this.isLoading=!0;var n=this.apiList.filter((function(e){return e.id===t[0]}))[0];this.item.wayInfo.field_schema.forEach((function(e){e.apiContent=n,i.$set(e.apiContent,"bodyTableData",[])})),this.apiId=e,setTimeout((function(){i.isLoading=!1}),1e3)},getApiContent:function(e){var t=this;this.isLoading=!0;var i={id:e};this.$store.dispatch("apiRemote/get_remote_api_detail",i).then((function(i){var n=i.data;t.item.wayInfo.field_schema.forEach((function(i){"api_source"===i.key&&i.value?(i.apiId=e,i.systemId=n.remote_system):(i.apiContent=n,t.$set(i.apiContent,"bodyTableData",[]))})),t.getApiTableList(n.remote_system),t.apiId=e,setTimeout((function(){t.isLoading=!1}),1e3)})).catch((function(e){(0,o.errorHandler)(e,t)})).finally((function(){}))}}}},"/BG8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("Jwqd"),a=i("WSG0"),s=(n=a)&&n.__esModule?n:{default:n};var r={styles:{type:Object,default:function(){return{}}},value:{type:[String,Array],default:""}};t.default={name:"TagText",mixins:[(0,o.getFormMixins)(r)],data:function(){return{}},computed:{hasChildren:function(){return this.form.children&&Array.isArray(this.form.children)&&!!this.form.children.length}},methods:{onClick:function(){if(this.hasChildren){var e="";e=Array.isArray(this.value)?this.value.map((function(e){return(e.label||"")+e.value})).join(","):(this.label||"")+this.value;var t=this.getContext();if(t.config&&"combine"===t.config.mode)this.getTopViewItem().appendCrumbsItem(e,this.form.children);else(0,s.default)({title:e,formData:this.form.children,context:t})}}}}},"/Hw/":function(e,t,i){"use strict";i.r(t);var n=i("kvAC"),o=i("HOWN");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("ayEi");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"2cad9d24",null);r.options.__file="src/views/commonComponent/fieldComponent/members.vue",t.default=r.exports},"/KdC":function(e,t,i){"use strict";i.r(t);var n=i("ujts"),o=i("13wB");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"2a82c570",null);r.options.__file="src/views/commonComponent/fieldComponent/checkbox.vue",t.default=r.exports},"/Xc1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("QbLZ"),a=(n=o)&&n.__esModule?n:{default:n},s=i("CeR/");t.default={name:"ChooseServiceTemplateDialog",components:{},props:{isShow:Boolean,createInfo:Object,serviceId:[String,Number]},data:function(){return{loading:!1,searchModel:!1,searchResultList:[],recomTemplateList:[],createdTemplateList:[]}},computed:{createWay:function(){return this.createInfo.key},templateList:function(){return this.searchModel?this.searchResultList:"recom"===this.createWay?this.recomTemplateList:this.createdTemplateList}},watch:{isShow:function(e){if(!e)return!1;"recom"===this.createWay?this.getRecomService():this.getAllService()}},methods:{getAllService:function(){var e=this;this.loading=!0,this.$store.dispatch("service/getServiceList",{no_page:!0}).then((function(t){t.result&&(e.createdTemplateList=t.data)})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.loading=!1}))},getRecomService:function(){var e=this;this.loading=!0,this.$store.dispatch("basicModule/get_tables",{no_page:!0}).then((function(t){e.recomTemplateList=t.data}),(function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.loading=!1}))},searchHandler:function(e){this.searchModel=""!==e;var t=new RegExp("("+e+")","ig");this.searchResultList=this.createdTemplateList.filter((function(e){return t.test(e.name)})).map((function(e){return(0,a.default)({},e,{name:e.name.replace(t,'<span style="color: #3a84ff;">$1</span>')})}))},onTemplateClick:function(e){var t=void 0,i=void 0;"recom"===this.createWay?(t={id:this.serviceId,table_id:e.id},i="importFromTemplate"):(t={id:this.serviceId,service_id:e.id},i="importFromService"),this.updateCurrServiceForm(t,i)},updateCurrServiceForm:function(e,t){var i=this;this.loading=!0,this.$store.dispatch("service/"+t,e).then((function(e){i.$bkMessage({message:i.$t('m.systemConfig["更新成功"]'),theme:"success"}),i.$emit("update:isShow",!1),i.$emit("updateServiceSource","importFromTemplate"===t?"template":"service")})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){i.loading=!1}))},onDialogClose:function(e){this.$emit("update:isShow",e)}}}},"/bFB":function(e,t,i){"use strict";i("s31z")},"/inP":function(e,t,i){"use strict";i.r(t);var n=i("Bzqh"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"/jEY":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[i("bk-table",{attrs:{data:e.prcTable,size:"small"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),prop:"name"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.desc}},[e._v(e._s(t.row.desc||"--"))])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[i("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:t.row.source_type,callback:function(i){e.$set(t.row,"source_type",i)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"CUSTOM"===t.row.source_type?i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[i("bk-input",{attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}})],1):i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[i("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:t.row.value_key,callback:function(i){e.$set(t.row,"value_key",i)},expression:"props.row.value_key"}},e._l(e.stateList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1)]}}])})],1)],1)},o=[];n._withStripped=!0},"/ojM":function(e,t,i){"use strict";i.r(t);var n=i("Tbkf"),o=i("aDD8");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("mwWM");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"70fb165e",null);r.options.__file="src/views/processManagement/publicTrigger/components/modifyField.vue",t.default=r.exports},"070I":function(e,t,i){"use strict";i.r(t);var n=i("qi5P"),o=i("hAcJ");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("FeB+");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7fa53101",null);r.options.__file="src/views/commonComponent/fieldComponent/file.vue",t.default=r.exports},"0Aq+":function(e,t,i){"use strict";i.r(t);var n=i("aQoq"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"0nTK":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("P2sY")),o=f(i("gDS+")),a=f(i("jWXv")),s=f(i("FyfS")),r=f(i("JO7F")),c=f(i("nLf9")),l=f(i("GQeE")),u=f(i("SEkw")),d=i("4ZMo");function f(e){return e&&e.__esModule?e:{default:e}}function p(e,t,i){return t in e?(0,u.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=(0,l.default)(i);"function"==typeof c.default&&(n=n.concat((0,c.default)(i).filter((function(e){return(0,r.default)(i,e).enumerable})))),n.forEach((function(t){p(e,t,i[t])}))}return e}var h=function(e,t,i,n,o,a,s,r,c,l){"boolean"!=typeof s&&(c=r,r=s,s=!1);var u,d="function"==typeof i?i.options:i;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,o&&(d.functional=!0)),n&&(d._scopeId=n),a?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=u):t&&(u=s?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),u)if(d.functional){var f=d.render;d.render=function(e,t){return u.call(t),f(e,t)}}else{var p=d.beforeCreate;d.beforeCreate=p?[].concat(p,u):[u]}return i},v="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase()),g=document.head||document.getElementsByTagName("head")[0],b={},_=function(e){return function(e,t){return function(e,t){var i=v?t.media||"default":e,n=b[i]||(b[i]={ids:new a.default,styles:[]});if(!n.ids.has(e)){n.ids.add(e);var s=t.source;if(t.map&&(s+="\n/*# sourceURL="+t.map.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent((0,o.default)(t.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",t.media&&n.element.setAttribute("media",t.media),g.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(s),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{var r=n.ids.size-1,c=document.createTextNode(s),l=n.element.childNodes;l[r]&&n.element.removeChild(l[r]),l.length?n.element.insertBefore(c,l[r]):n.element.appendChild(c)}}}(e,t)}},y=h({render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"palette-panel"},[this._t("palette",[this._m(0)])],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"palette-group"},[t("li",[t("div",{staticClass:"palette-default-item type-a",attrs:{"data-type":"type-a"}},[this._v("A")])]),t("li",[t("div",{staticClass:"palette-default-item type-b",attrs:{"data-type":"type-b"}},[this._v("B")])]),t("li",[t("div",{staticClass:"palette-default-item type-c",attrs:{"data-type":"type-c"}},[this._v("C")])]),t("li",[t("div",{staticClass:"palette-default-item type-d",attrs:{"data-type":"type-d"}},[this._v("D")])])])}]},(function(e){e&&e("data-v-6c6ee110_0",{source:".palette-group{margin:0;padding:0;background:#fcfcfc;text-align:center;list-style:none}.palette-group>li{padding:14px 0}.palette-default-item{display:inline-block;width:40px;height:40px;line-height:40px;font-size:12px;color:#888;border:1px solid #999;border-radius:2px;cursor:pointer;user-select:none}.palette-default-item:hover{box-shadow:0 0 8px rgba(50,50,50,.3)}.type-a{border-radius:50%}.type-b{border-radius:50%;border:4px solid #333}.type-c,.type-d{height:30px;line-height:30px;border:1px solid #999}.type-d{position:relative}.type-d:after{content:'';position:absolute;top:0;right:0;width:5px;height:5px;border-radius:50%;background:#ccc}",map:void 0,media:void 0})}),{name:"PalettePanel",props:["selector"],data:function(){return{}},mounted:function(){this.$emit("registerPaletteEvent")}},void 0,!1,void 0,_,void 0),k=h({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tool-panel"},e._l(e.tools,(function(t,n){return i("div",{key:n,class:["tool-item",t.cls,{actived:"frameSelect"===t.type&&e.isFrameSelecting}],attrs:{title:t.title},on:{click:function(i){return e.onToolClick(t)}}},[e._v("\n        "+e._s(t.name)+"\n    ")])})),0)},staticRenderFns:[]},(function(e){e&&e("data-v-20cba315_0",{source:".tool-item{display:inline-block;margin-right:10px;user-select:none;cursor:pointer}.tool-item:last-child{margin-right:0}.tool-item.actived{color:#3a84ff}",map:void 0,media:void 0})}),{name:"ToolPanel",props:["tools","isFrameSelecting"],data:function(){return{}},methods:{onToolClick:function(e){this.$emit("onToolClick",e)}}},void 0,!1,void 0,_,void 0),I=h({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-flow-location",on:{mousedown:function(t){e.moveFlag=!1},mousemove:function(t){e.moveFlag=!0},mouseup:function(t){return e.onNodeClick(e.node,t)}}},["type-a"===e.node.type?i("div",{staticClass:"type-a"},[e._v("start")]):"type-b"===e.node.type?i("div",{staticClass:"type-b"},[e._v("end")]):"type-c"===e.node.type?i("div",{staticClass:"type-c"},[e._v("taskNode")]):"type-d"===e.node.type?i("div",{staticClass:"type-d"},[e._v("subFlow")]):i("div",{staticClass:"node-default"})])},staticRenderFns:[]},(function(e){e&&e("data-v-2d0e3090_0",{source:".bk-flow-location .type-c,.bk-flow-location .type-d{width:120px;height:60px;line-height:60px;border:1px solid #ccc;text-align:center;cursor:pointer}.bk-flow-location .type-c:hover,.bk-flow-location .type-d:hover{border-color:#348aff}.bk-flow-location .type-d{position:relative}.bk-flow-location .type-d:after{content:'';position:absolute;top:0;right:0;width:10px;height:10px;border-radius:50%;background:#ccc}.bk-flow-location .type-a,.bk-flow-location .type-b{width:60px;height:60px;line-height:60px;border-radius:50%;border:1px solid #ccc;text-align:center}.bk-flow-location .type-b{border:4px solid #333}.bk-flow-location .node-default{width:120px;height:80px;line-height:80px;border:1px solid #ccc;border-radius:2px;text-align:center}.bk-flow-location .node-default.selected{border:1px solid #3a84ff}",map:void 0,media:void 0})}),{name:"NodeTemplate",props:{node:{type:Object,default:function(){return{}}}},data:function(){return{moveFlag:!1}},methods:{onNodeClick:function(e,t){this.moveFlag||console.log(e.x,e.y)}}},void 0,!1,void 0,_,void 0);function w(e){return"touches"in e?e.touches[0]:e}function C(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="",i=0;i<7;i++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e+t}var S={showPalette:{type:Boolean,default:!0},showTool:{type:Boolean,default:!0},tools:{type:Array,default:function(){return[{type:"zoomIn",name:"放大",cls:"tool-item"},{type:"zoomOut",name:"缩小",cls:"tool-item"},{type:"resetPosition",name:"重置",cls:"tool-item"},{type:"frameSelect",name:"框选",cls:"tool-item"}]}},editable:{type:Boolean,default:!0},selector:{type:String,default:"palette-default-item"},quickConnect:{type:Boolean,default:!0},data:{type:Object,default:function(){return{nodes:[],lines:[]}}},nodeOptions:{type:Object,default:function(){return{grid:[5,5]}}},connectorOptions:{type:Object,default:function(){return{paintStyle:{fill:"transparent",stroke:"#a9adb6",strokeWidth:2},hoverPaintStyle:{fill:"transparent",stroke:"#3a84ff"}}}},endpointOptions:{type:Object,default:function(){return{endpoint:"Dot",connector:["Flowchart",{stub:[1,6],alwaysRespectStub:!0,gap:8,cornerRadius:2}],connectorOverlays:[["PlainArrow",{width:8,length:6,location:1,id:"arrow"}]],anchor:["Left","Right","Top","Bottom"],isSource:!0,isTarget:!0}}}},x={mousedown:"ontouchstart"in document.documentElement?"touchstart":"mousedown",mousemove:"ontouchmove"in document.documentElement?"touchmove":"mousemove",mouseup:"ontouchend"in document.documentElement?"touchend":"mouseup"},L=h({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"jsflow"},[i("div",{staticClass:"canvas-area"},[e.showTool?i("div",{staticClass:"tool-panel-wrap"},[e._t("toolPanel",[i("tool-panel",{attrs:{tools:e.tools,"is-frame-selecting":e.isFrameSelecting},on:{onToolClick:e.onToolClick}})])],2):e._e(),e.showPalette?i("div",{ref:"palettePanel",staticClass:"palette-panel-wrap"},[e._t("palettePanel",[i("palette-panel",{attrs:{selector:e.selector}})])],2):e._e(),i("div",{ref:"canvasFlowWrap",staticClass:"canvas-flow-wrap",style:e.canvasWrapStyle,on:e._d({},[e.mousedown,e.onCanvasMouseDown,e.mouseup,e.onCanvasMouseUp])},[i("div",{ref:"canvasFlow",staticClass:"canvas-flow",style:e.canvasStyle,attrs:{id:"canvas-flow"}},e._l(e.nodes,(function(t){return i("div",{key:t.id,staticClass:"jsflow-node canvas-node",attrs:{id:t.id},on:{mouseover:function(i){return e.toggleHighLight(t,!0)},mouseout:function(i){return e.toggleHighLight(t,!1)}}},[e._t("nodeTemplate",[i("node-template",{attrs:{node:t}})],{node:t})],2)})),0),e.isFrameSelecting?i("div",{staticClass:"canvas-frame-selector",style:e.frameSelectorStyle}):e._e()]),e.showAddingNode?i("div",{staticClass:"jsflow-node adding-node",style:e.setNodeInitialPos(e.addingNodeConfig)},[e._t("nodeTemplate",[i("node-template",{attrs:{node:e.addingNodeConfig}})],{node:e.addingNodeConfig})],2):e._e()])])},staticRenderFns:[]},(function(e){e&&e("data-v-e853be96_0",{source:".jsflow{height:100%;border:1px solid #ccc}.jsflow .canvas-area{position:relative;height:100%}.jsflow .tool-panel-wrap{position:absolute;top:20px;left:70px;padding:10px 20px;background:#c4c6cc;opacity:.65;border-radius:4px;z-index:4}.jsflow .palette-panel-wrap{float:left;width:60px;height:100%;border-right:1px solid #ccc}.jsflow .canvas-flow-wrap{position:relative;height:100%;overflow:hidden}.jsflow .canvas-flow{position:relative;min-width:100%;min-height:100%}.jsflow .canvas-frame-selector{position:absolute;border:1px solid #3a84ff;background:rgba(58,132,255,.15)}.jsflow .jsflow-node{position:absolute;z-index:1}.jsflow .jtk-endpoint{z-index:1}.jsflow .adding-node{opacity:.8}.jsflow .jtk-endpoint.jtk-dragging{z-index:0}",map:void 0,media:void 0})}),{name:"JsFlow",components:{PalettePanel:y,ToolPanel:k,NodeTemplate:I},model:{prop:"data",event:"change"},props:S,data:function(){var e=this.data;return m({nodes:e.nodes,lines:e.lines,canvasGrabbing:!1,isFrameSelecting:!1,mouseDownPos:{},canvasPos:{x:0,y:0},canvasOffset:{x:0,y:0},frameSelectorPos:{x:0,y:0},frameSelectorRect:{width:0,height:0},selectedNodes:[],showAddingNode:!1,addingNodeConfig:{},addingNodeRect:{},canvasRect:{},paletteRect:{},zoom:1},x)},computed:{canvasWrapStyle:function(){return{cursor:this.isFrameSelecting?"crosshair":this.canvasGrabbing?"-webkit-grabbing":"-webkit-grab"}},canvasStyle:function(){return{left:"".concat(this.canvasOffset.x,"px"),top:"".concat(this.canvasOffset.y,"px")}},frameSelectorStyle:function(){return{left:"".concat(this.frameSelectorPos.x,"px"),top:"".concat(this.frameSelectorPos.y,"px"),width:"".concat(this.frameSelectorRect.width,"px"),height:"".concat(this.frameSelectorRect.height,"px")}}},watch:{data:{handler:function(e){var t=e.nodes,i=e.lines;this.nodes=t,this.lines=i},deep:!0},editable:function(e){var t=this.$el.querySelectorAll(".canvas-node");this.toggleNodeDraggable(t,e)}},mounted:function(){this.initCanvas(),this.registerEvent(),this.renderData(),this.canvasRect=this.$refs.canvasFlow.getBoundingClientRect(),this.$refs.palettePanel&&(this.paletteRect=this.$refs.palettePanel.getBoundingClientRect(),this.registerPaletteEvent())},beforeDestroy:function(){this.$refs.palettePanel&&this.$refs.palettePanel.removeEventListener(this.mousedown,this.nodeCreateHandler),this.$el.removeEventListener(this.mousemove,this.nodeMovingHandler),document.removeEventListener(this.mouseup,this.nodeMoveEndHandler)},methods:{initCanvas:function(){var e={},t=m({},this.endpointOptions,this.connectorOptions);for(var i in t){var n=i[0].toUpperCase();e["".concat(n).concat(i.slice(1))]=t[i]}this.instance=d.jsPlumb.getInstance(m({container:"canvas-flow"},e))},registerEvent:function(){var e=this;this.instance.bind("beforeDrag",(function(t){return!!e.editable&&("function"!=typeof e.$listeners.onBeforeDrag||e.$listeners.onBeforeDrag(t))})),this.instance.bind("beforeDrop",(function(t){return!!e.editable&&("function"!=typeof e.$listeners.onBeforeDrop||e.$listeners.onBeforeDrop(t))})),this.instance.bind("connectionDrag",(function(t){"function"==typeof e.$listeners.connectionDrag&&e.$emit("connectionDrag",t)})),this.instance.bind("connection",(function(t){if("function"==typeof e.$listeners.onConnection)return e.$listeners.onConnection(t)})),this.instance.bind("connectionDragStop",(function(t,i){if(!t.target||!t.target.classList.contains("jsflow-node")){var n=e.getNodeWithEndpoint(i.target);if(n){var o=e.nodes.find((function(e){return n.id===e.id}));if("function"==typeof e.$listeners.onConnectionDragStop){var a={id:t.source.id,arrow:t.endpoints[0].anchor.type};e.$emit("onConnectionDragStop",a,o.id,i)}}}})),this.instance.bind("beforeDetach",(function(t){return"function"!=typeof e.$listeners.onBeforeDetach||e.$listeners.onBeforeDetach(t)})),this.instance.bind("connectionDetached",(function(t,i){var n=e.lines.filter((function(e){return e.source.id!==t.sourceId&&e.target.id!==t.targetId}));e.lines=n,"function"==typeof e.$listeners.onConnectionDetached&&e.$emit("onConnectionDetached",n)})),this.instance.bind("connectionMoved",(function(t,i){"function"==typeof e.$listeners.onConnectionMoved&&e.$emit("onConnectionMoved",lines)})),this.instance.bind("click",(function(t,i){"function"==typeof e.$listeners.onConnectionClick&&e.$emit("onConnectionClick",t,i)})),this.instance.bind("dblclick",(function(t,i){"function"==typeof e.$listeners.onConnectionDbClick&&e.$emit("onConnectionDbClick",t,i)}))},renderData:function(){var e=this;this.instance.batch((function(){e.nodes.forEach((function(t){e.initNode(t)})),e.lines.forEach((function(t){e.createConnector(t,e.connectorOptions)}))}))},createNode:function(e){var t=this;("function"!=typeof this.$listeners.onCreateNodeBefore||this.$listeners.onCreateNodeBefore(e))&&(this.nodes.push(e),this.$nextTick((function(){t.initNode(e)})))},initNode:function(e){var t=document.getElementById(e.id);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px"),this.setNodeDraggable(e,this.nodeOptions),this.setNodeEndPoint(e,this.endpointOptions),"function"==typeof this.$listeners.onCreateNodeAfter&&this.$emit("onCreateNodeAfter",e)},removeNode:function(e){var t=this.nodes.findIndex((function(t){return t.id===e.id}));this.nodes.splice(t,1),this.instance.remove(e.id)},setNodeEndPoint:function(e,t){var i=this;(e.endpoints||["Top","Right","Bottom","Left"]).forEach((function(n){i.instance.addEndpoint(e.id,m({anchor:n,uuid:n+e.id},t))}))},setNodeDraggable:function(e,t){if(this.editable){var i=this;this.instance.draggable(e.id,m({grid:[20,20],drag:function(t){var o=(0,n.default)({},e);i.$emit("onNodeMoving",o,t)},stop:function(t){var o=i.nodes.findIndex((function(t){return t.id===e.id})),a=(0,n.default)({},e),r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=[],n=!0,o=!1,a=void 0;try{for(var r,c=(0,s.default)(e);!(n=(r=c.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t.pos,2),c=r[0],l=r[1];a.x=c,a.y=l,i.nodes.splice(o,1,a),i.$emit("onNodeMoveStop",a,t)}},t))}},setNodePosition:function(e){var t=document.getElementById(e.id);t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px"),this.instance.revalidate(t)},toggleNodeDraggable:function(e,t){this.instance.setDraggable(e,t)},setNodeInitialPos:function(e){return{left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}},createConnector:function(e,t){var i=e.options||{};return this.instance.connect({source:e.source.id,target:e.target.id,uuids:[e.source.arrow+e.source.id,e.target.arrow+e.target.id]},m({},t,i))},getConnectorsByNodeId:function(e){return this.instance.getAllConnections().filter((function(t){return t.sourceId===e||t.targetId===e}))},getNodeWithEndpoint:function(e){var t=e.parentNode;return!(!t||"HTML"===t.nodeName)&&(t.classList.contains("jsflow-node")?t:this.getNodeWithEndpoint(t))},removeConnector:function(e){var t=this;this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){t.instance.deleteConnection(e)}))},addLineOverlay:function(e,t){var i=this;this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){e.addOverlay([t.type,{label:t.name,location:t.location,cssClass:t.cls,id:t.id,events:{click:function(e,t){i.$emit("onOverlayClick",e,t)}}}])}))},removeLineOverlay:function(e,t){this.instance.getConnections({source:e.source.id,target:e.target.id}).forEach((function(e){e.removeOverlay(t)}))},onCanvasMouseDown:function(e){e=w(e),this.isFrameSelecting?this.frameSelectHandler(e):(this.canvasGrabbing=!0,this.mouseDownPos={x:e.pageX,y:e.pageY},this.$refs.canvasFlowWrap.addEventListener(this.mousemove,this.canvasFlowMoveHandler,!1))},canvasFlowMoveHandler:function(e){e=w(e),this.canvasOffset={x:this.canvasPos.x+e.pageX-this.mouseDownPos.x,y:this.canvasPos.y+e.pageY-this.mouseDownPos.y}},onCanvasMouseUp:function(e){this.isFrameSelecting?this.frameSelectEndHandler(e):(this.canvasGrabbing=!1,this.$refs.canvasFlowWrap.removeEventListener(this.mousemove,this.canvasFlowMoveHandler),this.canvasPos={x:this.canvasOffset.x,y:this.canvasOffset.y})},registerPaletteEvent:function(){this.$refs.palettePanel.addEventListener(this.mousedown,this.nodeCreateHandler,!1)},nodeCreateHandler:function(e){var t=this,i=function e(t,i){return 1===t.nodeType&&t.classList.contains(i)?t:"HTML"!==t.parentNode.nodeName?e(t.parentNode,i):null}(e.target,this.selector);if(!i)return!1;var n=i.dataset.type?i.dataset.type:"",o=i.dataset?i.dataset.config:{};this.showAddingNode=!0,this.addingNodeConfig.id=C("node"),this.addingNodeConfig.type=n,this.$nextTick((function(){var i=t.$el.querySelector(".adding-node");t.addingNodeRect=i.getBoundingClientRect();var a=t.getAddingNodePos(e);t.addingNodeConfig=m({id:C("node"),type:n,x:a.x,y:a.y},o),t.$el.addEventListener(t.mousemove,t.nodeMovingHandler,!1),document.addEventListener(t.mouseup,t.nodeMoveEndHandler,!1)}))},nodeMovingHandler:function(e){var t=this.getAddingNodePos(e);this.$set(this.addingNodeConfig,"x",t.x),this.$set(this.addingNodeConfig,"y",t.y)},nodeMoveEndHandler:function(e){if(this.$el.removeEventListener(this.mousemove,this.nodeMovingHandler),document.removeEventListener(this.mouseup,this.nodeMoveEndHandler),this.showAddingNode=!1,e.pageX>this.paletteRect.left+this.paletteRect.width){var t=this.addingNodeConfig.x-this.paletteRect.width-this.canvasOffset.x,i=this.addingNodeConfig.y-this.canvasOffset.y;this.$set(this.addingNodeConfig,"x",t),this.$set(this.addingNodeConfig,"y",i),this.createNode(this.addingNodeConfig)}this.addingNodeConfig={},this.addingNodeRect={}},getAddingNodePos:function(e){return{x:e.pageX-this.paletteRect.left-this.addingNodeRect.width/2,y:e.pageY-this.paletteRect.top-this.addingNodeRect.height/2}},toggleHighLight:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(this.instance.getEndpoints(e.id),document.getElementById(e.id));this.instance.selectEndpoints({source:n}).each((function(e){var n=i?t.endpointOptions.hoverPaintStyle:t.endpointOptions.paintStyle;e.setStyle(n)}))},onToolClick:function(e){"function"==typeof this[e.type]&&this[e.type](),this.$emit("onToolClick",e)},setZoom:function(e){this.instance.setContainer("canvas-flow"),this.$refs.canvasFlow.style.transform="matrix("+e+",0,0,"+e+",0,0)",this.$refs.canvasFlow.style.transformOrigin="0 0",this.$refs.canvasFlow.zoom=e,this.zoom=e,this.instance.setZoom(e)},zoomIn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.1;this.setZoom(this.zoom*e)},zoomOut:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.9;this.setZoom(this.zoom*e)},resetPosition:function(){this.setZoom(1),this.setCanvasPosition(0,0)},setCanvasPosition:function(e,t){this.canvasOffset={x:e,y:t},this.canvasPos={x:e,y:t}},frameSelect:function(){this.isFrameSelecting=!0},frameSelectHandler:function(e){this.mouseDownPos={x:e.pageX-this.canvasRect.left,y:e.pageY-this.canvasRect.top},this.$refs.canvasFlowWrap.addEventListener(this.mousemove,this.frameSelectMovingHandler,!1)},frameSelectMovingHandler:function(e){var t=e.pageX-this.mouseDownPos.x-this.canvasRect.left,i=e.pageY-this.mouseDownPos.y-this.canvasRect.top;this.frameSelectorRect={width:Math.abs(t),height:Math.abs(i)},this.frameSelectorPos={x:t>0?this.mouseDownPos.x:this.mouseDownPos.x+t,y:i>0?this.mouseDownPos.y:this.mouseDownPos.y+i}},frameSelectEndHandler:function(e){this.$refs.canvasFlowWrap.removeEventListener(this.mousemove,this.frameSelectMovingHandler),this.$refs.canvasFlowWrap.removeEventListener(this.mouseup,this.frameSelectEndHandler),document.addEventListener("keydown",this.nodeLineCopyhandler,!1),document.addEventListener("keydown",this.nodeLinePastehandler,!1),document.addEventListener("keydown",this.nodeLineDeletehandler,!1),document.addEventListener(this.mousedown,this.cancelFrameSelectorHandler,{capture:!1,once:!0});var t=this.getSelectedNodes(),i=t.map((function(e){return e.id}));this.isFrameSelecting=!1,this.frameSelectorPos={x:0,y:0},this.frameSelectorRect={width:0,height:0},this.selectedNodes=t,this.clearNodesDragSelection(),this.addNodesToDragSelection(i),this.$emit("frameSelectNodes",t.slice(0))},getSelectedNodes:function(){var e=this,t=this.frameSelectorPos,i=t.x,n=t.y,o=this.frameSelectorRect,a=o.width,s=o.height;return this.nodes.filter((function(t){var o=document.querySelector("#".concat(t.id)),r=o.getBoundingClientRect(),c=r.left-e.canvasRect.left,l=r.top-e.canvasRect.top;if(i<c&&i+a>c&&n<l&&n+s>l)return o.classList.add("selected"),!0}))},cancelFrameSelectorHandler:function(e){this.selectedNodes.forEach((function(e){var t=document.querySelector("#".concat(e.id));t&&t.classList.remove("selected")})),this.selectedNodes=[],this.clearNodesDragSelection()},nodeLineCopyhandler:function(e){(e.ctrlKey||e.metaKey)&&67===e.keyCode&&this.$emit("onNodeCopy",this.selectedNodes)},nodeLinePastehandler:function(e){(e.ctrlKey||e.metaKey)&&86===e.keyCode&&this.$emit("onNodePaste")},nodeLineDeletehandler:function(e){var t=this;46!==e.keyCode&&8!==e.keyCode||(this.selectedNodes.forEach((function(e){t.removeNode(e)})),this.cancelFrameSelectorHandler())},addNodesToDragSelection:function(e){this.instance.addToDragSelection(e)},clearNodesDragSelection:function(){this.instance.clearDragSelection()}}},void 0,!1,void 0,_,void 0);"undefined"!=typeof window&&"Vue"in window&&window.Vue.component("js-flow",L),t.default=L},"0njq":function(e,t,i){"use strict";i.r(t);var n=i("Noe1"),o=i("Mf0c");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("uFXv");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"bc2c159c",null);r.options.__file="src/views/commonComponent/fieldComponent/editor.vue",t.default=r.exports},"0rd9":function(e,t,i){"use strict";i.r(t);var n=i("3ncw"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"0uNP":function(e,t,i){"use strict";i.r(t);var n=i("DoRf"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"0vGa":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("QbLZ")),o=r(i("KW1/")),a=i("L2JU"),s=i("CeR/");function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"triggerCondition",components:{triggerField:o.default},props:{triggerRules:{type:Object,default:function(){return{}}}},data:function(){return{keyList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,a.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),mounted:function(){this.keyList=this.triggerVariables,this.$set(this.triggerRules,"checkStatus",!1)},methods:{addLine:function(e,t,i){e.itemList.splice(i+1,0,{condition:"",key:"",value:"",conditionList:[],type:"STRING"})},deleteLine:function(e,t,i){1!==e.itemList.length&&e.itemList.splice(i,1)},changeBetween:function(e){e.type="all"===e.type?"any":"all"},handleBetween:function(){this.triggerRules.type="all"===this.triggerRules.type?"any":"all"},addGroup:function(){this.triggerRules.list.push({type:"all",itemList:[{key:"",condition:"",value:"",conditionList:[],type:"STRING"}]})},deleteGroup:function(e,t){1!==this.triggerRules.list.length&&this.triggerRules.list.splice(t,1)},changeContent:function(e){var t=this.keyList.filter((function(t){return t.key===e.key}))[0],i=t.type.toLowerCase();e.conditionList=this.globalChoise.trigger_methods[i],this.getConditionList(t,e),e.condition="",this.$set(e,"conditionType",""),e.type=t.type;e.value=["MEMBERS","MEMBER","MULTI_MEMBERS","MULTISELECT","CHECKBOX"].some((function(t){return t===e.type}))?[]:""},changeCondition:function(e){var t=e.conditionList.filter((function(t){return t.name===e.condition}))[0];this.$set(e,"conditionType",t.input_type)},getConditionList:function(e,t){var i=this;["SELECT","RADIO","MULTISELECT","CHECKBOX"].some((function(t){return t===e.type}))&&(this.$set(t,"loading",!0),this.$set(t,"options",[]),"DATADICT"===e.source_type?this.$store.dispatch("datadict/get_data_by_key",{key:e.source_uri,field_key:e.key}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):"API"===e.source_type?this.$store.dispatch("apiRemote/get_data_workflow",{kv_relation:e.kv_relation,api_instance_id:e.api_instance_id}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):"RPC"===e.source_type?this.$store.dispatch("apiRemote/getRpcData",{meta:e.meta,source_uri:e.source_uri}).then((function(e){t.options=e.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){t.loading=!1})):(t.options=e.choice.map((function(e){return{key:e.key,name:e.name}})),t.loading=!1))}}}},"11QV":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(i("jWXv")),o=y(i("rfXi")),a=y(i("P2sY")),s=y(i("QbLZ")),r=y(i("gDS+")),c=y(i("14Xm")),l=y(i("D3Ub")),u=y(i("GQeE")),d=y(i("PaSM")),f=y(i("Y6/M")),p=y(i("JGQq")),m=y(i("lAAG")),h=y(i("qVGl")),v=y(i("XDfz")),g=y(i("2Vgw")),b=i("ughI"),_=i("CeR/");function y(e){return e&&e.__esModule?e:{default:e}}t.default={name:"addField",components:{dataSource:f.default,dataContent:p.default,customTableData:m.default,defaultValue:h.default,hiddenConditions:v.default},mixins:[d.default],props:{formAlign:{type:String,default:"vertical"},changeInfo:{type:Object,default:function(){return{}}},workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},sospInfo:{type:Object,default:function(){return{}}},addOrigin:{type:Object,default:function(){return{isOther:!1,addOriginInfo:{}}}},isEditPublic:{type:Boolean,default:!1},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},autoSelectedType:{type:Boolean,default:!0},nodesList:Array},data:function(){return{isShowDataSource:!1,isDataLoading:!1,trueStatus:!0,falseStatus:!1,secondClick:!1,isPublicField:!1,formInfo:{prevId:"",name:"",key:"",type:"",regex:"",regex_config:{rule:{expressions:[],type:"and"}},customRegex:"",source_type:"",source_uri:"",default_value:"",layout:"",validate:"",desc:"",is_tips:!1,tips:"",show_type:!1,show_conditions:{}},regexFieldList:[],allBetweenList:[{id:1,available:"INT",name:this.$t("m.common['大于']"),typeName:">"},{id:2,available:"INT",name:this.$t("m.common['小于']"),typeName:"<"},{id:3,available:"INT",name:this.$t("m.common['不大于']"),typeName:"<="},{id:4,available:"INT",name:this.$t("m.common['不小于']"),typeName:">="},{id:5,available:"DATE",name:this.$t("m.common['早于']"),typeName:"<"},{id:6,available:"DATE",name:this.$t("m.common['晚于']"),typeName:">"},{id:7,available:"DATE",name:this.$t("m.common['不早于']"),typeName:">="},{id:8,available:"DATE",name:this.$t("m.common['不晚于']"),typeName:"<="}],betweenList:[],customTableInfo:{list:[{name:"",display:"input",choice:"",required:!1,nameCheck:!1,check:!1}]},prevNodeList:[],frontNodesList:[],regexList:[],showType:{sourceList:["SELECT","MULTISELECT","CHECKBOX","RADIO","TABLE","TREESELECT","INPUTSELECT"],belongDefaultList:["STRING","TEXT","INT","DATE","DATETIME","DATETIMERANGE","SELECT","MULTISELECT","CHECKBOX","RADIO","MEMBER","MEMBERS","INPUTSELECT","RICHTEXT","CUSTOM-FORM"],multipleList:["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"],layoutList:["TABLE","CUSTOMTABLE","RICHTEXT","CUSTOM-FORM"]},rules:{},assignValue:{},fieldInfo:{list:[{name:"",key:"",required:!1}]},apiDetail:{},apiInfo:{api_info:{remote_system_id:"",remote_api_id:"",req_params:{},req_body:{},rsp_data:""},kv_relation:{key:"",name:""}},dictionaryData:{list:[],check:""},prcData:{list:[],check:""},prcTable:[],fileList:[],fileVal:"",checkStatus:{customStatus:!1,customTableStatus:!1,customFormStatus:!1},fieldTypeList:[],hiddenConditionStatus:!0}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo},isShowDataSourcebtn:function(){return!("API"!==this.formInfo.source_type&&"CUSTOM"!==this.formInfo.source_type||0===(0,u.default)(this.apiDetail).length&&0===this.fieldInfo.list.length)},isDisabled:function(){return"API"===this.formInfo.source_type&&!this.apiInfo.api_info.remote_api_id}},watch:{formInfo:{handler:function(e){this.$emit("getAddFieldStatus",""!==e.name)},deep:!0}},mounted:function(){var e=this;return(0,l.default)(c.default.mark((function t(){return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isDataLoading=!0,t.next=3,e.initData();case 3:e.rules.name=e.checkCommonRules("name").name,e.rules.key=e.checkCommonRules("key").key,e.rules.type=e.checkCommonRules("select").select,e.rules.tips=e.checkCommonRules("select").select,e.rules.prevId=e.checkCommonRules("select").select,e.isDataLoading=!1,"add"===e.changeInfo.id&&e.autoSelectedType&&e.changeType();case 10:case"end":return t.stop()}}),t,e)})))()},methods:{openDataSource:function(){this.isShowDataSource=!0},fieldNameChange:function(){var e=this.$refs.fieldForm.$data.formItems.find((function(e){return"key"===e.property}));e.fieldValue&&(e.validator.content="",e.validator.state="")},initData:function(){var e=this;this.fieldTypeList=this.globalChoise.field_type.filter((function(e){return"DATETIMERANGE"!==e.typeName})),"COMPLEX-MEMBERS"!==this.changeInfo.type&&"SOPS_TEMPLATE"!==this.changeInfo.type||"templateField"!==this.addOrigin.addOriginInfo.type||(this.fieldTypeList=this.fieldTypeList.concat([{name:this.$t("m.common['复杂人员选择']"),typeName:"COMPLEX-MEMBERS"},{name:this.$t("m.common['标准运维模板']"),typeName:"SOPS_TEMPLATE"}])),this.globalChoise.source_type.forEach((function(t){var i="CUSTOM"===t.typeName?e.$t("m.treeinfo['自定义数据每行的name和key都不能相同。']"):e.$t("m.treeinfo['接口中的数据详情']");e.$set(t,"desc",i)})),this.nodesList?this.frontNodesList=this.nodesList:this.getFrontNodesList(),this.assignmentData(),this.changeRegex("ASSOCIATED_FIELD_VALIDATION"),this.getRegexList(),this.getRpcList(),this.getSysDictList(),this.getPreStates()},assignmentData:function(e){var t=this,i=e||this.changeInfo;if(this.formInfo.name=i.name,this.formInfo.key=i.key,this.formInfo.type=i.type,this.formInfo.regex=i.regex,"CUSTOM"===this.formInfo.regex&&(this.formInfo.customRegex=i.custom_regex||""),i.regex_config&&i.regex_config.rule&&(this.changeRegex("ASSOCIATED_FIELD_VALIDATION"),this.formInfo.regex_config.rule.type=i.regex_config.rule.type,this.formInfo.regex_config=i.regex_config),this.formInfo.layout=i.layout,this.formInfo.validate=i.validate_type,this.formInfo.desc=i.desc,this.formInfo.is_tips=i.is_tips,this.formInfo.tips=i.tips,this.formInfo.default_value=this.showType.multipleList.some((function(e){return e===i.type}))&&""!==i.default?i.default.split(","):i.default||"",this.formInfo.source_type=i.source_type,"CUSTOM"===i.source_type)if("FILE"===i.type)for(var n in i.choice)this.fileList.push(i.choice[n]);else 0!==i.choice.length&&(this.fieldInfo.list=[],i.choice.forEach((function(e){t.fieldInfo.list.push({name:e.name,key:e.key,required:!!e.required,nameCheck:!1,keyCheck:!1})})));else"API"===this.formInfo.source_type?this.apiInfo.api_info=i.api_info:"DATADICT"===this.formInfo.source_type?(this.formInfo.source_uri=i.source_uri,this.dictionaryData.check=this.formInfo.source_uri):"RPC"===this.formInfo.source_type&&(this.formInfo.source_uri=i.source_uri,this.prcData.check=i.source_uri);this.formInfo.show_type=0===i.show_type,this.formInfo.show_conditions=i.show_conditions||{},"CUSTOMTABLE"===this.formInfo.type&&(this.customTableInfo.list=[],i.meta.hasOwnProperty("columns")?i.meta.columns.forEach((function(e){var i=[];e.choice.forEach((function(e){i.push(e.name)})),t.customTableInfo.list.push({name:e.name,display:e.display,choice:i.join("\n"),required:e.required,nameCheck:!1,check:!1})})):this.customTableInfo.list.push({name:"",display:"input",choice:"",required:!1,nameCheck:!1,check:!1})),(0,u.default)(this.sospInfo).length&&(this.formInfo.name=this.sospInfo.name||"",this.formInfo.validate="REQUIRE"),this.assignValue=JSON.parse((0,r.default)(i))},getFrontNodesList:function(){var e=this;return(0,l.default)(c.default.mark((function t(){var i,n;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state||e.templateInfo.id){t.next=2;break}return t.abrupt("return");case 2:return i="",n={},e.state&&(i="apiRemote/get_related_fields",n.workflow=e.workflow,n.state=e.state),e.templateInfo.id&&(i="taskTemplate/getFrontFieldsList",n.id=e.templateInfo.id,n.stage=e.templateStage),t.next=8,e.$store.dispatch(i,n).then((function(t){e.frontNodesList=t.data})).catch((function(t){(0,_.errorHandler)(t,e)}));case 8:case"end":return t.stop()}}),t,e)})))()},addExpression:function(){this.formInfo.regex_config.rule.expressions.push({condition:"",key:"",source:"field",type:this.formInfo.type,value:""})},deleteExpression:function(e){1!==this.formInfo.regex_config.rule.expressions.length&&this.formInfo.regex_config.rule.expressions.splice(e,1)},changeType:function(e){var t=this;return(0,l.default)(c.default.mark((function e(){return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.formInfo.regex="EMPTY",t.formInfo.customRegex="",t.showType.layoutList.includes(t.formInfo.type)&&(t.formInfo.layout="COL_12"),t.formInfo.field="",t.dictionaryData.check="","TREESELECT"===t.formInfo.type?t.formInfo.source_type="DATADICT":t.formInfo.source_type="CUSTOM",t.fieldInfo.list.length||(t.fieldInfo.list=[{name:"",key:"",required:!1,nameCheck:!1,keyCheck:!1}]),"CUSTOM-FORM"===t.formInfo.type&&(t.formInfo.default_value=b.CUSTOM_FORM_DEFAULT_VALUE),e.next=10,t.getRegexList();case 10:t.formInfo.regex_config.rule.expressions=[];case 11:case"end":return e.stop()}}),e,t)})))()},changeRegex:function(e){var t=this;this.formInfo.customRegex="","ASSOCIATED_FIELD_VALIDATION"===e&&(this.regexFieldList=this.frontNodesList.filter((function(e){return"INT"===t.formInfo.type?e.type===t.formInfo.type:"DATE"===e.type||"DATETIME"===e.type})).filter((function(e){return e.id!==t.changeInfo.id})),["DATE","DATETIME"].includes(this.formInfo.type)&&this.regexFieldList.push({name:"系统时间",id:"system_time",key:"system_time",source:"system"}),this.betweenList=this.allBetweenList.filter((function(e){return"INT"===t.formInfo.type?"INT"===e.available:"DATE"===e.available})),this.betweenList.push({name:"等于",typeName:"=="}),this.formInfo.regex_config.rule.expressions.length||this.addExpression())},getRegexList:function(){var e=this,t=this.formInfo.type;this.$store.dispatch("cdeploy/regexList",t).then((function(t){e.regexList=t.data.regex_choice.map((function(t){return{name:t[1]?t[1]:e.$t('m.treeinfo["无"]'),typeName:t[0]}}))})).catch((function(t){(0,_.errorHandler)(t,e)}))},onRegexFieldChange:function(e,t){t.source=["system_time"].includes(e)?"system":"field"},relateSelected:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];t[2].type=t[1].type,t[2].source=t[1].source},putKey:function(){var e=this;"number"!=typeof this.changeInfo.id&&(this.formInfo.key="",(0,g.default)(this.formInfo.name,{style:g.default.STYLE_NORMAL,heteronym:!1}).forEach((function(t){e.formInfo.key=e.formInfo.key+""+t})),this.formInfo.key=this.formInfo.key.toUpperCase(),this.formInfo.key=this.formInfo.key.replace(/\ /g,"_"),this.formInfo.key.length>=32&&(this.formInfo.key=this.formInfo.key.substr(0,32)))},changeApiInfo:function(e){this.apiDetail=e},getRpcData:function(e){this.prcTable=e},handleFile:function(e){for(var t=this,i=e.target.files[0],n=i.size/1024,o=i.name,a=0;a<this.fileList.length;a++)if(o===this.fileList[a].name)return void this.$bkMessage({message:this.$t('m.treeinfo["此文件已经上传"]'),theme:"error"});if(n<=1e5){var r=new FormData;r.append("field_file",i),this.$store.dispatch("cdeploy/fileUpload",{data:r}).then((function(e){for(var i in e.data.succeed_files)t.fileList.push((0,s.default)({},e.data.succeed_files[i],{key:i}));t.fileVal="",t.$bkMessage({message:t.$t('m.treeinfo["上传成功"]'),theme:"success"})})).catch((function(e){(0,_.errorHandler)(e,t)}))}else this.fileVal="",this.$bkMessage({message:this.$t('m.treeinfo["该文件大小超过100MB！"]'),theme:"error"})},deleteFile:function(e,t){this.fileList.splice(t,1)},addField:function(){var e=this;return(0,l.default)(c.default.mark((function t(){var i,n,o,s;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDataContent();case 2:if(i=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!e.secondClick){t.next=7;break}return t.abrupt("return");case 7:e.secondClick=!0,"number"==typeof e.changeInfo.id?(n=e.changeInfo.id,o="TABLE"===e.changeInfo.source?"cdeploy/changeNewModuleField":"cdeploy/changeNewField",e.addOrigin.isOther&&e.addOrigin.addOriginInfo.updateUrl&&(o=e.addOrigin.addOriginInfo.updateUrl,"templateField"===e.addOrigin.addOriginInfo.type&&(i.task_schema_id=e.templateInfo.id,i.stage=e.templateStage,"COMPLEX-MEMBERS"!==i.type&&"SOPS_TEMPLATE"!==i.type||delete i.type)),e.changeInfo.project_key&&(i.project_key=e.changeInfo.project_key),e.$store.dispatch(o,{params:i,id:n}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["修改成功"]'),theme:"success"}),e.$emit("closeShade"),e.addOrigin.isOther&&e.addOrigin.addOriginInfo.updateUrl&&"templateField"!==e.addOrigin.addOriginInfo.type&&e.$parent.$parent.getList?e.$parent.$parent.getList():e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():e.$emit("getRelatedFields"),e.$emit("onConfirm",(0,a.default)({},e.changeInfo,i))})).catch((function(t){(0,_.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))):(i.state=e.state,(0,u.default)(e.sospInfo).length&&(i.state=e.formInfo.prevId),s="cdeploy/addNewField",e.addOrigin.isOther&&e.addOrigin.addOriginInfo.addUrl&&(s=e.addOrigin.addOriginInfo.addUrl,"templateField"===e.addOrigin.addOriginInfo.type&&(i.task_schema_id=e.templateInfo.id,i.stage=e.templateStage)),e.changeInfo.project_key&&(i.project_key=e.changeInfo.project_key),e.$store.dispatch(s,{params:i}).then((function(t){e.addNew=t.data,e.$bkMessage({message:e.$t('m.treeinfo["新增成功"]'),theme:"success"}),e.$emit("closeShade"),e.addOrigin.isOther&&e.addOrigin.addOriginInfo.addUrl?"templateField"===e.addOrigin.addOriginInfo.type&&e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():e.$parent.$parent.getList&&e.$parent.$parent.getList():e.$parent.$parent.getTableList?e.$parent.$parent.getTableList():(e.$emit("getRelatedFields"),e.$parent.$parent.showNew&&e.$parent.$parent.showNew(e.sospInfo,t)),e.$emit("onConfirm",t.data)})).catch((function(t){(0,_.errorHandler)(t,e)})).finally((function(){e.secondClick=!1})));case 9:case"end":return t.stop()}}),t,e)})))()},onCancelClick:function(){this.$emit("closeShade"),this.$emit("onCancel")},checkInfo:function(){var e=this;this.$refs.fieldForm.validate().then((function(t){e.$refs.dataSource&&e.$refs.dataSource.checkSouce()||e.checkField()||(!e.formInfo.is_tips||e.formInfo.tips?e.addField():e.$bkMessage({theme:"warning",message:e.$t('m.treeinfo["字段释疑为必填项"]')}))}),(function(e){console.error(e)}))},getDataContent:function(){var e=this;return(0,l.default)(c.default.mark((function t(){var i,a,s,r,l,u;return c.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i={}).layout=e.formInfo.layout,i.validate_type=e.formInfo.validate,i.regex=e.formInfo.regex,i.regex_config=e.formInfo.regex_config,i.default="",e.showType.belongDefaultList.some((function(t){return t===e.formInfo.type}))&&(s=[],(a=["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"]).some((function(t){return t===e.formInfo.type}))&&e.formInfo.default_value&&(s=e.formInfo.default_value.filter((function(e){return""!==e}))),i.default=a.some((function(t){return t===e.formInfo.type}))?s.join(","):e.formInfo.default_value),!e.$refs.hiddenConditions){t.next=17;break}if(!e.$refs.hiddenConditions.checkList()){t.next=11;break}return e.hiddenConditionStatus=!1,t.abrupt("return",!1);case 11:r=e.$refs.hiddenConditions.listInfo,i.show_conditions={type:e.$refs.hiddenConditions.conditionType,expressions:[]},r.forEach((function(e){i.show_conditions.expressions.push({key:e.key,condition:e.condition,value:Array.isArray(e.value)?e.value.join(","):e.value,type:e.type})})),i.show_type=0,t.next=19;break;case 17:i.show_type=1,i.show_conditions={};case 19:if("TABLE"===e.changeInfo.source){t.next=62;break}if(i.workflow=e.workflow,i.name=e.formInfo.name,i.key=e.formInfo.key,i.type=e.formInfo.type,i.desc=e.formInfo.desc,i.source_type=e.formInfo.source_type||"CUSTOM",i.custom_regex=e.formInfo.customRegex,i.is_tips=e.formInfo.is_tips,i.tips=e.formInfo.tips,"FILE"!==e.formInfo.type){t.next=34;break}i.choice={},e.fileList.forEach((function(t){e.$set(i.choice,t.key,t)})),t.next=51;break;case 34:if("CUSTOM"!==e.formInfo.source_type){t.next=39;break}i.choice=[],"SELECT"===e.formInfo.type||"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type||"RADIO"===e.formInfo.type||"INPUTSELECT"===e.formInfo.type?e.fieldInfo.list.forEach((function(e){i.choice.push({key:e.key,name:e.name})})):"TABLE"===e.formInfo.type&&e.fieldInfo.list.forEach((function(e){i.choice.push({key:e.key,name:e.name,required:e.required})})),t.next=51;break;case 39:if("API"!==e.formInfo.source_type){t.next=50;break}if("API"!==e.formInfo.source_type){t.next=46;break}return t.next=43,e.$refs.dataContent[0].apiFz();case 43:if(t.sent){t.next=46;break}return t.abrupt("return",!1);case 46:i.api_info=e.apiInfo.api_info,i.kv_relation=e.apiInfo.kv_relation,t.next=51;break;case 50:"DATADICT"===e.formInfo.source_type&&(i.choice=[],i.source_uri=e.dictionaryData.check);case 51:if("CUSTOMTABLE"!==e.formInfo.type){t.next=61;break}if(e.customTableInfo.list.forEach((function(e){var t=[];!e.choice||"select"!==e.display&&"multiselect"!==e.display||(t=e.choice.split("\n").filter((function(e){return e.length>0}))),e.nameCheck=0===e.name.length||e.name.length>120,e.check=!t.length&&("select"===e.display||"multiselect"===e.display)})),l=e.customTableInfo.list.some((function(e){return e.nameCheck})),u=e.customTableInfo.list.some((function(e){return e.check})),!l&&!u){t.next=58;break}return e.$bkMessage({theme:"warning",message:e.$t('m.treeinfo["请填写正确格式的自定义数据"]')}),t.abrupt("return",!1);case 58:i.meta={},i.meta.columns=[],e.customTableInfo.list.forEach((function(e){var t=e.choice.split("\n").filter((function(e){return e.length>0}));t=(0,o.default)(new n.default(t)),i.meta.columns.push({name:e.name,display:e.display,choice:e.choice.length?t:[],required:e.required})}));case 61:"RPC"===e.formInfo.source_type&&(i.source_uri=e.prcData.check,i.meta={},e.prcTable.forEach((function(e){var t="CUSTOM"===e.source_type?e.value:"${params_"+e.value_key+"}";i.meta[e.name]=t})));case 62:return t.abrupt("return",e.timeConversion(i));case 63:case"end":return t.stop()}}),t,e)})))()},timeConversion:function(e){var t=this;return""!==e.default&&("DATE"!==e.type&&"DATETIME"!==e.type||(e.default="DATE"===e.type?this.standardDayTime(e.default):this.standardTime(e.default))),e.show_conditions&&e.show_conditions.expressions&&e.show_conditions.expressions.length&&e.show_conditions.expressions.forEach((function(e){"DATE"!==e.type&&"DATETIME"!==e.type||(e.value="DATE"===e.type?t.standardDayTime(e.value):t.standardTime(e.value))})),e},checkField:function(){var e=this;this.checkStatus.customStatus=!1,this.checkStatus.customTableStatus=!1,this.checkStatus.customFormStatus=!1;if(["SELECT","MULTISELECT","CHECKBOX","RADIO","TABLE"].some((function(t){return e.formInfo.type===t}))&&"CUSTOM"===this.formInfo.source_type&&(this.fieldInfo.list.forEach((function(e){e.nameCheck=e.name.length>120||0===e.name.length,e.keyCheck=!/^[a-zA-Z0-9_]+$/.test(e.key)})),this.fieldInfo.list.forEach((function(t,i){e.fieldInfo.list.forEach((function(e,n){i!==n&&(e.key===t.key&&(t.keyCheck=!0),e.name===t.name&&(t.nameCheck=!0))}))})),this.checkStatus.customStatus=this.fieldInfo.list.some((function(e){return e.nameCheck||e.keyCheck}))),"CUSTOMTABLE"===this.formInfo.type){var t=[];this.customTableInfo.list.forEach((function(e){var i=[];!e.choice||"select"!==e.display&&"multiselect"!==e.display||(i=e.choice.split("\n").filter((function(e){return e.length>0}))),e.nameCheck=0===e.name.length||e.name.length>120,e.check=!i.length&&("select"===e.display||"multiselect"===e.display),t.includes(e.name)?e.nameCheck=!0:t.push(e.name)})),this.checkStatus.customTableStatus=this.customTableInfo.list.some((function(e){return e.nameCheck||e.check}))}if("CUSTOM-FORM"===this.formInfo.type)try{var i=JSON.parse(this.formInfo.default_value);i&&(this.checkStatus.customFormStatus=!i.schemes||!i.form_data)}catch(e){this.checkStatus.customFormStatus=!0}return this.checkStatus.customStatus||this.checkStatus.customTableStatus||this.checkStatus.customFormStatus},getRpcList:function(){var e=this;this.$store.dispatch("datadict/getPrcData").then((function(t){e.prcData.list=t.data,e.prcData.list.filter((function(t){return t.key===e.prcData.check})).length&&(e.prcTable=e.prcData.list.filter((function(t){return t.key===e.prcData.check}))[0].req_params)})).catch((function(t){(0,_.errorHandler)(t,e)}))},getSysDictList:function(){var e=this;this.$store.dispatch("datadict/list",{}).then((function(t){e.dictionaryData.list=t.data.filter((function(e){return e.is_enabled}))})).catch((function(t){(0,_.errorHandler)(t,e)}))},getPreStates:function(){var e=this;this.state&&this.$store.dispatch("deployCommon/getPreStates",{id:this.state}).then((function(t){e.prevNodeList=t.data})).catch((function(t){(0,_.errorHandler)(t,e)}))}}}},"13wB":function(e,t,i){"use strict";i.r(t);var n=i("ohl0"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"1Eew":function(e,t,i){"use strict";i.r(t);var n=i("z7tL"),o=i("dV6M");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("W8Ex");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"5c1641e1",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/autoComponents/nodeCondition.vue",t.default=r.exports},"1GnK":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"basic-card-wrap"},[e.showFoldTitle?i("div",{staticClass:"more-configuration mb20",on:{click:function(t){e.showMore=!e.showMore}}},[e.showMore?i("i",{staticClass:"bk-icon icon-up-shape"}):i("i",{staticClass:"bk-icon icon-down-shape"}),e._v(" "),i("span",[e._v(e._s(e.foldTitle))])]):e._e(),e._v(" "),i("collapse-transition",[e.showMore?i("div",{staticClass:"common-section-card-block"},[i("label",{staticClass:"common-section-card-label"},[e._v("\n                "+e._s(e.cardLabel)+"\n                "),e.cardDesc?i("p",{staticClass:"common-section-card-desc"},[e._v(e._s(e.cardDesc))]):e._e()]),e._v(" "),i("div",{staticClass:"common-section-card-body"},[e._t("default")],2)]):e._e()])],1)},o=[];n._withStripped=!0},"1fnQ":function(e,t,i){"use strict";i.r(t);var n=i("/Xc1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"1hFm":function(e,t,i){"use strict";i.r(t);var n=i("NFkJ"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"1lNk":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(i("m1cH")),o=m(i("14Xm")),a=m(i("4d7F")),s=m(i("QbLZ")),r=m(i("gDS+")),c=m(i("D3Ub")),l=m(i("PIEm")),u=m(i("PRQd")),d=m(i("bcjM")),f=m(i("s4tT")),p=i("CeR/");function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ApprovalNode",components:{BasicCard:f.default,dealPerson:l.default,fieldConfig:u.default,commonTriggerList:d.default},props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}}},data:function(){return{betweenList:[{id:1,name:">=",key:">="},{id:2,name:">",key:">"},{id:3,name:"=",key:"=="},{id:4,name:"<=",key:"<="},{id:5,name:"<",key:"<"}],finishCondition:{expressions:[{expressions:[],type:"and"}],type:"or"},finishConditionRule:{key:[{required:!0,message:this.$t("m.systemConfig['请输入']"),trigger:"blur"}],value:[{required:!0,message:this.$t("m.systemConfig['请输入']"),trigger:"blur"}]},passRateExpression:{key:"",condition:">=",value:"",source:"global",type:"INT",meta:{code:"PROCESS_COUNT",unit:"INT"},tooltipInfo:{disabled:!0,content:"",placements:["top"]}},emptyExpression:{key:"",condition:">=",value:"",source:"global",type:"INT",meta:{code:"",unit:"INT"},tooltipInfo:{disabled:!1,content:this.$t("m.treeinfo['请先选择条件']"),placements:["top"]}},isShowSignSwitch:!1,isShowSignOptions:!1,processType:"",isLoading:!1,secondClick:!1,getConditionFlag:!1,ticketKeyLoading:!1,formInfo:{name:"",tag:"",ticket_type:"",ticket_key:"",is_sequential:!1,is_multi:!0,processors:[],is_allow_skip:!1},nodeTagList:[],allCondition:[],secondLevelList:[],excludeProcessor:[],deliversExclude:["BY_ASSIGNOR","EMPTY","STARTER","VARIABLE","API","ASSIGN_LEADER","STARTER_LEADER"],billStatusList:[{type:"keep",name:this.$t('m.treeinfo["延续上个节点"]')},{type:"custom",name:this.$t('m.treeinfo["自定义"]')}],processorsInfo:{type:"",value:""},deliversInfo:{type:"",value:""},checkStatus:{delivers:!1,processors:!1},nodeInfoRule:{name:[{required:!0,message:this.$t("m.newCommon['请输入节点名称']"),trigger:"blur"}],processors:[{validator:function(e){return e.length},message:this.$t("m.newCommon['请选择处理人']"),trigger:"blur"}]}}},watch:{"formInfo.processors":function(){this.setAllTooltip()}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,c.default)(o.default.mark((function t(){var i,n,c;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAllConditions();case 2:e.isLoading=!0,i=void 0,e.processType="multi",e.formInfo.name=e.configur.name,e.formInfo.tag=e.configur.tag||"",e.formInfo.is_multi=!0===e.configur.is_multi,e.configur.is_multi?(e.isShowSignSwitch=!0,e.configur.is_sequential?e.processType="sequential":e.processType="random"):e.processType="multi",e.formInfo.is_sequential=e.configur.is_sequential,e.formInfo.is_allow_skip=e.configur.is_allow_skip,e.formInfo.processors=e.configur.processors?e.configur.processors.split(","):[],e.formInfo.ticket_type=e.configur.extras.ticket_status?e.configur.extras.ticket_status.type:"keep",e.formInfo.ticket_key=e.configur.extras.ticket_status?e.configur.extras.ticket_status.name:"",e.configur.finish_condition&&e.configur.finish_condition.expressions?(e.configur.finish_condition.expressions.length&&(e.isShowSignOptions=!0),e.finishCondition=JSON.parse((0,r.default)(e.configur.finish_condition)),e.finishCondition.expressions.forEach((function(e){e.expressions=e.expressions.map((function(e){return(0,s.default)({},e,{tooltipInfo:{disabled:!0,content:"",placements:["top"]}})}))}))):((n=e.allCondition.find((function(e){return"PROCESS_COUNT"===e.meta.code})))&&(e.passRateExpression.key=n.key),e.finishCondition.expressions[0].expressions.push(JSON.parse((0,r.default)(e.passRateExpression))),e.giveTooltip(e.passRateExpression)),e.$set(e.formInfo,"can_deliver",!0===e.configur.can_deliver),"custom"===e.formInfo.ticket_type&&(i=e.getSecondLevelList()),e.formInfo.can_deliver&&(e.deliversInfo={type:e.configur.delivers_type,value:e.configur.delivers}),e.processorsInfo={type:e.configur.processors_type,value:e.configur.processors},c=e.getNodeTagList(),e.getExcludeRoleTypeList(),a.default.all([i,c]).then((function(){e.isLoading=!1}));case 22:case"end":return t.stop()}}),t,e)})))()},getNodeTagList:function(){var e=this;return this.$store.dispatch("datadict/get_data_by_key",{key:"STATE_TAG_TYPE"}).then((function(t){e.nodeTagList=t.data})).catch((function(t){(0,p.errorHandler)(t,e)})).finally((function(){}))},getSecondLevelList:function(){var e=this;return this.ticketKeyLoading=!0,this.$store.dispatch("ticketStatus/getOverallTicketStatuses").then((function(t){e.secondLevelList=t.data})).catch((function(t){(0,p.errorHandler)(t,e)})).finally((function(){e.ticketKeyLoading=!1}))},getExcludeRoleTypeList:function(){var e=[];e=this.configur.is_builtin?["BY_ASSIGNOR","STARTER","VARIABLE"]:["OPEN"],"DISTRIBUTE_THEN_PROCESS"!==this.configur.distribute_type&&"DISTRIBUTE_THEN_CLAIM"!==this.configur.distribute_type&&e.push("BY_ASSIGNOR"),this.flowInfo.is_biz_needed||(e.push("CMDB"),this.deliversExclude.push("CMDB")),this.excludeProcessor=["EMPTY","API"].concat((0,n.default)(e))},submitNode:function(){var e=this;return(0,c.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=[e.$refs.nodeInfoForm.validate()],t.next=3,a.default.all(i).then((function(){var t={is_draft:!1,workflow:e.flowInfo.id,type:e.configur.type,is_terminable:!1,processors_type:"PERSON",finish_condition:e.finishCondition,is_multi:!1,is_allow_skip:!1};if(t.name=e.formInfo.name,t.is_sequential=e.formInfo.is_sequential,t.processors_type="",t.processors="",e.isShowSignOptions||(t.finish_condition={expressions:[],type:"or"}),!e.$refs.processors||e.$refs.processors.verifyValue()){if(e.$refs.processors){var i=e.$refs.processors.getValue();t.processors_type=i.type,t.processors=i.value}if(!e.$refs.delivers||e.$refs.delivers.verifyValue()){if(t.is_allow_skip=e.formInfo.is_allow_skip,e.$refs.delivers){var n=e.$refs.delivers.getValue();t.delivers_type=n.type,t.delivers=n.value}"multi"!==e.processType&&(t.is_multi=!0),t.tag=e.formInfo.tag,t.can_deliver=e.formInfo.can_deliver,t.ticket_type=e.formInfo.ticket_type,t.extras={ticket_status:{name:e.formInfo.ticket_key,type:e.formInfo.ticket_type}};var o=e.$refs.field.showTabList;t.fields=o.map((function(e){return e.id}));var a=e.configur.id;e.secondClick||(e.secondClick=!0,e.$store.dispatch("deployCommon/updateNode",{params:t,id:a}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$emit("closeConfigur",!0)})).catch((function(t){(0,p.errorHandler)(t,e)})).finally((function(){e.secondClick=!1})))}else e.checkStatus.delivers=!0}else e.checkStatus.processors=!0})).catch((function(e){console.log(e)}));case 3:case"end":return t.stop()}}),t,e)})))()},closeNode:function(){this.$emit("closeConfigur",!1)},handleChangeDispose:function(e){this.isShowSignSwitch=!1,this.formInfo.is_sequential=!1,"multi"!==e&&(this.isShowSignSwitch=!0),"sequential"===e&&(this.formInfo.is_sequential=!0)},handleTicket:function(e){this.formInfo.ticket_key="","custom"===e&&(this.secondLevelList.length||this.getSecondLevelList())},operateGroup:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",i=arguments[1];"del"===t?1===this.finishCondition.expressions.length?this.$bkInfo({type:"warning",title:this.$t("m.treeinfo['确定删除唯一的条件组？']"),subTitle:this.$t("m.treeinfo['若删除，则必须所有人处理完成才结束']"),confirmFn:function(){e.finishCondition.expressions.splice(i,1)}}):this.finishCondition.expressions.splice(i,1):this.finishCondition.expressions.push({expressions:[JSON.parse((0,r.default)(this.emptyExpression))],type:"and"})},operateExpression:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",i=arguments[2],n=arguments[3],o=arguments[4];if("del"===t){if(1===e.expressions.length)return;0===n&&0===i&&"PROCESS_COUNT"===o.meta.code?this.$bkInfo({type:"warning",title:this.$t("m.treeinfo['确定删除“处理人数”？']"),subTitle:this.$t("m.treeinfo['若删除该条件，则忽略处理人数，条件满足即结束']"),confirmFn:function(){e.expressions.splice(i,1)}}):e.expressions.splice(i,1)}else e.expressions.push(JSON.parse((0,r.default)(this.emptyExpression)))},getAllConditions:function(){var e=this;return(0,c.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.configur.id,e.getConditionFlag=!0,t.next=4,e.$store.dispatch("apiRemote/get_sign_conditions",i).then((function(t){var i=t.data.filter((function(e){return"NODE_APPROVE_RESULT"!==e.meta.code}));e.allCondition=i})).catch((function(t){(0,p.errorHandler)(t,e)})).finally((function(){e.getConditionFlag=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},giveTooltip:function(e){return e.key?"PASS_RATE"===e.meta.code||"REJECT_RATE"===e.meta.code||this.$refs.processors.getValue().value?(e.tooltipInfo.disabled=!0,void(e.tooltipInfo.content="")):(e.tooltipInfo.disabled=!1,void(e.tooltipInfo.content=this.$t("m.treeinfo['请先选择处理人']"))):(e.tooltipInfo.disabled=!1,void(e.tooltipInfo.content=this.$t("m.treeinfo['请先选择条件']")))},setAllTooltip:function(){var e=this;this.finishCondition.expressions.forEach((function(t){t.expressions.forEach((function(t){e.giveTooltip(t)}))}))},selectCondition:function(e,t,i,n){this.changeCondition(t)},changeCondition:function(e){e.meta.code=this.allCondition.find((function(t){return t.key===e.key})).meta.code,e.meta.unit=this.allCondition.find((function(t){return t.key===e.key})).meta.unit||"INT",this.giveTooltip(e)}}}},"22U7":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"devops-preview",class:{"full-screen":e.isFullScreen}},[i("header",{staticClass:"devops-header"},[e.isFullScreen?i("span",{staticClass:"exit-full-screen",on:{click:function(t){return t.stopPropagation(),e.onCloseFullScreen.apply(null,arguments)}}},[i("i",{staticClass:"bk-itsm-icon icon-order-close"}),e._v(" "),i("span",{staticClass:"exit-text"},[e._v(e._s(e.$t("m.common['退出全屏']")))])]):i("i",{staticClass:"bk-itsm-icon icon-order-open",on:{click:function(t){return t.stopPropagation(),e.openFullScreen()}}})]),e._v(" "),i("section",{staticClass:"devops-preview-wrap"},[i("div",{staticClass:"devops-preview-body"},e._l(e.stages,(function(t,n){return i("div",{key:t.id,staticClass:"stage"},[i("span",{staticClass:"stage-connect-line"}),e._v(" "),i("h4",{staticClass:"stage-name"},[e._v(e._s(t.name))]),e._v(" "),e._l(t.containers,(function(o,a){return i("ul",{key:o.id,staticClass:"containers"},[0!==n?i("svg",{staticClass:"container-connect-line left",style:e.getSvgStyle(t,a),attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"60",height:0===a?70:56*(t.containers[a-1].elements.length+1)}},[i("path",{attrs:{d:e.getPath(t,a)}})]):e._e(),e._v(" "),i("svg",{staticClass:"container-connect-line",style:e.getSvgStyle(t,a),attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"60",height:0===a?70:56*(t.containers[a-1].elements.length+1)}},[i("path",{attrs:{d:e.getPath(t,a)}})]),e._v(" "),i("li",{staticClass:"element container-title"},[e._v("\n                        "+e._s(o.name)+"\n                        "),0!==n?i("span",{staticClass:"semicircle"}):e._e(),e._v(" "),0!==n?i("span",{staticClass:"triangle"}):e._e()]),e._v(" "),e._l(o.elements,(function(t){return i("li",{key:t.id,class:["element",{"not-execute":!e.isElementCanExecute(t)}]},[e._v("\n                        "+e._s(t.name)+"\n                    ")])}))],2)}))],2)})),0),e._v(" "),e.loading?i("div",{staticClass:"loading"},[i("i",{staticClass:"bk-itsm-icon icon-icon-loading"}),e._v(" "),i("span",[e._v(e._s(e.$t("m.tickets['预览正在加载中']")))])]):e._e()])])},o=[];n._withStripped=!0},"25E2":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=T(i("z1yn")),o=T(i("jub7")),a=T(i("Za/z")),s=T(i("u14n")),r=T(i("/KdC")),c=T(i("TNjk")),l=T(i("qyUP")),u=T(i("VrAx")),d=T(i("4K0D")),f=T(i("nxpg")),p=T(i("eOfU")),m=T(i("MBfY")),h=T(i("/Hw/")),v=T(i("Q3ZP")),g=T(i("Wl5c")),b=T(i("0njq")),_=T(i("+QRE")),y=T(i("070I")),k=T(i("gy7N")),I=T(i("aYIO")),w=T(i("SUIt")),C=T(i("BWJp")),S=T(i("PaSM")),x=i("ygAv"),L=i("CeR/");function T(e){return e&&e.__esModule?e:{default:e}}t.default={name:"fieldInfo",components:{"CW-STRING":n.default,"CW-LINK":o.default,"CW-INT":a.default,"CW-TEXT":s.default,"CW-CHECKBOX":r.default,"CW-RADIO":c.default,"CW-SELECT":l.default,"CW-INPUTSELECT":u.default,"CW-MULTISELECT":d.default,"CW-DATE":f.default,"CW-DATETIME":p.default,"CW-MEMBER":m.default,"CW-MEMBERS":h.default,"CW-TABLE":v.default,"CW-CUSTOMTABLE":g.default,"CW-RICHTEXT":b.default,"CW-TREESELECT":_.default,"CW-FILE":y.default,"CW-CASCADE":k.default,"CW-SOPS_TEMPLATE":I.default,"CW-DEVOPS_TEMPLATE":w.default},mixins:[C.default,S.default],props:{fields:{type:Array,required:!0,default:function(){return[]}},allFieldList:{type:Array,default:function(){return[]}},basicInfomation:{type:Object,default:function(){return{}}},origin:{type:String,default:"normal"},typeInfo:{type:String,default:function(){return""}},disabled:{type:Boolean,default:!1}},data:function(){return{rotate:!1,labelWidth:200}},created:function(){var e=this;this.fields.forEach((function(t){e.$set(t,"checkValue",!1)}))},mounted:function(){var e=this;this.$nextTick((function(){e.labelWidth=e.$refs.fieldContent.clientWidth/2||200}))},methods:{freshBtn:function(e){this.rotate=!this.rotate,"CreateTicket"===this.$route.name?this.freshApi(e,this.fields,"submit"):this.freshApi(e,this.fields,"field")},freshRpc:function(e){var t=this;this.rotate=!this.rotate,this.$store.dispatch("apiRemote/getRpcData",e).then((function(t){e.choice=t.data,e.val=""})).catch((function(e){(0,L.errorHandler)(e,t)}))},fieldChange:function(){this.fieldFormatting(this.fields)},checkBuiltInTaskTemplate:function(){var e=this,t=[];return this.fields.forEach((function(i,n){"SOPS_TEMPLATE"!==i.type&&"DEVOPS_TEMPLATE"!==i.type||t.push(e.$refs["component"+n][0].validate())})),t.every((function(e){return!!e}))},jointVerification:function(){var e=this,t=!0;return this.relatedRegex(this.fields,(0,x.isEmpty)(this.allFieldList)?this.fields:this.allFieldList).validList.forEach((function(i){i.result||(t=!1,i.validList.forEach((function(t){var i=e.fields.find((function(e){return e.key===t.key}));i&&!i.checkValue&&(i.checkValue=!0,i.checkMessage=t.tips)})))})),t},requiredVerification:function(){var e=this,t=this.fields.filter((function(e){return e.showFeild&&"REQUIRE"===e.validate_type})).filter((function(e){return"CUSTOMTABLE"===e.type?e.meta.columns.some((function(e){return e.required})):"SOPS_TEMPLATE"!==e.type&&"DEVOPS_TEMPLATE"!==e.type})).filter((function(t){var i=!1;t.checkValue=!1;var n="";switch(t.type){case"TABLE":var o=!0;t.choice.forEach((function(e){""!==t.value[0][e.key]?o=!1:n+=e.name+", "})),i=o,n&&(n+=e.$t('m.newCommon["为必填项！"]'));break;case"CUSTOMTABLE":var a=!1;t.meta.columns.forEach((function(e){return t.value.forEach((function(t){e.required&&(0,x.isEmpty)(t[e.key])&&(n+=e.name+", ",a=!0)}))})),i=a,n&&(n+=e.$t('m.newCommon["为必填项！"]'));break;default:i=(0,x.isEmpty)(t.value)}return n&&(t.checkMessage=n,i=!0),t.checkValue=i,i})),i=this.checkBuiltInTaskTemplate();return!t.length&&i},checkValue:function(){this.fieldChange();var e=this.requiredVerification(),t=this.jointVerification();return e&&t}}}},"282m":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-basic-node"},[i("basic-card",{attrs:{"card-label":e.$t("m.treeinfo['基本信息']")}},[i("bk-form",{attrs:{"data-test-id":"service-form-autoNode","label-width":150,model:e.formInfo,"form-type":"vertical"}},[i("bk-form-item",{attrs:{"data-test-id":"autoNode-input-nodeName",label:e.$t("m.treeinfo['节点名称：']"),required:!0}},[i("bk-input",{attrs:{"ext-cls":"bk-form-width",maxlength:"120"},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"autoNode-select-apiInterface",label:e.$t("m.treeinfo['API接口']"),required:!0}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",clearable:!1,placeholder:e.$t("m.treeinfo['请选择接入系统']"),searchable:""},on:{selected:e.changeCode},model:{value:e.formInfo.api_info.remote_system_id,callback:function(t){e.$set(e.formInfo.api_info,"remote_system_id",t)},expression:"formInfo.api_info.remote_system_id"}},e._l(e.apiSysList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),e.formInfo.api_info.remote_system_id?[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",loading:e.isLoading,clearable:!1,searchable:""},on:{selected:e.changeMethod},model:{value:e.formInfo.api_info.remote_api_id,callback:function(t){e.$set(e.formInfo.api_info,"remote_api_id",t)},expression:"formInfo.api_info.remote_api_id"}},e._l(e.apiList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:e._e()],2),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"autoNode-select-processor",label:e.$t("m.treeinfo['处理人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.processors=!1}}},[i("deal-person",{ref:"processors",attrs:{value:e.processorsInfo,"node-info":e.configur,"exclude-role-type-list":e.excludeRoleTypeList}})],1)])],1)],1),e._v(" "),e.formInfo.api_info.remote_api_id?[i("basic-card",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],attrs:{"card-label":e.$t("m.treeinfo['输入参数']"),"card-desc":e.$t("m.treeinfo['调用该API需要传递的参数信息']")}},[e.apiDetail.req_params&&e.apiDetail.req_params.length&&e.apiDetail.req_params[0].name?i("div",{staticClass:"bk-param"},[i("get-param",{ref:"getParam",attrs:{"change-info":e.configur,"state-list":e.stateList,"api-detail":e.apiDetail},on:{addNewItem:e.addNewItem}})],1):e._e(),e._v(" "),e.apiDetail.req_body&&Object.keys(e.apiDetail.req_body).length&&e.apiDetail.req_body.properties&&Object.keys(e.apiDetail.req_body.properties).length?i("div",{staticClass:"bk-param"},[i("post-param",{ref:"postParam",attrs:{"change-info":e.configur,"state-list":e.stateList,"api-detail":e.apiDetail},on:{addNewItem:e.addNewItem}})],1):e._e()]),e._v(" "),i("basic-card",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],attrs:{"card-label":e.$t("m.treeinfo['返回数据']"),"card-desc":e.$t("m.treeinfo['调用成功后API将会返回的参数信息']")}},[i("div",{staticClass:"bk-param"},[e.apiDetail.rsp_data&&Object.keys(e.apiDetail.rsp_data).length&&e.apiDetail.rsp_data.properties&&Object.keys(e.apiDetail.rsp_data.properties).length?i("response-data-node",{ref:"responseDataNode",attrs:{"change-info":e.configur,"state-list":e.stateList,"api-detail":e.apiDetail}}):e._e()],1)]),e._v(" "),i("basic-card",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],attrs:{"card-label":e.$t("m.treeinfo['轮询配置']"),"card-desc":e.$t("m.treeinfo['当出现异常时，设置重试及结束的条件']")}},[i("nodeCondition",{attrs:{"form-info":e.formInfo,"line-info":e.lineInfo}})],1)]:e._e(),e._v(" "),i("basic-card",[i("bk-sideslider",{attrs:{"is-show":e.sliderInfo.show,title:e.sliderInfo.title,width:e.sliderInfo.width},on:{"update:isShow":function(t){return e.$set(e.sliderInfo,"show",t)},"update:is-show":function(t){return e.$set(e.sliderInfo,"show",t)}}},[e.sliderInfo.show?i("div",{staticClass:"p20",attrs:{slot:"content"},slot:"content"},[i("add-field",{attrs:{"change-info":e.changeInfo,"sosp-info":e.showTabData,workflow:e.flowInfo.id,state:e.configur.id},on:{getRelatedFields:e.getRelatedFields,closeShade:e.closeShade}})],1):e._e()]),e._v(" "),i("common-trigger-list",{attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"mt20",staticStyle:{"font-size":"0"}},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"autoNode-button-submit",title:e.$t("m.treeinfo['确定']"),disabled:!e.formInfo.api_info.remote_api_id},on:{click:e.submitNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['确定']"))+"\n            ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"autoNode-button-close",title:e.$t("m.treeinfo['取消']")},on:{click:e.closeNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['取消']"))+"\n            ")])],1)],1)],2)},o=[];n._withStripped=!0},"291A":function(e,t,i){"use strict";i("EYn8")},"2CJJ":function(e,t,i){},"2Mt+":function(e,t,i){"use strict";i.r(t);var n=i("fJAq"),o=i("TOmV");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("6qrs");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7b17c852",null);r.options.__file="src/views/processManagement/publicTrigger/apiContent/inputParams.vue",t.default=r.exports},"2XNL":function(e,t,i){},"2iWM":function(e,t,i){},"34/K":function(e,t,i){"use strict";i.r(t);var n=i("8fx1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"3EVL":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"render-view",staticStyle:{"margin-left":"10px"}},e._l(e.formData,(function(t,n){return i("div",{key:n+new Date,staticClass:"view-item-wrap"},[i("ViewItem",{attrs:{"top-index":n,"is-top":!0,scheme:e.getScheme(t),form:t}})],1)})),0)},o=[];n._withStripped=!0},"3auN":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},["CUSTOM-FORM"===e.item.type?i("p",{staticClass:"mt5 mb0 f12",staticStyle:{color:"#c4c6cc"},attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t('m["当前字段为自定义表单"]')))]):e._e(),e._v(" "),i("render-view",{attrs:{"form-data":e.formData,context:e.context}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},"3jvg":function(e,t,i){"use strict";i.r(t);var n=i("j7Oh"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"3ncw":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("efIh"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"LINK",mixins:[a.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},"429m":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i("14Xm")),o=a(i("D3Ub"));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"getRpcParam",components:{},props:{prcTable:{type:Array,default:function(){return[]}},changeInfo:{type:Object,default:function(){return{}}},stateList:{type:Array,default:function(){return[]}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}]}},computed:{},watch:{prcTable:function(e,t){this.initData()}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.changeInfo;case 2:e.initData();case 3:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;this.prcTable.forEach((function(t){for(var i in e.$set(t,"isCheck",!1),e.$set(t,"isSatisfied",!1),e.$set(t,"el",null),e.$set(t,"source_type","CUSTOM"),e.$set(t,"value_key",""),e.changeInfo.meta)t.name===i&&(-1!==e.changeInfo.meta[i].indexOf("{params_")?(t.source_type="FIELDS",t.value_key=e.changeInfo.meta[i].split("${params_")[1].split("}")[0]):(t.source_type="CUSTOM",t.value=e.changeInfo.meta[i]))}))}}}},"47e5":function(e,t,i){},"4J33":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['开始节点']"),expression:"$t(`m.treeinfo['开始节点']`)",modifiers:{right:!0}}]},[i("div",{staticClass:"entry-item entry-start",attrs:{"data-type":"START"}},[e._v("\n            "+e._s(e.$t('m.treeinfo["开始"]'))+"\n        ")]),e._v(" "),i("div",{staticClass:"entry-disabled"})]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['结束节点']"),expression:"$t(`m.treeinfo['结束节点']`)",modifiers:{right:!0}}]},[i("div",{staticClass:"entry-item",attrs:{"data-type":"END"}},[e._v("\n            "+e._s(e.$t('m.treeinfo["结束"]'))+"\n        ")]),e._v(" "),i("div",{staticClass:"entry-disabled"})]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['手动节点']"),expression:"$t(`m.treeinfo['手动节点']`)",modifiers:{right:!0}}]},[e._m(0)]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['API节点']"),expression:"$t(`m.treeinfo['API节点']`)",modifiers:{right:!0}}]},[e._m(1)]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['标准运维节点']"),expression:"$t(`m.treeinfo['标准运维节点']`)",modifiers:{right:!0}}]},[e._m(2)]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m['蓝盾节点']"),expression:"$t(`m['蓝盾节点']`)",modifiers:{right:!0}}]},[e._m(3),e._v(" "),"open"===e.devsopDisable?i("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m['暂未开放']"),expression:"$t(`m['暂未开放']`)",modifiers:{right:!0}}],staticClass:"entry-disabled"}):e._e()]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['审批节点']"),expression:"$t(`m.treeinfo['审批节点']`)",modifiers:{right:!0}}]},[e._m(4)]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['并行网关']"),expression:"$t(`m.treeinfo['并行网关']`)",modifiers:{right:!0}}]},[e._m(5)]),e._v(" "),i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:e.$t("m.treeinfo['汇聚网关']"),expression:"$t(`m.treeinfo['汇聚网关']`)",modifiers:{right:!0}}]},[e._m(6)])])},o=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",staticStyle:{margin:"10px 0 0"},attrs:{"data-type":"NORMAL"}},[t("i",{staticClass:"bk-itsm-icon icon-icon-artificial",staticStyle:{"font-size":"26px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",staticStyle:{margin:"12px 0 2px"},attrs:{"data-type":"TASK"}},[t("i",{staticClass:"bk-itsm-icon icon-api-node",staticStyle:{"font-size":"26px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",staticStyle:{margin:"12px 0 2px"},attrs:{"data-type":"TASK-SOPS"}},[t("i",{staticClass:"bk-itsm-icon icon-task-icon",staticStyle:{"font-size":"26px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",staticStyle:{margin:"12px 0 2px"},attrs:{"data-type":"TASK-DEVOPS"}},[t("i",{staticClass:"bk-itsm-icon icon-devops-task-icon",staticStyle:{"font-size":"26px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",staticStyle:{margin:"12px 0 2px"},attrs:{"data-type":"APPROVAL"}},[t("i",{staticClass:"bk-itsm-icon icon-approval-node",staticStyle:{"font-size":"26px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",attrs:{"data-type":"ROUTER-P"}},[t("i",{staticClass:"bk-itsm-icon icon-flow-convergence"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"entry-item entry-gateway",attrs:{"data-type":"COVERAGE"}},[t("i",{staticClass:"bk-itsm-icon icon-flow-branch"})])}];n._withStripped=!0},"4K0D":function(e,t,i){"use strict";i.r(t);var n=i("O1Wb"),o=i("CyHO");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"21f99000",null);r.options.__file="src/views/commonComponent/fieldComponent/multiselect.vue",t.default=r.exports},"4lVZ":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("m1cH")),o=d(i("14Xm")),a=d(i("gDS+")),s=d(i("GQeE")),r=d(i("D3Ub")),c=d(i("BkRI")),l=d(i("VflG")),u=d(i("9ZYk"));function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseData",components:{exportTree:u.default},mixins:[l.default],props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},remoteApiIid:{type:[String,Number],default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{organization:{processorPerson:[],processorTree:{},assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:[!1,!1,!1]},cascaderData:[],bodyTableData:[],responseTableData:[],paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')},selectInfo:{selectkeylist:[],selectkey:"",selectvaluelist:[],selectvalue:""},isShow:!1,tampFormInfo:{ancestorsList_str:"",isSelectedKey:"",isSelectedValue:"",settingKeyName:"",settingValueName:""},isCheck:!1,maxLevel:1,maxLevelTree:[1,1,1],settingKeyName:"",settingValueName:""}},computed:{},watch:{"apiDetail.rsp_data":{handler:function(e,t){this.initData()},deep:!0}},mounted:function(){this.initData()},methods:{initData:function(){this.responseTableDataChange()},responseTableDataChange:function(){var e=this;return(0,r.default)(o.default.mark((function t(){var i,n,l,u,d,f,p,m;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.selectInfo={selectkeylist:[],selectkey:"",selectvaluelist:[],selectvalue:""},e.organization={processorPerson:[],processorTree:{},assignorPerson:[],assignorTree:{}},e.maxLevel=1,e.maxLevelTree=[1,1,1],e.settingKeyName="",e.settingValueName="",t.next=8,e.changeInfo;case 8:if((0,s.default)(e.apiDetail.rsp_data).length){t.next=13;break}e.apiDetail.responseTreeDataList=[{has_children:!1,showChildren:!0,checkInfo:!1,key:"root",is_necessary:!0,type:"object",desc:e.$t('m.treeinfo["初始化数据"]'),parentInfo:"",children:[]}],e.apiDetail.responseTableData=[],t.next=19;break;case 13:return t.next=15,e.jsonschemaToList({root:JSON.parse((0,a.default)(e.apiDetail.rsp_data))});case 15:return e.apiDetail.responseTreeDataList=t.sent,t.next=18,e.treeToTableList(JSON.parse((0,a.default)(e.apiDetail.responseTreeDataList[0].children)));case 18:e.apiDetail.responseTableData=t.sent;case 19:return t.next=21,JSON.parse((0,a.default)(e.apiDetail.responseTableData));case 21:return i=t.sent,t.next=24,i.forEach((function(t){t.children=[],t.source_type="CUSTOM",t.value="",t.name=t.key,t.isSelectAbled=!1,t.isSelectedKey=!1,t.isSelectedKeyDisabled=!1,t.isSelectedValue=!1,t.isSelectedValueDisabled=!e.changeInfo.api_info}));case 24:return t.next=26,e.recordChildren(i);case 26:return t.next=28,e.recordParent(i);case 28:return t.next=30,e.showSelectAbled(i);case 30:return n=t.sent,t.next=33,n.forEach(function(){var t=(0,r.default)(o.default.mark((function t(i){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.markCanUseArray(i);case 2:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}());case 33:return t.next=35,i;case 35:return e.responseTableData=t.sent,l=e.responseTableData.filter((function(e){return!e.level&&"data"===e.key})),t.next=39,e.makeArrayTree(l);case 39:if(e.cascaderData=t.sent,e.organization.assignorPerson=e.cascaderData[0]||[],!e.changeInfo.api_info||e.changeInfo.api_info.remote_api_id!==e.apiDetail.id){t.next=64;break}return t.next=44,e.changeInfo.api_info.rsp_data.split(".");case 44:return u=t.sent,t.next=47,u.map((function(e,t){return e=t+"_"+e}));case 47:return d=t.sent,f=d.length+"_items_0",d.push(f),p=d.toString()+","+d.length+"_"+e.changeInfo.kv_relation.key,m=d.toString()+","+d.length+"_"+e.changeInfo.kv_relation.name,e.tampFormInfo.ancestorsList_str=d.toString(),e.responseTableData.forEach((function(t){t.ancestorsList_str===p&&(t.isSelectedKey=!0,e.tampFormInfo.isSelectedKey=t.ancestorsList_str,e.tampFormInfo.settingKeyName=t.name),t.ancestorsList_str===m&&(t.isSelectedValue=!0,e.tampFormInfo.isSelectedValue=t.ancestorsList_str,e.tampFormInfo.settingValueName=t.name)})),t.next=56,e.organization.assignorPerson.forEach((function(t){e.treeData(t,"assignors")}));case 56:e.selectInfo.selectkeylist=e.responseTableData.filter((function(e){return e.ancestorsList.join()===d.join()})),e.selectInfo.selectkey=e.tampFormInfo.isSelectedKey,e.selectInfo.selectvaluelist=(0,c.default)(e.selectInfo.selectkeylist),e.selectInfo.selectvalue=e.tampFormInfo.isSelectedValue,e.settingValueName=e.tampFormInfo.settingValueName,e.settingKeyName=e.tampFormInfo.settingKeyName,e.giveFirstCheckInfo(e.selectInfo.selectkeylist,p),e.giveFirstCheckInfo(e.selectInfo.selectvaluelist,m);case 64:case"end":return t.stop()}}),t,e)})))()},giveFirstCheckInfo:function(e,t){var i=this;e.forEach((function(e){e.ancestorsList_str===t&&(e.checkInfo=!0),e.has_children&&e.children.length&&"object"===e.type&&i.giveFirstCheckInfo(e.children,t)}))},treeData:function(e,t){var i=this;e.checkInfo=!1,e.has_children=!(!e.children||!e.children.length),e.showChildren=!0,String(this.tampFormInfo.ancestorsList_str.split(",").slice(0,-1).toString())===String(e.ancestorsList_str)&&"assignors"===t&&(e.checkInfo=!0,this.organization.assignorTree=e),e.has_children&&e.children.forEach((function(e){i.treeData(e,t)}))},recordChildren:function(e,t){var i=e.map((function(e){return e.level}));this.maxLevel=Math.max.apply(Math,(0,n.default)(i));for(var o=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},a=this.maxLevel;a>(t||0);a--)o(a)},recordParent:function(e,t){for(var i=this.maxLevel,n=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){t.level?t.parentInfo=e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0]:t.parentInfo=""}(e,t)}))},o=0;o<=(t||i);o++)n(o)},markCanUseArray:function(e){e.isCanUseArray=!0,e.level&&this.markCanUseArray(e.parentInfo)},makeArrayTree:function(e){var t=[];return function e(t,i){i.forEach((function(n){i.name=n.name,i.isSelect=!1,i.ancestorsList_str=n.ancestorsList_str;var o=n.children;i.children=[],t.push(i),o&&o.length&&e(i.children,o)}))}(t,e),t},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},changeType:function(e){},selectOneKey:function(e){var t=e.isSelectedKey;this.responseTableData.forEach((function(e){e.isSelectedKey=!1})),e.isSelectedKey=!t,this.responseTableData.filter((function(e){return e.isSelectAbled})).forEach((function(t){t.isSelectedKeyDisabled=!1,t.isSelectedValueDisabled=t.parentInfo!==e.parentInfo})),this.responseTableData.filter((function(t){return t.isSelectAbled&&t.parentInfo!==e.parentInfo})).forEach((function(e){e.isSelectedValue=!1}))},selectOneValue:function(e){var t=e.isSelectedValue;this.responseTableData.forEach((function(e){e.isSelectedValue=!1})),e.isSelectedValue=!t},countArrayAncestors:function(e){var t=[];return function e(i){"array"===i.parentInfo.type&&(t.push(i.parentInfo),e(i.parentInfo)),"object"===i.parentInfo.type&&e(i.parentInfo)}(e),t},showSelectAbled:function(e){var t=this;return(0,r.default)(o.default.mark((function i(){var n,a;return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=[],a=e.filter((function(e){return"array"!==e.type&&"object"!==e.type&&e.level&&(!e.children||!e.children.length)&&-1!==e.ancestorsList.indexOf("0_data")})),a.filter((function(e){var i=t.countArrayAncestors(e),o=1===i.length&&("array"===e.parentInfo.type||"array"===e.parentInfo.parentInfo.type);return o&&-1===n.indexOf(i[0])&&n.push(i[0]),o})).forEach((function(e){e.isSelectAbled=!0})),i.abrupt("return",n);case 5:case"end":return i.stop()}}),i,t)})))()},showTree:function(e){if(e){var t=this.selectInfo.selectkeylist.map((function(e){return e.level}));this.$set(this.maxLevelTree,1,Math.max.apply(Math,(0,n.default)(t))-1),this.$set(this.maxLevelTree,2,Math.max.apply(Math,(0,n.default)(t))-1)}else{var i=this.organization.assignorPerson.map((function(e){return e.level}));this.$set(this.maxLevelTree,0,Math.max.apply(Math,(0,n.default)(i))-1)}for(var o=this.organizaInfo.assignorShow[e],a=0;a<3;a++)this.$set(this.organizaInfo.assignorShow,a,!1);this.$set(this.organizaInfo.assignorShow,e,!o)},closeOther0:function(){this.$set(this.organizaInfo.assignorShow,0,!1)},closeOther1:function(){this.$set(this.organizaInfo.assignorShow,1,!1)},closeOther2:function(){this.$set(this.organizaInfo.assignorShow,2,!1)},recordCheckFn:function(e){var t=this;e.checkInfo=!1,null==e.children||e.children&&!e.children.length||e.children.forEach((function(e){t.recordCheckFn(e)}))},assignorToggle:function(e,t){var i=this;"object"===e.type||t&&"array"===e.type||(t?1===t?(this.selectInfo.selectkeylist.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectkey=e.ancestorsList_str,this.settingKeyName=e.name,this.responseTableData.forEach((function(e){e.isSelectedKey=!1})),this.responseTableData.filter((function(t){return t.ancestorsList_str===e.ancestorsList_str}))[0].isSelectedKey=!0):(this.selectInfo.selectvaluelist.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectvalue=e.ancestorsList_str,this.settingValueName=e.name,this.responseTableData.forEach((function(e){e.isSelectedValue=!1})),this.responseTableData.filter((function(t){return t.ancestorsList_str===e.ancestorsList_str}))[0].isSelectedValue=!0):(this.organization.assignorPerson.forEach((function(e){i.recordCheckFn(e)})),this.selectInfo.selectkeylist=e.children[0].children,this.selectInfo.selectvaluelist=(0,c.default)(this.selectInfo.selectkeylist),this.organization.assignorTree=e,this.tampFormInfo.assignors=e.id,this.checkInfo.assignors=!1),e.checkInfo=!0,this.closeTree(t))},closeTree:function(e){this.$set(this.organizaInfo.assignorShow,e,!1)},toggleChildren:function(){arguments[0].showChildren=!arguments[0].showChildren}}}},"4omV":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",{staticClass:"ci-template"},[i("bk-form",{ref:"devopsForm",attrs:{model:e.item.devopsContent,rules:e.defaultRules,"label-width":200,"form-type":"vertical"}},[i("bk-form-item",{attrs:{label:e.$t("m.tickets['项目']"),required:!0,property:"project_id","error-display-type":"normal"}},[i("bk-select",{attrs:{loading:e.projectLoading,searchable:"",disabled:e.disabled},on:{selected:e.handleProjectChange},model:{value:e.item.devopsContent.project_id,callback:function(t){e.$set(e.item.devopsContent,"project_id",t)},expression:"item.devopsContent.project_id"}},e._l(e.projectList,(function(e){return i("bk-option",{key:e.projectCode,attrs:{id:e.projectCode,name:e.project_name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.tickets['流水线']"),required:!0,property:"pipeline_id","error-display-type":"normal"}},[i("bk-select",{attrs:{loading:e.pipelineLoading,searchable:"",disabled:e.disabled},on:{selected:e.handlePipelineChange},model:{value:e.item.devopsContent.pipeline_id,callback:function(t){e.$set(e.item.devopsContent,"pipeline_id",t)},expression:"item.devopsContent.pipeline_id"}},e._l(e.pipelineList,(function(e){return i("bk-option",{key:e.pipelineId,attrs:{id:e.pipelineId,name:e.pipelineName}})})),1)],1)],1),e._v(" "),i("h3",{staticClass:"setion-title"},[i("span",{staticClass:"setion-title-icon",on:{click:function(t){t.stopPropagation(),e.showPipelineVariable=!e.showPipelineVariable}}},[e.showPipelineVariable?i("i",{staticClass:"bk-icon icon-angle-down"}):i("i",{staticClass:"bk-icon icon-angle-right"})]),e._v("\n        "+e._s(e.$t("m.tickets['流水线变量']"))+"\n    ")]),e._v(" "),i("bk-form",{directives:[{name:"show",rawName:"v-show",value:e.showPipelineVariable,expression:"showPipelineVariable"},{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.pipelineStartLoading},expression:"{ isLoading: pipelineStartLoading }"}],ref:"devopsVariable",attrs:{model:e.item.devopsContent.variables,"label-width":200,"form-type":"vertical"}},e._l(e.pipelineVariableList,(function(t){return i("bk-form-item",{key:t.id,staticClass:"half-width-item",attrs:{label:t.id,required:!0,property:t.id,rules:e.rules[t.id],"error-display-type":"normal"}},[i("bk-input",{attrs:{disabled:e.disabled,clearable:!0},model:{value:e.item.devopsContent.variables[t.id],callback:function(i){e.$set(e.item.devopsContent.variables,t.id,i)},expression:"item.devopsContent.variables[variable.id]"}})],1)})),1),e._v(" "),i("h3",{staticClass:"setion-title border-none"},[i("span",{staticClass:"setion-title-icon",on:{click:function(t){t.stopPropagation(),e.showPipelineStages=!e.showPipelineStages}}},[e.showPipelineStages?i("i",{staticClass:"bk-icon icon-angle-down"}):i("i",{staticClass:"bk-icon icon-angle-right"})]),e._v("\n        "+e._s(e.$t("m.tickets['插件预览']"))+"\n    ")]),e._v(" "),i("devops-preview",{directives:[{name:"show",rawName:"v-show",value:e.showPipelineStages,expression:"showPipelineStages"}],attrs:{stages:e.pipelineStages,loading:e.pipelineDetailLoading}})],1):e._e()},o=[];n._withStripped=!0},"5/Zn":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"CASCADE",props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,required:!0,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{firstShow:!1,firstInfo:this.item.val,firstList:[],secondInfo:"",firstPlace:this.$t('m.newCommon["请选择所属的厅委办"]'),secondPlace:this.$t('m.newCommon["请选择所属业务"]'),clickChange:!1}},computed:{changeFields:function(){return this.fields}},watch:{"item.val":function(){this.changeInfo()}},mounted:function(){this.changeInfo()},methods:{itemSelect:function(e,t){var i=this.item.choice.filter((function(t){return t.key===e}))[0];this.clickInfo=!0,this.firstShow=!!i.items,this.firstInfo=e,this.item.val=this.firstShow?"":e,this.firstList=i.items,this.secondInfo="",this.clickChange=!0},changeFrist:function(e,t){this.secondInfo=e,this.item.val=this.secondInfo},changeInfo:function(){if(this.clickChange)this.clickChange=!1;else if(this.item.val){this.firstShow=!1,this.firstList=[];for(var e=!0,t=0;t<this.item.choice.length;t++)if(String(this.item.choice[t].key)===String(this.item.val)){this.firstInfo=this.item.val,e=!1,this.firstShow=!!this.item.choice[t].items;break}if(e)for(var i=0;i<this.item.choice.length;i++)if(this.item.choice[i].items){var n=this.item.choice[i].items;this.firstShow=!0,this.firstInfo===this.item.choice[i].key&&(this.firstList=n);for(var o=0;o<n.length;o++)if(String(n[o].key)===String(this.item.val)){this.firstList=n,this.secondInfo=this.item.val,this.firstInfo=this.item.choice[i].key;break}}}else this.firstShow=!1,this.firstList=[],this.firstInfo=""}}}},"59Gz":function(e,t,i){"use strict";i("WhZk")},"5Bno":function(e,t,i){},"5KDo":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-basic-info"},[i("bk-form",{ref:"basicForm",attrs:{"label-width":150,model:e.formInfo,rules:e.rules,"form-type":"vertical"}},[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['节点名称：']"),"data-test-id":"basicInfo-input-nodeName","ext-cls":"bk-item-width",required:!0,property:"name"}},[i("bk-input",{attrs:{"font-size":"medium",maxlength:"120"},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['节点标签：']"),required:!0}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width",clearable:!1,searchable:"","font-size":"medium"},model:{value:e.formInfo.tag,callback:function(t){e.$set(e.formInfo,"tag",t)},expression:"formInfo.tag"}},e._l(e.nodeTagList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"basicInfo-select-ProcessingScenarios",label:e.$t("m.treeinfo['处理场景：']"),required:!0}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width",clearable:!1,searchable:"",disabled:e.nodeInfo.is_builtin,"font-size":"medium"},on:{selected:e.changeDistribute},model:{value:e.formInfo.distribute_type,callback:function(t){e.$set(e.formInfo,"distribute_type",t)},expression:"formInfo.distribute_type"}},e._l(e.sceneList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),e._l(e.prompt,(function(t,n){return t.id===e.formInfo.distribute_type?i("p",{key:n,staticClass:"mt5 mb0 bk-revoke-span"},[i("i",{staticClass:"bk-icon icon-exclamation-circle",staticStyle:{"padding-right":"5px"}}),e._v(" "),i("span",[e._v(e._s(t.prompt))])]):e._e()}))],2),e._v(" "),e.assignorsTypeList.some((function(t){return t===e.formInfo.distribute_type}))?[i("bk-form-item",{attrs:{"data-test-id":"basicInfo-select-assignors",label:e.$t("m.treeinfo['派单人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.assignors=!1}}},[i("deal-person",{ref:"assignors",attrs:{value:e.assignorsInfo,"exclude-role-type-list":e.assignorExclude}})],1)])]:e._e(),e._v(" "),e.processorsInfo.type?[i("bk-form-item",{attrs:{"data-test-id":"basicInfo-component-processor",label:e.$t("m.treeinfo['处理人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.processors=!1}}},[i("deal-person",{ref:"processors",attrs:{value:e.processorsInfo,"node-info":e.nodeInfo,"exclude-role-type-list":e.excludeProcessor}})],1)])]:e._e(),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['设置单据状态：']"),required:!0}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",clearable:!1,searchable:"","font-size":"medium"},on:{selected:e.handleTicket},model:{value:e.formInfo.ticket_type,callback:function(t){e.$set(e.formInfo,"ticket_type",t)},expression:"formInfo.ticket_type"}},e._l(e.billStatusList,(function(e){return i("bk-option",{key:e.type,attrs:{id:e.type,name:e.name}})})),1),e._v(" "),"custom"===e.formInfo.ticket_type?[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",loading:e.ticketKeyLoading,clearable:!1,searchable:"","font-size":"medium"},model:{value:e.formInfo.ticket_key,callback:function(t){e.$set(e.formInfo,"ticket_key",t)},expression:"formInfo.ticket_key"}},e._l(e.secondLevelList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2),e._v(" "),e.nodeInfo.is_builtin?e._e():[i("bk-form-item",{attrs:{"data-test-id":"basicInfo-radio-canDeliver",label:e.$t("m.treeinfo['是否可转单：']"),required:!0}},[i("bk-radio-group",{model:{value:e.formInfo.can_deliver,callback:function(t){e.$set(e.formInfo,"can_deliver",t)},expression:"formInfo.can_deliver"}},[i("bk-radio",{attrs:{value:e.trueStatus,"ext-cls":"mr20"}},[e._v(e._s(e.$t('m.treeinfo["是"]')))]),e._v(" "),i("bk-radio",{attrs:{value:e.falseStatus}},[e._v(e._s(e.$t('m.treeinfo["否"]')))])],1)],1)],e._v(" "),e.formInfo.can_deliver?[i("bk-form-item",{attrs:{"data-test-id":"basicInfo-radio-delivers",label:e.$t("m.treeinfo['转单人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.delivers=!1}}},[i("deal-person",{ref:"delivers",attrs:{value:e.deliversInfo,"exclude-role-type-list":e.deliversExclude}})],1)])]:e._e()],2)],1)},o=[];n._withStripped=!0},"5Pf/":function(e,t,i){"use strict";i.r(t);var n=i("7yQo"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"5R1Y":function(e,t,i){"use strict";i.r(t);var n=i("lR6s"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"5WyB":function(e,t,i){"use strict";i.r(t);var n=i("5KDo"),o=i("uR5J");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("hjSG");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"e5458556",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/basicInfo.vue",t.default=r.exports},"5hmv":function(e,t,i){"use strict";i.r(t);var n=i("Gr/V"),o=i("kQq5");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("odgA");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,null,null);r.options.__file="src/views/commonComponent/customUpload/upload.vue",t.default=r.exports},"5zZ0":function(e,t,i){},"6StV":function(e,t,i){"use strict";i("7zwb")},"6aJY":function(e,t,i){},"6qrs":function(e,t,i){"use strict";i("jRUZ")},"7DqX":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"TABLE",props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){if(""===this.item.val){this.item.val=[];for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)}"function"==typeof this.$parent.refresh&&this.$parent.refresh()}},created:function(){if(""===this.item.val||Array.isArray(this.item.val)&&!this.item.val.length){this.item.val=[];for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)}},methods:{addOne:function(){for(var e={},t=0;t<this.item.choice.length;t++){e[this.item.choice[t].key]=""}this.item.val.push(e)},deleteOne:function(e){var t=this;1===this.item.val.length?this.$bkMessage({message:"默认行不能删除",theme:"warning"}):this.$bkInfo({title:"确认要删除此条数据？",confirmFn:function(){t.item.val.splice(e.$index,1)}})}}}},"7Hjg":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-basic-node"},[i("basic-card",{attrs:{"card-label":e.$t("m.treeinfo['基本信息']")}},[i("bk-form",{ref:"basicInfo",attrs:{model:e.basicInfo,"label-width":150,rules:e.basicInfoRules,"ext-cls":"bk-form","form-type":"vertical"}},[i("bk-form-item",{attrs:{"data-test-id":"devops-input-name",label:e.$t("m.treeinfo['节点名称：']"),required:!0,"ext-cls":"bk-form-width bk-form-display",property:"nodeName"}},[i("bk-input",{attrs:{clearable:!0},model:{value:e.basicInfo.nodeName,callback:function(t){e.$set(e.basicInfo,"nodeName",t)},expression:"basicInfo.nodeName"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"devops-select-project",label:e.$t("m['项目']"),required:!0,"ext-cls":"bk-form-width bk-form-display",property:"businessId"}},[i("bk-select",{attrs:{searchable:"",disabled:!1},on:{selected:e.onSelectBusiness},model:{value:e.basicInfo.businessId,callback:function(t){e.$set(e.basicInfo,"businessId",t)},expression:"basicInfo.businessId"}},e._l(e.businessList,(function(e){return i("bk-option",{key:e.englishName,attrs:{id:e.englishName,name:e.projectName}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"devops-select-pipeline",label:e.$t("m['流水线：']"),required:!0,property:"pipelineId","ext-cls":"bk-form-width bk-form-display"}},[i("bk-select",{attrs:{searchable:"",loading:e.pipelineLoading,disabled:e.pipelineDisabled},on:{selected:function(t){return e.getPipelineInfo(0)}},model:{value:e.basicInfo.pipelineId,callback:function(t){e.$set(e.basicInfo,"pipelineId",t)},expression:"basicInfo.pipelineId"}},e._l(e.pipelineList,(function(e){return i("bk-option",{key:e.pipelineId,attrs:{id:e.pipelineId,name:e.pipelineName}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"devops-component-processor",label:e.$t("m.treeinfo['处理人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.processors=!1}}},[i("deal-person",{ref:"processors",attrs:{value:e.processorsInfo,"node-info":e.configur,"exclude-role-type-list":e.excludeProcessor}})],1)])],1)],1),e._v(" "),i("basic-card",[i("div",{staticClass:"piprline-title"},[i("p",[e._v(e._s(e.$t("m['流水线参数']"))+":")]),e._v(" "),i("p",[e._v(e._s(e.$t("m.treeinfo['调用该API需要传递的参数信息']")))])]),e._v(" "),0!==e.pipelineFormList.length?i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.pipeFormLoading},expression:"{ isLoading: pipeFormLoading }"}],staticClass:"bk-param"},[i("bk-form",{ref:"devopsVariable",attrs:{"ext-cls":"pipelineForm","form-type":"vertical",model:e.pipelineData,rules:e.pipelineRules,"label-width":200}},e._l(e.pipelineFormList,(function(t){return i("bk-form-item",{key:t.id,attrs:{label:t.id,property:t.id,rules:e.pipelineRules[t.id],required:t.required}},[i("bk-input",{attrs:{clearable:!0},model:{value:e.pipelineData[t.id],callback:function(i){e.$set(e.pipelineData,t.id,i)},expression:"pipelineData[pipeline.id]"}})],1)})),1),e._v(" "),i("span",{staticClass:"setion-title-icon",on:{click:function(t){t.stopPropagation(),e.showPipelineStages=!e.showPipelineStages}}},[e.showPipelineStages?i("i",{staticClass:"bk-icon icon-angle-down"}):i("i",{staticClass:"bk-icon icon-angle-right"}),e._v("\n                "+e._s(e.$t("m.tickets['插件预览']"))+"\n            ")]),e._v(" "),i("devops-preview",{directives:[{name:"show",rawName:"v-show",value:e.showPipelineStages,expression:"showPipelineStages"}],attrs:{stages:e.pipelineStages}})],1):i("no-data"),e._v(" "),i("common-trigger-list",{attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"mt20",staticStyle:{"font-size":"0"}},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"devops-button-submit",title:e.$t("m.treeinfo['确定']")},on:{click:e.submit}},[e._v("\n                "+e._s(e.$t("m.treeinfo['确定']"))+"\n            ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"devops-button-close",title:e.$t("m.treeinfo['取消']")},on:{click:e.closeNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['取消']"))+"\n            ")])],1)],1)],1)},o=[];n._withStripped=!0},"7J8O":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-field-info mb20"},[e.isShowTitle?i("p",{staticClass:"bk-field-title"},[e._v("字段配置")]):e._e(),e._v(" "),i("div",{staticClass:"bk-node-btn"},["APPROVAL"!==e.configur.type?i("bk-button",{staticClass:"mr10",attrs:{"data-test-id":"fieldConfig-button-addField",theme:"default",title:e.$t("m.treeinfo['新增字段']")},on:{click:e.addField}},[e._v("\n            "+e._s(e.$t("m.treeinfo['新增字段']"))+"\n        ")]):e._e(),e._v(" "),"APPROVAL"===e.configur.type||"SIGN"===e.configur.type||e.templateStage?e._e():i("bk-button",{staticClass:"mr10",attrs:{"data-test-id":"fieldConfig-button-addModelField",theme:"default",title:e.$t("m.treeinfo['选择模型字段']")},on:{click:e.openAddModule}},[e._v("\n            "+e._s(e.$t("m.treeinfo['选择模型字段']"))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",staticStyle:{float:"right",border:"0"},attrs:{theme:"default","data-test-id":"fieldConfig-button-previewField",title:e.$t("m.treeinfo['字段预览']"),disabled:!e.showTabList.length},on:{click:e.previewField}},[i("i",{staticClass:"bk-itsm-icon icon-itsm-icon-three",staticStyle:{"font-size":"16px"}}),e._v("\n            "+e._s(e.$t("m.treeinfo['字段预览']"))+"\n        ")])],1),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],staticClass:"mt15 bk-draggable"},[i("table",{staticClass:"bk-draggable-table"},[i("thead",[i("tr",[i("th",[e._v(e._s(e.$t('m.treeinfo["字段名称"]')))]),e._v(" "),i("th",{staticStyle:{"max-width":"150px"}},[e._v(e._s(e.$t('m.treeinfo["唯一标识"]')))]),e._v(" "),i("th",[e._v(e._s(e.$t('m.treeinfo["字段类型"]')))]),e._v(" "),i("th",[e._v(e._s(e.$t('m.treeinfo["是否只读"]')))]),e._v(" "),i("th",{staticStyle:{"min-width":"50px"}},[e._v(e._s(e.$t('m.treeinfo["布局"]')))]),e._v(" "),i("th",{staticStyle:{"max-width":"100px"}},[e._v(e._s(e.$t('m.treeinfo["字段描述"]')))]),e._v(" "),i("th",[e._v(e._s(e.$t('m.treeinfo["是否必填"]')))]),e._v(" "),i("th",[e._v(e._s(e.$t('m.treeinfo["更新人"]')))]),e._v(" "),i("th",[e._v(e._s(e.$t('m.treeinfo["操作"]')))])])]),e._v(" "),i("draggable",{attrs:{tag:"tbody",handle:".move-handler-content"},on:{end:e.updateInfo},model:{value:e.showTabList,callback:function(t){e.showTabList=t},expression:"showTabList"}},[e.showTabList.length?e._l(e.showTabList,(function(t,n){return i("tr",{key:n},[i("td",{staticClass:"move-handler-content"},[i("span",[i("i",{staticClass:"bk-itsm-icon icon-move-new move-handler"}),e._v(e._s(t.name))])]),e._v(" "),i("td",{staticStyle:{"max-width":"150px"},attrs:{title:t.key}},[e._v("\n                            "+e._s(t.key)+"\n                        ")]),e._v(" "),i("td",[e._v("\n                            "+e._s(t.typeName||"--")+"\n                        ")]),e._v(" "),i("td",{staticStyle:{"max-width":"100px"},attrs:{title:t.is_readonly?e.$t("m.treeinfo['是']"):e.$t("m.treeinfo['否']")}},[e._v("\n                            "+e._s(t.is_readonly?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n                        ")]),e._v(" "),i("td",{staticStyle:{"min-width":"50px"}},[e._v("\n                            "+e._s("COL_6"===t.layout?e.$t('m.treeinfo["半行"]'):e.$t('m.treeinfo["整行"]'))+"\n                        ")]),e._v(" "),i("td",{staticStyle:{"max-width":"100px"},attrs:{title:t.desc}},[i("pre",[i("span",[e._v(e._s(t.desc||"--"))])])]),e._v(" "),i("td",[e._v("\n                            "+e._s(t.is_required||"--")+"\n                        ")]),e._v(" "),i("td",[e._v("\n                            "+e._s(t.updated_by||"--")+"\n                        ")]),e._v(" "),i("td",[i("bk-button",{staticClass:"table-opt-button",attrs:{theme:"primary",disabled:e.checkEditDisabled(t),text:""},on:{click:function(i){return e.openField(t)}}},[e._v("\n                                "+e._s(e.$t('m.user["编辑"]'))+"\n                            ")]),e._v(" "),i("bk-button",{staticClass:"table-opt-button",attrs:{theme:"primary",disabled:e.checkDeleteDisabled(t),text:""},on:{click:function(i){return e.deleteTable(t)}}},[e._v("\n                                "+e._s(e.$t('m.user["删除"]'))+"\n                            ")])],1)])})):[i("tr",{},[i("td",{staticClass:"bk-none-content",attrs:{colspan:"10"}},[i("i",{staticClass:"bk-table-empty-icon bk-icon icon-empty"}),e._v(" "),i("p",{staticClass:"bk-none-info"},[e._v(e._s(e.$t('m.treeinfo["暂无数据"]')))])])])]],2)],1)]),e._v(" "),i("bk-dialog",{attrs:{width:"760",position:e.processInfo.position,draggable:e.processInfo.draggable,title:e.processInfo.title,"render-directive":"if","ext-cls":"bk-preview-overflow"},model:{value:e.processInfo.isShow,callback:function(t){e.$set(e.processInfo,"isShow",t)},expression:"processInfo.isShow"}},[i("field-preview",{attrs:{fields:e.previewTab}}),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("bk-button",{attrs:{theme:"default"},on:{click:function(t){e.processInfo.isShow=!1}}},[e._v("\n                "+e._s(e.$t('m.home["取消"]'))+"\n            ")])],1)],1),e._v(" "),i("bk-sideslider",{attrs:{"is-show":e.sliderInfo.show,title:e.sliderInfo.title,width:e.sliderInfo.width},on:{"update:isShow":function(t){return e.$set(e.sliderInfo,"show",t)},"update:is-show":function(t){return e.$set(e.sliderInfo,"show",t)}}},[e.sliderInfo.show?i("div",{staticClass:"p20",attrs:{slot:"content"},slot:"content"},[i("add-field",{attrs:{"change-info":e.changeInfo,"template-info":e.templateInfo,"template-stage":e.templateStage,"nodes-list":e.nodesList,"add-origin":e.addOrigin,"table-list":e.showTabList,"is-edit-public":e.isEditPublic,workflow:e.flowInfo?e.flowInfo.id:0,state:e.configur.id?e.configur.id:0},on:{closeShade:e.closeShade}})],1):e._e()]),e._v(" "),i("bk-dialog",{attrs:{"render-directive":"if",width:e.moduleInfo.width,"header-position":e.moduleInfo.headerPosition,loading:e.secondClick,"auto-close":e.moduleInfo.autoClose,"mask-close":e.moduleInfo.autoClose},on:{confirm:e.submitModule},model:{value:e.moduleInfo.isShow,callback:function(t){e.$set(e.moduleInfo,"isShow",t)},expression:"moduleInfo.isShow"}},[i("p",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.$t('m.treeinfo["选择模型字段"]')))]),e._v(" "),i("div",{staticClass:"bk-add-module"},[i("inherit-state",{ref:"inheritState",attrs:{workflow:e.flowInfo?e.flowInfo.id:0,state:e.configur.id?e.configur.id:0,configur:e.configur,"show-tab-list":e.showTabList}})],1)])],1)},o=[];n._withStripped=!0},"7M1H":function(e,t,i){"use strict";i("oL/I")},"7TlO":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-date-picker",{class:{"bk-border-error":e.item.checkValue},attrs:{placeholder:e.$t("m.newCommon['选择日期']"),disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{"open-change":function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},"7XAC":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("2eEL"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"exportTree",components:{collapseTransition:a.default},props:{treeDataList:{type:Array,default:function(){return[]}},treeIndex:{type:Number,default:0},isKeyValue:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+25*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e,this.isKeyValue)},checkItem:function(e){this.$emit("selectItem",e)},selectItem:function(e){this.$emit("selectItem",e)}}}},"7YIX":function(e,t,i){"use strict";i("47e5")},"7yQo":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("gDS+")),o=l(i("QbLZ")),a=l(i("u8Ap")),s=l(i("OE89")),r=i("L2JU"),c=i("CeR/");function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"changeConductor",components:{memberSelect:a.default,exportTree:s.default},props:{itemInfo:{type:Object,default:function(){return{}}},recipientItem:{type:Object,default:function(){return{}}},recipientIndex:{type:Number,default:function(){return""}}},data:function(){return{recipientKeyList:[],roles:{viewTreeDataList:[],viewtree:{},viewTreeOpen:!1},variableList:[]}},computed:(0,o.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,r.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){var e=["OPEN","STARTER","BY_ASSIGNOR","EMPTY"];this.recipientKeyList=this.globalChoise.processor_type.filter((function(t){return!e.some((function(e){return e===t.typeName}))})),this.recipientItem.key&&(this.recipientItem.secondLevelList=[],"ORGANIZATION"===this.recipientItem.key?this.getOrganization():"VARIABLE"===this.recipientItem.key?this.recipientItem.value=this.recipientItem.value:"PERSON"===this.recipientItem.key?(this.recipientItem.secondLevelList=[],this.recipientItem.value=Array.isArray(this.recipientItem.value)?this.recipientItem.value:this.recipientItem.value.split(",")):(this.recipientItem.value=Array.isArray(this.recipientItem.value)?this.recipientItem.value:this.recipientItem.value.split(","),this.secondListFn(this.recipientItem)))},mounted:function(){this.variableList=this.triggerVariables},methods:{getSecondLevelList:function(){this.recipientItem.value=[],this.recipientItem.secondLevelList=[],"ORGANIZATION"===this.recipientItem.key?(this.recipientItem.value="",this.getOrganization()):"VARIABLE"===this.recipientItem.key?this.recipientItem.value="":"PERSON"===this.recipientItem.key?this.recipientItem.secondLevelList=[]:this.secondListFn(this.recipientItem)},secondListFn:function(e){var t=this;e.key&&(e.isLoading=!0,this.$store.dispatch("deployCommon/getSecondUser",{role_type:e.key,project_key:this.$store.state.project.id}).then((function(t){var i=t.data,n=[];"GENERAL"===e.key?i.forEach((function(e){n.push({id:String(e.id),name:e.name+"("+e.count+")",disabled:0===e.count})})):i.forEach((function(e){n.push({id:String(e.id),name:e.name})})),e.secondLevelList=n})).catch((function(e){(0,c.errorHandler)(e,t)})).finally((function(){e.isLoading=!1})))},getOrganization:function(){var e=this;this.$store.dispatch("cdeploy/getTreeInfo").then((function(t){e.roles.viewTreeDataList=t.data,e.roles.viewTreeDataList.forEach((function(t){e.treeData(t,"view")})),e.roles.viewtree.route.length&&e.roles.viewTreeDataList.forEach((function(t){e.openChildren(t,"view")}))})).catch((function(e){}))},recordCheckFn:function(e){var t=this;e.checkInfo=!1,null==e.children||e.children&&!e.children.length||e.children.forEach((function(e){t.recordCheckFn(e)}))},toggleInfo:function(e){var t=this;this.roles.viewTreeDataList.forEach((function(e){t.recordCheckFn(e)})),e.checkInfo=!0,this.roles.viewtree=e,this.concatName(),this.recipientItem.value=e.id,this.closeTree()},toggleChildren:function(){"view"===arguments[1]&&(arguments[0].showChildren=!arguments[0].showChildren,this.roles.viewTreeDataList=JSON.parse((0,n.default)(this.roles.viewTreeDataList)))},openChildren:function(e,t){var i=this;e.showChildren=!1,"view"===t&&(e.showChildren=this.roles.viewtree.route.some((function(t){return String(t.id)===String(e.id)}))),e.children&&e.children.length&&e.children.forEach((function(e){i.openChildren(e,t)}))},treeData:function(e,t){var i=this;e.checkInfo=!1,e.has_children=!(!e.children||!e.children.length),String(this.recipientItem.value)===String(e.id)&&"view"===t&&(e.checkInfo=!0,this.roles.viewtree=e,this.concatName()),e.has_children&&e.children.forEach((function(e){i.treeData(e,t)}))},showTree:function(e){"view"===e&&(this.roles.viewTreeOpen=!this.roles.viewTreeOpen,this.roles.otherTreeOpen=!1)},closeTree:function(){this.roles.viewTreeOpen=!1},concatName:function(){var e=[];this.roles.viewtree.route.length&&(e=this.roles.viewtree.route.map((function(e){return e.name}))),e.push(this.roles.viewtree.name),this.$set(this.roles.viewtree,"showName",e.join("/"))},addRecipient:function(){this.itemInfo.value.splice(this.recipientIndex+1,0,{type:"",value:"",secondLevelList:[],isLoading:!1})},deleteRecipient:function(){1!==this.itemInfo.value.length&&this.itemInfo.value.splice(this.recipientIndex,1)}}}},"7zwb":function(e,t,i){},"8fx1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i("z/5e")),o=a(i("efIh"));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"INT",mixins:[o.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{max:n.default,isErrMessage:!1}},watch:{"item.val":function(e){this.isErrMessage=e>this.max||!1,this.conditionField(this.item,this.fields)}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{}}},"8gVO":function(e,t,i){var n={"./1c":"9xzc","./1c.js":"9xzc","./abnf":"tSgA","./abnf.js":"tSgA","./accesslog":"mY11","./accesslog.js":"mY11","./actionscript":"+fC4","./actionscript.js":"+fC4","./ada":"Aayt","./ada.js":"Aayt","./angelscript":"28xz","./angelscript.js":"28xz","./apache":"8Kqh","./apache.js":"8Kqh","./applescript":"e8E9","./applescript.js":"e8E9","./arcade":"MF4s","./arcade.js":"MF4s","./arduino":"lE5/","./arduino.js":"lE5/","./armasm":"ozyK","./armasm.js":"ozyK","./asciidoc":"ApBa","./asciidoc.js":"ApBa","./aspectj":"mBTZ","./aspectj.js":"mBTZ","./autohotkey":"BIHe","./autohotkey.js":"BIHe","./autoit":"75kF","./autoit.js":"75kF","./avrasm":"pvv5","./avrasm.js":"pvv5","./awk":"EGmf","./awk.js":"EGmf","./axapta":"qIW7","./axapta.js":"qIW7","./bash":"8Pgg","./bash.js":"8Pgg","./basic":"oVqn","./basic.js":"oVqn","./bnf":"ddo8","./bnf.js":"ddo8","./brainfuck":"WSH0","./brainfuck.js":"WSH0","./cal":"d4EH","./cal.js":"d4EH","./capnproto":"Sl5E","./capnproto.js":"Sl5E","./ceylon":"unZW","./ceylon.js":"unZW","./clean":"Uasv","./clean.js":"Uasv","./clojure":"uIR8","./clojure-repl":"FJ32","./clojure-repl.js":"FJ32","./clojure.js":"uIR8","./cmake":"6quq","./cmake.js":"6quq","./coffeescript":"qZUF","./coffeescript.js":"qZUF","./coq":"gLO8","./coq.js":"gLO8","./cos":"gmEm","./cos.js":"gmEm","./cpp":"Agkw","./cpp.js":"Agkw","./crmsh":"yOV0","./crmsh.js":"yOV0","./crystal":"KUpP","./crystal.js":"KUpP","./cs":"u2N3","./cs.js":"u2N3","./csp":"QnJG","./csp.js":"QnJG","./css":"7oys","./css.js":"7oys","./d":"jW1C","./d.js":"jW1C","./dart":"fEaW","./dart.js":"fEaW","./delphi":"H4p3","./delphi.js":"H4p3","./diff":"SLii","./diff.js":"SLii","./django":"0kiY","./django.js":"0kiY","./dns":"iobV","./dns.js":"iobV","./dockerfile":"RLXu","./dockerfile.js":"RLXu","./dos":"fP8y","./dos.js":"fP8y","./dsconfig":"uR4j","./dsconfig.js":"uR4j","./dts":"sM9k","./dts.js":"sM9k","./dust":"9Nr/","./dust.js":"9Nr/","./ebnf":"G01c","./ebnf.js":"G01c","./elixir":"dycj","./elixir.js":"dycj","./elm":"UFGb","./elm.js":"UFGb","./erb":"E2cJ","./erb.js":"E2cJ","./erlang":"s8Vx","./erlang-repl":"9JLW","./erlang-repl.js":"9JLW","./erlang.js":"s8Vx","./excel":"9c9R","./excel.js":"9c9R","./fix":"KyKy","./fix.js":"KyKy","./flix":"oU5B","./flix.js":"oU5B","./fortran":"SF9x","./fortran.js":"SF9x","./fsharp":"AhXs","./fsharp.js":"AhXs","./gams":"fZ2E","./gams.js":"fZ2E","./gauss":"rnof","./gauss.js":"rnof","./gcode":"lKKg","./gcode.js":"lKKg","./gherkin":"NRrW","./gherkin.js":"NRrW","./glsl":"3wag","./glsl.js":"3wag","./gml":"5upZ","./gml.js":"5upZ","./go":"CyL5","./go.js":"CyL5","./golo":"kZ3Q","./golo.js":"kZ3Q","./gradle":"lURu","./gradle.js":"lURu","./groovy":"H2RM","./groovy.js":"H2RM","./haml":"T0rU","./haml.js":"T0rU","./handlebars":"5VxD","./handlebars.js":"5VxD","./haskell":"PziN","./haskell.js":"PziN","./haxe":"fHEK","./haxe.js":"fHEK","./hsp":"wi1Z","./hsp.js":"wi1Z","./htmlbars":"ebWy","./htmlbars.js":"ebWy","./http":"wB1n","./http.js":"wB1n","./hy":"hmeD","./hy.js":"hmeD","./inform7":"Ll1m","./inform7.js":"Ll1m","./ini":"KpOm","./ini.js":"KpOm","./irpf90":"B05S","./irpf90.js":"B05S","./isbl":"u0OR","./isbl.js":"u0OR","./java":"My+Z","./java.js":"My+Z","./javascript":"TdF3","./javascript.js":"TdF3","./jboss-cli":"BKhn","./jboss-cli.js":"BKhn","./json":"WtIr","./json.js":"WtIr","./julia":"ImXp","./julia-repl":"t6qC","./julia-repl.js":"t6qC","./julia.js":"ImXp","./kotlin":"qUGr","./kotlin.js":"qUGr","./lasso":"Jb18","./lasso.js":"Jb18","./ldif":"GgYO","./ldif.js":"GgYO","./leaf":"LptB","./leaf.js":"LptB","./less":"GEZ5","./less.js":"GEZ5","./lisp":"mzJY","./lisp.js":"mzJY","./livecodeserver":"G+vv","./livecodeserver.js":"G+vv","./livescript":"LhHj","./livescript.js":"LhHj","./llvm":"fDA8","./llvm.js":"fDA8","./lsl":"KK3C","./lsl.js":"KK3C","./lua":"7P7d","./lua.js":"7P7d","./makefile":"el66","./makefile.js":"el66","./markdown":"BLBw","./markdown.js":"BLBw","./mathematica":"73oX","./mathematica.js":"73oX","./matlab":"jKVu","./matlab.js":"jKVu","./maxima":"OZ3z","./maxima.js":"OZ3z","./mel":"u34i","./mel.js":"u34i","./mercury":"JCUK","./mercury.js":"JCUK","./mipsasm":"o0In","./mipsasm.js":"o0In","./mizar":"DxbC","./mizar.js":"DxbC","./mojolicious":"ZrqW","./mojolicious.js":"ZrqW","./monkey":"pxCe","./monkey.js":"pxCe","./moonscript":"sbla","./moonscript.js":"sbla","./n1ql":"9Mhc","./n1ql.js":"9Mhc","./nginx":"9U8A","./nginx.js":"9U8A","./nimrod":"DzyG","./nimrod.js":"DzyG","./nix":"Rq6a","./nix.js":"Rq6a","./nsis":"syIQ","./nsis.js":"syIQ","./objectivec":"m/If","./objectivec.js":"m/If","./ocaml":"7mzT","./ocaml.js":"7mzT","./openscad":"AsRY","./openscad.js":"AsRY","./oxygene":"beiO","./oxygene.js":"beiO","./parser3":"NyhX","./parser3.js":"NyhX","./perl":"alHH","./perl.js":"alHH","./pf":"dnrZ","./pf.js":"dnrZ","./pgsql":"+FGM","./pgsql.js":"+FGM","./php":"KQfT","./php.js":"KQfT","./plaintext":"ROUN","./plaintext.js":"ROUN","./pony":"ldBm","./pony.js":"ldBm","./powershell":"UI5O","./powershell.js":"UI5O","./processing":"r7oX","./processing.js":"r7oX","./profile":"uQpx","./profile.js":"uQpx","./prolog":"Q5ZB","./prolog.js":"Q5ZB","./properties":"VrLj","./properties.js":"VrLj","./protobuf":"Lo5G","./protobuf.js":"Lo5G","./puppet":"UCcd","./puppet.js":"UCcd","./purebasic":"GwJY","./purebasic.js":"GwJY","./python":"lRCX","./python.js":"lRCX","./q":"Xfvt","./q.js":"Xfvt","./qml":"YSo5","./qml.js":"YSo5","./r":"Jrxr","./r.js":"Jrxr","./reasonml":"6ZBy","./reasonml.js":"6ZBy","./rib":"D68y","./rib.js":"D68y","./roboconf":"9Q8I","./roboconf.js":"9Q8I","./routeros":"2Vkh","./routeros.js":"2Vkh","./rsl":"oKc0","./rsl.js":"oKc0","./ruby":"gst6","./ruby.js":"gst6","./ruleslanguage":"irpp","./ruleslanguage.js":"irpp","./rust":"LOdI","./rust.js":"LOdI","./sas":"QPTg","./sas.js":"QPTg","./scala":"n3/M","./scala.js":"n3/M","./scheme":"QQjU","./scheme.js":"QQjU","./scilab":"6k3J","./scilab.js":"6k3J","./scss":"YROV","./scss.js":"YROV","./shell":"tluB","./shell.js":"tluB","./smali":"Gxxu","./smali.js":"Gxxu","./smalltalk":"jU8F","./smalltalk.js":"jU8F","./sml":"3EHr","./sml.js":"3EHr","./sqf":"4qfg","./sqf.js":"4qfg","./sql":"3gkP","./sql.js":"3gkP","./stan":"iTGd","./stan.js":"iTGd","./stata":"1LUk","./stata.js":"1LUk","./step21":"AIHI","./step21.js":"AIHI","./stylus":"vYiF","./stylus.js":"vYiF","./subunit":"Aqyh","./subunit.js":"Aqyh","./swift":"Kjk6","./swift.js":"Kjk6","./taggerscript":"JGhL","./taggerscript.js":"JGhL","./tap":"BrQc","./tap.js":"BrQc","./tcl":"on2m","./tcl.js":"on2m","./tex":"KcjC","./tex.js":"KcjC","./thrift":"rfnV","./thrift.js":"rfnV","./tp":"phP4","./tp.js":"phP4","./twig":"9G73","./twig.js":"9G73","./typescript":"r0Rl","./typescript.js":"r0Rl","./vala":"8SK+","./vala.js":"8SK+","./vbnet":"ieeH","./vbnet.js":"ieeH","./vbscript":"Wj43","./vbscript-html":"9Fqr","./vbscript-html.js":"9Fqr","./vbscript.js":"Wj43","./verilog":"4Q+X","./verilog.js":"4Q+X","./vhdl":"MQ8/","./vhdl.js":"MQ8/","./vim":"PGlF","./vim.js":"PGlF","./x86asm":"oVRe","./x86asm.js":"oVRe","./xl":"Jjkb","./xl.js":"Jjkb","./xml":"jctj","./xml.js":"jctj","./xquery":"JopO","./xquery.js":"JopO","./yaml":"Lns6","./yaml.js":"Lns6","./zephir":"nwyE","./zephir.js":"nwyE"};function o(e){var t=a(e);return i(t)}function a(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=a,e.exports=o,o.id="8gVO"},"8is8":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"formEditItem",staticClass:"form-edit-item"},[i("add-field",{ref:"addField",attrs:{"form-align":"horizontal","change-info":e.formData,workflow:e.workflowId,state:e.nodeId,"auto-selected-type":!1},on:{onConfirm:e.onConfirmClick,getAddFieldStatus:e.getAddFieldStatus,onCancel:function(t){return e.$emit("onEditCancel")}}})],1)},o=[];n._withStripped=!0},"8zq1":function(e,t,i){"use strict";i.r(t);var n=i("W98i"),o=i("0uNP");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("XvPQ");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"30b63a58",null);r.options.__file="src/views/processManagement/publicTrigger/components/responseCondition.vue",t.default=r.exports},"9KRo":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("nav-title",{attrs:{"show-icon":!0,"title-name":e.serviceInfo.name||e.$t("m.serviceConfig['新建服务']")},on:{goBack:e.onBackIconClick}},[i("div",{attrs:{slot:"step"},slot:"step"},[i("bk-steps",{attrs:{"ext-cls":"steps-icon","data-test-id":"service_steps_serviceEditStep",controllable:!0,"line-type":"solid","cur-step":e.currStep,steps:e.stepList},on:{"step-changed":e.onStepChange}})],1)]),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.serviceLoading||e.flowInfoLoading},expression:"{ isLoading: serviceLoading || flowInfoLoading }"}],class:["steps-content",{"steps-content-height":e.isShowNodeConfig}]},[e.serviceLoading||e.flowInfoLoading?e._e():[1===e.currStep?i("service-form-step",{ref:"serviceFormStep",attrs:{type:e.type,"service-id":e.serviceId,"service-info":e.serviceInfo,"create-ticket-node-id":e.serviceInfo.first_state_id},on:{updateServiceInfo:e.updateServiceInfo}}):2===e.currStep?i("service-process-step",{ref:"serviceProcessStep",attrs:{"service-info":e.serviceInfo,"flow-info":e.flowInfo},on:{updateFlowInfo:e.getFlowDetailInfo,setConfigStatus:e.setConfigStatus}}):3===e.currStep?i("service-setting-step",{ref:"serviceSettingStep",attrs:{"service-info":e.serviceInfo,"flow-info":e.flowInfo}}):e._e()]],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShowNodeConfig||2!==e.currStep,expression:"!isShowNodeConfig || currStep !== 2"}],staticClass:"submit-footer-bar"},[i("bk-button",{attrs:{"data-test-id":"service_button_prevStep","ext-cls":"button-item",theme:"default",disabled:e.isSubmitting},on:{click:e.onPrevStepClick}},[e._v("\n            "+e._s(e.prevStepBtnName)+"\n        ")]),e._v(" "),i("bk-button",{attrs:{"data-test-id":"service_button_nextStepAndSave","ext-cls":"button-item",theme:"primary",disabled:!e.serviceId&&0!==e.serviceId,loading:e.isSubmitting},on:{click:e.onNextStepClick}},[e._v("\n            "+e._s(e.nextStepBtnName)+"\n        ")])],1)],1)},o=[];n._withStripped=!0},"9MBU":function(e,t,i){"use strict";i.r(t);var n=i("k85c"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"9ZYk":function(e,t,i){"use strict";i.r(t);var n=i("o+k2"),o=i("EQfD");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("o3v5");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"76ad1ee0",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/exportApiTree.vue",t.default=r.exports},"9h1A":function(e,t,i){},"9nYo":function(e,t,i){},"9psX":function(e,t,i){"use strict";i.r(t);var n=i("ptjD"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"9te6":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-template-node"},["START"===e.node.type?i("div",{staticClass:"startpoint"},[e._v("\n        "+e._s(e.$t('m.treeinfo["开始"]'))+"\n    ")]):e._e(),e._v(" "),"END"===e.node.type?i("div",{staticClass:"endpoint"},[e._v("\n        "+e._s(e.$t('m.treeinfo["结束"]'))+"\n    ")]):e._e(),e._v(" "),e._l(e.typeList,(function(t,n){return[e.node.type===t.type?[i("div",{key:n,staticClass:"common-node",class:{"common-auto":"TASK"===t.type}},[i("span",{staticClass:"common-auto-icon",class:{"bk-is-draft":e.node.nodeInfo&&e.node.nodeInfo.is_draft}},["TASK"!==t.type?i("i",{staticClass:"bk-itsm-icon",class:t.iconStyle}):i("span",{staticStyle:{"font-size":"12px","font-weight":"bold"}},[e._v("API")])]),e._v(" "),i("span",{staticClass:"bk-more-word"},[e._v(e._s(e.node.name||e.$t('m.treeinfo["新增节点"]')))])])]:e._e()]})),e._v(" "),"ROUTER-P"===e.node.type?i("div",{staticClass:"common-branch"},[i("i",{staticClass:"bk-itsm-icon icon-flow-convergence"})]):e._e(),e._v(" "),"COVERAGE"===e.node.type?i("div",{staticClass:"common-branch"},[i("i",{staticClass:"bk-itsm-icon icon-flow-branch"})]):e._e()],2)},o=[];n._withStripped=!0},"9xhR":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("14Xm")),o=d(i("D3Ub")),a=d(i("5WyB")),s=d(i("PRQd")),r=d(i("bcjM")),c=d(i("s4tT")),l=i("ygAv"),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"basicNode",components:{BasicCard:c.default,basicInfo:a.default,fieldConfig:s.default,commonTriggerList:r.default},props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}}},data:function(){return{isLoading:!1,secondClick:!1,showMoreConfig:!1,stringValueList:["OPEN","STARTER"],nodeTagList:[],baseFormData:{}}},mounted:function(){this.initData()},methods:{initData:function(){this.getNodeTagList()},getNodeTagList:function(){var e=this;this.$store.dispatch("datadict/get_data_by_key",{key:"STATE_TAG_TYPE"}).then((function(t){e.nodeTagList=t.data})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){}))},checkStringValue:function(e){return-1===this.stringValueList.findIndex((function(t){return t===e}))},submitNode:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i,o,a,s,r;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.$refs.basic.backBasicInfo(),!((o=e.$refs.basic.checkStatus).name||o.assignors||o.delivers||o.processors)){t.next=4;break}return t.abrupt("return");case 4:if((a={}).is_draft=!1,a.workflow=e.flowInfo.id,a.type=e.configur.type,a.is_terminable=!1,a.name=i.name,a.tag=i.tag,a.distribute_type=i.distribute_type,a.assignors_type=i.assignors_type,a.assignors=i.assignors,a.processors_type=i.processors_type,a.processors=i.processors,a.extras={ticket_status:{name:i.ticket_key,type:i.ticket_type}},a.can_deliver=i.can_deliver,a.delivers_type=i.delivers_type,a.delivers=i.delivers,s=e.$refs.field.showTabList,a.fields=s.map((function(e){return e.id})),r=e.configur.id,!e.secondClick){t.next=25;break}return t.abrupt("return");case 25:e.secondClick=!0,e.$store.dispatch("deployCommon/updateNode",{params:a,id:r}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$emit("closeConfigur",!0)})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}));case 27:case"end":return t.stop()}}),t,e)})))()},closeNode:function(){this.$emit("closeConfigur",!1)},baseFormInfoChange:function(e){var t=e.distribute_type,i=e.can_deliver;if(t!==this.baseFormData.distribute_type||i!==this.baseFormData.can_deliver){this.baseFormData=(0,l.deepClone)(e);var n={PROCESS:[],DISTRIBUTE_THEN_PROCESS:["CLAIM_STATE","DELIVER_STATE"],CLAIM_THEN_PROCESS:["DISTRIBUTE_STATE","DELIVER_STATE"],DISTRIBUTE_THEN_CLAIM:[]}[t]||[];this.configur.is_builtin||(i?n=n.filter((function(e){return"DELIVER_STATE"!==e})):-1===n.indexOf("DELIVER_STATE")&&n.push("DELIVER_STATE")),this.$refs.commonTriggerList&&(this.$refs.commonTriggerList.setFilterSignal(n),this.$refs.commonTriggerList.getBoundTriggerList())}}}}},"A/4B":function(e,t,i){"use strict";i.r(t);var n=i("v5D/"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},AFtY:function(e,t,i){"use strict";i.r(t);var n=i("M78e"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},AIvP:function(e,t,i){},AMCF:function(e,t,i){},AMUZ:function(e,t,i){},APEn:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree bk-form-width",class:{"bk-border-error":e.item.checkValue}},[i("div",{staticClass:"bk-search-tree-wrapper",class:{bkdisabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e.showTree.apply(null,arguments)}}},[i("span",{class:{"bk-color-tree":e.treeSlectInfo.info.name}},[e._v("\n                    "+e._s(e.treeSlectInfo.info.showName||e.$t('m.newCommon["请选择"]'))+"\n                ")]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]),e._v(" "),i("transition",{attrs:{name:"common-fade"}},[e.treeSlectInfo.show?[e.treeSlectInfo.treeDataList.length?i("div",{staticClass:"bk-search-tree-content"},[i("export-tree",{attrs:{"tree-data-list":e.treeSlectInfo.treeDataList},on:{toggle:e.toggleInfo,toggleChildren:e.toggleChildren}})],1):i("div",{staticClass:"bk-search-tree-content"},[i("p",{staticClass:"bk-search-tree-nodata"},[e._v(e._s(e.$t('m.treeinfo["暂无数据"]')))])])]:e._e()],2)],1)]),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},Abqk:function(e,t,i){"use strict";i.r(t);var n=i("25E2"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},Acdu:function(e,t,i){"use strict";i("zdoL")},Albq:function(e,t,i){"use strict";i.r(t);var n=i("v9ex"),o=i("bIVE");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("ySJU");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"3247fc23",null);r.options.__file="src/views/service/editService/HalfRowForm.vue",t.default=r.exports},BFl6:function(e,t,i){"use strict";i.r(t);var n=i("ew6e"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},BGW0:function(e,t,i){},BKtx:function(e,t,i){"use strict";i.r(t);var n=i("zmPZ"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},BPSA:function(e,t,i){"use strict";i("2XNL")},BVcZ:function(e,t,i){"use strict";i.r(t);var n=i("IlXa"),o=i("ciLR");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("NREj");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"39367542",null);r.options.__file="src/views/service/editService/ServiceSettingStep.vue",t.default=r.exports},BWJp:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=d(i("4d7F")),a=d(i("/f1G")),s=d(i("14Xm")),r=d(i("gDS+")),c=d(i("D3Ub")),l=d(i("sEfC")),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}t.default={methods:{get_priority:function(e,t){var i=this;return(0,c.default)(s.default.mark((function n(){var o,a;return s.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((o=JSON.parse((0,r.default)(e))).service_type=t.service,delete o.id,a={id:t.ticket_id},o.impact&&o.urgency){n.next=7;break}return n.next=7,i.$store.dispatch("change/getStepList",a).then((function(t){t.data.forEach((function(t){t.fields.forEach((function(t){"urgency"===t.key&&(o.urgency=e.urgency||t.value),"impact"===t.key&&(o.impact=e.impact||t.value)}))}))}),(function(e){(0,u.errorHandler)(e,i)}));case 7:i.$store.dispatch("apiRemote/get_priority",{data:o}).then((function(e){t.val=e.data})).catch((function(e){(0,u.errorHandler)(e,i)}));case 8:case"end":return n.stop()}}),n,i)})))()},get_data_by_key:function(e){var t=this;return(0,c.default)(s.default.mark((function i(){return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",t.$store.dispatch("datadict/get_data_by_key",{key:e.source_uri,field_key:e.key,service:e.service,current_status:e.ticket_status}).then((function(t){e.choice=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(e){(0,u.errorHandler)(e,t)})));case 1:case"end":return i.stop()}}),i,t)})))()},apiRemoteGetData:function(e,t,i){var n=this,o=JSON.parse((0,r.default)(e)),a="apiRemote/get_data";return"workflow"===i&&(a="apiRemote/get_data_workflow"),"submit"===i&&(a="apiRemote/get_data_receipts",o={api_instance_id:t.api_instance_id,kv_relation:t.kv_relation,fields:o}),o.id=t.id,o.kv_relation=t.kv_relation,o.api_instance_id=t.api_instance_id,o.api_info=t.api_info,this.$store.dispatch(a,o).then((function(e){t.choice=[],e.data.map((function(e){return{key:e.key||e.id,name:e.name}})).forEach((function(e){t.choice.push(JSON.parse((0,r.default)(e)))}))})).catch((function(e){(0,u.errorHandler)(e,n)}))},debounce:(0,l.default)((n=(0,c.default)(s.default.mark((function e(t,i,n,o,a){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("priority"!==i.key){e.next=3;break}return n.get_priority(t,i,o),e.abrupt("return",!1);case 3:n.apiRemoteGetData(t,i,o,a);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,i,o,a){return n.apply(this,arguments)}),1e3,{leading:!0,trailing:!0,maxWait:2e3}),isNecessaryToWatch:function(e,t,i){var n=this;return(0,c.default)(s.default.mark((function r(){var l,u,d,f,p,m;return s.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(l=[],e.fields.forEach((function(i){if("DATADICT"===i.type&&"TREESELECT"!==i.type&&l.push(n.get_data_by_key(i)),("API"===i.source_type||"priority"===i.key)&&!i.choice.some((function(e){return e.can_delete}))){var o={id:i.id,api_instance_id:i.api_instance_id,kv_relation:i.kv_relation};i.related_fields&&i.related_fields.rely_on&&i.related_fields.rely_on.forEach((function(t){var i=e.fields.find((function(e){return e.key===t}));i&&(o[t]=i.val||"")})),(0,a.default)(o).every((function(e){return!!e}))&&"priority"!==e.key&&l.push(n.apiRemoteGetData(o,i,t))}})),o.default.all(l).then((function(){i&&i()})),(u=e.fields.filter((function(e){return("API"===e.source_type||"priority"===e.key)&&e.related_fields&&e.related_fields.rely_on&&e.related_fields.rely_on.length}))).length){r.next=6;break}return r.abrupt("return");case 6:if(d=[],u.forEach((function(e){d=d.concat(e.related_fields.rely_on)})),(f=e.fields.filter((function(e){return e.related_fields&&e.related_fields.be_relied&&e.related_fields.be_relied.length}))).length){r.next=11;break}return r.abrupt("return");case 11:if((p=f.filter((function(e){return-1!==d.indexOf(e.key)}))).length){r.next=14;break}return r.abrupt("return");case 14:m=n,p.forEach((function(i){m.$watch((function(){return i.val}),(function(n,o){var a,r=this;i.val&&u.filter((function(e){return-1!==e.related_fields.rely_on.indexOf(i.key)})).forEach((a=(0,c.default)(s.default.mark((function i(n){var o;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:p.filter((function(e){return-1!==n.related_fields.rely_on.indexOf(e.key)})).every((function(e){return e.val}))&&(o={id:n.id,api_instance_id:n.api_instance_id,kv_relation:n.kv_relation},n.related_fields&&n.related_fields.rely_on&&n.related_fields.rely_on.forEach((function(t){var i=p.find((function(e){return e.key===t}));e.fields.find((function(e){return e.key===t}))&&(o[t]=i.val||"")})),"priority"!==n.key&&(n.choice.splice(0,n.choice.length),n.val=""),m.debounce(o,n,m,t));case 3:case"end":return i.stop()}}),i,r)}))),function(e){return a.apply(this,arguments)}))}),{deep:!0})}));case 16:case"end":return r.stop()}}),r,n)})))()},freshApi:function(e,t,i){var n={},o=t.map((function(e){return e.key}));e.related_fields&&e.related_fields.rely_on&&e.related_fields.rely_on.forEach((function(e){var i=t.filter((function(t){return t.key===e}))[0];-1!==o.indexOf(e)&&(n[e]=i&&i.val||"")})),(0,a.default)(n).every((function(e){return!!e}))&&(e.choice.splice(0,e.choice.length),e.val="",this.debounce(n,e,this,i))}}}},BcAi:function(e,t,i){"use strict";i("QKTH")},BkRI:function(e,t,i){var n=i("OBhP");e.exports=function(e){return n(e,5)}},Bzqh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"FullScreen",props:{isFull:{type:Boolean,default:!1},title:{type:String,default:""}},watch:{isFull:function(e){e&&(this.$bkMessage({message:this.$t('m.common["按 ESC 键退出全屏"]')}),document.addEventListener("keydown",this.handlerKeyDown))}},methods:{onClose:function(){this.$emit("onClose")},handlerKeyDown:function(e){27===e.keyCode&&(this.onClose(),document.removeEventListener("keydown",this.handlerKeyDown))}}}},C65D:function(e,t,i){"use strict";i.r(t);var n=i("go9q"),o=i("Vv2+");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("NsTJ");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,null,null);r.options.__file="src/components/renderview/sideslider/Sideslider.vue",t.default=r.exports},C6tm:function(e,t,i){"use strict";i.r(t);var n=i("P+p4"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},CBo5:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("efIh"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"TEXT",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{}}},"CXV/":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojNzM3OTg3O30KPC9zdHlsZT4KPGc+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNzA0LDY0TDcwNCw2NEgxMjh2ODk2aDc2OFYyNTZsMCwwTDcwNCw2NHogTTcwNCwxNTQuNUw4MDUuNSwyNTZINzA0VjE1NC41eiBNODMyLDg5NkgxOTJWMTI4aDQ0OHYxOTJoMTkyCgkJVjg5NnoiLz4KCTxyZWN0IHg9IjI4OCIgeT0iMzIwIiBjbGFzcz0ic3QwIiB3aWR0aD0iMjU2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSIyODgiIHk9IjQ0OCIgY2xhc3M9InN0MCIgd2lkdGg9IjQ0OCIgaGVpZ2h0PSI2NCIvPgoJPHJlY3QgeD0iMjg4IiB5PSI1NzYiIGNsYXNzPSJzdDAiIHdpZHRoPSI0NDgiIGhlaWdodD0iNjQiLz4KCTxyZWN0IHg9IjI4OCIgeT0iNzA0IiBjbGFzcz0ic3QwIiB3aWR0aD0iNDQ4IiBoZWlnaHQ9IjY0Ii8+CjwvZz4KPC9zdmc+Cg=="},CjxG:function(e,t,i){"use strict";i.r(t);var n=i("mW7z"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},CmE3:function(e,t,i){"use strict";i("2CJJ")},CskW:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-dialog",{attrs:{"data-test-id":"service_dialog_serviceChoiceDialog","render-directive":"if","ext-cls":"choose-service-template-dialog",width:980,value:e.isShow,"auto-close":!1,"show-footer":!1},on:{"value-change":e.onDialogClose}},[i("div",{staticClass:"choose-service-template"},[i("h3",{staticClass:"dialog-header"},[i("span",{staticClass:"dialog-name"},[e._v(e._s(e.createInfo.name))]),e._v(" "),"created"===e.createWay?i("bk-input",{staticClass:"search-input",attrs:{"right-icon":"bk-icon icon-search",placeholder:e.$t("m.common['请输入服务名称']"),clearable:!0},on:{change:e.searchHandler}}):e._e()],1),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading},expression:"{ isLoading: loading }"}],staticClass:"dialog-body"},[e.templateList.length?i("ul",{staticClass:"template-list"},e._l(e.templateList,(function(t,n){return i("li",{key:n,staticClass:"template-item",attrs:{"data-test-id":"serviceTemplateList-li-"+t.id},on:{click:function(i){return e.onTemplateClick(t)}}},[i("p",{staticClass:"template-name",domProps:{innerHTML:e._s(t.name)}}),e._v(" "),"recom"===e.createWay?i("p",{staticClass:"template-time"},[e._v(e._s(t.time))]):e._e()])})),0):i("div",{staticClass:"service-empty"},[i("div",[i("i",{staticClass:"bk-icon icon-empty"}),e._v(" "),i("p",{staticClass:"text"},[e.searchModel?i("span",[e._v(e._s(e.$t("m.common['无匹配服务']")))]):i("span",[e._v("暂无服务")])])])])])])])},o=[];n._withStripped=!0},CyHO:function(e,t,i){"use strict";i.r(t);var n=i("HxM3"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},Cyyo:function(e,t,i){"use strict";i.r(t);var n=i("/BG8"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"D0+e":function(e,t,i){"use strict";i("2iWM")},DcOk:function(e,t,i){"use strict";i("FUmd")},DjpW:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{placeholder:e.item.desc,type:"textarea",rows:8,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},DoRf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("14Xm")),o=r(i("gDS+")),a=r(i("D3Ub")),s=r(i("TQwK"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseCondition",components:{responseContent:s.default},props:{responseWayList:{type:Array,default:function(){return[]}},responseList:{type:Array,default:function(){return[]}},signal:String},data:function(){return{wayList:[],apiList:[]}},created:function(){},methods:{addResponse:function(e,t){this.responseList.splice(t+1,0,{way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1})},deleteResponse:function(e,t){1!==this.responseList.length&&this.responseList.splice(t,1)},selectedWay:function(){var e=arguments,t=this;return(0,a.default)(n.default.mark((function i(){return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e[2].wayStatus&&(e[2].wayStatus=!1),e[2].isLoading=!0,e[2].wayInfo=JSON.parse((0,o.default)(t.responseWayList.filter((function(t){return t.key===e[0]}))[0])),setTimeout((function(){e[2].isLoading=!1}),1e3);case 4:case"end":return i.stop()}}),i,t)})))()}}}},Du1T:function(e,t,i){"use strict";i.r(t);var n=i("429m"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},Dxj1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-deal-person",class:{"person-vertical":"vertical"===e.formType,"inline-auto-width":"inline-auto-width"===e.formType,"no-second":e.noSecondTypeList.includes(e.formData.levelOne)}},[i("div",{staticClass:"first-level"},[i("bk-select",{attrs:{"ext-cls":"bk-form-width mr10","data-test-id":"dealPerson-select-firstHandler",loading:e.initLoaing,clearable:!1,searchable:"","font-size":"medium"},on:{selected:e.onFirstLevelChange},model:{value:e.formData.levelOne,callback:function(t){e.$set(e.formData,"levelOne",t)},expression:"formData.levelOne"}},e._l(e.firstLevelList,(function(e){return i("bk-option",{key:e.id,attrs:{"data-test-id":"dealPerson-select-first-"+e.id,id:e.id,name:e.name}})})),1)],1),e._v(" "),["PERSON","GENERAL","CMDB","IAM","API","ASSIGN_LEADER","VARIABLE","ORGANIZATION"].includes(e.formData.levelOne)?i("div",{staticClass:"second-level"},["PERSON"===e.formData.levelOne&&Array.isArray(e.formData.levelSecond)?[i("member-select",{attrs:{"data-test-id":"dealPerson-select-personSecondHandler","ext-cls":"bk-form-width","specify-id-list":e.targetSpecifyIdList},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})]:["GENERAL","CMDB","IAM","API","ASSIGN_LEADER","VARIABLE"].includes(e.formData.levelOne)?[i("bk-select",{attrs:{"ext-cls":"bk-form-width","data-test-id":"dealPerson-select-secondHandler",loading:e.isLoading,"show-select-all":"",multiple:!["ASSIGN_LEADER"].includes(e.formData.levelOne),searchable:"","font-size":"medium"},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.secondLevelList,(function(e){return i("bk-option",{key:e.id,attrs:{"data-test-id":"dealPerson-select-second-"+e.id,id:e.id,name:e.name}})})),1)]:"ORGANIZATION"===e.formData.levelOne?[i("select-tree",{attrs:{list:e.organizationList,"organization-loading":e.organizationLoading,"ext-cls":"bk-form-width"},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})]:e._e()],2):e._e(),e._v(" "),e.showError?i("p",{staticClass:"bk-error-info"},[e._v(e._s(e.requiredMsg||e.$t("m.treeinfo['处理人不能为空']")))]):e._e()])},o=[];n._withStripped=!0},E3ky:function(e,t,i){"use strict";i.r(t);var n=i("W/oT"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},E8LH:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-basic-node"},[i("basic-card",{attrs:{"card-label":e.$t("m.treeinfo['基本信息']")}},[i("bk-form",{ref:"nodeInfoForm",attrs:{"label-width":150,model:e.formInfo,rules:e.nodeInfoRule}},[i("bk-form-item",{attrs:{"data-test-id":"signNode-input-name",label:e.$t("m.treeinfo['节点名称：']"),required:!0,property:"name","ext-cls":"bk-form-width"}},[i("bk-input",{attrs:{maxlength:"120"},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['处理方式：']"),required:!0,property:"nodeType"}},[i("bk-radio-group",{model:{value:e.formInfo.is_sequential,callback:function(t){e.$set(e.formInfo,"is_sequential",t)},expression:"formInfo.is_sequential"}},[i("bk-radio",{attrs:{value:!1,"ext-cls":"mr50 pr40"}},[e._v(e._s(e.$t("m.treeinfo['多人随机会签']"))+"\n                        "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['要求所有处理人全部处理完成，多人处理没有先后顺序要求。']"),expression:"$t(`m.treeinfo['要求所有处理人全部处理完成，多人处理没有先后顺序要求。']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"})]),e._v(" "),i("bk-radio",{attrs:{value:!0}},[e._v(e._s(e.$t("m.treeinfo['多人依次会签']"))+"\n                        "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.$t("m.treeinfo['要求所有处理人按照名单顺序，依次全部处理完成。']"),expression:"$t(`m.treeinfo['要求所有处理人按照名单顺序，依次全部处理完成。']`)"}],staticClass:"bk-itsm-icon icon-icon-info tooltip-icon"})])],1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"signNode-radio-processors ",label:e.$t("m.treeinfo['处理人：']"),required:!0,property:"processors","ext-cls":"bk-processor-width form-cus-height"}},[i("member-select",{model:{value:e.formInfo.processors,callback:function(t){e.$set(e.formInfo,"processors",t)},expression:"formInfo.processors"}}),e._v(" "),e.formInfo.processors.length?i("p",{staticClass:"bk-processor-length"},[e._v(e._s(e.$t("m.treeinfo['共']"))),i("span",[e._v(e._s(e.formInfo.processors.length))]),e._v(e._s(e.formInfo.is_sequential?e.$t("m.treeinfo['人']")+e.$t("m.treeinfo['，名单顺序将会影响会签顺序']"):e.$t("m.treeinfo['人']")))]):e._e()],1)],1)],1),e._v(" "),i("basic-card",{staticClass:"mt20",attrs:{"card-label":e.$t("m.treeinfo['字段配置']")}},[i("field-config",{ref:"field",attrs:{"flow-info":e.flowInfo,configur:e.configur}})],1),e._v(" "),i("basic-card",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.getConditionFlag},expression:"{ isLoading: getConditionFlag }"}],staticClass:"mt20",attrs:{"card-label":e.$t("m.treeinfo['会签提前结束配置']"),"card-desc":e.$t("m.treeinfo['默认结束条件：所有处理人处理完成，会签自动结束；若配置了会签提前结束条件，满足条件，将提前结束']")}},[i("div",{staticClass:"bk-condition-content"},[e._l(e.finishCondition.expressions,(function(t,n){return i("div",{key:n,staticClass:"bk-condition-group"},[i("p",{staticClass:"bk-group-title"},[e._v(e._s(e.$t("m.treeinfo['或-条件组']"))+e._s(n+1))]),e._v(" "),i("div",{class:{"bk-group-content":!0,"bk-group-contents":t.expressions.length>1}},e._l(t.expressions,(function(o,a){return i("bk-form",{key:a,ref:"finishConditionForms",refInFor:!0,attrs:{"label-width":0,rules:e.finishConditionRule,model:o,"form-type":"inline","ext-cls":"bk-condition"}},[i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus",property:"key"}},[t.expressions.length>1?i("div",{staticClass:"bk-left-block"},[i("span",{class:{"left-top-default":!0,"no-left-border":0===a}}),e._v(" "),i("span",{class:{"left-bottom-default":!0,"no-left-border":a===t.expressions.length-1}}),e._v(" "),a!==t.expressions.length-1?i("span",{staticClass:"bk-left-letter"},[e._v(e._s(e.$t("m.common['且']")))]):e._e()]):e._e(),e._v(" "),i("bk-select",{attrs:{"font-size":"medium",clearable:!1,"ext-cls":"bk-form-width-long"},on:{selected:function(t){return e.selectCondition(t,o,a,n)}},model:{value:o.key,callback:function(t){e.$set(o,"key",t)},expression:"expression.key"}},e._l(e.allCondition,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus"}},[i("bk-select",{attrs:{"font-size":"medium",clearable:!1,"ext-cls":"bk-form-width-short"},model:{value:o.condition,callback:function(t){e.$set(o,"condition",t)},expression:"expression.condition"}},e._l(e.betweenList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"signNode-input-conditionValue","ext-cls":"bk-form-item-cus",property:"value"}},[i("bk-input",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:o.tooltipInfo,expression:"expression.tooltipInfo"}],attrs:{"ext-cls":"bk-form-width-long",disabled:!e.formInfo.processors.length&&"INT"===o.meta.unit||!o.key,clearable:!1,type:"number",max:"INT"===o.meta.unit?e.formInfo.processors.length:100,min:0,precision:0},on:{change:function(t){return e.giveTooltip(o)}},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"expression.value"}}),e._v(" "),"PERCENT"===o.meta.unit?i("span",{staticClass:"buttonIcon"},[e._v("%")]):e._e()],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-form-item-cus"}},[i("div",{staticClass:"bk-operate-expression"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add mr10",on:{click:function(i){return e.operateExpression(t)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce mr10",class:{"bk-itsm-icon-disable":1===t.expressions.length},on:{click:function(i){return e.operateExpression(t,"del",a,n,o)}}})])]),e._v(" "),i("i",{staticClass:"bk-icon icon-close bk-delete-group",on:{click:function(t){return e.operateGroup("del",n)}}})],1)})),1)])})),e._v(" "),i("p",{staticClass:"bk-add-group",on:{click:e.operateGroup}},[i("i",{staticClass:"bk-itsm-icon icon-add-new mr5"}),e._v("\n                "+e._s(e.$t("m.treeinfo['添加“或”条件组']")))])],2)]),e._v(" "),i("common-trigger-list",{attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"bk-node-btn"},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"signNode-button-submit",title:e.$t("m.treeinfo['确定']"),loading:e.secondClick},on:{click:e.submitNode}},[e._v("\n            "+e._s(e.$t("m.treeinfo['确定']"))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"signNode-button-close",title:e.$t("m.treeinfo['取消']"),loading:e.secondClick},on:{click:e.closeNode}},[e._v("\n            "+e._s(e.$t("m.treeinfo['取消']"))+"\n        ")])],1)],1)},o=[];n._withStripped=!0},EQfD:function(e,t,i){"use strict";i.r(t);var n=i("7XAC"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},EYXk:function(e,t,i){},EYn8:function(e,t,i){},Epmc:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"view-item"},[e.crumbsList.length>1?i("div",{staticClass:"bread-crumbs"},e._l(e.crumbsList,(function(t,n){return i("span",{key:n,staticClass:"crumbs-item",on:{click:function(t){return t.stopPropagation(),e.onCrumbsClick(n)}}},[e._v("\n            "+e._s(t.label)+"\n        ")])})),0):e._e(),e._v(" "),e.crumbsList.length<=1?i(e.componentType,e._b({tag:"component",attrs:{form:e.form}},"component",e.getAttrs(e.form),!1)):i("render-view",{ref:"childrenView",attrs:{"hidden-label":!0,"form-data":e.childrenViewConfig.form_data,context:e.getContext()}})],1)},o=[];n._withStripped=!0},Et6z:function(e,t,i){},EtUq:function(e,t,i){"use strict";i.r(t);var n=i("jppy"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},EvQG:function(e,t,i){},F1Y2:function(e,t,i){},F5gn:function(e,t,i){},FCVG:function(e,t,i){"use strict";i.r(t);var n=i("3EVL"),o=i("9MBU");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"ea674922",null);r.options.__file="src/components/renderview/RenderView.vue",t.default=r.exports},FFUD:function(e,t,i){"use strict";i("5Bno")},FGMr:function(e,t,i){"use strict";i.r(t);var n=i("/jEY"),o=i("Du1T");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"2c90ff7a",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/getRpcParam.vue",t.default=r.exports},FO58:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"service-form",class:{"hide-field-option":!e.showFieldOption}},[i("div",{class:["field-option",e.isShowField?"field-hide":""]},[i("div",{staticStyle:{overflow:"hidden",height:"100%"}},[i("div",{staticClass:"field-type"},[e._v("字段类型")]),e._v(" "),i("div",{staticClass:"show-field",on:{click:e.handleShowField}},[i("i",{class:["bk-itsm-icon",e.isShowField?"icon-xiangyou1":"icon-xiangzuo1"]})]),e._v(" "),i("div",{staticStyle:{display:"flex",height:"calc(100% - 100px)","flex-direction":"column"}},[i("div",{staticClass:"field-content"},[i("div",{staticClass:"field-title"},[i("span",[e._v("控件库")]),e._v(" "),i("bk-input",{staticClass:"search-field",attrs:{size:"small","right-icon":"bk-icon icon-search"},on:{enter:e.handleSearchLibrary}})],1),e._v(" "),i("ul",{staticClass:"field-list"},e._l(e.fieldsLibrary,(function(t,n){return i("li",{key:n,staticClass:"field-item",on:{click:function(i){return e.onAddFormClick(t)}}},[i("span",{staticClass:"field-name"},[e._v(e._s(t.name))])])})),0),e._v(" "),0===e.fieldsLibrary.length?i("div",{staticClass:"public-field"},[i("i",{staticClass:"bk-itsm-icon icon-itsm-icon-four-zero",staticStyle:{"font-size":"14px"}}),e._v(" 已有字段不存在你搜索的内容")]):e._e()]),e._v(" "),i("div",{staticClass:"field-content"},[i("div",{staticClass:"field-title"},[i("span",[e._v("已有字段")]),e._v(" "),i("bk-input",{staticClass:"search-field",attrs:{size:"small","right-icon":"bk-icon icon-search"},on:{enter:e.handleSearchField}})],1),e._v(" "),i("ul",{staticClass:"field-list"},e._l(e.publicFields,(function(t,n){return i("li",{key:n,staticClass:"field-item",on:{click:function(i){return e.addField(t)}}},[i("span",{staticClass:"field-name"},[e._v(e._s(t.name))])])})),0),e._v(" "),0===e.publicFields.length?i("div",{staticClass:"public-field"},[i("i",{staticClass:"bk-itsm-icon icon-itsm-icon-four-zero",staticStyle:{"font-size":"14px"}}),e._v(" 已有字段不存在你搜索的内容")]):e._e()])])])]),e._v(" "),i("div",{staticClass:"basic-body"},[i("section",{staticClass:"settion-card create-info-card",attrs:{"data-test-id":"servie_section_serviceticketInformation"}},[e.showFieldOption?e._e():i("div",{staticClass:"service-template"},e._l(e.serviceFormCreateWays.slice(0,2),(function(t,n){return i("div",{key:n,staticClass:"template-type",attrs:{"data-test-id":"servie_section_QuicklyCreateForm"},on:{click:function(i){return e.onCreateFormWayCLick(t)}}},[i("i",{staticClass:"bk-itsm-icon icon-it-new-globalview"}),e._v(" "),i("span",[e._v(e._s(t.name))])])})),0),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.formLoading},expression:"{ isLoading: formLoading }"}],staticClass:"create-service-form"},[i("div",[i("ServiceForm",{ref:"serviceForm",attrs:{"add-field-status":e.addFieldStatus,"service-info":e.serviceInfo,"node-id":e.createTicketNodeId,forms:e.ticketNodeForm,"crt-form":e.crtForm},on:{"update:crtForm":function(t){e.crtForm=t},"update:crt-form":function(t){e.crtForm=t},dragUpdateList:e.dragUpdateList,onAddFormClick:e.onAddFormClick,addField:e.addField,onFormEditClick:e.onFormEditClick,cancelAdd:e.cancelAddField,fieldClone:e.fieldClone,fieldDelete:e.fieldDelete,saveField:e.saveField}})],1)])])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.crtForm,expression:"crtForm"}],staticClass:"drag-line",on:{mousedown:e.handleDragLine}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.crtForm,expression:"crtForm"}],staticClass:"edit-service-field"},[i("div",{staticClass:"edit-service-title"},[e._v("字段属性")]),e._v(" "),i("div",{staticClass:"edit-service-forms"},[e._l(e.ticketNodeForm,(function(t){return[t.id===e.crtForm?i("form-edit-item",{key:t.id,attrs:{fields:e.ticketNodeForm,form:t,"workflow-id":e.serviceInfo.workflow_id,"node-id":e.createTicketNodeId},on:{onEditCancel:e.onEditCancel,getAddFieldStatus:e.getAddFieldStatus,onEditConfirm:e.onEditConfirm}}):e._e()]}))],2)]),e._v(" "),i("bk-dialog",{attrs:{width:"800",value:e.isCreateService,"mask-close":!1,title:"创建服务","auto-close":!1},on:{confirm:e.onBasicFormSubmit,cancel:e.onBasicFormCancel}},[i("bk-form",{ref:"basicForm",staticClass:"basic-form",attrs:{"form-type":"vertical",rules:e.rules,model:e.formData}},[i("bk-form-item",{attrs:{"data-test-id":"service-input-serviceName",label:e.$t("m.newCommon['服务名称']"),required:!0,property:"name","error-display-type":"normal"}},[i("bk-input",{attrs:{maxlength:120,"show-word-limit":!0},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.serviceConfig['服务描述']"),property:"desc"}},[i("bk-input",{attrs:{type:"textarea",row:3,maxlength:100},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"service-select-serviceDirectory",label:e.$t("m.tickets['所属目录']"),required:!0,property:"catalog_id","error-display-type":"normal"}},[i("select-tree",{attrs:{list:e.dirList,"ext-cls":"bk-form-width"},model:{value:e.formData.catalog_id,callback:function(t){e.$set(e.formData,"catalog_id",t)},expression:"formData.catalog_id"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"service-select-serviceType",label:e.$t("m.serviceConfig['服务类型']"),required:!0,property:"key","error-display-type":"normal"}},[i("bk-select",{attrs:{placeholder:e.$t("m.serviceConfig['请选择服务类型']"),clearable:!1,searchable:"","font-size":"medium"},model:{value:e.formData.key,callback:function(t){e.$set(e.formData,"key",t)},expression:"formData.key"}},e._l(e.serviceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1)],1)],1),e._v(" "),i("choose-service-template-dialog",{attrs:{"is-show":e.isShowChooseSerTempDialog,"create-info":e.currCreateFormWay,"service-id":e.serviceId},on:{"update:isShow":function(t){e.isShowChooseSerTempDialog=t},"update:is-show":function(t){e.isShowChooseSerTempDialog=t},updateServiceSource:e.updateServiceSource}})],1)},o=[];n._withStripped=!0},FQeJ:function(e,t,i){"use strict";i.r(t);var n=i("f+2m"),o=i("/inP");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("zwsV");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"3290733f",null);r.options.__file="src/components/common/FullScreen.vue",t.default=r.exports},FUmd:function(e,t,i){},FVR2:function(e,t,i){},FauL:function(e,t,i){"use strict";i.r(t);var n=i("pV0w"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},FbwU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"NoData",props:{text:{type:String}},data:function(){return{imgUrl:i("tNV3")}}}},"FeB+":function(e,t,i){"use strict";i("eKnG")},FqMa:function(e,t,i){},Fz92:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-trigger-field"},["STRING"===e.item.type||"TEXT"===e.item.type?[i("bk-input",{attrs:{maxlength:120},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"INT"===e.item.type?[i("bk-input",{attrs:{clearable:!0,type:"number"},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"SELECT"===e.item.type||"RADIO"===e.item.type?[i("bk-select",{attrs:{searchable:"",loading:e.item.loading},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}},e._l(e.item.options,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"CHECKBOX"===e.item.type||"MULTISELECT"===e.item.type?[i("bk-select",{attrs:{searchable:"",multiple:"",loading:e.item.loading},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}},e._l(e.item.options,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"MEMBERS"===e.item.type||"MULTI_MEMBERS"===e.item.type||"MEMBER"===e.item.type?[i("member-select",{model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"DATE"===e.item.type?[i("bk-date-picker",{attrs:{placeholder:e.$t("m.newCommon['选择日期']")},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:"DATETIME"===e.item.type?[i("bk-date-picker",{attrs:{type:"datetime",placeholder:e.$t("m.newCommon['选择日期时间']")},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]:[i("bk-input",{attrs:{maxlength:120},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})]],2)},o=[];n._withStripped=!0},G0Vx:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"fieldContent",staticClass:"bk-field-preview",attrs:{id:"bkPreview"}},[i("bk-form",{attrs:{"label-width":e.labelWidth,"form-type":"vertical","ext-cls":"bk-ext-form"}},[e._l(e.fields,(function(t,n){return[t.showFeild?i("div",{key:n,class:{"bk-field-line":"COL_12"===t.layout,"bk-field-half":"COL_6"===t.layout,"bk-field-trigger":"trigger"===e.origin}},[i("CW-"+t.type,{ref:"component"+n,refInFor:!0,tag:"component",attrs:{item:t,fields:e.fields,"basic-infomation":e.basicInfomation,"type-info":e.typeInfo,disabled:e.disabled}}),e._v(" "),"trigger"!==e.origin?["API"===t.source_type?i("i",{staticClass:"bk-icon icon-refresh bk-icon-refresh",class:{"not-rotate":!e.rotate,rotate:e.rotate},on:{click:function(i){return e.freshBtn(t)}}}):e._e(),e._v(" "),"RPC"===t.source_type?i("i",{staticClass:"bk-icon icon-refresh bk-icon-refresh",class:{"not-rotate":!e.rotate,rotate:e.rotate},on:{click:function(i){return e.freshRpc(t)}}}):e._e()]:e._e()],2):e._e()]}))],2)],1)},o=[];n._withStripped=!0},G6uA:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("ybrk"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"RICHTEXT",components:{RichTextEditor:a.default},props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},GPtd:function(e,t,i){"use strict";i("Et6z")},Ga10:function(e,t,i){},"Gr/V":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-upload"},[i("div",{staticClass:"file-wrapper",class:{isdrag:e.isdrag}},[i("img",{staticClass:"upload-icon",attrs:{src:e.uploadIcon}}),e._v(" "),i("span",{staticClass:"drop-upload"},[e._v(e._s(e.dragText))]),e._v(" "),i("span",{staticClass:"click-upload"},[e._v(e._s(e.clickText))]),e._v(" "),i("input",{ref:"uploadel",attrs:{accept:e.accept,multiple:e.multiple,disabled:e.disabled,type:"file",accept:".txt,.log,.pdf,.doc,.ppt,.xls,.docx,.pptx,.xlsx,.zip,.jpg,.png"},on:{change:e.selectFile}})]),e._v(" "),e.tip?i("p",{staticClass:"tip"},[e._v(e._s(e.tip))]):e._e(),e._v(" "),e.fileList.length?i("div",{staticClass:"all-file"},e._l(e.fileList,(function(t,n){return i("div",{key:n},[i("div",{staticClass:"file-item"},[i("div",{staticClass:"file-icon"},[i("img",{attrs:{src:e.getIcon(t)}})]),e._v(" "),t.done?e._e():i("i",{staticClass:"bk-icon icon-close close-upload",on:{click:function(i){return e.deleteFile(n,t)}}}),e._v(" "),i("div",{staticClass:"file-info"},[i("div",{staticClass:"file-name"},[i("span",[e._v(e._s(t.name))])]),e._v(" "),i("div",{staticClass:"file-message"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.done&&"running"===t.status,expression:"!file.done && file.status === 'running'"}],staticClass:"upload-speed"},[e._v(e._s(e.speed)+e._s(e.unit))]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.done,expression:"!file.done"}],staticClass:"file-size"},[e._v(e._s(e.filesize(t.size)))]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.done,expression:"file.done"}],staticClass:"file-size done"},[e._v(e._s("上传完成"))])]),e._v(" "),i("div",{staticClass:"progress-bar-wrapper"},[i("div",{staticClass:"progress-bar",class:{fail:t.errorMsg},style:{width:t.progress}})])])]),e._v(" "),t.errorMsg?i("p",{staticClass:"error-msg"},[e._v(e._s(t.errorMsg))]):e._e()])})),0):e._e()])},o=[];n._withStripped=!0},GtMo:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1},o=function(e,t){if(e){for(var i=e.className,o=(t||"").split(" "),a=0,s=o.length;a<s;a++){var r=o[a];r&&(e.classList?e.classList.add(r):n(e,r)||(i+=" "+r))}e.classList||(e.className=i)}},a=function(e,t){if(e&&t){for(var i=t.split(" "),o=" "+e.className+" ",a=0,s=i.length;a<s;a++){var r=i[a];r&&(e.classList?e.classList.remove(r):n(e,r)&&(o=o.replace(" "+r+" "," ")))}e.classList||(e.className=(o||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,""))}},s={beforeEnter:function(e){o(e,"collapse-transition"),e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height="0",e.style.paddingTop=0,e.style.paddingBottom=0},enter:function(e){e.dataset.oldOverflow=e.style.overflow,0!==e.scrollHeight?(e.style.height=e.scrollHeight+"px",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom):(e.style.height="",e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom),e.style.overflow="hidden"},afterEnter:function(e){a(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow},beforeLeave:function(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},leave:function(e){0!==e.scrollHeight&&(o(e,"collapse-transition"),e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave:function(e){a(e,"collapse-transition"),e.style.height="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom}};t.default={name:"CollapseTransition",functional:!0,render:function(e,t){var i=t.children;return e("transition",{on:s},i)}}},Gz9R:function(e,t,i){"use strict";i.r(t);var n=i("nrD6"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},H2GU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(i("QbLZ")),o=p(i("m1cH")),a=p(i("jWXv")),s=p(i("rfXi")),r=p(i("14Xm")),c=p(i("D3Ub")),l=p(i("GQeE")),u=p(i("aNPh")),d=p(i("2eEL")),f=i("CeR/");function p(e){return e&&e.__esModule?e:{default:e}}t.default={name:"commonTriggerList",components:{addTrigger:u.default,collapseTransition:d.default},props:{sourceId:{type:[String,Number],default:""},stepSignal:{type:String,default:""},origin:{type:String,default:"task"},sender:{type:[Number,String],default:""},templateStage:{type:String,default:""},table:{type:[Number,String],default:""},nodeType:{type:String,default:""}},data:function(){return{boundTriggerList:[],boundListLoading:!1,showMoreConfig:!1,triggerDialogInfo:{isShow:!1,searchKey:"",list:[],listLoading:!1},triggerSliderInfo:{isShow:!1,title:this.$t("m.taskTemplate['创建触发器']"),width:950,addLoading:!1,item:{}},iconList:[{key:"icon-icon-notice-new",name:"",typeName:"message"},{key:"icon-icon-user-new",name:"",typeName:"user"},{key:"icon-icon-status-new",name:"",typeName:"status"},{key:"icon-icon-api-new",name:"",typeName:"api"}],originInfoToTrigger:{},stage:"",signal:"",type:"",sourceType:"",senderId:"",triggerEventListFilter:""}},computed:{citeList:function(){return this.triggerDialogInfo.list.filter((function(e){return e.checked}))},globalChoise:function(){return this.$store.state.common.configurInfo},openFunction:function(){return this.$store.state.openFunction},allSignal:function(){var e={state:"STATE",transition:"TRANSITION",workflow:"FLOW"};return this.stepSignal?this.stepSignal:e[this.origin]?(0,l.default)(this.globalChoise.trigger_signals[e[this.origin]]).join(","):""}},watch:{sourceId:function(e){e&&this.initData()},stepSignal:function(){this.initData()}},mounted:function(){var e=this;return(0,c.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,c.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.initParams(),e.setFilterSignal(),e.getPublicTriggerList(),t.next=5,e.getBoundTriggerList();case 5:case"end":return t.stop()}}),t,e)})))()},initParams:function(){if(this.senderId=this.sourceId,this.sourceType="workflow",this.stepSignal)return this.sourceType="task",this.triggerEventListFilter="TASK",this.type="task_schemas",void(this.stage=this.templateStage);"state"===this.origin&&(this.triggerEventListFilter="STATE",this.senderId=this.sender,this.type="states"),"transition"===this.origin&&(this.showMoreConfig=!0,this.triggerEventListFilter="TRANSITION",this.senderId=this.sender,this.type="transitions"),"workflow"===this.origin&&(this.showMoreConfig=!0,this.triggerEventListFilter="FLOW",this.type="templates")},setFilterSignal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e;["TASK","TASK-SOPS","SIGN"].indexOf(this.nodeType)>-1&&"state"===this.origin&&(t=(0,s.default)(new a.default(["CLAIM_STATE","DELIVER_STATE","DISTRIBUTE_STATE"].concat((0,o.default)(e)))));var i=this.allSignal.split(",");this.signal=i.filter((function(e){return-1===t.indexOf(e)})).join(",")},getBoundTriggerList:function(){var e=this;return(0,c.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sourceId){t.next=2;break}return t.abrupt("return");case 2:return i={source_id:e.sourceId,source_type:e.sourceType,sender:e.senderId,signal__in:e.signal,project_key:e.$store.state.project.id},e.boundListLoading=!0,t.next=6,e.$store.dispatch("taskTemplate/getTemplateTriggers",i).then((function(t){e.boundTriggerList=t.data.map((function(t){return(0,n.default)({},t,{iconKey:e.iconList.find((function(e){return e.typeName===t.icon})).key})}))})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.showMoreConfig=Boolean(e.boundTriggerList.length)||"workflow"===e.origin||"transition"===e.origin,e.boundListLoading=!1}));case 6:case"end":return t.stop()}}),t,e)})))()},selectAllFn:function(){var e=this.triggerDialogInfo.list.length!==this.citeList.length;this.triggerDialogInfo.list.forEach((function(t){t.checked=e}))},openNew:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.originInfoToTrigger={id:this.sourceId,signal:this.signal,sender:this.senderId,filter:this.triggerEventListFilter,source:this.sourceType,type:this.type,stage:this.stage},"cite"===e?this.triggerDialogInfo.isShow=!0:(this.triggerSliderInfo.item=t,this.triggerSliderInfo.isShow=!0)},citeTrigger:function(){var e=this,t={project_key:this.$store.state.project.id,src_trigger_ids:this.citeList.map((function(e){return e.id})),dst_source_id:this.sourceId,dst_source_type:this.sourceType,dst_sender:this.senderId};this.$store.dispatch("taskTemplate/patchCloneTriggers",t).then((function(t){e.$bkMessage({message:e.$t("m.taskTemplate['引用成功']"),theme:"success"})})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.triggerDialogInfo.isShow=!1,e.getBoundTriggerList()}))},delTrigger:function(e){var t=this;this.$bkInfo({type:"warning",title:this.$t("m.taskTemplate['确认删除触发器？']"),subTitle:this.$t("m.taskTemplate['一旦删除，该触发器相关的动作将会一并删除。']"),confirmFn:function(){t.doDelTrigger(e)}})},doDelTrigger:function(e){var t=this;this.$store.dispatch("taskTemplate/deleteTrigger",e.id).then((function(){t.$bkMessage({message:t.$t("m.flowManager['删除成功']"),theme:"success"})})).catch((function(e){(0,f.errorHandler)(e,t)})).finally((function(){t.getBoundTriggerList()}))},getPublicTriggerList:function(){var e=this,t={source_id:0,source_type:"basic",sender:0,is_draft:!1,signal__in:this.signal,name__icontains:this.triggerDialogInfo.searchKey,project_key:this.$store.state.project.id};this.table&&(t.source_table_id=this.table),this.triggerDialogInfo.listLoading=!0,this.$store.dispatch("taskTemplate/getTemplateTriggers",t).then((function(t){e.triggerDialogInfo.list=t.data.map((function(t){return(0,n.default)({},t,{checked:!1,iconKey:e.iconList.find((function(e){return e.typeName===t.icon})).key})}))})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.triggerDialogInfo.listLoading=!1}))},newTrigger:function(){this.initDialogInfo(),this.$router.push({name:"projectTrigger",query:{project_id:this.$route.query.project_id}})},initDialogInfo:function(){this.triggerDialogInfo.isShow=!1,this.triggerDialogInfo.searchKey=""},searchInfo:function(){this.getPublicTriggerList()},clearSearch:function(){this.triggerDialogInfo.searchKey="",this.getPublicTriggerList()}}}},HE0t:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading},expression:"{ isLoading: loading }"},{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree",class:e.extCls},[i("div",{staticClass:"bk-search-tree-wrapper",on:{click:function(t){return t.stopPropagation(),e.showTree("view")}}},[i("span",{class:{"bk-color-tree":e.displayName}},[e._v("\n            "+e._s(e.displayName||e.$t('m.serviceConfig["请选择"]'))+"\n        ")]),e._v(" "),e.organizationLoading?i("i",{staticClass:"bk-select-angle bk-itsm-icon icon-icon-loading"}):e._e()]),e._v(" "),i("transition",{attrs:{name:"common-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTree,expression:"isShowTree"}],staticClass:"bk-search-tree-content"},[i("tree",{attrs:{"tree-data-list":e.displayList},on:{toggle:e.toggleInfo,toggleChildren:function(t){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return e.toggleChildren.apply(void 0,n.concat(["view"]))}}})],1)])],1)},o=[];n._withStripped=!0},HOWN:function(e,t,i){"use strict";i.r(t);var n=i("lWSq"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"Ha+5":function(e,t,i){"use strict";i.r(t);var n=i("NLOC"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"Hk/7":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-basic-node"},[i("basic-card",{attrs:{"card-label":e.$t("m.treeinfo['基本信息']")}},[i("bk-form",{ref:"basicsForm",attrs:{"data-test-id":"service-form-sopsNode","label-width":150,model:e.basicsFormData,rules:e.rules,"ext-cls":"bk-form","form-type":"vertical"}},[i("bk-form-item",{attrs:{"data-test-id":"sopsNode-select-nodeName",label:e.$t("m.treeinfo['节点名称：']"),required:!0,property:"name"}},[i("bk-input",{attrs:{"ext-cls":"bk-form-width",maxlength:"120"},model:{value:e.basicsFormData.name,callback:function(t){e.$set(e.basicsFormData,"name",t)},expression:"basicsFormData.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"sopsNode-select-processType",label:e.$t("m['流程类型：']"),required:!0,property:"processType"}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",placeholder:e.$t("m['请选择流程类型']"),searchable:""},on:{selected:e.getTemplateList},model:{value:e.basicsFormData.processType,callback:function(t){e.$set(e.basicsFormData,"processType",t)},expression:"basicsFormData.processType"}},e._l(e.processOptions,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"sopsNode-select-business",label:e.$t("m['关联业务：']"),required:!0,property:"projectId"}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",placeholder:e.$t("m['请选择关联业务']"),searchable:"",disabled:e.processDisable},on:{clear:e.onClearProcess,selected:e.getProjectTemplateList},model:{value:e.basicsFormData.projectId,callback:function(t){e.$set(e.basicsFormData,"projectId",t)},expression:"basicsFormData.projectId"}},e._l(e.projectList,(function(e){return i("bk-option",{key:e.bk_biz_id,attrs:{id:e.bk_biz_id,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"sopsNode-select-processTemplate",label:e.$t("m['流程模板：']"),required:!0,property:"templateId"}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",placeholder:e.$t("m['请选择流程模板']"),searchable:"",disabled:e.templateDisable,loading:e.processesLoading},on:{clear:e.onClearTemplate,selected:e.getTemplateDetail},model:{value:e.basicsFormData.templateId,callback:function(t){e.$set(e.basicsFormData,"templateId",t)},expression:"basicsFormData.templateId"}},e._l(e.templateList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m['执行方案：']")}},[i("bk-select",{attrs:{"ext-cls":"bk-form-width bk-form-display",disabled:e.planDisable,placeholder:e.$t("m['选择执行方案，默认选择全部任务节点']"),multiple:"",clearable:!0,loading:e.planLoading},on:{selected:e.onplanSelect},model:{value:e.basicsFormData.planId,callback:function(t){e.$set(e.basicsFormData,"planId",t)},expression:"basicsFormData.planId"}},e._l(e.planList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"sopsnode-component-processor",label:e.$t("m.treeinfo['处理人：']"),required:!0}},[i("div",{on:{click:function(t){e.checkStatus.processors=!1}}},[i("deal-person",{ref:"processors",attrs:{value:e.processorsInfo,"node-info":e.configur,"exclude-role-type-list":e.excludeProcessor}})],1)])],1)],1),e._v(" "),i("basic-card",[i("div",{staticClass:"sops-params-title"},[i("p",[e._v(e._s(e.$t("m.treeinfo['输入参数']"))+":")]),e._v(" "),i("p",[e._v(e._s(e.$t("m.treeinfo['调用该API需要传递的参数信息']")))])]),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.sopsFormLoading},expression:"{ isLoading: sopsFormLoading }"}],staticClass:"bk-param"},[0!==e.constants.length?i("sops-get-param",{ref:"getParam",attrs:{configur:e.configur,"param-table-data":e.paramTableData,"state-list":e.stateList,fields:e.fieldList,context:e.context,constants:e.constants,"hooked-var-list":e.hookedVarList,"constant-default-value":e.constantDefaultValue,"quote-vars":e.quoteVars,"flow-info":e.flowInfo},on:{onChangeHook:e.onChangeHook}}):i("no-data"),e._v(" "),i("common-trigger-list",{attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"mt20",staticStyle:{"font-size":"0"}},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"sopsNode-button-submit",title:e.$t("m.treeinfo['确定']")},on:{click:e.submit}},[e._v("\n                    "+e._s(e.$t("m.treeinfo['确定']"))+"\n                ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"sopsNode-button-close",title:e.$t("m.treeinfo['取消']")},on:{click:e.closeNode}},[e._v("\n                    "+e._s(e.$t("m.treeinfo['取消']"))+"\n                ")])],1)],1)])],1)},o=[];n._withStripped=!0},HksE:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("vDqi")),o=i("CeR/"),a=f(i("y7UH")),s=f(i("s8s0")),r=f(i("jzyo")),c=f(i("kAUb")),l=f(i("+DAV")),u=f(i("vHDd")),d=f(i("Tz34"));function f(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ServiceProcessStep",components:{secondFlow:a.default,basicNode:s.default,autoNode:r.default,sopsNode:c.default,signNode:l.default,ApprovalNode:d.default,devopsNode:u.default},props:{serviceInfo:{type:Object,default:function(){return{}}},flowInfo:{type:Object,default:function(){return{}}}},data:function(){return{flowDataLoading:!1,isShowNodeConfig:!1,nodeList:[],lineList:[],configur:{}}},computed:{processId:function(){return this.serviceInfo.workflow_id},nodeType:function(){return{"TASK-DEVOPS":this.$t('m["蓝盾节点"]'),"TASK-SOPS":this.$t('m["标准运维节点"]'),NORMAL:this.$t('m["手动节点"]'),TASK:this.$t('m["任务节点"]'),APPROVAL:this.$t('m["审批节点"]'),SIGN:this.$t('m["会签节点"]')}[this.configur.type]}},watch:{isShowNodeConfig:function(e){this.$emit("setConfigStatus",e)}},created:function(){this.$emit("setConfigStatus",this.isShowNodeConfig)},mounted:function(){this.processId&&this.getFlowChart()},methods:{getFlowChart:function(){var e=this;this.flowDataLoading=!0,n.default.all([this.$store.dispatch("deployCommon/getStates",{workflow:this.processId}),this.$store.dispatch("deployCommon/getChartLink",{workflow:this.processId,page_size:1e3})]).then(n.default.spread((function(t,i){e.nodeList=t.data,e.lineList=i.data.items}))).finally((function(){e.flowDataLoading=!1}))},handleNodeClick:function(e){this.isShowNodeConfig=!0,this.configur=e},closeConfigur:function(){this.isShowNodeConfig=!1,this.configur={},this.$emit("updateFlowInfo")},submitFlow:function(){var e=this,t=this.$refs.flowInfo.canvasData,i={workflow_id:this.processId,transitions:[]};t.lines.forEach((function(e){i.transitions.push({id:e.lineInfo.id,axis:{start:e.source.arrow,end:e.target.arrow}})})),this.$store.dispatch("deployCommon/updateFlowLine",{params:i}).catch((function(t){(0,o.errorHandler)(t,e)}))},saveProcess:function(){var e=this,t=this.processId;return this.$store.dispatch("cdeploy/submitChart",{params:[],id:t}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"})}),(function(t){return t.data&&t.data.data&&(e.errorList=t.data.data.invalid_state_ids,e.$refs.flowInfo.errorNodes(e.errorList)),(0,o.errorHandler)(t,e),{data:{result:!1}}}))},validate:function(){return this.submitFlow(),this.saveProcess()}}}},Hlvs:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i("GQeE")),o=h(i("4d7F")),a=h(i("m1cH")),s=h(i("14Xm")),r=h(i("D3Ub")),c=h(i("PIEm")),l=h(i("bcjM")),u=h(i("s4tT")),d=h(i("tgnH")),f=h(i("I1Ty")),p=i("CeR/"),m=h(i("EstQ"));function h(e){return e&&e.__esModule?e:{default:e}}function v(){return{required:!0,message:m.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}}t.default={name:"devops",components:{BasicCard:u.default,commonTriggerList:l.default,DevopsPreview:d.default,NoData:f.default,dealPerson:c.default},props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}},state:{type:[String,Number],default:function(){return""}}},data:function(){return{isLoading:!1,basicInfo:{nodeName:"",businessId:"",pipelineId:"",processors:[]},businessList:[],pipelineList:[],pipelineDisabled:!0,pipelineLoading:!1,constants:[],pipelineFormList:[],pipelineData:{},pipeFormLoading:!1,pipelineStages:[],showPipelineStages:!0,basicInfoRules:{nodeName:[v()],businessId:[v()],pipelineId:[v()]},pipelineRules:{},checkStatus:{delivers:!1,processors:!1},excludeProcessor:[],processorsInfo:{type:"",value:""}}},watch:{"basicInfo.businessId":function(e){this.pipelineDisabled=!e,e||(this.pipelineList=[],this.pipelineFormList=[],this.basicInfo.pipelineId="")},"basicInfo.pipelineId":function(e){e||(this.pipelineFormList=[])}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,r.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$store.dispatch("ticket/getDevopsUserProjectList").then((function(t){e.businessList=t.data,e.configur&&!e.configur.is_draft&&(e.basicInfo.nodeName=e.configur.name,e.basicInfo.businessId=t.data.filter((function(t){return t.project_name===e.configur.extras.devops_info.project_id.name}))[0].englishName,e.onSelectBusiness(),e.basicInfo.pipelineId=e.configur.extras.devops_info.pipeline_id.value,e.getPipelineInfo(1),e.processorsInfo={type:e.configur.processors_type,value:e.configur.processors},e.getExcludeRoleTypeList())}));case 1:case"end":return t.stop()}}),t,e)})))()},getExcludeRoleTypeList:function(){var e=[];e=this.configur.is_builtin?["BY_ASSIGNOR","STARTER","VARIABLE"]:["OPEN"],"DISTRIBUTE_THEN_PROCESS"!==this.configur.distribute_type&&"DISTRIBUTE_THEN_CLAIM"!==this.configur.distribute_type&&e.push("BY_ASSIGNOR"),this.flowInfo.is_biz_needed||e.push("CMDB"),this.excludeProcessor=["EMPTY","API"].concat((0,a.default)(e))},onSelectBusiness:function(){var e=this;this.pipelineLoading=!0,this.basicInfo.pipelineId="";try{this.$store.dispatch("ticket/getDevopsPipelineList",{project_id:this.basicInfo.businessId}).then((function(t){e.pipelineList=t.data}))}catch(e){console.log(e)}finally{this.pipelineLoading=!1}},getPipelineInfo:function(e){var t=this;this.pipeFormLoading=!0,o.default.all([this.$store.dispatch("ticket/getDevopsPipelineStartInfo",{project_id:this.basicInfo.businessId,pipeline_id:this.basicInfo.pipelineId}),this.$store.dispatch("ticket/getDevopsPipelineDetail",{project_id:this.basicInfo.businessId,pipeline_id:this.basicInfo.pipelineId})]).then((function(i){t.pipelineData={},t.pipelineFormList=i[0].data.properties,i[0].data.properties.forEach((function(i){e&&(i.defaultValue=t.configur.extras.devops_info.constants.filter((function(e){return e.name===i.id}))[0].value),t.$set(t.pipelineData,i.id,i.defaultValue),t.pipelineRules[i.id]=[{required:i.required,message:m.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}]})),t.pipelineStages=i[1].data.stages})).catch((function(e){console.log(e)})).finally((function(e){t.pipeFormLoading=!1}))},closeNode:function(){this.$parent.closeConfigur()},submit:function(){var e=this;!this.$refs.processors||this.$refs.processors.verifyValue()?o.default.all([this.$refs.basicInfo.validate(),this.$refs.devopsVariable?this.$refs.devopsVariable.validate():null]).then((function(t){var i=e.businessList.filter((function(t){return t.project_code===e.basicInfo.businessId}))[0],o=e.pipelineList.filter((function(t){return t.pipelineId===e.basicInfo.pipelineId}))[0],a=(0,n.default)(e.pipelineData).map((function(t){return{value:e.pipelineData[t],name:t,key:t}})),s=e.$refs.processors.getValue(),r=s.value,c=s.type,l={extras:{devops_info:{username:window.username,project_id:{value:i.projectCode,name:i.projectName,key:i.project_id},pipeline_id:{value:o.pipelineId,name:o.pipelineName,key:o.pipeline_id},constants:a}},processors:r||"",processors_type:c,is_draft:!1,is_terminable:!1,name:e.basicInfo.nodeName,type:"TASK-DEVOPS",workflow:e.configur.workflow},u=e.configur.id;e.$store.dispatch("cdeploy/putDevopsInfo",{params:l,stateId:u}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$parent.closeConfigur()}),(function(t){(0,p.errorHandler)(t,e)})).finally((function(){}))})):this.checkStatus.processors=!0}}}},Ho96:function(e,t,i){"use strict";i("q9Lf")},HtfW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("m1cH")),o=l(i("14Xm")),a=l(i("gDS+")),s=l(i("GQeE")),r=l(i("D3Ub")),c=l(i("VflG"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"responseDataNode",components:{},mixins:[c.default],props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},isCustom:{type:Boolean,default:!1},isStatic:{type:Boolean,default:!1}},data:function(){return{trueStatus:!0,falseStatus:!1,cascaderData:[],organization:{processorPerson:[],processorTree:{},assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1},bodyTableData:[],responseTableData:[],paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')},selectInfo:{selectkeylist:[],selectkey:"",selectvaluelist:[],selectvalue:""},isShow:!1,objIsCanUse:!1}},computed:{tableList:function(){return this.responseTableData.filter((function(e){return e.isShow}))}},watch:{apiDetail:function(e,t){this.initData()}},mounted:function(){this.initData()},methods:{initData:function(){this.responseTableDataChange()},responseTableDataChange:function(){var e=this;return(0,r.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,s.default)(e.apiDetail.rsp_data).length){t.next=5;break}e.apiDetail.responseTreeDataList=[{has_children:!1,showChildren:!1,checkInfo:!1,key:"root",is_necessary:!0,type:"object",desc:e.$t('m.treeinfo["初始化数据"]'),parentInfo:"",children:[]}],e.apiDetail.responseTableData=[],t.next=11;break;case 5:return t.next=7,e.jsonschemaToList({root:JSON.parse((0,a.default)(e.apiDetail.rsp_data))});case 7:return e.apiDetail.responseTreeDataList=t.sent,t.next=10,e.treeToTableList(JSON.parse((0,a.default)(e.apiDetail.responseTreeDataList[0].children)));case 10:e.apiDetail.responseTableData=t.sent;case 11:return t.next=13,JSON.parse((0,a.default)(e.apiDetail.responseTableData));case 13:return i=t.sent,t.next=16,i.forEach((function(e){e.isCheck=!1,e.isSatisfied=!1,e.el=null,e.children=[],e.source_type="",e.customValue=e.value,e.value="",e.name=e.key,e.isSelectAbled=!1,e.isSelectedKey=!1,e.isSelectedValue="",e.isSelectedValueDisabled=!0}));case 16:return t.next=18,e.recordChildren(i);case 18:return t.next=20,e.recordParent(i);case 20:return t.next=22,e.showSelectAbled(i);case 22:return t.next=24,i.filter((function(e){return e.isSelectAbled})).forEach(function(){var t=(0,r.default)(o.default.mark((function t(i){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.markCanUseArray(i);case 2:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}());case 24:return t.next=26,i;case 26:return e.responseTableData=t.sent,t.next=29,e.makeArrayTree(e.responseTableData.filter((function(e){return!e.level})));case 29:return e.cascaderData=t.sent,e.organization.assignorPerson=JSON.parse((0,a.default)(e.cascaderData)),t.next=33,e.organization.assignorPerson.forEach((function(t){e.treeData(t,"assignors")}));case 33:if(!e.isCustom){t.next=35;break}return t.abrupt("return");case 35:if(!e.changeInfo.api_info||e.changeInfo.api_info.remote_api_id!==e.apiDetail.id){t.next=39;break}return t.next=38,e.changeInfo.variables.outputs.filter((function(e){return"global"===e.source})).forEach(function(){var t=(0,r.default)(o.default.mark((function t(i){var n,a;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.ref_path.split(".");case 2:return n=t.sent,t.next=5,n.map((function(e,t){return e=t+"_"+e}));case 5:a=t.sent,e.responseTableData.filter((function(e){return e.ancestorsList_str===a.toString()})).forEach((function(e){e.isSelectedKey=!0,e.isSelectedValue=i.name,e.isSelectedValueDisabled=!1}));case 7:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}());case 38:e.$parent.$parent.lineInfo.between=e.changeInfo.api_info.succeed_conditions.type;case 39:if(!(e.changeInfo.api_info&&e.changeInfo.api_info.remote_api_id===e.apiDetail.id&&e.changeInfo.api_info.succeed_conditions&&e.changeInfo.api_info.succeed_conditions.expressions&&e.changeInfo.api_info.succeed_conditions.expressions.length)){t.next=45;break}return t.next=42,e.changeInfo.api_info.succeed_conditions.expressions.map((function(t){var i={type:t.type,expressions:[]};return i.expressions=t.expressions.map((function(t){var i=t.key.split(".").map((function(e,t){return e=t+"_"+e})).toString(),n=e.responseTableData.filter((function(e){return e.ancestorsList_str===i}))[0],o={condition:t.condition,key:i,name:"",choiceList:"",value:t.value,type:n?n.type:"string",organization:{assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1}};return"boolean"===o.type&&(o.value=o.value?"1":"0"),o.organization.assignorPerson=JSON.parse((0,a.default)(e.cascaderData)),o.organization.assignorPerson.forEach((function(t){e.treeData(t,"assignors",o,i)})),o})),i}));case 42:e.$parent.$parent.lineInfo.expressions=t.sent,t.next=47;break;case 45:return t.next=47,e.$parent.$parent.lineInfo.expressions.forEach((function(t){var i;t.expressions.forEach((i=(0,r.default)(o.default.mark((function t(i){var n;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse((0,a.default)(e.cascaderData)),t.next=3,n.forEach((function(t){e.treeData(t,"assignors")}));case 3:i.organization.assignorPerson=n;case 4:case"end":return t.stop()}}),t,e)}))),function(e){return i.apply(this,arguments)}))}));case 47:case"end":return t.stop()}}),t,e)})))()},treeData:function(e,t,i,n){var o=this;e.checkInfo=!1,e.has_children=!(!e.children||!e.children.length),e.showChildren=!1,n===String(e.ancestorsList_str)&&i&&n&&(e.checkInfo=!0,i.organization.assignorTree=e),e.has_children&&e.children.forEach((function(e){o.treeData(e,t,i,n)}))},recordChildren:function(e,t){for(var i=e.map((function(e){return e.level})),o=Math.max.apply(Math,(0,n.default)(i)),a=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},s=o;s>(t||0);s--)a(s)},recordParent:function(e,t){for(var i=e.map((function(e){return e.level})),o=Math.max.apply(Math,(0,n.default)(i)),a=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){t.level?t.parentInfo=e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0]:t.parentInfo=""}(e,t)}))},s=0;s<=(t||o);s++)a(s)},markCanUseArray:function(e){e.isCanUseArray=!0,e.level&&this.markCanUseArray(e.parentInfo)},makeArrayTree:function(e,t){var i=[];return function e(i,n){n.forEach((function(n){if(n.isCanUseArray||t){var o={isCheck:!1,isShow:!1,isShowChildren:!1,isSelect:!1};o.name=n.name,o.type=n.type,o.isSelect=!1,o.ancestorsList_str=n.ancestorsList_str;var a=n.children;o.children=[],i.push(o),a&&a.length&&e(o.children,a)}}))}(i,e),i},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},selectOneKey:function(e){e.isSelectedValue=e.isSelectedValue||e.key,e.isSelectedValueDisabled=!e.isSelectedKey},countArrayAncestors:function(e){var t=[];return function e(i){"array"===i.parentInfo.type&&(t.push(i.parentInfo),e(i.parentInfo)),"object"===i.parentInfo.type&&e(i.parentInfo)}(e),t},showSelectAbled:function(e){var t=this;return(0,r.default)(o.default.mark((function i(){return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:[],(t.objIsCanUse?e.filter((function(e){return!t.countArrayAncestors(e).length})):e.filter((function(e){return!t.countArrayAncestors(e).length&&"object"!==e.type&&"array"!==e.type}))).forEach((function(e){e.isSelectAbled=!0}));case 3:case"end":return i.stop()}}),i,t)})))()}}}},HxM3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),o=s(i("D3Ub")),a=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MULTISELECT",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],selectedItems:[]}},watch:{"item.val":function(e,t){this.selectedItems=""===this.item.val?[]:this.item.val.split(","),this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.item.value&&!e.item.val&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:return t.next=5,e.judgeValue(e.item.val,e.item.choice);case 5:i=t.sent,e.item.val=i?e.item.val:"",e.selectedItems=""===e.item.val?[]:e.item.val.split(","),e.conditionField(e.item,e.fields);case 9:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.options=e.item.choice=t.sent;case 3:case"end":return t.stop()}}),t,e)})))()},selected:function(e){var t=this;this.item.val=e.join(","),this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(e){t.fields.forEach((function(t){e===t.key&&(t.val=t.value="")}))}))}}}},I1Ty:function(e,t,i){"use strict";i.r(t);var n=i("z+Fq"),o=i("qgII");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("D0+e");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"58fca26f",null);r.options.__file="src/components/common/NoData.vue",t.default=r.exports},IDfM:function(e,t,i){"use strict";i.r(t);var n=i("3auN"),o=i("fkix");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7518a5cc",null);r.options.__file="src/views/commonComponent/fieldComponent/customForm.vue",t.default=r.exports},IGTl:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-api-call"},[e._l(e.item.wayInfo.field_schema,(function(t,n){return[i("bk-form-item",{key:n,attrs:{"ext-cls":"bk-field-schema mb20",label:t.name,required:t.required,desc:t.tips}},["api_source"===t.key?[i("bk-select",{attrs:{"ext-cls":"bk-form-display",clearable:!1,placeholder:e.$t("m.treeinfo['请选择接入系统']"),searchable:""},on:{selected:function(i){for(var n=arguments.length,o=Array(n);n--;)o[n]=arguments[n];return e.changeCode.apply(void 0,o.concat([t]))}},model:{value:t.systemId,callback:function(i){e.$set(t,"systemId",i)},expression:"itemInfo.systemId"}},e._l(e.apiSysList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),t.systemId?[i("bk-select",{attrs:{"ext-cls":"bk-form-display",clearable:!1,searchable:""},on:{selected:function(i){for(var n=arguments.length,o=Array(n);n--;)o[n]=arguments[n];return e.changeApi.apply(void 0,o.concat([t]))}},model:{value:t.apiId,callback:function(i){e.$set(t,"apiId",i)},expression:"itemInfo.apiId"}},e._l(e.apiList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:e._e()]:e._e(),e._v(" "),"API_INFO"===t.type&&e.apiId?[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticStyle:{"min-height":"100px"}},[e.isLoading?e._e():i("input-params",{attrs:{"item-info":t}})],1)]:e._e()],2)]}))],2)},o=[];n._withStripped=!0},IdEF:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-second-flow"},[i("js-flow",{ref:"jsFlow",attrs:{"data-test-id":"service_jsflow_serviceProcess",selector:"entry-item","endpoint-options":e.endpointOptions,"connector-options":e.connectorOptions,"node-options":e.nodeOptions,tools:e.toolsInfo},on:{onConnectionClick:e.onConnectionClick,onToolClick:e.onToolClick,onConnection:e.onConnection,onConnectionDragStop:e.onConnectionDragStop,onBeforeDrop:e.onBeforeDrop,onCreateNodeBefore:e.onCreateNodeBefore,onNodeMoveStop:e.onNodeMoveStop,onNodeMoving:e.onNodeMoving,onOverlayClick:e.onOverlayClick},scopedSlots:e._u([{key:"nodeTemplate",fn:function(t){var n=t.node;return[i("node-template",{ref:"templateNode",attrs:{node:n,"canvas-data":e.canvasData},on:{openDelete:e.openDelete,closeShow:e.closeShow,fastAddNode:e.fastAddNode,updateNode:e.updateNode,updateLine:e.updateLine,configuNode:e.configuNode}})]}}]),model:{value:e.canvasData,callback:function(t){e.canvasData=t},expression:"canvasData"}},[i("template",{slot:"palettePanel"},[i("Palette")],1)],2),e._v(" "),i("div",{staticClass:"bk-configu-line"},[i("bk-sideslider",{attrs:{"is-show":e.customLine.isShow,title:e.customLine.title,width:e.customLine.width},on:{"update:isShow":function(t){return e.$set(e.customLine,"isShow",t)},"update:is-show":function(t){return e.$set(e.customLine,"isShow",t)}}},[e.customLine.isShow?i("div",{attrs:{slot:"content"},slot:"content"},[i("lineConfigue",{attrs:{"custom-line":e.customLine,"flow-info":e.flowInfo},on:{submitLine:e.submitLine,closeLine:e.closeLine,deleteLine:e.deleteLine}})],1):e._e()])],1)],1)},o=[];n._withStripped=!0},"Ieu/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i("t2rG")),o=a(i("RPM2"));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"HalfRowForm",components:{draggable:n.default,FormViewItem:o.default},props:{rowIndex:Number,workflowId:Number,nodeId:Number,fields:Array,rowForms:{type:Array,default:function(){return[]}},crtForm:{type:[String,Number],default:""},addFieldStatus:Boolean},data:function(){return{isEdit:this.checkEdit(),localForms:this.getLocalForms(this.rowForms)}},computed:{editForm:function(){var e=this;return this.isEdit?this.rowForms.find((function(t){return t&&t.id===e.crtForm})):null}},watch:{rowForms:function(e){this.localForms=this.getLocalForms(e)},crtForm:function(e){this.isEdit=""!==e&&this.checkEdit()}},methods:{getLocalForms:function(e){return e.map((function(e){return void 0===e?[]:[e]}))},checkEdit:function(){var e=this;return this.rowForms.find((function(t){return t&&t.id===e.crtForm}))},halfRowFormPut:function(e,t){return 0===e.el.children.length}}}},Ig0E:function(e,t,i){"use strict";i("zXeT")},IlXa:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"service-setting"},[i("section",{staticClass:"settion-card"},[i("h2",{staticClass:"card-title"},[e._v(e._s(e.$t("m.tickets['服务设置']")))]),e._v(" "),i("div",{staticClass:"card-content"},[i("bk-form",{ref:"serviceSetting",staticClass:"service-setting-form",attrs:{"data-test-id":"service_form_serviceSetting","form-type":"vertical",model:e.formData}},[i("bk-form-item",{attrs:{label:e.$t("m.serviceConfig['可见范围']")}},[i("deal-person",{ref:"displayRange",staticClass:"display-range",staticStyle:{width:"600px"},attrs:{"form-type":"inline-auto-width",value:e.formData.visibleRange,"show-role-type-list":e.displayRangeTypes}})],1),e._v(" "),i("bk-form-item",{staticClass:"auto-with-form-item mt20",attrs:{label:e.$t("m.tickets['撤回方式']")}},[i("bk-select",{model:{value:e.formData.revokeWay,callback:function(t){e.$set(e.formData,"revokeWay",t)},expression:"formData.revokeWay"}},e._l(e.revokeWayList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),"specify_node"===e.formData.revokeWay?i("bk-select",{attrs:{placeholder:e.$t("m.treeinfo['请选择撤单节点']"),loading:e.nodeListLoading,searchable:""},model:{value:e.formData.revokeState,callback:function(t){e.$set(e.formData,"revokeState",t)},expression:"formData.revokeState"}},e._l(e.nodeList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1):e._e()],1),e._v(" "),i("bk-form-item",{staticClass:"mt20",attrs:{label:e.$t("m.tickets['其他设置']")}},[i("bk-checkbox-group",{model:{value:e.formData.otherSettings,callback:function(t){e.$set(e.formData,"otherSettings",t)},expression:"formData.otherSettings"}},[i("bk-checkbox",{staticClass:"mr40",attrs:{value:"can_ticket_agency"}},[e._v("\n                            "+e._s(e.$t("m.tickets['支持代提']"))+"\n                        ")]),e._v(" "),i("bk-checkbox",{staticClass:"mr40",attrs:{value:"is_supervise_needed"}},[e._v("\n                            "+e._s(e.$t("m.tickets['允许督办']"))+"\n                        ")])],1)],1),e._v(" "),e.formData.otherSettings.includes("is_supervise_needed")?i("bk-form-item",{attrs:{"label-width":100,label:e.$t("m.treeinfo['其他督办人']")}},[i("deal-person",{ref:"supervisePerson",attrs:{"form-type":"inline-auto-width",value:e.supervisePerson,"show-role-type-list":e.superviseTypes}})],1):e._e(),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['自动处理']")}},[i("bk-checkbox",{attrs:{"true-value":!0,"false-value":!1},model:{value:e.formData.is_auto_approve,callback:function(t){e.$set(e.formData,"is_auto_approve",t)},expression:"formData.is_auto_approve"}},[e._v("\n                        当审批节点的审批人为申请人时，自动通过\n                    ")])],1)],1)],1)]),e._v(" "),i("section",{staticClass:"settion-card notic-card"},[i("h2",{staticClass:"card-title"},[e._v(e._s(e.$t("m.tickets['通知设置']")))]),e._v(" "),i("div",{staticClass:"card-content"},[i("bk-form",{staticClass:"service-setting-form",attrs:{"data-test-id":"service_form_serviceSettingNotification","form-type":"vertical",model:e.formData}},[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['通知方式']")}},[i("bk-checkbox-group",{model:{value:e.formData.notify,callback:function(t){e.$set(e.formData,"notify",t)},expression:"formData.notify"}},[i("bk-checkbox",{attrs:{value:"WEIXIN","ext-cls":"mr40"}},[e._v("\n                            "+e._s(e.$t('m.treeinfo["企业微信"]'))+"\n                        ")]),e._v(" "),i("bk-checkbox",{attrs:{value:"EMAIL","ext-cls":"mr40"}},[e._v("\n                            "+e._s(e.$t('m.treeinfo["邮件"]'))+"\n                        ")]),e._v(" "),i("bk-checkbox",{attrs:{value:"SMS"}},[e._v("\n                            "+e._s(e.$t('m.treeinfo["手机短信"]'))+"\n                        ")])],1)],1)],1)],1)]),e._v(" "),e.openFunction.TRIGGER_SWITCH||e.openFunction.TASK_SWITCH?i("section",{staticClass:"settion-card"},[i("div",{staticClass:"card-title more-configuration mt20",attrs:{"data-test-id":"editService-div-showMoreConfig"},on:{click:function(t){e.showMoreConfig=!e.showMoreConfig}}},[e.showMoreConfig?i("i",{staticClass:"bk-icon icon-up-shape"}):i("i",{staticClass:"bk-icon icon-down-shape"}),e._v(" "),i("span",[e._v(e._s(e.$t("m.taskTemplate['高级配置']")))])]),e._v(" "),e.showMoreConfig?i("div",[i("collapse-transition",[i("div",[i("basic-card",{staticClass:"mt20",attrs:{"card-label":e.$t("m.newCommon['触发器']"),"card-desc":e.$t("m.taskTemplate['满足触发条件后要完成的特定动作']")}},[i("common-trigger-list",{attrs:{origin:"workflow","source-id":e.processId,table:e.flowInfo.table}})],1),e._v(" "),i("basic-card",{staticClass:"mt20",attrs:{"card-label":e.$t("m.taskTemplate['任务配置']"),"card-desc":e.$t("m.taskTemplate['如果需要在流程中调用标准运维的业务流程进而创建任务，请在第一步的流程字段配置中，将已有字段中的“关联业务” 字段添加至流程中。']")}},[i("TaskConfigPanel",{ref:"taskConfigPanel",attrs:{"service-info":e.serviceInfo}})],1)],1)])],1):e._e()]):e._e(),e._v(" "),i("bk-dialog",{attrs:{"mask-close":!1,"show-footer":!1},on:{cancel:e.goToServiceList},model:{value:e.slaValidateDialogShow,callback:function(t){e.slaValidateDialogShow=t},expression:"slaValidateDialogShow"}},[i("div",{staticClass:"sla-validate-msg"},[i("i",{staticClass:"bk-icon icon-check-circle"}),e._v(" "),i("h4",[e._v(e._s(e.$t("m['保存成功']")))]),e._v(" "),e._l(e.slaValidateMsg,(function(t,n){return i("p",{key:n},[e._v(e._s(t))])})),e._v(" "),i("div",{staticClass:"operate-btns"},[i("bk-button",{attrs:{theme:"primary"},on:{click:function(t){e.slaValidateDialogShow=!1}}},[e._v(e._s(e.$t("m['确定']")))]),e._v(" "),i("bk-button",{on:{click:e.goToServiceList}},[e._v(e._s(e.$t("m['取消']")))])],1)],2)])],1)},o=[];n._withStripped=!0},JGQq:function(e,t,i){"use strict";i.r(t);var n=i("j/2n"),o=i("qJoz");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("hZSR");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"626bb56a",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/dataContent.vue",t.default=r.exports},JXR1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=S(i("z1yn")),o=S(i("jub7")),a=S(i("Za/z")),s=S(i("u14n")),r=S(i("/KdC")),c=S(i("TNjk")),l=S(i("qyUP")),u=S(i("VrAx")),d=S(i("4K0D")),f=S(i("nxpg")),p=S(i("eOfU")),m=S(i("MBfY")),h=S(i("/Hw/")),v=S(i("Q3ZP")),g=S(i("Wl5c")),b=S(i("0njq")),_=S(i("+QRE")),y=S(i("070I")),k=S(i("gy7N")),I=S(i("aYIO")),w=S(i("g9b+")),C=S(i("IDfM"));function S(e){return e&&e.__esModule?e:{default:e}}t.default={name:"preview",components:{"CW-STRING":n.default,"CW-LINK":o.default,"CW-INT":a.default,"CW-TEXT":s.default,"CW-CHECKBOX":r.default,"CW-RADIO":c.default,"CW-SELECT":l.default,"CW-INPUTSELECT":u.default,"CW-MULTISELECT":d.default,"CW-DATE":f.default,"CW-DATETIME":p.default,"CW-MEMBER":m.default,"CW-MEMBERS":h.default,"CW-TABLE":v.default,"CW-CUSTOMTABLE":g.default,"CW-RICHTEXT":b.default,"CW-TREESELECT":_.default,"CW-FILE":y.default,"CW-CASCADE":k.default,"CW-SOPS_TEMPLATE":I.default,"CW-COMPLEX-MEMBERS":w.default,"CW-CUSTOM-FORM":C.default},props:{fields:{type:Array,required:!0,default:function(){return[]}},isPreview:{type:Boolean,default:!1},isFilePreview:{type:Boolean,default:!1}},data:function(){return{}}}},JbQy:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("14Xm")),o=d(i("D3Ub")),a=d(i("gDS+")),s=d(i("0nTK")),r=d(i("jF+y")),c=d(i("uy81")),l=d(i("lXJ6")),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}var f={endpoint:"Dot",connector:["Flowchart",{stub:[10,16],alwaysRespectStub:!0,gap:2,cornerRadius:10}],connectorOverlays:[["PlainArrow",{width:8,length:6,location:1,id:"arrow"}]],paintStyle:{fill:"rgba(0, 0, 0, 0)",stroke:"",strokeWidth:1,radius:8},hoverPaintStyle:{fill:"#EE8F62",stroke:"#EE8F62",radius:8},cssClass:"template-canvas-endpoint",hoverClass:"template-canvas-endpoint-hover",isSource:!0,isTarget:!0,maxConnections:-1},p={grid:[5,5]},m={paintStyle:{fill:"transparent",stroke:"#a9adb6",strokeWidth:1},hoverPaintStyle:{fill:"transparent",stroke:"#3a84ff",strokeWidth:2},cssClass:"bk-sops-connector",hoverClass:"bk-sops-connector-hover",detachable:!0};t.default={name:"SecondFlow",components:{JsFlow:s.default,NodeTemplate:r.default,Palette:c.default,lineConfigue:l.default},props:{addList:{type:Array,default:function(){return[]}},lineList:{type:Array,default:function(){return[]}},flowInfo:{type:Object,default:function(){return{}}}},data:function(){return{clickSecond:!1,endpointOptions:f,connectorOptions:m,nodeOptions:p,canvasData:{nodes:[],lines:[]},toolsInfo:[{type:"zoomIn",name:" ",title:this.$t("m.treeinfo['放大']"),cls:"bk-itsm-icon icon-flow-other-add"},{type:"zoomOut",name:" ",title:this.$t("m.treeinfo['缩小']"),cls:"bk-itsm-icon icon-flow-other-reduc"},{type:"resetPosition",name:" ",title:this.$t("m.treeinfo['还原']"),cls:"bk-itsm-icon icon-flow-restore"},{type:"frameSelect",name:" ",title:this.$t("m.treeinfo['框选']"),cls:"bk-itsm-icon icon-choose-node"}],nodeInfo:{},toolLimit:4,customLine:{isShow:!1,title:this.$t('m.treeinfo["线条配置"]'),width:700,isOnly:!1,lineInfo:{},lineValue:{},nodeInfo:{from_state:{},to_state:{}}},deleteInfo:{isShow:!1,title:this.$t('m.treeinfo["确认删除"]'),content:this.$t('m.treeinfo["确认后，此节点将从该流程中移除！"]'),info:{}},drawStatus:!1,currentNode:{}}},computed:{nodeStatus:function(){return this.$store.state.deployCommon.nodeStatus},stateNodeInfo:function(){return this.$store.state.deployCommon.nodeInfo}},created:function(){this.initDate()},mounted:function(){this.addLineOverlay()},methods:{initDate:function(){var e=this;this.addList.forEach((function(t,i){var n=t.axis.x?t.axis.x:165+250*i,o=t.axis.y?t.axis.y:195+(i%2==1?5:0);e.canvasData.nodes.push({id:"node_"+t.id,x:n,y:o,type:t.type,name:t.name,showMore:!1,nodeInfo:t}),e.$set(e.nodeInfo,"node_"+t.id,t)})),this.lineList.forEach((function(t,i){e.canvasData.lines.push({source:{arrow:t.axis.start||"Right",id:"node_"+t.from_state},target:{arrow:t.axis.end||"Left",id:"node_"+t.to_state},lineInfo:t})}))},errorNodes:function(e){var t=this;this.canvasData.nodes.forEach((function(i){e.forEach((function(e){i.nodeInfo.id===e&&t.$set(i.nodeInfo,"errorInfo",!0)}))}))},addLineOverlay:function(){var e=this;this.canvasData.lines.forEach((function(t){var i={source:t.source,target:t.target,lineInfo:t.lineInfo,id:t.lineInfo.id,name:t.lineInfo.name};e.lineOverlay(i)}))},lineOverlay:function(e){if(!this.canvasData.nodes.some((function(t){return e.source.id===t.id&&"START"===t.type}))){var t='<span class="bk-label-test-name">'+(e.name||this.$t('m.treeinfo["默认"]'))+"</span>",i={id:"label_"+e.id,type:"Label",name:t,cls:"label-test",location:.5};this.$refs.jsFlow.addLineOverlay(e,i)}},removerLine:function(e){this.$refs.jsFlow.removeConnector({source:{id:e.sourceId},target:{id:e.targetId}})},onToolClick:function(e){},closeShow:function(){this.canvasData.nodes.forEach((function(e){e.showMore=!1}))},onConnectionClick:function(e,t){},onOverlayClick:function(e){var t=this,i=Number(e.id.split("_")[1]),n=this.canvasData.lines.filter((function(e){return e.lineInfo.id===i})),o=this.canvasData.nodes.filter((function(e){return e.id===n[0].source.id})),a=this.$refs.jsFlow.getConnectorsByNodeId(o[0].id);this.customLine.lineInfo=a.filter((function(e){return n[0].source.id===e.sourceId&&n[0].target.id===e.targetId}))[0],this.canvasData.lines.forEach((function(e,i){e.source.id===t.customLine.lineInfo.sourceId&&e.target.id===t.customLine.lineInfo.targetId&&(t.customLine.lineValue=e.lineInfo)})),this.canvasData.nodes.forEach((function(e){t.customLine.lineInfo.sourceId===e.id&&(t.customLine.nodeInfo.from_state=e.nodeInfo),t.customLine.lineInfo.targetId===e.id&&(t.customLine.nodeInfo.to_state=e.nodeInfo)})),this.customLine.isOnly=2===a.length,this.customLine.isShow=!this.customLine.isShow},submitLine:function(e){this.customLine.lineValue.name&&this.$refs.jsFlow.removeLineOverlay(this.customLine.lineInfo,"label_"+this.customLine.lineValue.id),this.canvasData.lines.forEach((function(t){t.lineInfo.id===e.id&&(t.lineInfo=e)})),this.canvasData.lines=JSON.parse((0,a.default)(this.canvasData.lines));var t={id:"label_"+this.customLine.lineValue.id,type:"Label",name:'<span class="bk-label-test-name">'+(e.name||this.$t('m.treeinfo["默认"]'))+"</span>",cls:"label-test",location:.5};this.$refs.jsFlow.addLineOverlay(this.customLine.lineInfo,t),this.closeLine()},closeLine:function(){this.customLine.isShow=!1},deleteLine:function(){var e=this,t=this.customLine.lineValue.id;this.clickSecond||(this.clickSecond=!0,this.$store.dispatch("deployCommon/deleteLine",t).then((function(t){var i=[{source:{arrow:"Left",id:e.customLine.lineInfo.sourceId},target:{arrow:"Left",id:e.customLine.lineInfo.targetId},lineInfo:{}}];e.updateLine(i,"delete"),e.removerLine(e.customLine.lineInfo),e.closeLine()})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.clickSecond=!1})))},onConnection:function(e){this.drawStatus&&(this.drawLine(e),this.drawStatus=!1)},onConnectionDragStop:function(e,t,i){var n={sourceId:e.id,targetId:t};if(this.checkLineInfo(n)){var o=void 0,a={source:e,target:{id:t}},s=document.getElementById(t).getBoundingClientRect(),r=i.clientX-s.left,c=i.clientY-s.Top;o=r<s.width/2?c<s.height/2?r>c?"Top":"Left":r>s.height-c?"Bottom":"Left":c<s.height/2?s.width-r>c?"Top":"Right":s.width-r>s.height-c?"Bottom":"Right",a.target.arrow=o,this.$refs.jsFlow.createConnector(a);var l={sourceId:e.id,targetId:t,sourceEndpoint:{anchor:{type:e.arrow}},targetEndpoint:{anchor:{type:o}}};this.drawLine(l),this.drawStatus=!1}},onBeforeDrop:function(e){return this.checkLineInfo(e)},checkLineInfo:function(e){var t=this.canvasData.nodes.filter((function(t){return t.id===e.sourceId})),i=this.canvasData.nodes.filter((function(t){return t.id===e.targetId})),n={status:!0,msg:""};"START"===t[0].type&&(this.canvasData.lines.some((function(e){return e.source.id===t[0].id}))&&(n.status=!1,n.msg=this.$t('m.treeinfo["开始节点只能单一输出！"]')));"START"===i[0].type&&(n.status=!1,n.msg=this.$t('m.treeinfo["开始节点只能输出！"]')),"END"===t[0].type&&(n.status=!1,n.msg=this.$t('m.treeinfo["结束节点只能输入！"]')),"START"===t[0].type&&"END"===i[0].type&&(n.status=!1,n.msg=this.$t('m.treeinfo["开始节点和结束节点不能直接相连！"]')),e.sourceId===e.targetId&&(n.status=!1,n.msg=this.$t('m.treeinfo["自身不能相连！"]'));for(var o=0;o<this.canvasData.lines.length;o++)e.sourceId===this.canvasData.lines[o].source.id&&e.targetId===this.canvasData.lines[o].target.id&&(n.status=!1,n.msg=this.$t('m.treeinfo["已存在的连线！"]'));return n.status||this.$bkMessage({message:n.msg,theme:"warning"}),this.drawStatus=!0,n.status},drawLine:function(e){var t=this;return(0,o.default)(n.default.mark((function i(){var o,a,s,r;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o="",a="",s={targetId:"",sourceId:""},t.canvasData.nodes.forEach((function(t,i){t.id===e.sourceId&&(a=t.nodeInfo.id,s.sourceId=t.id),t.id===e.targetId&&(o=t.nodeInfo.id,s.targetId=t.id)})),r={workflow:t.addList[0].workflow,name:t.$t('m.treeinfo["默认"]'),axis:{start:e.sourceEndpoint.anchor.type,end:e.targetEndpoint.anchor.type},from_state:a,to_state:o},!t.canvasData.lines.some((function(e){return e.source.id===s.sourceId&&e.target.id===s.targetId}))){i.next=8;break}return i.abrupt("return");case 8:if(!t.clickSecond){i.next=10;break}return i.abrupt("return");case 10:return t.clickSecond=!0,i.next=13,t.$store.dispatch("deployCommon/createLine",{lineParams:r}).then((function(i){var n=[{source:{arrow:r.axis.start,id:e.sourceId},target:{arrow:r.axis.end,id:e.targetId},lineInfo:i.data,id:i.data.id,name:i.data.name}];t.updateLine(n,"add"),t.lineOverlay(n[0])})).catch((function(e){(0,u.errorHandler)(e,t),t.canvasData.lines.some((function(e){return e.source.id===s.sourceId&&e.target.id===s.targetId}))||t.$refs.jsFlow.removeConnector({source:{id:s.sourceId},target:{id:s.targetId}})})).finally((function(){t.clickSecond=!1}));case 13:case"end":return i.stop()}}),i,t)})))()},updateLine:function(e,t){var i=this;"delete"===t?e.forEach((function(e){i.canvasData.lines.forEach((function(t,n){t.source.id===e.source.id&&t.target.id===e.target.id&&i.canvasData.lines.splice(n,1)}))})):"update"===t?e.forEach((function(e){i.canvasData.lines.forEach((function(t,i){t.source.id===e.source.id&&t.target.id===e.target.id&&(t.lineInfo=e.lineInfo)}))})):"add"===t&&(this.canvasData.lines=this.canvasData.lines.concat(e))},onConnectionDetached:function(){},onZoomIn:function(){this.toolLimit>9||(this.toolLimit+=1,this.$refs.jsFlow&&this.$refs.jsFlow.zoomIn())},onZoomOut:function(){0!==this.toolLimit&&(this.toolLimit-=1,this.$refs.jsFlow&&this.$refs.jsFlow.zoomOut())},onResetPosition:function(){this.$refs.jsFlow.resetPosition()},onCanvasFrameSelect:function(){},handleScroll:function(e){e.deltaY>0?this.onZoomOut():this.onZoomIn()},fastAddNode:function(e){var t=this;setTimeout((function(){t.$refs.jsFlow.createConnector(e.line);var i={source:e.line.source,target:e.line.target,lineInfo:e.line.lineInfo,id:e.line.lineInfo.id,name:e.line.lineInfo.name};t.lineOverlay(i)}),100)},updateNode:function(e,t){var i=this;this.$refs.jsFlow.createNode(e.node);var n=[];"COPY"!==t&&this.canvasData.nodes.forEach((function(t){var o=t.x-e.node.x,a=t.y-e.node.y;if(e.node.id!==t.id&&a>=-40&&o>=-150&&o<=150){var s={id:t.id,nodeInfo:t.nodeInfo,x:t.x,y:t.y+100};n.push(s),setTimeout((function(){i.$refs.jsFlow.setNodePosition(s),i.moveNode(s)}),100)}})),this.canvasData.nodes.forEach((function(e){n.forEach((function(t){e.id===t.id&&(e.x=t.x,e.y=t.y)}))}))},onCreateNodeBefore:function(e){var t=this;return(0,o.default)(n.default.mark((function i(){var o;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.nodeStatus){i.next=2;break}return i.abrupt("return");case 2:return o={workflow:t.flowInfo.id,name:"",type:e.type,is_terminable:!1,axis:{x:e.x,y:e.y},extras:{}},i.next=5,t.$store.dispatch("deployCommon/creatNode",{params:o}).then((function(i){return t.$set(e,"nodeInfo",i.data),!0})).catch((function(i){(0,u.errorHandler)(i,t),t.$refs.jsFlow.removeNode(e)}));case 5:case"end":return i.stop()}}),i,t)})))()},openDelete:function(e){e.nodeInfo&&e.nodeInfo.is_builtin||(this.deleteInfo.info=e,this.deleteNode())},deleteNode:function(){var e=this,t=this.deleteInfo.info.nodeInfo.id;this.clickSecond||(this.clickSecond=!0,this.$store.dispatch("deployCommon/deleteNode",t).then((function(t){e.deleteInfo.info.nodeInfo.is_draft||e.$bkMessage({message:e.$t('m.treeinfo["删除成功"]'),theme:"success"});for(var i=e.$refs.jsFlow.getConnectorsByNodeId(e.deleteInfo.info.id),n=[],o=0;o<i.length;o++)n.push({source:{arrow:"Left",id:i[o].sourceId},target:{arrow:"Left",id:i[o].targetId},lineInfo:{}});n.length&&e.updateLine(n,"delete"),e.$refs.jsFlow.removeNode(e.deleteInfo.info),e.closeDelete()})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.clickSecond=!1})))},closeDelete:function(){this.deleteInfo.isShow=!1},configuNode:function(e){var t=this;this.$store.dispatch("deployCommon/getOneStateInfo",{id:e.id}).then((function(e){t.$emit("handleNodeClick",e.data)})).catch((function(e){(0,u.errorHandler)(e,t)}))},onNodeMoveStop:function(e,t){if(e.x===this.currentNode.x&&e.y===this.currentNode.y)return this.canvasData.nodes.forEach((function(e){e.showMore=!1})),void this.canvasData.nodes.forEach((function(t){e.id===t.id&&(t.showMore=!0)}));for(var i=!1,n=0;n<this.canvasData.nodes.length;n++){var o=this.canvasData.nodes[n];if(e.id!==o.id){var a={x:o.x-e.x,y:o.y-e.y};if("NORMAL"===e.type||"ROUTER"===e.type||"TASK"===e.type){if("NORMAL"===o.type||"ROUTER"===o.type||"TASK"===o.type){if(a.x>=-150&&a.x<=150&&a.y>=-40&&a.y<=40){i=!0;break}}else if(a.x>=-40&&a.x<=150&&a.y>=-40&&a.y<=40){i=!0;break}}else if("NORMAL"===o.type||"ROUTER"===o.type||"TASK"===o.type){if(a.x>=-150&&a.x<=40&&a.y>=-40&&a.y<=40){i=!0;break}}else if(a.x>=-40&&a.x<=40&&a.y>=-40&&a.y<=40){i=!0;break}}}if(i){var s={id:e.id,x:this.stateNodeInfo.x,y:this.stateNodeInfo.y};this.$refs.jsFlow.setNodePosition(s);for(var r=0;r<this.canvasData.nodes.length;r++)e.id===this.canvasData.nodes[r].id&&(this.canvasData.nodes[r].x=this.stateNodeInfo.x,this.canvasData.nodes[r].y=this.stateNodeInfo.y)}else this.moveNode(e)},onNodeMoving:function(e,t){var i=e;i.x=t.pos[0],i.y=t.pos[1]},getBestArrow:function(e,t){var i=this,n={parent:[],parentLine:[],children:[],childrenLine:[]},o=[];this.canvasData.lines.forEach((function(e){var t=!1;i.canvasData.lines.forEach((function(i){e.source.id===i.target.id&&e.target.id===i.source.id&&(t=!0)})),t||o.push(e)})),o.forEach((function(t){e.id===t.target.id&&(n.parent.push(t.source.id),n.parentLine.push(t)),e.id===t.source.id&&(n.children.push(t.target.id),n.childrenLine.push(t))}));var a=["NORMAL","ROUTER","TASK","TASK-SOPS"],s=this.getEndPointInfo(e,a),r={},c={};n.parent.forEach((function(e){i.canvasData.nodes.forEach((function(t){e===t.id&&(r[e]=i.getEndPointInfo(t,a))}))})),n.children.forEach((function(e){i.canvasData.nodes.forEach((function(t){e===t.id&&(c[e]=i.getEndPointInfo(t,a))}))}));var l=[];n.parent.forEach((function(t){l=[],s.forEach((function(e){var i;r[t].forEach((function(t){l.push({cArrow:e.anchor,pArrow:t.anchor,distance:Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)})})),l=l.sort((i="distance",function(e,t){return e[i]-t[i]}))}));var n=l[0],o={source:{id:t},target:{id:e.id}};i.deleteBestLine(o,n)}));var u=[];n.children.forEach((function(t){u=[],s.forEach((function(e){var i;c[t].forEach((function(t){u.push({cArrow:t.anchor,pArrow:e.anchor,distance:Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)})})),u=u.sort((i="distance",function(e,t){return e[i]-t[i]}))}));var n=u[0],o={source:{id:e.id},target:{id:t}};i.deleteBestLine(o,n)}))},getEndPointInfo:function(e,t){return[{anchor:"Top",x:e.x+(t.some((function(t){return t===e.type}))?75:20),y:e.y},{anchor:"Left",x:e.x,y:e.y+20},{anchor:"Right",x:e.x+(t.some((function(t){return t===e.type}))?150:40),y:e.y+20},{anchor:"Bottom",x:e.x+(t.some((function(t){return t===e.type}))?75:20),y:e.y+40}]},deleteBestLine:function(e,t){var i=this;this.canvasData.lines.some((function(i){return i.source.id===e.source.id&&i.target.id===e.target.id&&i.source.arrow===t.pArrow&&i.target.arrow===t.cArrow}))||(this.$refs.jsFlow.removeConnector({source:{id:e.source.id},target:{id:e.target.id}}),this.canvasData.lines.forEach((function(n){if(n.source.id===e.source.id&&n.target.id===e.target.id){n.source.arrow=t.pArrow,n.target.arrow=t.cArrow;var o={source:{arrow:t.pArrow,id:e.source.id},target:{arrow:t.cArrow,id:e.target.id},lineInfo:n.lineInfo};i.$refs.jsFlow.createConnector(o);var a={source:o.source,target:o.target,lineInfo:o.lineInfo,id:n.lineInfo.id,name:n.lineInfo.name};i.lineOverlay(a)}})))},moveNode:function(e){var t=this,i={axis:{x:e.x,y:e.y}},n=e.nodeInfo.id;this.$store.dispatch("deployCommon/updateNodeAxis",{params:i,id:n}).then((function(e){})).catch((function(e){(0,u.errorHandler)(e,t)}))}}}},Jdd0:function(e,t,i){},Jimo:function(e,t,i){"use strict";i("udFb")},Jje2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("efIh"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"STRING",mixins:[a.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},computed:{maxLength:function(){return"title"===this.item.key?120:"task_name"===this.item.key?50:null}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value)}}},Jwqd:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMON_ATTRS=void 0;var n,o=i("QbLZ"),a=(n=o)&&n.__esModule?n:{default:n};t.getFormMixins=function(e){var t={};for(var i in e)"value"!==i&&(t[i]=e[i]);return{props:(0,a.default)({},s,t),inject:["getContext"],data:function(){return{value:this.$attrs.value?this.$attrs.value:e.value.default}},methods:{getTopViewItem:function(){for(var e=this,t=!1;!t;)e.$parent&&e.$parent.isRootRenderView?t=!0:e=e.$parent;return e}}}};var s=t.COMMON_ATTRS={label:{type:String,required:!1},hiddenLabel:{type:Boolean,default:!1},form:{type:Object,default:function(){return{}}},children:{type:[String,Array],required:!1},desc:{type:String,required:!1}}},"K/3P":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"service-ticket-form"},[e.formList.length?i("div",{staticClass:"form-list",staticStyle:{padding:"10px 0"}},[i("bk-form",{attrs:{"form-type":"vertical"}},[i("draggable",{attrs:{"data-test-id":"service_draggable_serviceFormDrag",handle:".dragElement",value:e.formList,group:{name:"view-form",pull:!1,put:["view-form","half-row-field","form-view-item"]}},on:{end:e.onRowDragEnd,add:e.onHalfRowDragToRow}},[e._l(e.formList,(function(t,n){return[Array.isArray(t)?i("half-row-form",{key:n,attrs:{"row-index":n,"workflow-id":e.serviceInfo.workflow_id,"node-id":e.nodeId,fields:e.forms,"row-forms":t,"add-field-status":e.addFieldStatus,"crt-form":e.crtForm},on:{onHalfRowDragToHalfRow:e.onHalfRowDragToHalfRow,onFormEditClick:e.onFormEditClick,onFormCloneClick:e.onFormCloneClick,onFormDeleteClick:function(t){return e.$emit("fieldDelete",t)},onEditCancel:e.onEditCancel,onEditConfirm:e.onEditConfirm}}):[i("form-view-item",{key:t.id,attrs:{"data-id":t.id,fields:e.forms,form:t,"add-field-status":e.addFieldStatus,"crt-form":e.crtForm},on:{onFormEditClick:e.onFormEditClick,onFormCloneClick:e.onFormCloneClick,onFormDeleteClick:function(t){return e.$emit("fieldDelete",t)}}},[i("div",{staticClass:"dragElement",attrs:{slot:"draggable"},slot:"draggable"},[i("i",{staticClass:"bk-itsm-icon icon-move-new"})])])]]}))],2)],1)],1):i("div",{staticClass:"no-form"},[i("h3",[e._v(e._s(e.$t("m.tickets['暂无服务表单']")))]),e._v(" "),i("p",[e._v(e._s(e.$t("m.tickets['请在左侧的“控件库”或“已有字段”点击添加']")))])])])},o=[];n._withStripped=!0},"K2+b":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-select",{class:{"bk-form-two":e.firstShow},attrs:{searchable:"","font-size":"medium",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.choice[0]?e.item.choice[0].desc:e.firstPlace},on:{selected:e.itemSelect},model:{value:e.firstInfo,callback:function(t){e.firstInfo=t},expression:"firstInfo"}},e._l(e.item.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.firstShow?[i("bk-select",{class:{"bk-form-two-other":e.firstShow},attrs:{searchable:"",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,"font-size":"medium",placeholder:e.firstList[0]?e.firstList[0].desc:e.secondPlace},on:{selected:e.changeFrist},model:{value:e.secondInfo,callback:function(t){e.secondInfo=t},expression:"secondInfo"}},e._l(e.firstList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},KElf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("rMih"),a=(n=o)&&n.__esModule?n:{default:n},s=i("ygAv");t.default={name:"FormEditItem",components:{AddField:a.default},props:{form:Object,workflowId:Number,nodeId:Number},data:function(){return{formData:(0,s.deepClone)(this.form)}},mounted:function(){this.$refs.formEditItem.scrollIntoView({block:"center"})},methods:{onConfirmClick:function(e){this.$emit("onEditConfirm",(0,s.deepClone)(e))},getAddFieldStatus:function(e){this.$emit("getAddFieldStatus",e)}}}},"KW1/":function(e,t,i){"use strict";i.r(t);var n=i("Fz92"),o=i("f5Dy");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7a471b5f",null);r.options.__file="src/views/processManagement/publicTrigger/common/triggerField.vue",t.default=r.exports},KaYb:function(e,t,i){"use strict";i.r(t);var n=i("sF2c"),o=i("EtUq");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("fdTw");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"25024ae6",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/sopsGetParam.vue",t.default=r.exports},Kbo1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{maxlength:120,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},Kvpm:function(e,t,i){},LEca:function(e,t,i){"use strict";i.r(t);var n=i("tNmS"),o=i("gSHn");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("ho2g");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"4fa1aa35",null);r.options.__file="src/views/service/editService/TaskConfigPanel.vue",t.default=r.exports},LFqy:function(e,t,i){},LJsK:function(e,t,i){"use strict";i.r(t);var n=i("z/kA"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},LWgf:function(e,t,i){"use strict";i("oiO8")},Lbk4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("gDS+")),o=f(i("14Xm")),a=f(i("D3Ub")),s=f(i("t2rG")),r=f(i("BWJp")),c=f(i("eQfd")),l=f(i("rMih")),u=f(i("jFOa")),d=i("CeR/");function f(e){return e&&e.__esModule?e:{default:e}}t.default={name:"fieldInfo",components:{draggable:s.default,fieldPreview:c.default,addField:l.default,inheritState:u.default},mixins:[r.default],props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},isShowTitle:{type:Boolean,default:function(){return!1}}},data:function(){return{nodesList:[],isDataLoading:!1,secondClick:!1,showTabList:[],changeInfo:{},sliderInfo:{title:this.$t('m.treeinfo["新增字段"]'),show:!1,width:700},processInfo:{isShow:!1,title:this.$t('m.treeinfo["字段预览"]'),position:{top:150},draggable:!0},previewTab:[],isEditPublic:!1,moduleInfo:{isShow:!1,width:700,headerPosition:"left",autoClose:!1},addOrigin:{isOther:!1}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},watch:{"templateInfo.id":function(){this.initData()},templateStage:function(){this.initData()}},mounted:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:case"end":return t.stop()}}),t,e)})))()},beforeDestroy:function(){this.clearFieldsIndexInfo()},methods:{initData:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.templateStage&&(e.addOrigin.isOther=!0,e.addOrigin.addOriginInfo={type:"templateField",addUrl:"taskTemplate/createTemplateField",updateUrl:"taskTemplate/updateTemplateField"}),t.next=3,e.getTableList();case 3:case"end":return t.stop()}}),t,e)})))()},getTableList:function(){var e=this,t="deployCommon/getFieldList",i={};if(this.templateInfo.id)t="taskTemplate/getTemplateFields",i.task_schema_id=this.templateInfo.id,i.stage=this.templateStage;else{if(!this.flowInfo||!this.flowInfo.id)return;i.workflow=this.flowInfo.id,i.state=this.configur.id}this.isDataLoading=!0,this.$store.dispatch(t,i).then((function(t){e.showTabList=e.orderByCacheInfo(t.data),e.showTabList.forEach((function(t){e.globalChoise.field_type.forEach((function(i){t.type===i.typeName&&e.$set(t,"typeName",i.name)})),"COMPLEX-MEMBERS"===t.type&&e.$set(t,"typeName",e.$t("m.newCommon['处理人']")),"SOPS_TEMPLATE"===t.type&&e.$set(t,"typeName",e.$t("m.newCommon['流程模板']")),e.globalChoise.validate_type.forEach((function(i){t.validate_type===i.typeName&&e.$set(t,"is_required",i.name)}))}))})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},checkDeleteDisabled:function(e){return!(!e.is_builtin||!this.configur.is_first_state||-1!==["impact","urgency","priority","current_status"].indexOf(e.key))||("APPROVE_RESULT"===e.meta.code||(-1!==["processors","task_name"].indexOf(e.key)||"APPROVAL"===this.configur.type))},checkEditDisabled:function(e){return"APPROVAL"===this.configur.type},updateInfo:function(e){this.cacheFieldsIndexInfo()},closeShade:function(){this.sliderInfo.show=!1},orderByCacheInfo:function(e){var t=this,i=[],n=[];return e.forEach((function(e){var o=t.getOneFieldCacheIndex(e.id);o||0===o?i[o]=e:n.push(e)})),i.filter((function(e){return!!e})).concat(n)},cacheFieldsIndexInfo:function(){var e=this,t=this.showTabList.reduce((function(t,i,n){return t[window.username+"_"+e.flowInfo.id+"_"+e.configur.id+"_"+i.id]=n,t}),{});sessionStorage.setItem("fieldsIndexMap",(0,n.default)(t))},getOneFieldCacheIndex:function(e){var t=sessionStorage.getItem("fieldsIndexMap")||"{}";return JSON.parse(t)[window.username+"_"+this.flowInfo.id+"_"+this.configur.id+"_"+e]},clearFieldsIndexInfo:function(){sessionStorage.removeItem("fieldsIndexMap")},getFrontNodesList:function(){var e=this;if(this.configur.id||this.templateInfo.id){var t="",i={};this.configur.id&&(t="apiRemote/get_related_fields",i.workflow=this.workflow,i.state=this.configur.id),this.templateInfo.id&&(t="taskTemplate/getFrontFieldsList",i.id=this.templateInfo.id,i.stage=this.templateStage),this.$store.dispatch(t,i).then((function(t){e.nodesList=t.data,e.sliderInfo.show=!0})).catch((function(t){(0,d.errorHandler)(t,e)}))}},addField:function(){this.changeInfo={workflow:"",id:"",key:"",name:"",type:"STRING",desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],is_builtin:!1,source_type:"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:"",meta:{}},this.sliderInfo.title=this.$t('m.treeinfo["新增字段"]'),this.getFrontNodesList()},openField:function(e){this.changeInfo=e,this.changeInfo.is_tips=e.is_tips||!1,this.sliderInfo.title=this.$t('m.treeinfo["编辑字段"]'),this.getFrontNodesList()},previewField:function(){if(this.showTabList.length){this.previewTab=this.showTabList;for(var e=0;e<this.previewTab.length;e++){for(var t=0;t<this.previewTab[e].choice.length;t++)this.previewTab[e].choice[t].typeName=this.previewTab[e].choice[0]?this.previewTab[e].choice[0].key:"";this.$set(this.previewTab[e],"val",this.previewTab[e].default||""),this.$set(this.previewTab[e],"showFeild",!0)}this.processInfo.isShow=!0,this.isNecessaryToWatch({fields:this.previewTab},"workflow")}},deleteTable:function(e){var t=this;this.$bkInfo({type:"warning",title:this.$t('m.treeinfo["确认删除此字段？"]'),subTitle:this.$t('m.treeinfo["字段一旦删除，此字段将不在可用。请谨慎操作。"]'),confirmFn:function(){var i="deployCommon/deleteField",n={id:e.id,params:{state_id:t.configur.id}};t.templateInfo.id&&(i="taskTemplate/deleteTemplateField",delete n.params),t.secondClick||(t.secondClick=!0,t.$store.dispatch(i,n).then((function(e){t.$bkMessage({message:t.$t('m.systemConfig["删除成功"]'),theme:"success"}),t.getTableList()})).catch((function(e){(0,d.errorHandler)(e,t)})).finally((function(){t.secondClick=!1})))}})},openAddModule:function(){this.moduleInfo.isShow=!0},submitModule:function(){var e=this,t=this.$refs.inheritState.checkList.filter((function(e){return!e.is_disabled}));if(t.length){var i={fields:t},n=this.configur.id;if(this.secondClick)return;this.secondClick=!0,this.$store.dispatch("basicModule/add_fields_from_table",{params:i,id:n}).then((function(t){e.$bkMessage({message:e.$t('m.systemConfig["添加成功"]'),theme:"success"}),e.moduleInfo.isShow=!1,e.getTableList()})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))}else this.moduleInfo.isShow=!1}}}},LgrT:function(e,t,i){},M78e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("P2sY")),o=r(i("t2rG")),a=r(i("Albq")),s=r(i("RPM2"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ServiceForm",components:{draggable:o.default,HalfRowForm:a.default,FormViewItem:s.default},props:{serviceInfo:Object,nodeId:Number,forms:Array,crtForm:[String,Number],addFieldStatus:Boolean},data:function(){return{formList:this.transFieldsToDraggable(this.forms)}},watch:{forms:function(e){this.formList=this.transFieldsToDraggable(e)}},mounted:function(){},methods:{transFieldsToDraggable:function(e){var t=[];return e.forEach((function(e){var i=t[t.length-1];if("COL_6"!==e.layout)t.push(e);else if(Array.isArray(i)&&void 0===i[1]&&"right"===e.meta.layout_position)i[1]=e;else{var n="right"===e.meta.layout_position?[void 0,e]:[e,void 0];t.push(n)}})),t},onRowDragEnd:function(e){for(var t=Number(e.item.dataset.id),i=this.forms.find((function(e){return e.id===t})),n=e.newIndex,o=0;o<e.newIndex;o++)Array.isArray(this.formList[o])&&this.formList[o].every((function(e){return void 0!==e}))&&(n+=1);this.$emit("dragUpdateList",n,i)},onHalfRowDragToRow:function(e){var t=Number(e.item.dataset.id),i=e.newIndex;if(this.forms.find((function(e){return e.id===t}))){for(var n=this.forms.find((function(e){return e.id===t})),o=0;o<e.newIndex;o++){var a=this.formList[o];Array.isArray(a)&&(a.every((function(e){return void 0!==e&&e.id!==t}))&&(i+=1),a.some((function(e){return void 0===e}))&&a.find((function(e){return e&&e.id===t}))&&(i-=1))}n.meta.layout_position="left",this.$emit("dragUpdateList",i,n)}else{var s={api_info:e.item._underlying_vm_.api_info,workflow:"",id:"",key:"",name:e.item._underlying_vm_.name,type:e.item._underlying_vm_.type,desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],showFeild:!0,is_builtin:!1,source_type:e.item._underlying_vm_.source_type||"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:"",meta:{},default:""};this.$emit("onAddFormClick",i,s)}},onHalfRowDragToHalfRow:function(e){var t=void 0,i=Number(e.item.dataset.id),n=Number(e.target.dataset.rowindex),o=this.formList[n],a=o.find((function(e){return e})),s=this.forms.findIndex((function(e){return e.id===a.id}));if(this.forms.find((function(e){return e.id===i}))){var r=this.forms.find((function(e){return e.id===i}));void 0===o[0]?(r.meta.layout_position="left",t=r.id===a.id||0===s?s:s-1):(r.meta.layout_position="right",t=r.id===a.id||s===this.forms.length-1?s:s+1),this.$emit("dragUpdateList",t,r)}else{var c={api_info:e.item._underlying_vm_.api_info,workflow:"",id:"",key:"",name:e.item._underlying_vm_.name,type:e.item._underlying_vm_.type,desc:"",layout:"COL_6",validate_type:"REQUIRE",choice:[],showFeild:!0,is_builtin:!1,source_type:e.item._underlying_vm_.source_type||"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:"",meta:{},default:""};void 0===o[0]?(c.meta.layout_position="left",t=c.id===a.id||0===s?s:s-1):(c.meta.layout_position="right",t=c.id===a.id||s===this.forms.length-1?s:s+1),this.$emit("onAddFormClick",t,c)}},onFormEditClick:function(e){this.$emit("onFormEditClick",e)},onFormCloneClick:function(e){this.crtForm||this.$emit("fieldClone",e)},onEditCancel:function(){"add"===this.crtForm?this.$emit("cancelAdd"):this.$emit("update:crtForm","")},onEditConfirm:function(e){var t=this.forms.find((function(t){return t.id===e.id}));t?"COL_12"===e.layout?e.layout_position="":"COL_12"===t.layout&&(e.layout_position="left"):"COL_6"===e.layout&&(e.layout_position="left"),this.$emit("saveField",(0,n.default)({},t,e))}}}},MBfY:function(e,t,i){"use strict";i.r(t);var n=i("lnc2"),o=i("T2YI");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("kAVo");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"a2840042",null);r.options.__file="src/views/commonComponent/fieldComponent/member.vue",t.default=r.exports},MDWk:function(e,t,i){},MEtw:function(e,t,i){"use strict";i.r(t);var n=i("FO58"),o=i("rLYG");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Jimo"),i("GPtd");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"987056c6",null);r.options.__file="src/views/service/editService/ServiceFormStep.vue",t.default=r.exports},MG1K:function(e,t,i){"use strict";i.r(t);var n=i("1lNk"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},MI7q:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("GQeE")),o=r(i("gDS+")),a=r(i("14Xm")),s=r(i("D3Ub"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"getParam",components:{},props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},isStatic:{type:Boolean,default:function(){return!1}},isCustom:{type:Boolean,default:function(){return!1}},queryValue:{type:Object,default:function(){return{}}},entry:{type:String,default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')}}},computed:{},watch:{apiDetail:function(e,t){this.initData()}},mounted:function(){var e=this;return(0,s.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.changeInfo;case 2:return t.next=4,e.isStatic;case 4:return t.next=6,e.queryValue;case 6:return t.next=8,e.initData();case 8:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,JSON.parse((0,o.default)(e.apiDetail.req_params));case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:return i=t.t0,t.next=8,i.forEach((function(t){if(t.isCheck=!1,t.isSatisfied=!1,t.el=null,t.customValue=t.value||"",t.source_type="CUSTOM",t.value_key="",e.isStatic)t.value=e.queryValue[t.name]||"";else if(e.changeInfo.api_info&&(0,n.default)(e.changeInfo.api_info.req_params).length&&e.changeInfo.api_info.remote_api_id===e.apiDetail.id)if(/^\$\{params_.*\}$/.test(e.changeInfo.api_info.req_params[t.name]))t.source_type="FIELDS",t.value_key=e.changeInfo.api_info.req_params[t.name]?JSON.parse((0,o.default)(e.changeInfo.api_info.req_params[t.name])).replace(/^\$\{params_/,"").replace(/\}$/,""):"";else{var i=e.changeInfo.api_info.req_params[t.name];t.source_type="CUSTOM",t.value=i}}));case 8:return t.next=10,JSON.parse((0,o.default)(i));case 10:e.paramTableData=t.sent;case 11:case"end":return t.stop()}}),t,e)})))()},addNewItem:function(e){this.$emit("addNewItem",e)}}}},MImu:function(e,t,i){"use strict";i.r(t);var n=i("uv/p"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},MQva:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("gDS+")),o=c(i("14Xm")),a=c(i("D3Ub")),s=c(i("OE89")),r=c(i("VflG"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"nodeCondition",components:{exportTree:s.default},mixins:[r.default],props:{lineInfo:{type:Object,default:function(){return{}}},formInfo:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},stateList:{type:Array,default:function(){return[]}}},data:function(){return{booleanList:[{id:"1",name:"true"},{id:"0",name:"false"}],checkInfo:{assignors_type:!1,assignors:!1,processors_type:!1,processors:!1},scrollTopStatus:0}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},watch:{apiDetail:function(e,t){this.initData()}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t,e)})))()},globalChoiseFilter:function(e,t){return e.filter((function(e){switch(t){case"string":return-1!==["==","!=","startswith","endswith","not contains","contains"].indexOf(e.typeName);case"number":return-1!==["==","!=",">",">=","<","<="].indexOf(e.typeName);case"boolean":return-1!==["==","!="].indexOf(e.typeName);default:return!0}}))},addCondition:function(){var e=this,t={type:"and",checkInfo:!1,expressions:[{condition:"",key:"",value:"",name:"",choiceList:"",type:"string",organization:{assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1}}]};t.expressions.forEach((function(t){t.organization.assignorPerson=JSON.parse((0,n.default)(e.lineInfo.expressions[0].expressions[0].organization.assignorPerson))})),this.lineInfo.expressions.push(t)},delteCondition:function(e,t){1!==this.lineInfo.expressions.length&&this.lineInfo.expressions.splice(t,1)},addNode:function(e,t){var i={condition:"",key:"",value:"",name:"",choiceList:"",type:"string",organization:{assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1}};i.organization.assignorPerson=JSON.parse((0,n.default)(this.lineInfo.expressions[0].expressions[0].organization.assignorPerson)),e.expressions.splice(t+1,0,i)},deleteNode:function(e,t){1!==e.expressions.length&&e.expressions.splice(t,1)},showTree:function(e){var t=!e.organizaInfo.assignorShow;this.closeOther(),e.organizaInfo.assignorShow=t},closeOther:function(){this.lineInfo.expressions.forEach((function(e){e.expressions.forEach((function(e){e.organizaInfo.assignorShow=!1}))}))},recordCheckFn:function(e){var t=this;e.checkInfo=!1,null==e.children||e.children&&!e.children.length||e.children.forEach((function(e){t.recordCheckFn(e)}))},assignorToggle:function(){var e=this;arguments[1].type=arguments[0].type,arguments[1].name=arguments[0].name,arguments[1].key=arguments[0].ancestorsList_str,arguments[1].organization.assignorPerson.forEach((function(t){e.recordCheckFn(t)})),arguments[0].checkInfo=!0,arguments[1].organization.assignorTree=arguments[0],this.checkInfo.assignors=!1,this.closeTree(arguments[1])},closeTree:function(e){e.organizaInfo.assignorShow=!1},toggleChildren:function(){arguments[0].showChildren=!arguments[0].showChildren,arguments[1].organization.assignorPerson=JSON.parse((0,n.default)(arguments[1].organization.assignorPerson))}}}},Mf0c:function(e,t,i){"use strict";i.r(t);var n=i("G6uA"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},N3dC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("ygAv"),o=i("CeR/");t.default={name:"NodeTemplate",props:{node:{type:Object,default:function(){return{}}},canvasData:{type:Object,default:function(){return{}}}},data:function(){return{moveFlag:!1,clickSecond:!1,toolStatus:!1,valueInfo:{node:{},line:{}},typeList:[{type:"NORMAL",iconStyle:"icon-icon-person"},{type:"ROUTER",iconStyle:"icon-icon-person"},{type:"TASK",iconStyle:"icon-api-icon"},{type:"TASK-SOPS",iconStyle:"icon-task-node"},{type:"TASK-DEVOPS",iconStyle:"icon-devops-task-icon"},{type:"APPROVAL",iconStyle:"icon-approval-node"},{type:"SIGN",iconStyle:"icon-sign-node-white f18"}],clickList:[{type:"NORMAL",name:this.$t('m.treeinfo["手动节点"]'),iconStyle:"icon-icon-artificial"},{type:"TASK",name:this.$t('m.treeinfo["API节点"]'),iconStyle:"icon-api-node"},{type:"TASK-SOPS",name:this.$t('m.treeinfo["标准运维节点"]'),iconStyle:"icon-task-icon"},{type:"TASK-DEVOPS",name:this.$t('m["蓝盾节点"]'),iconStyle:"icon-devops-task-icon"},{type:"SIGN",name:this.$t("m.treeinfo['会签节点']"),iconStyle:"icon-sign-node"},{type:"APPROVAL",name:this.$t("m.treeinfo['审批节点']"),iconStyle:"icon-approval-node"},{type:"COVERAGE",name:this.$t('m.treeinfo["汇聚网关"]'),iconStyle:"icon-flow-branch"},{type:"ROUTER-P",name:this.$t('m.treeinfo["并行网关"]'),iconStyle:"icon-flow-convergence"},{type:"COPY",name:this.$t('m.treeinfo["复制节点"]'),iconStyle:"icon-copy-new"}],currentNode:{}}},mounted:function(){this.toolStatus=localStorage.getItem("toolStatus")||!1},methods:{hoverNode:function(e){e.nodeInfo&&e.nodeInfo.errorInfo&&(e.nodeInfo.errorInfo=!1)},moveDoneFn:function(e){this.moveFlag=!1;for(var t=document.getElementsByClassName("jsflow-node"),i=0;i<t.length;i++)t[i].style["z-index"]=101;document.getElementById(e.id)&&(document.getElementById(e.id).style["z-index"]=102)},moveFn:function(){this.moveFlag=!0},onNodeClick:function(e,t){this.currentNode=e;var i=Boolean(e.showMore);if(this.$set(e,"showMore",i),this.moveFlag){var n=this.canvasData.nodes.find((function(t){return t.id===e.id}));this.$store.commit("deployCommon/changeNodeInfo",n)}else;this.moveFlag=!1},clickNode:function(e,t){this.openconfigu()},rightClickNode:function(e,t){e&&(this.$emit("closeShow"),e.showMore=!0)},openconfigu:function(){var e=(0,n.deepClone)(this.node);Math.abs(e.x-this.currentNode.x)>3||Math.abs(e.y-this.currentNode.y)>3||"ROUTER-P"!==e.type&&"COVERAGE"!==e.type&&"START"!==e.type&&"END"!==e.type&&this.$emit("configuNode",e.nodeInfo)},closeNode:function(){this.node.showMore=!1},addNormal:function(e,t){var i=this;if(!this.clickSecond)if(this.clickSecond=!0,this.$store.commit("deployCommon/changeNodeStatus",!0),"COPY"!==t.type){var n=this.canvasData.lines.filter((function(t){return t.source.id===e.id})),o="NORMAL"===e.type||"TASK"===e.type?310:210,a={workflow:e.nodeInfo.workflow,name:"",type:t.type,is_terminable:!1,axis:{x:e.x+o,y:e.y+80*n.length},extras:{}};this.$store.dispatch("deployCommon/creatNode",{params:a}).then((function(a){i.valueInfo.node={id:"node_"+a.data.id,x:e.x+o,y:e.y+80*n.length,type:t.type,name:a.data.name,showMore:!1,nodeInfo:a.data},i.$emit("closeShow"),i.$emit("updateNode",i.valueInfo,t.type),i.addNewLine(e,a.data.id)})).catch((function(e){i.$bkMessage({message:e.data.msg,theme:"error"})})).finally((function(){i.clickSecond=!1,i.$store.commit("deployCommon/changeNodeStatus",!1)}))}else{var s=this.node.nodeInfo.id;this.$store.dispatch("deployCommon/copyNode",s).then((function(e){i.valueInfo.node={id:"node_"+e.data.id,x:e.data.axis.x-250,y:e.data.axis.y+100,type:e.data.type,name:e.data.name,showMore:!1,nodeInfo:e.data},i.$emit("closeShow"),i.$emit("updateNode",i.valueInfo,t.type)})).catch((function(e){i.$bkMessage({message:e.data.msg,theme:"error"})})).finally((function(){i.clickSecond=!1,i.$store.commit("deployCommon/changeNodeStatus",!1)}))}},addNewLine:function(e,t){var i=this,n={workflow:e.nodeInfo.workflow,name:this.$t('m.treeinfo["默认"]'),axis:{start:"Right",end:"Left"},from_state:e.nodeInfo.id,to_state:t};this.$store.dispatch("deployCommon/createLine",{lineParams:n}).then((function(t){i.valueInfo.line={source:{arrow:"Right",id:e.id},target:{arrow:"Left",id:i.valueInfo.node.id},lineInfo:t.data},i.$emit("fastAddNode",i.valueInfo),i.$emit("updateLine",i.valueInfo.line,"add")})).catch((function(e){(0,o.errorHandler)(e,i)}))},clickDelete:function(e){this.$emit("openDelete",e)},closeTool:function(){this.toolStatus=!0,localStorage.setItem("toolStatus",!0)}}}},NBCF:function(e,t,i){"use strict";i("FVR2")},NFkJ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("ukIK"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"sendMessage",components:{changeConductor:a.default},props:{itemInfo:{type:Object,default:function(){return{}}}},data:function(){return{trueStatus:!0,falseStatus:!1,activeName:"send_email_message",show:!0}},computed:{},created:function(){var e=this;this.itemInfo.sub_components.forEach((function(t){switch(e.$set(t,"checked",t.checked||!1),e.$set(t,"label",t.name),e.$set(t,"icon",""),t.key){case"send_email_message":t.icon="icon-email";break;case"send_sms_message":t.icon="icon-mobile";break;case"send_wechat_message":t.icon="icon-weixin"}t.name=t.key}))},mounted:function(){},methods:{changPanel:function(e){this.activeName=e},changePanelStatus:function(e,t){var i=this;this.show=!1,this.$nextTick((function(){e.checked=!0,i.itemInfo.sub_components.splice(t,1,e),i.show=!0}))}}}},NGZu:function(e,t,i){"use strict";i.r(t);var n=i("Pe0B"),o=i("VtRw");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("vSlL");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"030ce8aa",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/getParam.vue",t.default=r.exports},NLOC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("efIh"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"DATE",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){if(this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value),!this.item.val){var e=new Date;this.item.val=e,this.item.value=e}},methods:{}}},NPk7:function(e,t,i){"use strict";i.r(t);var n=i("qg2T"),o=i("Cyyo");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Ig0E");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"f01d3876",null);r.options.__file="src/components/renderview/tags/TagText.vue",t.default=r.exports},NREj:function(e,t,i){"use strict";i("xnXd")},NT7A:function(e,t,i){},NV0X:function(e,t,i){"use strict";i("BGW0")},NXOa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i("efIh")),o=a(i("FCVG"));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"CUSTOM-FORM",components:{RenderView:o.default},mixins:[n.default],props:{item:{type:Object,default:function(){}},fields:{type:Array,default:function(){return[]}}},data:function(){return{formData:[],context:{},errMessage:""}},watch:{"item.val":{handler:function(){this.conditionField(this.item,this.fields),this.initRenderView()},immediate:!0}},mounted:function(){this.item.value&&!this.item.val&&(this.item.val=this.item.value)},methods:{initRenderView:function(){this.errMessage="";try{var e="string"==typeof this.item.val?JSON.parse(this.item.val):this.item.val,t=e.form_data,i=e.schemes,n=e.config;this.formData=t,this.context={schemes:i,config:n}}catch(e){this.errMessage=e,this.formData=[]}}}}},NcGx:function(e,t,i){"use strict";i("SpgR")},NesJ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("efIh"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"DATETIME",mixins:[a.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){if(this.conditionField(this.item,this.fields),this.item.value&&!this.item.val&&(this.item.val=this.item.value),!this.item.val){var e=new Date;this.item.val=e,this.item.value=e}},methods:{}}},NoEz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[i("bk-table",{attrs:{data:e.tableList,size:"small"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"bk-more"},[i("span",{style:{paddingLeft:20*t.row.level+"px"}},[t.row.has_children?i("span",{class:["bk-icon","tree-expanded-icon",t.row.showChildren?"icon-down-shape":"icon-right-shape"],on:{click:function(i){return e.changeState(t.row)}}}):i("span",{staticClass:"bk-icon bk-more-icon"}),e._v(" "),i("span",[e._v(e._s(t.row.key||"--"))])])])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['类型']"),prop:"type"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['是否必须']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.desc}},[e._v(e._s(t.row.desc||"--"))])]}}])}),e._v(" "),e.isStatic?i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"270"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.customValue||"--")+"\n            ")]}}],null,!1,4172783685)}):e.isCustom?i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"270"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("bk-input",{staticClass:"bk-respone-input",attrs:{clearable:!0,type:"text",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.customValue,callback:function(i){e.$set(t.row,"customValue",i)},expression:"props.row.customValue"}})]}}])}):i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['引用为全局变量']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSelectAbled?[i("bk-checkbox",{staticStyle:{width:"40px",position:"absolute",top:"12px",left:"15px"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus,disabled:t.row.isSelectedKeyDisabled},on:{change:function(i){return e.selectOneKey(t.row)}},model:{value:t.row.isSelectedKey,callback:function(i){e.$set(t.row,"isSelectedKey",i)},expression:"props.row.isSelectedKey"}}),e._v(" "),i("bk-input",{staticClass:"bk-respone-input",class:{"bk-border-error":t.row.isCheck&&!t.row.isSelectedValue.toString()},attrs:{clearable:!0,type:"text",placeholder:e.$t("m.treeinfo['请输入变量名']"),disabled:t.row.isSelectedValueDisabled},model:{value:t.row.isSelectedValue,callback:function(i){e.$set(t.row,"isSelectedValue",i)},expression:"props.row.isSelectedValue"}})]:[i("span",[e._v("--")])]]}}])})],1)],1)},o=[];n._withStripped=!0},Noe1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{staticStyle:{"font-size":"0"},attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("rich-text-editor",{attrs:{"full-title":e.item.name,id:e.item.key,"is-preview":e.disabled},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},NsTJ:function(e,t,i){"use strict";i("vdTl")},Nxk6:function(e,t,i){i("dbV7"),e.exports=9007199254740991},O1Wb:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,searchable:"",multiple:"","font-size":"medium",placeholder:e.item.desc},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}},e._l(e.options,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},O4mU:function(e,t,i){"use strict";i.r(t);var n=i("8is8"),o=i("kjRb");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("wuvY");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"fe4b638e",null);r.options.__file="src/views/service/editService/FormEditItem.vue",t.default=r.exports},O4pD:function(e,t,i){"use strict";i.r(t);var n=i("RnPO"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},OE89:function(e,t,i){"use strict";i.r(t);var n=i("TvXt"),o=i("O4pD");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("7YIX");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"5bcb1d8e",null);r.options.__file="src/views/commonComponent/treeInfo/exportTree.vue",t.default=r.exports},OWBw:function(e,t,i){"use strict";i.r(t);var n=i("9KRo"),o=i("A/4B");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("NcGx");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"f442f8ec",null);r.options.__file="src/views/service/editService/index.vue",t.default=r.exports},OZnK:function(e,t,i){"use strict";i.r(t);var n=i("Hlvs"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},OjZH:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("WgRI"),a=(n=o)&&n.__esModule?n:{default:n},s=i("ygAv");t.default={name:"SelectTree",components:{Tree:a.default},model:{prop:"value",event:"selected"},props:{list:{type:Array,default:function(){return[]}},value:{type:[Number,String,Array],default:""},placeholder:{type:String,default:""},loading:{type:Boolean,default:!1},extCls:{type:String,default:""},organizationLoading:Boolean},data:function(){return{isShowTree:!1,displayName:"",displayList:[],checked:null}},watch:{list:function(){this.initData()},value:function(e){this.initData()},loading:function(){this.initData()}},created:function(){this.initData()},methods:{initData:function(){var e=this;this.displayList=(0,s.deepClone)(this.list),this.displayList.length&&this.displayList.forEach((function(t){e.setCheckedValue(t)})),this.value&&this.checked&&this.displayList.forEach((function(t){e.openChildren(t)})),this.checked&&this.$emit("change",(0,s.deepClone)(this.checked))},setCheckedValue:function(e){var t=this;if(this.$set(e,"checkInfo",!1),this.$set(e,"has_children",!(!e.children||!e.children.length)),this.value&&String(this.value)===String(e.id))return e.checkInfo=!0,this.checked=e,void this.setDispalyName();e.has_children&&(this.$set(e,"showChildren",!1),e.children.forEach((function(e){t.setCheckedValue(e)})))},openChildren:function(e){var t=this;this.$set(e,"showChildren",!1),this.$set(e,"showChildren",this.checked.route.some((function(t){return String(t.id)===String(e.id)}))),e.children&&e.children.length&&e.children.forEach((function(e){t.openChildren(e)}))},setDispalyName:function(){var e=[];this.checked.route.length&&(e=this.checked.route.map((function(e){return e.name}))),e.push(this.checked.name),this.displayName=e.join("/")},showTree:function(){this.loading||(this.isShowTree=!0)},closeTree:function(){this.isShowTree=!1},toggleInfo:function(e){this.checked=e,this.setDispalyName(),this.cancelAllSectedStatus(),this.$set(e,"checkInfo",!0),this.$emit("selected",e.id),this.$emit("change",(0,s.deepClone)(e)),this.closeTree()},cancelAllSectedStatus:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.displayList;t.forEach((function(t){e.$set(t,"checkInfo",!1),t.children&&t.children.length&&e.cancelAllSectedStatus(t.children)}))},toggleChildren:function(e){this.$set(e,"showChildren",!e.showChildren)}}}},OkDz:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Jwqd"),o={column:{type:Array,default:function(){return[{name:"操作",type:"text",key:"column1"},{name:"关联相关内容",key:"column2",scheme:"table_text_scheme",attrs:{}},{name:"申请期限",type:"text",key:"column3",attrs:{sort:!0}}]}},value:{type:Array,default:function(){return[]}}};t.default={name:"TagTable",components:{ViewItem:function(){return Promise.resolve().then(i.bind(null,"UsFA"))}},mixins:[(0,n.getFormMixins)(o)],methods:{getScheme:function(e,t){var i=this.getContext().schemes;return t&&t.scheme&&i[t.scheme]?i[t.scheme]:e.scheme?i[e.scheme]:t&&t.type?{type:t.type}:{type:e.type}}}}},OkKR:function(e,t,i){"use strict";i("RF1O")},Ox22:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"templateNode",props:{node:{type:Object,default:function(){return{}}}},data:function(){return{typeList:[{type:"NORMAL",iconStyle:"icon-icon-person"},{type:"ROUTER",iconStyle:"icon-icon-person"},{type:"TASK",iconStyle:"icon-api-icon"},{type:"TASK-SOPS",iconStyle:"icon-task-node"},{type:"SIGN",iconStyle:"icon-sign-node-white"},{type:"APPROVAL",iconStyle:"icon-approval-node"}]}},methods:{}}},"P+p4":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("P2sY"),a=(n=o)&&n.__esModule?n:{default:n},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i("wsa1"));var r={language:"javascript",theme:"vs-dark",automaticLayout:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"same"};t.default={name:"CodeEditor",props:{value:{type:String,default:""},options:{type:Object,default:function(){return{}}}},data:function(){return{editorOptions:(0,a.default)({},r,this.options,{value:this.value}),monacoInstance:null}},watch:{value:function(e){e!==this.monacoInstance.getValue()&&this.monacoInstance.setValue(e)},options:{deep:!0,handler:function(e){this.editorOptions=(0,a.default)({},r,e,{value:this.value}),this.updateOptions()}}},mounted:function(){this.initIntance()},beforeDestroy:function(){this.monacoInstance&&this.monacoInstance.dispose()},methods:{initIntance:function(){var e=this;this.monacoInstance=s.editor.create(this.$el,this.editorOptions);var t=this.monacoInstance.getModel();if(t.setEOL(0),this.value.indexOf("\r\n")>-1){var i=document.createElement("textarea");i.value=this.value,this.$emit("input",i.value)}t.onDidChangeContent((function(t){var i=e.monacoInstance.getValue();e.$emit("input",i)})),this.monacoInstance.addCommand(s.KeyMod.CtrlCmd|s.KeyCode.KEY_S,(function(){var t=e.monacoInstance.getValue();e.$emit("saveContent",t)}))},updateOptions:function(){this.monacoInstance.updateOptions(this.editorOptions)}}}},P0kt:function(e,t,i){"use strict";i.r(t);var n=i("/5i8"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},PAo4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("QbLZ")),o=s(i("tQ05")),a=i("L2JU");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"modifyFields",components:{fieldInfo:o.default},props:{fieldSchema:{type:Array,default:function(){return[]}}},data:function(){return{fieldKeyItem:"",fieldValueItem:"",fieldValue:"",show:!0,sourceTypeList:[{id:1,key:"custom",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"reference",name:this.$t('m.treeinfo["引用变量"]')}],variableList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,a.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},mounted:function(){this.variableList=this.triggerVariables,this.initData()},methods:{initData:function(){var e=this;if(this.fieldSchema.forEach((function(t){e.$set(t,"referenceType",t.ref_type||"custom")})),this.fieldKeyItem=this.fieldSchema[0],this.fieldValueItem=this.fieldSchema[1],this.$set(this.fieldValueItem,"itemInfo",[]),this.fieldKeyItem.value){var t=this.fieldKeyItem.choice.filter((function(t){return t.key===e.fieldKeyItem.value}));t[0].value=t[0].val=this.fieldValueItem.value,this.fieldValueItem.itemInfo=t,this.show=!0}},selectedFieldKey:function(e){var t=this;this.fieldValueItem.itemInfo.splice(0,this.fieldValueItem.itemInfo.length),this.show=!1,this.$nextTick((function(){var i=t.fieldKeyItem.choice.find((function(t){return t.key===e}));i.showFeild=!0,t.fieldValueItem.itemInfo.push(i),t.show=!0}))},selectedReference:function(){this.fieldValueItem.itemInfo[0].value=""}}}},PGA1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("GQeE")),o=f(i("P2sY")),a=f(i("14Xm")),s=f(i("D3Ub")),r=f(i("I1Ty")),c=i("CeR/"),l=i("ygAv"),u=f(i("efIh")),d=f(i("PaSM"));function f(e){return e&&e.__esModule?e:{default:e}}t.default={name:"SOPS_TEMPLATE",components:{NoData:r.default},mixins:[u.default,d.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},basicInfomation:{type:Object,default:function(){return{}}},typeInfo:{type:String,default:function(){return""}},disabled:{type:Boolean,default:!1}},data:function(){return{disabledRenderForm:!1,editTask:!0,constantDefaultValue:{},templateList:[],planList:[],sopsTaskList:[],optionalNodeIdList:[],hookedVarList:{},quoteVars:[],quoteVarsLoading:!1,quoteErrors:[],configLoading:!1,formLoading:!1,loading:{templateList:!1,sopsTaskList:!1,plan:!1},lastEditTaskName:"",rules:{},previewSopsTaskUrl:""}},computed:{bkBizId:function(){return this.basicInfomation&&-1!==this.basicInfomation.bk_biz_id?this.basicInfomation.bk_biz_id:""},showRenderForm:function(){return this.item.sopsContent.constants.filter((function(e){return"show"===e.show_type})).length>0},formOptions:function(){return{showRequired:!0,showGroup:!0,showLabel:!0,showHook:!0,showDesc:!0,formEdit:!this.disabled&&!this.disabledRenderForm}}},created:function(){this.item.sopsContent||this.$set(this.item,"sopsContent",{id:"",sopsTask:{id:"",template_id:""},planId:"",createWay:"template",exclude_task_nodes_id:[],formData:{},context:{project:{id:"",bk_biz_id:"",name:"",from_cmdb:!0},bk_biz_id:"",site_url:window.SITE_URL_SOPS+window.PREFIX_SOPS},constants:[]}),this.rules.id=this.checkCommonRules("select").select,this.rules.sopsTaskId=this.checkCommonRules("select").select},mounted:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.item.value&&(e.item.sopsContent.id=e.item.value.id,(i=e.templateList.find((function(t){return t.id===e.item.sopsContent.id})))&&void 0!==i.bk_biz_id&&(e.item.sopsContent.context.project.bk_biz_id=i.bk_biz_id,e.item.sopsContent.context.project.id=e.item.sopsContent.id,e.item.sopsContent.context.project.name=e.item.name),e.item.sopsContent.constants=e.item.value.constants,e.item.value.constants.forEach((function(t){t.value&&(e.item.sopsContent.formData[t.key]=(0,l.deepClone)(t.value)),t.is_quoted&&(e.hookedVarList[t.key]=!0)}))),e.editTask=!!e.item.value,e.editTask&&e.item.value.id&&e.getTemplateDetail(e.item.value.bk_biz_id,e.item.value.id),e.getTicketOutput(),e.getTemplateList();case 5:case"end":return t.stop()}}),t,e)})))()},methods:{getTicketOutput:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.quoteVarsLoading=!0,t.next=4,e.$store.dispatch("ticket/getTicketOutput",e.basicInfomation.id);case 4:i=t.sent,e.quoteVars=i.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:return t.prev=11,e.quoteVarsLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,e,[[0,8,11,14]])})))()},onSelectTpl:function(e){var t=this;this.item.sopsContent.id=e;var i=this.templateList.find((function(e){return e.id===t.item.sopsContent.id}));i&&void 0!==i.bk_biz_id&&(this.item.sopsContent.context.project.bk_biz_id=i.bk_biz_id,this.item.sopsContent.context.project.id=i.project_id,this.item.sopsContent.context.project.name=i.project_name),this.hookedVarList={},this.quoteErrors=[],this.getTempaltePlanList(),this.getTemplateDetail(i.bk_biz_id,this.item.sopsContent.id)},onSopsTaskChange:function(e){if(!e)return!1;this.hookedVarList={},this.quoteErrors=[],this.setTaskNameAndDisable(e),this.getSopsTaskDetail(e)},setTaskNameAndDisable:function(e){var t=this.fields.find((function(e){return"task_name"===e.key})),i=this.sopsTaskList.find((function(t){return t.id===e}));t&&(this.lastEditTaskName=t.val||t.value,t.val=i.name,t.value=i.name,t.is_readonly=!0),this.disabledRenderForm="started_task"===this.item.sopsContent.createWay},clearTaskNameAndDisable:function(){if(this.item.sopsContent.sopsTask.id){var e=this.fields.find((function(e){return"task_name"===e.key}));e&&(e.val=this.lastEditTaskName,e.value=this.lastEditTaskName,e.is_readonly=!1)}},getSopsTaskDetail:function(e){var t=this;return(0,s.default)(a.default.mark((function i(){var n;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.configLoading=!0,n={bk_biz_id:t.bkBizId,task_id:e},i.next=4,t.$store.dispatch("taskFlow/getSopsTaskDetail",n).then((function(e){t.previewSopsTaskUrl=e.data.task_url;var i=[];for(var n in e.data.constants)"show"===e.data.constants[n].show_type&&i.push(e.data.constants[n]);i.sort((function(e,t){return e-t})),t.item.sopsContent.constants=i,t.item.sopsContent.sopsTask.template_id=e.data.template_id})).catch((function(e){(0,c.errorHandler)(e,t)})).finally((function(){t.configLoading=!1}));case 4:case"end":return i.stop()}}),i,t)})))()},getTemplateDetail:function(e,t){var i=this;this.formLoading=!0;var n={template_id:t,bk_biz_id:e||""};this.$store.dispatch("getTemplateDetail",n).then((function(e){var t=[];e.data.constants.forEach((function(e){var n=i.item.sopsContent.constants.find((function(t){return t.key===e.key}));i.editTask&&!n||(n&&(e=(0,o.default)(n,e)),e.is_meta&&(e.meta=(0,l.deepClone)(e)),i.item.value&&(e.value=(0,l.deepClone)(i.item.sopsContent.formData[e.key])),i.constantDefaultValue[e.key]=(0,l.deepClone)(e.value),"show"===e.show_type&&t.push(e))})),i.item.sopsContent.constants=t,i.optionalNodeIdList=e.data.optional_ids})).catch((function(e){(0,c.errorHandler)(e,i)})).finally((function(){i.formLoading=!1}))},getTemplateList:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading.templateList=!0,i={bk_biz_id:e.bkBizId,with_common:!0},t.next=4,e.$store.dispatch("getTemplateList",i).then((function(t){e.templateList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.loading.templateList=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},getSopsTaskList:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading.sopsTaskList=!0,i={bk_biz_id:e.bkBizId,is_started:"started_task"===e.item.sopsContent.createWay},t.next=4,e.$store.dispatch("taskFlow/getSopsTask",i).then((function(t){e.sopsTaskList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.loading.sopsTaskList=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},getTempaltePlanList:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var i,n,o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.item.sopsContent.id,n=e.templateList.find((function(e){return e.id===i})),e.planList=[],e.loading.plan=!0,o={bk_biz_id:n.bk_biz_id,template_id:n.id},t.next=7,e.$store.dispatch("getTemplatePlanList",o).then((function(t){e.planList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.loading.plan=!1}));case 7:case"end":return t.stop()}}),t,e)})))()},onplanSelect:function(e){var t=this;return(0,s.default)(a.default.mark((function i(){var n,o,s,r,c;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n=[],e.length>0?(e.forEach((function(e){var i=t.planList.find((function(t){return t.id===e}));if(i.data)for(var o=JSON.parse(i.data),a=0;a<o.length;a++)-1===n.indexOf(o[a])&&n.push(o[a])})),t.item.sopsContent.exclude_task_nodes_id=t.optionalNodeIdList.filter((function(e){return!n.includes(e)}))):t.item.sopsContent.exclude_task_nodes_id=[],o=t.templateList.find((function(e){return e.id===t.item.sopsContent.id})),i.prev=3,t.formLoading=!0,i.next=7,t.$store.dispatch("taskFlow/getSopsPreview",{bk_biz_id:o.bk_biz_id,template_id:o.id,exclude_task_nodes_id:t.item.sopsContent.exclude_task_nodes_id});case 7:for(c in s=i.sent,r=[],s.data.pipeline_tree.constants)"show"===s.data.pipeline_tree.constants[c].show_type&&r.push(s.data.pipeline_tree.constants[c]);r.sort((function(e,t){return e.index-t.index})),t.item.sopsContent.constants=r,i.next=17;break;case 14:i.prev=14,i.t0=i.catch(3),console.error(i.t0);case 17:return i.prev=17,t.formLoading=!1,i.finish(17);case 20:case"end":return i.stop()}}),i,t,[[3,14,17,20]])})))()},jumpToSops:function(){window.open(this.previewSopsTaskUrl)},handleCreateWayChange:function(e){this.clearTaskNameAndDisable(),this.item.sopsContent.id="",this.item.sopsContent.planId="",this.item.sopsContent.constants=[],this.item.sopsContent.sopsTask.id="","task"===e||"started_task"===e?this.getSopsTaskList():this.getTemplateList()},onReloadPlanBtnClick:function(){this.item.sopsContent.id&&this.getTempaltePlanList()},validate:function(){var e=this;this.$refs.taskForm.validate();var t=!0;this.disabled||this.disabledRenderForm?t=!0:this.$refs.renderForm&&(t=this.$refs.renderForm.validate());var i="template"===this.item.sopsContent.createWay?!!this.item.sopsContent.id:!!this.item.sopsContent.sopsTask.id,o=(0,n.default)(this.hookedVarList).every((function(t){return!e.hookedVarList[t]||""!==e.item.sopsContent.formData[t]||(e.quoteErrors.push(t),!1)}));return t&&i&&o},jumpToSopsSelectSchemePage:function(){var e=this.item.sopsContent.id,t="taskflow/newtask/"+this.templateList.find((function(t){return t.id===e})).project_id+"/selectnode/?template_id="+e+"&entrance=templateEdit";window.open(window.SOPS_URL+t,"__blank")},onHookChange:function(e,t){this.$set(this.hookedVarList,t.tag_code,e);var i=this.item.sopsContent.constants.find((function(e){return e.key===t.tag_code}));if(i.is_quoted=e,e)this.item.sopsContent.formData[t.tag_code]="";else{this.item.sopsContent.formData[t.tag_code]=i?(0,l.deepClone)(this.constantDefaultValue[t.tag_code]):"";var n=this.quoteErrors.findIndex((function(e){return e===t.tag_code}));n>-1&&this.quoteErrors.splice(n,1)}},onSelectVar:function(e,t){this.item.sopsContent.formData[t.tag_code]="${"+e+"}";var i=this.quoteErrors.findIndex((function(e){return e===t.tag_code}));i>-1&&this.quoteErrors.splice(i,1)}}}},PIEm:function(e,t,i){"use strict";i.r(t);var n=i("Dxj1"),o=i("BKtx");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("291A");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"38e63258",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/dealPerson.vue",t.default=r.exports},PRQd:function(e,t,i){"use strict";i.r(t);var n=i("7J8O"),o=i("f1Q0");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("vef3");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"636627f5",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/fieldConfig.vue",t.default=r.exports},Pe0B:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[i("bk-table",{attrs:{data:e.paramTableData,size:"small"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),prop:"name"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.desc}},[e._v(e._s(t.row.desc||"--"))])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isStatic?[e._v("\n                    "+e._s(t.row.customValue||"--")+"\n                ")]:e.isCustom?[i("bk-input",{attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.customValue,callback:function(i){e.$set(t.row,"customValue",i)},expression:"props.row.customValue"}})]:[i("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:t.row.source_type,callback:function(i){e.$set(t.row,"source_type",i)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"CUSTOM"===t.row.source_type?i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[i("bk-input",{class:{"bk-border-error":t.row.isCheck&&!t.row.value.toString()},attrs:{clearable:!0,placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}})],1):i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[i("bk-select",{class:{"bk-border-error":t.row.isCheck&&!t.row.value.toString()},attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:t.row.value_key,callback:function(i){e.$set(t.row,"value_key",i)},expression:"props.row.value_key"}},[e._l(e.stateList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),e._v(" "),"addField"!==e.entry?[i("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"extension"},on:{click:function(i){return e.addNewItem(t.row)}},slot:"extension"},[i("i",{staticClass:"bk-icon icon-plus-circle mr10"}),e._v(e._s(e.$t('m.treeinfo["添加变量"]'))+"\n                                ")])]:e._e()],2)],1)]]}}])})],1)],1)},o=[];n._withStripped=!0},PwIM:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mt20 mb20"},[e.openFunction.TRIGGER_SWITCH&&"workflow"!==e.origin&&"transition"!==e.origin?i("div",{staticClass:"more-configuration",attrs:{"data-test-id":"trigger-div-showMoreConfig"},on:{click:function(t){e.showMoreConfig=!e.showMoreConfig}}},[e.showMoreConfig?i("i",{staticClass:"bk-icon icon-up-shape"}):i("i",{staticClass:"bk-icon icon-down-shape"}),e._v(" "),i("span",[e._v(e._s(e.$t("m.taskTemplate['高级配置']")))])]):e._e(),e._v(" "),e.showMoreConfig?i("div",{staticClass:"common-section-card-block mt20",class:[{"inner-mode":"workflow"===e.origin||"transition"===e.origin}]},[i("label",{staticClass:"common-section-card-label"},[e._v("\n            "+e._s(e.$t("m.newCommon['触发器']"))+"\n        ")]),e._v(" "),i("div",{staticClass:"common-section-card-body"},[e.showMoreConfig?[i("collapse-transition",[i("div",[i("div",[i("ul",{staticClass:"bk-trigger-content"},[e._l(e.boundTriggerList,(function(t,n){return i("li",{key:n,class:{"li-transition":"transition"===e.origin},on:{click:function(i){return i.stopPropagation(),e.openNew("add",t)}}},[i("span",{staticClass:"bk-trigger-icon"},[i("i",{staticClass:"bk-itsm-icon icon-info-circle",class:[t.iconKey],staticStyle:{"font-size":"24px"}})]),e._v(" "),i("span",{staticClass:"bk-trigger-name",attrs:{title:t.name}},[e._v(e._s(t.name||"--")+"\n                                        "),t.is_draft?i("span",{staticStyle:{color:"#3A84FF"}},[e._v(e._s(e.$t('m.taskTemplate["(草稿)"]')))]):e._e()]),e._v(" "),i("span",{staticClass:"bk-trigger-delete"},[i("i",{staticClass:"bk-icon icon-delete",on:{click:function(i){return i.stopPropagation(),e.delTrigger(t)}}})])])})),e._v(" "),i("bk-dropdown-menu",{staticStyle:{float:"left"},attrs:{trigger:"click"}},[i("div",{staticClass:"bk-trigger-add",attrs:{slot:"dropdown-trigger",title:e.$t("m.taskTemplate['添加触发器']")},slot:"dropdown-trigger"},[i("i",{staticClass:"bk-icon icon-plus"})]),e._v(" "),i("ul",{staticClass:"bk-dropdown-list",attrs:{slot:"dropdown-content"},slot:"dropdown-content"},[i("li",[i("a",{attrs:{href:"javascript:;","data-test-id":"taskTemplate-li-addTrigger"},on:{click:function(t){return e.openNew("add")}}},[e._v(e._s(e.$t("m.taskTemplate['新建']")))])]),e._v(" "),i("li",[i("a",{attrs:{href:"javascript:;","data-test-id":"taskTemplate-li-quoteCommonTrigger"},on:{click:function(t){return e.openNew("cite")}}},[e._v(e._s(e.$t("m.taskTemplate['引用公共触发器']")))])])])])],2)])])])]:e._e()],2),e._v(" "),[i("bk-dialog",{attrs:{theme:"primary",width:"660","mask-close":!1},model:{value:e.triggerDialogInfo.isShow,callback:function(t){e.$set(e.triggerDialogInfo,"isShow",t)},expression:"triggerDialogInfo.isShow"}},[i("div",{staticClass:"trigger-dialog-header",attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(e.$t("m.taskTemplate['引用公共触发器']")))]),e._v(" "),i("div",{staticClass:"bk-search-key"},[i("bk-input",{attrs:{clearable:!0,"right-icon":"bk-icon icon-search"},on:{enter:e.searchInfo,clear:e.clearSearch},model:{value:e.triggerDialogInfo.searchKey,callback:function(t){e.$set(e.triggerDialogInfo,"searchKey",t)},expression:"triggerDialogInfo.searchKey"}})],1)]),e._v(" "),i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.triggerDialogInfo.listLoading},expression:"{ isLoading: triggerDialogInfo.listLoading }"}],staticClass:"trigger-dialog-box"},[0===e.triggerDialogInfo.list.length?i("p",{staticClass:"dialog-none-content"},[i("i",{staticClass:"bk-icon icon-info-circle"}),e._v(" "),i("span",[e._v(e._s(e.$t("m.taskTemplate['暂无匹配的公共触发器，']")))]),e._v(" "),i("span",{staticClass:"bk-primary",on:{click:e.newTrigger}},[e._v(e._s(e.$t("m.taskTemplate['跳转创建']")))])]):[i("span",[e._v(e._s(e.$t("m.taskTemplate['根据您当前的引用位置，系统已筛选出适用的公共触发器。']")))]),e._v(" "),i("ul",{staticClass:"bk-trigger-content"},e._l(e.triggerDialogInfo.list,(function(t,n){return i("li",{key:n,class:{"li-checked":t.checked},on:{click:function(e){t.checked=!t.checked}}},[i("span",{staticClass:"bk-trigger-icon"},[i("i",{staticClass:"bk-itsm-icon icon-info-circle",class:[t.iconKey],staticStyle:{"font-size":"24px"}})]),e._v(" "),i("span",{staticClass:"bk-trigger-name",attrs:{title:t.name}},[e._v(e._s(t.name||"--"))]),e._v(" "),i("span",{staticClass:"bk-trigger-delete"},[i("bk-checkbox",{attrs:{value:t.checked}})],1)])})),0)]],2),e._v(" "),i("div",{staticClass:"trigger-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("bk-checkbox",{attrs:{value:Boolean(e.triggerDialogInfo.list.length===e.citeList.length&&e.triggerDialogInfo.list.length),"ext-cls":"checkbox",disabled:!e.triggerDialogInfo.list.length},on:{change:e.selectAllFn}},[e._v(e._s(e.$t("m.taskTemplate['全选']")))]),e._v(" "),i("span",[e._v(e._s(e.$t("m.taskTemplate['已选']"))),i("span",[e._v(e._s(e.citeList.length))]),e._v("个")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"common-trigger-confirm",title:e.$t("m.taskTemplate['确定']")},on:{click:e.citeTrigger}},[e._v("\n                        "+e._s(e.$t("m.taskTemplate['确定']"))+"\n                    ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default",title:e.$t("m.taskTemplate['取消']")},on:{click:e.initDialogInfo}},[e._v("\n                        "+e._s(e.$t("m.taskTemplate['取消']"))+"\n                    ")])],1)])],e._v(" "),[i("bk-sideslider",{attrs:{"is-show":e.triggerSliderInfo.isShow,title:e.triggerSliderInfo.title,width:e.triggerSliderInfo.width},on:{"update:isShow":function(t){return e.$set(e.triggerSliderInfo,"isShow",t)},"update:is-show":function(t){return e.$set(e.triggerSliderInfo,"isShow",t)}}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.triggerSliderInfo.addLoading},expression:"{ isLoading: triggerSliderInfo.addLoading }"}],staticStyle:{"min-height":"300px"},attrs:{slot:"content"},slot:"content"},[e.triggerSliderInfo.isShow?i("add-trigger",{attrs:{"node-type":e.nodeType,"trigger-info":e.triggerSliderInfo.item,"origin-info-to-trigger":e.originInfoToTrigger},on:{closeTrigger:function(t){e.triggerSliderInfo.isShow=!1},getList:e.getBoundTriggerList}}):e._e()],1)])]],2):e._e()])},o=[];n._withStripped=!0},Q3ZP:function(e,t,i){"use strict";i.r(t);var n=i("aorS"),o=i("ymPp");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"4f8f8e19",null);r.options.__file="src/views/commonComponent/fieldComponent/table.vue",t.default=r.exports},"QGI/":function(e,t,i){"use strict";i("nUUp")},QKTH:function(e,t,i){},QcZ3:function(e,t,i){},R1Hl:function(e,t,i){"use strict";i("rv5B")},R5iJ:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojNzM3OTg3O30KPC9zdHlsZT4KPGc+Cgk8cmVjdCB4PSI1MTIiIHk9IjIyNCIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSI0MTYiIHk9IjI4OCIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cmVjdCB4PSI1MTIiIHk9IjM1MiIgY2xhc3M9InN0MCIgd2lkdGg9Ijk2IiBoZWlnaHQ9IjY0Ii8+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDE2LDY0MGgxOTJWNDgwaC05NnYtNjRoLTk2VjY0MHogTTQ2NCw1MjhoOTZ2NjRoLTk2VjUyOHoiLz4KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05Niw5NnY4MzJoODMyVjk2SDk2eiBNODY0LDg2NEgxNjBWMTYwaDI1NnY2NGg5NnYtNjRoMzUyVjg2NHoiLz4KPC9nPgo8L3N2Zz4K"},R6Sx:function(e,t,i){"use strict";i("NT7A")},RF1O:function(e,t,i){},RPM2:function(e,t,i){"use strict";i.r(t);var n=i("U/zI"),o=i("MImu");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Z0RM");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"50756058",null);r.options.__file="src/views/service/editService/FormViewItem.vue",t.default=r.exports},RPzc:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-data-source"},[i("bk-select",{attrs:{"ext-cls":e.typeClass,clearable:!1,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,searchable:""},on:{selected:e.changeSource},model:{value:e.formInfo.source_type,callback:function(t){e.$set(e.formInfo,"source_type",t)},expression:"formInfo.source_type"}},e._l(e.sourceList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"DATADICT"===e.formInfo.source_type?[i("bk-select",{attrs:{"ext-cls":"bk-halfline-item",clearable:!1,searchable:""},model:{value:e.dictionaryData.check,callback:function(t){e.$set(e.dictionaryData,"check",t)},expression:"dictionaryData.check"}},e._l(e.dictionaryData.list,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"API"===e.formInfo.source_type?[i("bk-select",{attrs:{"ext-cls":"bk-threeline-item bk-halfline-margin",placeholder:e.$t("m.treeinfo['请选择接入系统']"),clearable:!1,loading:e.isSystemLoading,searchable:""},on:{selected:e.changeApiSystem},model:{value:e.apiInfo.remote_system_id,callback:function(t){e.$set(e.apiInfo,"remote_system_id",t)},expression:"apiInfo.remote_system_id"}},e._l(e.apiSysList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),i("bk-select",{attrs:{"ext-cls":"bk-threeline-item",placeholder:e.$t("m.treeinfo['请选择接口']"),clearable:!1,loading:e.isApiLoading,searchable:""},on:{selected:e.changeApiPort},model:{value:e.apiInfo.remote_api_id,callback:function(t){e.$set(e.apiInfo,"remote_api_id",t)},expression:"apiInfo.remote_api_id"}},e._l(e.apiPortList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:e._e(),e._v(" "),"RPC"===e.formInfo.source_type?[i("bk-select",{attrs:{"ext-cls":"bk-halfline-item",clearable:!1,searchable:""},on:{selected:e.changeRpc},model:{value:e.prcData.check,callback:function(t){e.$set(e.prcData,"check",t)},expression:"prcData.check"}},e._l(e.prcData.list,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2)},o=[];n._withStripped=!0},RQEQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-date-picker",{class:{"bk-border-error":e.item.checkValue},attrs:{type:"datetime",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.$t("m.newCommon['选择日期时间']")},on:{"open-change":function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},Rg1I:function(e,t,i){},RgGx:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading: isLoading }"}],staticClass:"bk-hidden-conditions",on:{click:function(t){e.checkStatus=!1}}},[i("div",{staticClass:"bk-form-content",staticStyle:{"margin-left":"0"}},[i("p",{staticClass:"bk-form-p"},[e._v(e._s(e.$t("m.treeinfo['条件组间关系']")))]),e._v(" "),i("bk-radio-group",{model:{value:e.conditionType,callback:function(t){e.conditionType=t},expression:"conditionType"}},[i("bk-radio",{attrs:{value:"and","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['且']")))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t("m.treeinfo['或']")))])],1)],1),e._v(" "),e.checkStatus?i("p",{staticClass:"bk-error-msg"},[e._v(e._s(e.$t("m.treeinfo['关系名称，关系表达式，关系值不能为空']")))]):e._e(),e._v(" "),i("i",{staticClass:"bk-icon icon-close",on:{click:e.clearCondition}}),e._v(" "),e._l(e.listInfo,(function(t,n){return i("div",{key:n,staticClass:"bk-between-form",class:{mt20:n}},[i("bk-select",{staticStyle:{width:"182px",float:"left","margin-right":"10px"},attrs:{searchable:""},on:{selected:function(i){for(var n=arguments.length,o=Array(n);n--;)o[n]=arguments[n];return e.changeName.apply(void 0,o.concat([t]))}},model:{value:t.key,callback:function(i){e.$set(t,"key",i)},expression:"node.key"}},e._l(e.fieldList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),i("bk-select",{staticStyle:{width:"120px",float:"left","margin-right":"10px"},attrs:{searchable:""},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"node.condition"}},e._l(t.betweenList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"SELECT"===t.type||"MULTISELECT"===t.type||"RADIO"===t.type||"CHECKBOX"===t.type||"MEMBERS"===t.type||"TREESELECT"===t.type?[t.choiceList.length?[i("bk-select",{attrs:{"ext-cls":"bk-form-style",searchable:"",multiple:t.multiSelect},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"node.value"}},e._l(t.choiceList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:[i("bk-input",{attrs:{"ext-cls":"bk-form-style",type:"INT"===t.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入关系值']")},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"node.value"}})]]:"DATE"===t.type||"DATETIME"===t.type?[i("bk-date-picker",{attrs:{"ext-cls":"bk-form-style",type:"DATETIME"===t.type?"datetime":"date"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"node.value"}})]:[i("bk-input",{attrs:{"ext-cls":"bk-form-style",type:"INT"===t.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入关系值']")},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"node.value"}})],e._v(" "),i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addNode(t,n)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.listInfo.length},on:{click:function(i){return e.deleteNode(t,n)}}})])],2)}))],2)},o=[];n._withStripped=!0},RnPO:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("2eEL"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"exportTree",components:{collapseTransition:a.default},props:{treeDataList:{type:Array,default:[]},treeIndex:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+15*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e)},selectItem:function(e){this.$emit("selectItem",e)}}}},S1Ju:function(e,t,i){"use strict";i("lMr9")},SAMo:function(e,t,i){"use strict";i.r(t);var n=i("K/3P"),o=i("AFtY");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("DcOk");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"28a42431",null);r.options.__file="src/views/service/editService/ServiceForm.vue",t.default=r.exports},SO4U:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"CUSTOMTABLE",props:{item:{type:Object,required:!0,default:function(){}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{multiSelect:!0}},watch:{"item.val":function(){if(""===this.item.val){this.item.val=[];for(var e={},t=0;t<this.item.meta.columns.length;t++){e[this.item.meta.columns[t].key]=""}this.item.val.push(e)}"function"==typeof this.$parent.refresh&&this.$parent.refresh()}},created:function(){var e=this;if(""===this.item.val||Array.isArray(this.item.val)&&!this.item.val.length){this.item.val=[];for(var t={},i=0;i<this.item.meta.columns.length;i++){t[this.item.meta.columns[i].key]=""}this.item.val.push(t)}this.item.val.forEach((function(t){e.item.meta.columns.forEach((function(e){if(("multiselect"===e.display||"select"===e.display)&&!("string"==typeof t[e.key]?[t[e.key]]:t[e.key]).every((function(t){return e.choice.find((function(e){return e.key===t}))}))){var i=e.choice.find((function(i){return i.name===t[e.key]}));t[e.key]=i?i.key:""}}))}))},methods:{addOne:function(){for(var e={},t=0;t<this.item.meta.columns.length;t++){e[this.item.meta.columns[t].key]=""}this.item.val.push(e)},deleteOne:function(e){var t=this;1===this.item.val.length?this.$bkMessage({message:"默认行不能删除",theme:"warning"}):this.$bkInfo({title:"确认要删除此条数据？",confirmFn:function(){t.item.val.splice(e,1)}})}}}},SUIt:function(e,t,i){"use strict";i.r(t);var n=i("4omV"),o=i("gr+U");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("ZFr9");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"587be848",null);r.options.__file="src/views/commonComponent/fieldComponent/devopsTemplate.vue",t.default=r.exports},SioU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(i("14Xm")),o=m(i("gDS+")),a=m(i("m1cH")),s=m(i("D3Ub")),r=m(i("2Vgw")),c=m(i("NGZu")),l=m(i("c6Q5")),u=m(i("hA3y")),d=m(i("FGMr")),f=m(i("VflG")),p=i("CeR/");function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"dataContent",components:{getParam:c.default,postParam:l.default,responseData:u.default,getRpcParam:d.default},mixins:[f.default],props:{formInfo:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){return{}}},workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},apiInfo:{type:Object,default:function(){return{remote_system_id:"",remote_api_id:"",req_params:{},req_body:{},rsp_data:""}}},fieldInfo:{type:Object,default:function(){return{}}},kvRelation:{type:Object,default:function(){return{}}},prcTable:{type:Array,default:function(){return[]}}},data:function(){return{stateList:[],trueStatus:!0,falseStatus:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getRelatedFields()},methods:{addDataLine:function(e,t){if(!this.changeInfo.meta||"APPROVE_RESULT"!==this.changeInfo.meta.code){this.fieldInfo.list.splice(t+1,0,{name:"",key:"",required:!1,nameCheck:!1,keyCheck:!1})}},deleteDataLine:function(e,t){1===this.fieldInfo.list.length||this.changeInfo.meta&&"APPROVE_RESULT"===this.changeInfo.meta.code||this.fieldInfo.list.splice(t,1)},closeError:function(){this.fieldInfo.list.forEach((function(e){e.nameCheck=!1,e.keyCheck=!1}))},getRelatedFields:function(){var e=this;if(this.state){var t={workflow:this.workflow,state:this.state,field:""};this.$store.dispatch("apiRemote/get_related_fields",t).then((function(t){e.stateList=t.data})).catch((function(t){(0,p.errorHandler)(t,e)})).finally((function(){}))}},countArrayAncestors:function(e){var t=[];return function e(i){"array"===i.parentInfo.type&&(t.push(i),e(i.parentInfo)),"object"===i.parentInfo.type&&e(i.parentInfo)}(e),t},listTojson:function(e){var t={};return e.length&&e.forEach((function(e){t[e.name]="CUSTOM"===e.source_type?e.value:"${params_"+e.value_key+"}"})),t},apiFz:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var i,s,r,c,l,u,d,f,p,m,h,v,g;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.getParam){t.next=4;break}t.t0={},t.next=7;break;case 4:return t.next=6,e.listTojson(e.$refs.getParam.paramTableData);case 6:t.t0=t.sent;case 7:if(e.apiInfo.req_params=t.t0,e.$refs.postParam){t.next=12;break}t.t1={},t.next=15;break;case 12:return t.next=14,e.treeToJson(e.$refs.postParam.bodyTableData.filter((function(e){return!e.level})));case 14:t.t1=t.sent;case 15:if(e.apiInfo.req_body=t.t1,i=!1,!e.$refs.getParam){t.next=25;break}if((s=e.$refs.getParam.paramTableData.filter((function(e){return e.is_necessary}))).forEach((function(e,t){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?!!e.value:!!e.value_key})),!(r=s.filter((function(e){return!e.isSatisfied}))[0])){t.next=25;break}return e.$bkMessage({message:e.$t('m.treeinfo["请输入GET参数！"]'),theme:"error"}),i||(r.el.scrollIntoView(!0),i=!0),t.abrupt("return",!1);case 25:if(!e.$refs.postParam){t.next=34;break}if((c=e.$refs.postParam.bodyTableData.filter((function(e){return e.is_necessary&&"object"!==e.type&&"array"!==e.type}))).forEach((function(e,t){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?e.value.toString():!!e.value_key})),!(l=c.filter((function(e){return!e.isSatisfied}))[0])){t.next=34;break}return e.$refs.postParam.bodyTableData.forEach((function(e){e.showChildren=!0,e.isShow=!0})),e.$bkMessage({message:e.$t('m.treeinfo["请输入POST参数！"]'),theme:"error"}),i||(l.el.scrollIntoView(!0),i=!0),t.abrupt("return",!1);case 34:if(e.$refs.responseData){t.next=37;break}return e.$bkMessage({message:e.$t('m.treeinfo["数据为空，请联系管理员"]'),theme:"error"}),t.abrupt("return",!1);case 37:if(u=e.$refs.responseData.responseTableData.filter((function(e){return e.isSelectedKey}))[0],d=e.$refs.responseData.responseTableData.filter((function(e){return e.isSelectedValue}))[0],u&&d){t.next=45;break}return e.$bkMessage({message:e.$t('m.treeinfo["请选择返回数据"]'),theme:"error"}),e.$refs.responseData.isCheck=!0,t.abrupt("return",!1);case 45:return f=[].concat((0,a.default)(JSON.parse((0,o.default)(u.ancestorsList))),[u.primaryKey]),p=[].concat((0,a.default)(JSON.parse((0,o.default)(d.ancestorsList))),[d.primaryKey]),t.next=49,e.countArrayAncestors(u);case 49:return m=t.sent,t.next=52,e.countArrayAncestors(d);case 52:if(h=t.sent,v=f.indexOf(m[0].primaryKey),g=p.indexOf(h[0].primaryKey),1===m.length&&1===h.length){t.next=59;break}return t.abrupt("return",!1);case 59:return e.apiInfo.rsp_data=f.slice(0,v).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),e.kvRelation.key=f.slice(v+1).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),e.kvRelation.name=p.slice(g+1).map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),t.abrupt("return",!0);case 63:case"end":return t.stop()}}),t,e)})))()},putChar:function(e,t){var i=this;e.key||(this.fieldInfo.list[t].key="",(0,r.default)(this.fieldInfo.list[t].name,{style:r.default.STYLE_NORMAL,heteronym:!1}).forEach((function(e){i.fieldInfo.list[t].key=i.fieldInfo.list[t].key+""+e})),this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.toUpperCase(),this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.replace(/\ /g,"_"),this.fieldInfo.list[t].key.length>=32&&(this.fieldInfo.list[t].key=this.fieldInfo.list[t].key.substr(0,32)))}}}},Slck:function(e,t,i){},SpgR:function(e,t,i){},T2YI:function(e,t,i){"use strict";i.r(t);var n=i("o1/R"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},T3vI:function(e,t,i){"use strict";i.r(t);var n=i("IGTl"),o=i("VhbG");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("gYYX");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"9f5ae6d4",null);r.options.__file="src/views/processManagement/publicTrigger/components/apiCall.vue",t.default=r.exports},T7kK:function(e,t,i){},THJS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-default-value"},["STRING"===e.formInfo.type?[i("bk-input",{attrs:{"ext-cls":"bk-half",clearable:!0,placeholder:e.$t("m.treeinfo['请输入']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})]:e._e(),e._v(" "),"TEXT"===e.formInfo.type?[i("div",{staticStyle:{height:"30px"}},[i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.default_value,expression:"formInfo.default_value",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble",staticStyle:{width:"49%"},attrs:{rows:"8",placeholder:e.$t("m.treeinfo['请输入']")},domProps:{value:e.formInfo.default_value},on:{input:function(t){t.target.composing||e.$set(e.formInfo,"default_value",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]:e._e(),e._v(" "),"RICHTEXT"===e.formInfo.type?[i("div",[i("rich-text-editor",{attrs:{id:"default-rich-text-editor","full-title":e.label},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type||"SELECT"===e.formInfo.type||"RADIO"===e.formInfo.type||"INPUTSELECT"===e.formInfo.type?["API"===e.formInfo.source_type||"RPC"===e.formInfo.source_type?[i("bk-input",{attrs:{"ext-cls":"bk-half",clearable:!0,placeholder:e.$t("m.treeinfo['请输入']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})]:[i("bk-select",{attrs:{"ext-cls":"bk-half",multiple:"MULTISELECT"===e.formInfo.type||"CHECKBOX"===e.formInfo.type,searchable:""},on:{toggle:e.getSelectList},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}},e._l(e.selectList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]]:e._e(),e._v(" "),"INT"===e.formInfo.type?[i("div",{staticClass:"bk-half"},[i("bk-input",{attrs:{clearable:!0,type:"number",precision:e.precision},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"DATE"===e.formInfo.type?[i("div",{staticClass:"bk-half"},[i("bk-date-picker",{attrs:{placeholder:e.$t("m.newCommon['选择日期']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"DATETIME"===e.formInfo.type?[i("div",{staticClass:"bk-half"},[i("bk-date-picker",{attrs:{type:"datetime",placeholder:e.$t("m.newCommon['选择日期时间']")},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MEMBER"===e.formInfo.type?[i("div",{staticStyle:{width:"49%"}},[i("member-select",{attrs:{multiple:!1},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"MEMBERS"===e.formInfo.type?[i("div",{staticStyle:{width:"49%"}},[i("member-select",{model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1)]:e._e(),e._v(" "),"CUSTOM-FORM"===e.formInfo.type?[i("div",{staticClass:"editor-wrap"},[i("div",{staticClass:"editor-btn-group"},[i("router-link",{staticClass:"opt-item",attrs:{target:"_blank",to:{name:"CustomFormTest"}}},[e._v(e._s(e.$t("m.common['查看模板']")))]),e._v(" "),i("span",{staticClass:"opt-item",on:{click:e.downCustomFormTempalte}},[e._v("\n                    "+e._s(e.$t("m.common['下载模板']")))])],1),e._v(" "),i("code-editor",{attrs:{options:{language:"json"}},model:{value:e.formInfo.default_value,callback:function(t){e.$set(e.formInfo,"default_value",t)},expression:"formInfo.default_value"}})],1),e._v(" "),e.checkStatus.customFormStatus?i("p",{staticClass:"bk-field-error"},[e._v("\n            "+e._s(e.$t("m.treeinfo['格式错误！（JSON 语法错误或者根元素缺少 schemes 和 form_data 属性）']"))+"\n        ")]):e._e()]:e._e()],2)},o=[];n._withStripped=!0},TNjk:function(e,t,i){"use strict";i.r(t);var n=i("vfXS"),o=i("Gz9R");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"e77cf074",null);r.options.__file="src/views/commonComponent/fieldComponent/radio.vue",t.default=r.exports},TOmV:function(e,t,i){"use strict";i.r(t);var n=i("Vj9y"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},TQwK:function(e,t,i){"use strict";i.r(t);var n=i("c+QL"),o=i("P0kt");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("7M1H");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"21ce3014",null);r.options.__file="src/views/processManagement/publicTrigger/components/responseContent.vue",t.default=r.exports},Tbkf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"modify-fields"},[i("bk-form-item",{attrs:{"ext-cls":"bk-field-schema",label:e.fieldKeyItem.name,required:e.fieldKeyItem.required,desc:e.fieldKeyItem.tips}},[i("bk-select",{staticStyle:{width:"270px"},attrs:{"ext-cls":"bk-insert-info",searchable:""},on:{selected:e.selectedFieldKey},model:{value:e.fieldKeyItem.value,callback:function(t){e.$set(e.fieldKeyItem,"value",t)},expression:"fieldKeyItem.value"}},e._l(e.fieldKeyItem.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),e.fieldKeyItem.value?[i("bk-form-item",{attrs:{"ext-cls":"bk-field-schema",label:e.fieldValueItem.name,required:e.fieldValueItem.required,desc:e.fieldValueItem.tips}},[i("div",{staticStyle:{float:"left",width:"268px"}},[i("bk-select",{attrs:{clearable:!1,searchable:""},on:{selected:e.selectedReference},model:{value:e.fieldValueItem.referenceType,callback:function(t){e.$set(e.fieldValueItem,"referenceType",t)},expression:"fieldValueItem.referenceType"}},e._l(e.sourceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),"custom"===e.fieldValueItem.referenceType?i("div",{staticStyle:{float:"left",width:"268px","margin-left":"10px"}},[e.show?i("field-info",{attrs:{fields:e.fieldValueItem.itemInfo,origin:"trigger"}}):e._e()],1):e._e(),e._v(" "),"reference"===e.fieldValueItem.referenceType?i("div",{staticStyle:{float:"left",width:"268px","margin-left":"10px"}},[i("bk-select",{staticStyle:{width:"270px"},attrs:{"ext-cls":"bk-insert-info",searchable:""},model:{value:e.fieldValueItem.itemInfo[0].value,callback:function(t){e.$set(e.fieldValueItem.itemInfo[0],"value",t)},expression:"fieldValueItem.itemInfo[0].value"}},e._l(e.variableList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1):e._e()])]:e._e()],2)},o=[];n._withStripped=!0},TlxU:function(e,t,i){"use strict";i("fqZO")},TvXt:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"child-node"},e._l(e.treeDataList,(function(t,n){return i("li",{key:n,staticClass:"vue-tree-item"},[i("div",{class:["tree-node",{down:t.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:t.checkInfo}],style:e.pLeft,on:{click:function(i){return e.toggle(t)}}},[t.showChildren?i("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}):i("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}),e._v(" "),i("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),i("span",{staticClass:"name-text"},[e._v(e._s(t.name))]),e._v(" "),t.checkInfo?i("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]),e._v(" "),i("collapse-transition",[t.showChildren&&t.children?[i("exportTree",{attrs:{"tree-data-list":t.children,"tree-index":e.treeIndex+1},on:{selectItem:e.selectItem,toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})),0)},o=[];n._withStripped=!0},Tz34:function(e,t,i){"use strict";i.r(t);var n=i("+uwX"),o=i("MG1K");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("pLYB");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"423cdf17",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/ApprovalNode.vue",t.default=r.exports},"U/zI":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:["form-view-item",e.crtForm===e.form.id?"click-status":""]},[e.addFieldStatus||e.crtForm!==e.form.id?e._e():i("i",{staticClass:"bk-itsm-icon icon-itsm-icon-square-one"}),e._v(" "),i("div",{staticClass:"drag-element"},[e._t("draggable")],2),e._v(" "),i("div",{staticClass:"form-view-content"},[i("CW-"+e.form.type,{tag:"component",attrs:{item:e.form,fields:e.fields}})],1),e._v(" "),i("div",{staticClass:"mask",on:{click:function(t){return e.$emit("onFormEditClick",e.form)}}}),e._v(" "),i("div",{staticClass:"opt-btns"},["CUSTOM"===e.form.source?i("i",{staticClass:"btn-item bk-itsm-icon icon-itsm-icon-copy",on:{click:function(t){return e.$emit("onFormCloneClick",e.form)}}}):e._e(),e._v(" "),i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{placement:"auto-start",content:e.$t("m['内置字段，不可删除']"),disabled:!e.deleteDisabled,theme:"Light"},expression:"{ placement: 'auto-start', content: $t(`m['内置字段，不可删除']`), disabled: !deleteDisabled, theme: 'Light' }"}],staticClass:"btn-item bk-icon icon-delete",class:e.deleteDisabled?"disabled":"",on:{click:function(t){return e.onDeleteClick(e.form)}}})])])},o=[];n._withStripped=!0},U33Y:function(e,t,i){},UNHF:function(e,t,i){"use strict";i("yWHG")},UYcT:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-dialog-form"},[i("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],ref:"table",attrs:{data:e.dataList,size:"small"},on:{"select-all":e.handleSelectAll,select:e.handleSelect}},[i("bk-table-column",{attrs:{type:"selection",width:"60",align:"center",selectable:e.disabledFn}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['字段名称']"),prop:"name"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['唯一标识']"),prop:"key"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['字段类型']"),prop:"typeName"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['是否只读']")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("bk-radio-group",{model:{value:t.row.is_readonly,callback:function(i){e.$set(t.row,"is_readonly",i)},expression:"props.row.is_readonly"}},[i("bk-radio",{staticClass:"mr20",attrs:{value:e.trueStatus,disabled:"priority"===t.row.key||t.row.is_disabled}},[e._v("\n                        "+e._s(e.$t('m.treeinfo["是"]'))+"\n                    ")]),e._v(" "),i("bk-radio",{attrs:{value:e.falseStatus,disabled:"priority"===t.row.key||t.row.is_disabled}},[e._v("\n                        "+e._s(e.$t('m.treeinfo["否"]'))+"\n                    ")])],1)]}}])})],1)],1)},o=[];n._withStripped=!0},UhCq:function(e,t,i){"use strict";i.r(t);var n=i("m6ij"),o=i("sjGJ");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("uzkr");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"f0677304",null);r.options.__file="src/views/service/editService/ServiceProcessStep.vue",t.default=r.exports},UsFA:function(e,t,i){"use strict";i.r(t);var n=i("Epmc"),o=i("nVin");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("S1Ju");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"28a43dec",null);r.options.__file="src/components/renderview/ViewItem.vue",t.default=r.exports},VbbY:function(e,t,i){"use strict";i("MDWk")},VhbG:function(e,t,i){"use strict";i.r(t);var n=i("/9eO"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},Vj9y:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("m1cH")),o=d(i("P2sY")),a=d(i("14Xm")),s=d(i("gDS+")),r=d(i("D3Ub")),c=d(i("QbLZ")),l=d(i("VflG")),u=i("L2JU");function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"inputParams",mixins:[l.default],props:{itemInfo:{type:Object,default:function(){return{}}}},data:function(){return{sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],variableList:[]}},computed:(0,c.default)({paramTableData:function(){return this.itemInfo.apiContent.bodyTableData.filter((function(e){return e.isShow}))},globalChoise:function(){return this.$store.state.common.configurInfo}},(0,u.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){this.initData()},mounted:function(){this.variableList=this.triggerVariables},methods:{initData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$set(e.itemInfo.apiContent,"treeDataList",{}),t.next=3,e.jsonschemaToList({root:JSON.parse((0,s.default)(e.itemInfo.apiContent.req_body))});case 3:return e.itemInfo.apiContent.treeDataList=t.sent,e.itemInfo.value&&(e.itemInfo.apiContent.treeDataList=e.jsonValueTreeList(e.itemInfo.value,JSON.parse((0,s.default)(e.itemInfo.apiContent.treeDataList)))),t.next=7,e.treeToTableList(JSON.parse((0,s.default)(e.itemInfo.apiContent.treeDataList[0].children)));case 7:return e.itemInfo.apiContent.bodyTableData=t.sent,(i=JSON.parse((0,s.default)(e.itemInfo.apiContent.bodyTableData))).forEach((function(e){e.name=e.key||"",e.children=[],e.source_type=e.source_type||"CUSTOM",e.value=void 0!==e.value?e.value:"",e.value_key=void 0!==e.value_key&&e.value_key.toString()?e.value_key:""})),e.recordChildren(i),t.next=13,i;case 13:e.itemInfo.apiContent.bodyTableData=t.sent;case 14:case"end":return t.stop()}}),t,e)})))()},jsonValueTreeList:function(e,t){var i=function e(t,i,n,a,r){if("object"===r){var c=i.filter((function(e){return e.key===n}));if(!c.length)return;if("array"===a.constructor.name.toLowerCase()){if(!c[0].children||!c[0].children.length)return;for(var l=JSON.parse((0,s.default)((0,o.default)({parentInfo:""},c[0].children[0]))),u=1;u<a.length;u++)c[0].children.push(l);for(var d in a)e(c[0].children,c[0].children[d],"items",a[d],"array")}else if("object"===a.constructor.name.toLowerCase())if(a.ref_type)"reference"===a.ref_type?(c[0].source_type="FIELDS",c[0].value_key=a.value,c[0].value=a.value):(c[0].source_type="CUSTOM",c[0].value=a.value,c[0].value_key="",c[0].default_temp=c[0].value);else for(var f in a)e(c[0],c[0].children,f,a[f],"object");else"reference"===a.ref_type?(c[0].source_type="FIELDS",c[0].value_key=a.value,c[0].value=a.value):(c[0].source_type="CUSTOM",c[0].value=a.value,c[0].value_key="",c[0].default_temp=c[0].value)}else if("array"===r)if("array"===a.constructor.name.toLowerCase()){var p=i.filter((function(e){return e.key===n}));if(!p.length)return;if(!p[0].children||!p[0].children.length)return;for(var m=JSON.parse((0,s.default)(i.children[0])),h=1;h<a.length;h++)i.children.push(m);for(var v in a)e(i.children,i.children[v],"items",a[v],"array")}else if("object"===a.constructor.name.toLowerCase())if(a.ref_type)"reference"===a.ref_type?(i.source_type="FIELDS",i.value_key=a.value):(i.source_type="CUSTOM",i.value=a.value,i.default_temp=i.value);else for(var g in a)e(i,i.children,g,a[g],"object");else"reference"===a.ref_type?(i.source_type="FIELDS",i.value_key=a.value):(i.source_type="CUSTOM",i.value=a.value,i.default_temp=i.value)};for(var n in e)i(t[0],t[0].children,n,e[n],"object");return t},recordChildren:function(e,t){for(var i=e.map((function(e){return e.level})),o=Math.max.apply(Math,(0,n.default)(i)),a=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},s=o;s>(t||0);s--)a(s)},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},countSon:function(e){return 1===this.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0].children.length},countChildren:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var n,o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,o=function e(t){if(t.children&&t.children.length)for(var i=0;i<t.children.length;i++)n++,e(t.children[i])},t.next=4,o(e);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},cleanValue:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var n,o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse((0,s.default)(e)),o=function e(t){if(t.value="",t.source_type="CUSTOM",t.children&&t.children.length)for(var i=0;i<t.children.length;i++)e(t.children[i])},t.next=4,o(n);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},addChildren:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var o,r,c,l,u,d;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0],c=t.itemInfo.apiContent.bodyTableData.indexOf(r)+1,i.next=4,t.countChildren(r);case 4:return l=i.sent,i.next=7,t.cleanValue(r.children[0]);case 7:return u=i.sent,i.next=10,t.treeToTableList(JSON.parse((0,s.default)([].concat((0,n.default)(r.children),[u]))),r.level+1,r.primaryKey,"array",r.ancestorsList);case 10:return d=i.sent,i.next=13,d.forEach((function(e){e.children=[]}));case 13:return r.children=d.filter((function(e){return e.level===r.level+1})),i.next=16,t.recordChildren(d,r.level+1);case 16:(o=t.itemInfo.apiContent.bodyTableData).splice.apply(o,[c,l].concat((0,n.default)(d)));case 17:case"end":return i.stop()}}),i,t)})))()},deletChildren:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var n,o,s;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.countSon(e)){i.next=2;break}return i.abrupt("return");case 2:if(!((n=t.itemInfo.apiContent.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey&&t.ancestorsList.toString()===e.ancestorsList.slice(0,-1).toString()}))[0].children).length<=1)){i.next=5;break}return i.abrupt("return");case 5:return n.splice(n.indexOf(e),1),o=t.itemInfo.apiContent.bodyTableData.indexOf(e),i.next=9,t.countChildren(e);case 9:s=i.sent,t.itemInfo.apiContent.bodyTableData.splice(o,s+1);case 11:case"end":return i.stop()}}),i,t)})))()}}}},VrAx:function(e,t,i){"use strict";i.r(t);var n=i("sFvT"),o=i("3jvg");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("NV0X");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"2bdead71",null);r.options.__file="src/views/commonComponent/fieldComponent/inputSelect.vue",t.default=r.exports},VtRw:function(e,t,i){"use strict";i.r(t);var n=i("MI7q"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"Vv2+":function(e,t,i){"use strict";i.r(t);var n=i("fOTe"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"W/oT":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(i("m1cH")),o=m(i("14Xm")),a=m(i("GQeE")),s=m(i("D3Ub")),r=m(i("PIEm")),c=m(i("I1Ty")),l=m(i("KaYb")),u=m(i("bcjM")),d=m(i("s4tT")),f=i("CeR/"),p=i("ygAv");function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"sopsDevopsTask",components:{BasicCard:d.default,sopsGetParam:l.default,commonTriggerList:u.default,NoData:c.default,dealPerson:r.default},props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}},state:{type:[String,Number],default:function(){return""}}},data:function(){return{quoteVars:[],hookedVarList:{},constantDefaultValue:{},basicsFormData:{name:"",templateId:"",projectId:"",planId:[],processType:"",processors:[]},processOptions:[{id:"business",name:"项目流程"},{id:"common",name:"公共流程"}],isLoading:!1,excludeTaskNodesId:[],projectList:[],templateList:[],paramTableData:[],stateList:[],fieldList:[],constants:[],context:{project:{id:"",bk_biz_id:"",name:"",from_cmdb:!0},bk_biz_id:"",site_url:window.SITE_URL_SOPS+window.PREFIX_SOPS},sopsFormLoading:!1,processesLoading:!1,planLoading:!1,planList:[],optionalNodeIdList:[],templateDisable:!1,planDisable:!1,processDisable:!1,renderFormValidate:!1,biz:[{name:this.$t('m.treeinfo["业务"]'),custom_type:"",source_type:"custom",value:"--",key:1}],rules:{name:[{required:!0,message:"必填项",trigger:"blur"},{max:50,message:"不能多于50个字符",trigger:"blur"}],processType:[{required:!0,message:"必填项",trigger:"blur"}],projectId:[{required:!0,message:"必填项",trigger:"blur"}],templateId:[{required:!0,message:"必填项",trigger:"blur"}]},checkStatus:{delivers:!1,processors:!1},excludeProcessor:[],processorsInfo:{type:"",value:""}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},created:function(){},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,s.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,e.getRelatedFields(),t.next=4,e.$store.dispatch("apiRemote/get_user_project_list");case 4:if((i=t.sent)&&(e.projectList=i.data),0===(0,a.default)(e.configur.extras).length){t.next=22;break}if(e.basicsFormData.name=e.configur.name,e.basicsFormData.processType=e.configur.extras.sops_info.template_source,e.excludeTaskNodesId=e.configur.extras.sops_info.exclude_task_nodes_id||[],e.basicsFormData.projectId=e.configur.extras.sops_info.bk_biz_id.value,"common"!==e.basicsFormData.processType){t.next=16;break}return t.next=14,e.getTemplateList(e.basicsFormData.processType);case 14:t.next=18;break;case 16:return t.next=18,e.getProjectTemplateList(e.basicsFormData.projectId);case 18:return t.next=20,e.getTemplateDetail(e.configur.extras.sops_info.template_id);case 20:e.basicsFormData.templateId=e.configur.extras.sops_info.template_id,e.processorsInfo={type:e.configur.processors_type,value:e.configur.processors};case 22:e.getExcludeRoleTypeList(),e.isLoading=!1;case 24:case"end":return t.stop()}}),t,e)})))()},getTemplateList:function(e){var t=this;return(0,s.default)(o.default.mark((function i(){var n,a;return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=(n="common"===e)?{}:{bk_biz_id:t.basicsFormData.projectId},n||(t.basicsFormData.projectId=""),t.basicsFormData.templateId="",t.basicsFormData.planId=[],t.templateDisable=!n,t.planDisable=!n,!n){i.next=11;break}return t.processesLoading=!0,i.next=11,t.$store.dispatch("getTemplateList",a).then((function(e){t.templateList=e.data})).catch((function(e){(0,f.errorHandler)(e,t)})).finally((function(){t.processesLoading=!1}));case 11:case"end":return i.stop()}}),i,t)})))()},getProjectTemplateList:function(e){var t=this;return(0,s.default)(o.default.mark((function i(){var n,a;return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n={bk_biz_id:e},"common"===t.basicsFormData.processType){i.next=8;break}return t.processesLoading=!0,t.basicsFormData.templateId="",i.next=6,t.$store.dispatch("getTemplateList",n);case 6:(a=i.sent).result&&(t.templateList=a.data,t.templateDisable=!1,t.planDisable=!1,t.processesLoading=!1);case 8:case"end":return i.stop()}}),i,t)})))()},getTemplateDetail:function(e){var t=this;return(0,s.default)(o.default.mark((function i(){var n,a;return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n={bk_biz_id:"common"===t.basicsFormData.processType?"":t.basicsFormData.projectId,template_id:e},void 0!==(a=t.templateList.find((function(t){return t.id===e})))&&(t.context.project.bk_biz_id=a.bk_biz_id,t.context.project.id=t.template),t.constants=[],t.hookedVarList={},t.sopsFormLoading=!0,t.basicsFormData.planId=[],i.next=9,t.$store.dispatch("getTemplateDetail",n).then((function(i){t.processingVariables(i.data.constants),t.optionalNodeIdList=i.data.all_ids||[],t.getTempaltePlanList(e)})).catch((function(e){(0,f.errorHandler)(e,t)})).finally((function(){t.sopsFormLoading=!1}));case 9:case"end":return i.stop()}}),i,t)})))()},getTempaltePlanList:function(e){var t=this,i=this.templateList.find((function(t){return t.id===e}));this.planList=[];var n={bk_biz_id:i.bk_biz_id,template_id:i.id};this.planLoading=!0,this.$store.dispatch("getTemplatePlanList",n).then((function(e){t.planList=e.data,0!==t.excludeTaskNodesId.length&&e.data.forEach((function(e){if(e.data){var i=t.optionalNodeIdList.filter((function(t){return!JSON.parse(e.data).includes(t)}));0===i.filter((function(e){return!t.excludeTaskNodesId.includes(e)})).length&&t.excludeTaskNodesId.length===i.length&&t.basicsFormData.planId.push(e.id)}})),t.onplanSelect(t.basicsFormData.planId)})).catch((function(e){(0,f.errorHandler)(e,t)})).finally((function(){t.planLoading=!1}))},onplanSelect:function(e){var t=this;return(0,s.default)(o.default.mark((function i(){var a,s,r,c,l,u;return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=[],e.length>0?(e.forEach((function(e){var i=t.planList.find((function(t){return t.id===e}));if(i.data)for(var n=JSON.parse(i.data),o=0;o<n.length;o++)-1===a.indexOf(n[o])&&a.push(n[o])})),t.excludeTaskNodesId=t.optionalNodeIdList.filter((function(e){return!a.includes(e)}))):t.excludeTaskNodesId=[],s=t.templateList.find((function(e){return e.id===t.basicsFormData.templateId})),i.prev=3,t.sopsFormLoading=!0,r="common"===t.basicsFormData.processType){i.next=12;break}return i.next=9,t.$store.dispatch("taskFlow/getSopsPreview",{bk_biz_id:s.bk_biz_id,template_id:s.id,exclude_task_nodes_id:t.excludeTaskNodesId});case 9:i.t0=i.sent,i.next=13;break;case 12:i.t0=(0,p.deepClone)(t.constants);case 13:if(c=i.t0,l=[],r)l.push.apply(l,(0,n.default)(c));else for(u in c.data.pipeline_tree.constants)"show"===c.data.pipeline_tree.constants[u].show_type&&l.push(c.data.pipeline_tree.constants[u]);t.processingVariables(l),i.next=22;break;case 19:i.prev=19,i.t1=i.catch(3),console.error(i.t1);case 22:return i.prev=22,t.sopsFormLoading=!1,i.finish(22);case 25:case"end":return i.stop()}}),i,t,[[3,19,22,25]])})))()},onChangeHook:function(e,t){this.hookedVarList[e]=t},processingVariables:function(e){var t=this,i=e;i.sort((function(e,t){return e.index-t.index})),i.map((function(e){t.$set(t.hookedVarList,e.key,!1)})),this.configur.extras.hasOwnProperty("sops_info")&&i.forEach((function(e){var i=t.configur.extras.sops_info.constants.find((function(t){return t.key===e.key}));i&&(t.constantDefaultValue[e.key]=(0,p.deepClone)(i.value),i.is_quoted?(t.$set(t.hookedVarList,e.key,!0),e.value="${"+i.value+"}"):e.value=i.value)})),this.constants=i},getRelatedFields:function(){var e=this;return(0,s.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={workflow:e.flowInfo.id,state:e.configur.id,field:""},t.next=3,e.$store.dispatch("apiRemote/get_related_fields",i).then((function(t){e.stateList=t.data})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){}));case 3:case"end":return t.stop()}}),t,e)})))()},getExcludeRoleTypeList:function(){var e=[];e=this.configur.is_builtin?["BY_ASSIGNOR","STARTER","VARIABLE"]:["OPEN"],this.flowInfo.is_iam_used,"DISTRIBUTE_THEN_PROCESS"!==this.configur.distribute_type&&"DISTRIBUTE_THEN_CLAIM"!==this.configur.distribute_type&&e.push("BY_ASSIGNOR"),this.flowInfo.is_biz_needed||e.push("CMDB"),this.excludeProcessor=["EMPTY","API"].concat((0,n.default)(e))},onClearProcess:function(){"common"!==this.basicsFormData.processType&&(this.templateDisable=!0,this.planDisable=!0,this.constants=[]),this.templateList=[],this.basicsFormData.templateId="",this.planList=[]},onClearTemplate:function(){this.basicsFormData.planId=[],this.basicsFormData.templateId="",this.constants=[],this.planList=[]},closeNode:function(){this.$parent.closeConfigur()},submit:function(){var e=this;console.log(this.$refs.processors.getValue()),!this.$refs.processors||this.$refs.processors.verifyValue()?(this.$refs.getParam?this.renderFormValidate=this.$refs.getParam.getRenderFormValidate():this.renderFormValidate=!0,this.$refs.basicsForm.validate().then((function(t){if(e.renderFormValidate){var i=[],n={name:e.$t('m.treeinfo["业务"]'),value:e.basicsFormData.projectId,key:1,value_type:"custom"};e.constants.map((function(t){var n=(0,a.default)(e.$refs.getParam.formData).filter((function(e){return e===t.key})),o=t.name,s=t.key,r=e.hookedVarList[n]?"variable":"custom";if("show"===t.show_type){var c={value:e.hookedVarList[n]?e.$refs.getParam.formData[n].slice(2,e.$refs.getParam.formData[n].length-1):e.$refs.getParam.formData[n],name:o,key:s||1,value_type:r,type:t.custom_type,is_quoted:e.hookedVarList[n]};i.push(c)}}));var o=e.$refs.processors.getValue(),s=o.value,r=o.type,c={extras:{sops_info:{bk_biz_id:n,template_id:e.basicsFormData.templateId,constants:i,exclude_task_nodes_id:e.excludeTaskNodesId,template_source:e.basicsFormData.processType}},processors:s||"",processors_type:r,is_draft:!1,is_terminable:!1,name:e.basicsFormData.name,type:"TASK-SOPS",workflow:e.configur.workflow},l=e.configur.id;e.$store.dispatch("cdeploy/putSopsInfo",{params:c,stateId:l}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$parent.closeConfigur()}),(function(t){(0,f.errorHandler)(t,e)})).finally((function(){}))}}))):this.checkStatus.processors=!0}}}},"W3y+":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8yIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDI0IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojYzNjZGQ3O30KPC9zdHlsZT4KPGcgaWQ9IuS4iuS8oCI+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODk3LDQyMi45Yy0yOC40LTI4LjQtNjMuMy00Ny44LTEwMS4zLTU3Yy0xMC4xLTU3LjktMzcuNi0xMTEuMi04MC0xNTMuNkM2NjEuMywxNTgsNTg4LjksMTI4LDUxMiwxMjgKCQlzLTE0OS4zLDMwLTIwMy42LDg0LjRjLTQyLjQsNDIuNC02OS45LDk1LjctODAsMTUzLjZjLTM4LjEsOS4yLTczLDI4LjYtMTAxLjMsNTdjLTQwLjYsNDAuNi02Myw5NC42LTYzLDE1MnYxMAoJCWMwLDU3LjQsMjIuNCwxMTEuNCw2MywxNTJzOTQuNiw2MywxNTIsNjNoNDF2LTY0aC00MWMtODMuMywwLTE1MS02Ny43LTE1MS0xNTF2LTEwYzAtODMuMyw2Ny43LTE1MSwxNTEtMTUxaDkuMgoJCWMtMC4xLTIuNi0wLjItNS4zLTAuMi03LjlsMCwwbDAsMGMwLTEuNywwLTMuMywwLjEtNC45YzAtMC40LDAtMC44LDAtMS4zYzAtMS42LDAuMS0zLjIsMC4yLTQuN2MwLTAuNCwwLTAuNywwLjEtMS4xCgkJYzAuMS0xLjIsMC4xLTIuNSwwLjItMy43YzAtMC42LDAuMS0xLjIsMC4xLTEuOGMwLjEtMS40LDAuMi0yLjcsMC4zLTQuMWMwLjEtMC44LDAuMi0xLjYsMC4zLTIuNWMwLjEtMC42LDAuMS0xLjIsMC4yLTEuOQoJCWMxLjItMTAuMywzLjEtMjAuNCw1LjYtMzAuMmwwLDBjOS44LTM4LjQsMjkuOC03My42LDU4LjYtMTAyLjNDMzk1LjksMjE1LjMsNDUyLjIsMTkyLDUxMiwxOTJzMTE2LjEsMjMuMywxNTguNCw2NS42CgkJYzI4LjcsMjguNyw0OC43LDYzLjksNTguNiwxMDIuM2wwLDBjMi41LDkuOCw0LjQsMTkuOSw1LjYsMzAuMmMwLjEsMC42LDAuMSwxLjIsMC4yLDEuOWMwLjEsMC44LDAuMiwxLjYsMC4zLDIuNQoJCWMwLjEsMS40LDAuMiwyLjcsMC4zLDQuMWMwLDAuNiwwLjEsMS4yLDAuMSwxLjhjMC4xLDEuMiwwLjIsMi41LDAuMiwzLjdjMCwwLjQsMCwwLjcsMC4xLDEuMWMwLjEsMS42LDAuMSwzLjIsMC4yLDQuNwoJCWMwLDAuNCwwLDAuOCwwLDEuM2MwLDEuNiwwLjEsMy4zLDAuMSw0LjlsMCwwbDAsMGMwLDIuNy0wLjEsNS4zLTAuMiw3LjloOS4yYzgzLjMsMCwxNTEsNjcuNywxNTEsMTUxdjEwYzAsODMuMy02Ny43LDE1MS0xNTEsMTUxCgkJaC00MXY2NGg0MWM1Ny40LDAsMTExLjQtMjIuNCwxNTItNjNzNjMtOTQuNiw2My0xNTJ2LTEwQzk2MCw1MTcuNSw5MzcuNiw0NjMuNSw4OTcsNDIyLjl6Ii8+Cgk8cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjM3Ni4yLDYwMi45IDQyMS41LDY0OC4xIDQ4MCw1ODkuNiA0ODAsODk2IDU0NCw4OTYgNTQ0LDU4OS42IDYwMi41LDY0OC4xIDY0Ny44LDYwMi45IDUxMiw0NjcuMSAJIi8+CjwvZz4KPC9zdmc+Cgo="},W8Ex:function(e,t,i){"use strict";i("kJ3o")},W98i:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(e.responseList,(function(t,n){return i("div",{key:n,staticClass:"bk-trigger-condition"},[i("div",{staticClass:"bk-condition-name"},[i("p",[e._v(e._s(e.$t("m.trigger['响应动作']")))]),e._v(" "),i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addResponse(t,n)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.responseList.length},on:{click:function(i){return e.deleteResponse(t,n)}}})])]),e._v(" "),i("div",{staticClass:"bk-condition-content"},[i("div",{staticClass:"bk-response-way"},[i("p",{staticClass:"bk-response-name"},[e._v(e._s(e.$t("m.trigger['动作名称']"))),i("span",{staticClass:"bk-span-square"},[e._v("*")])]),e._v(" "),i("bk-select",{attrs:{"ext-cls":"bk-way-input",clearable:!1,searchable:""},on:{selected:function(i){for(var n=arguments.length,o=Array(n);n--;)o[n]=arguments[n];return e.selectedWay.apply(void 0,o.concat([t]))}},model:{value:t.way,callback:function(i){e.$set(t,"way",i)},expression:"item.way"}},e._l(e.responseWayList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),t.wayStatus?i("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['动作名称为必填项']")))]):e._e()],1),e._v(" "),t.wayInfo.field_schema&&t.wayInfo.field_schema.length?i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading: item.isLoading }"}],staticStyle:{"min-height":"100px"}},[!t.isLoading&&t.wayInfo.field_schema&&t.wayInfo.field_schema.length?i("response-content",{attrs:{item:t,signal:e.signal}}):e._e()],1):e._e()])])})),0)},o=[];n._withStripped=!0},WP3n:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("CeR/"),a=i("BWJp"),s=(n=a)&&n.__esModule?n:{default:n};t.default={name:"hiddenConditions",mixins:[s.default],props:{workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},formInfo:{type:Object,default:function(){return{}}},templateStage:{type:String,default:""},templateInfo:{type:Object,default:function(){return{}}},addOrigin:{type:Object,default:function(){return{isOther:!1,addOriginInfo:{}}}}},data:function(){return{isLoading:!1,listInfo:[],conditionType:"and",fieldList:[],checkStatus:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getFrontNodesList()},methods:{getFrontNodesList:function(){var e=this;if(this.state||this.templateInfo.id){var t="",i={};this.state&&(t="apiRemote/get_related_fields",i.workflow=this.workflow,i.state=this.state),this.templateInfo.id&&(t="taskTemplate/getFrontFieldsList",i.id=this.templateInfo.id,i.stage=this.templateStage),this.isLoading=!0,this.$store.dispatch(t,i).then((function(t){e.frontNodesList=t.data,e.initData()})).catch((function(t){(0,o.errorHandler)(t,e)})).finally((function(){e.isLoading=!1}))}},initData:function(){var e=this;this.listInfo=[],this.formInfo.show_conditions.expressions&&this.formInfo.show_conditions.expressions.length?(this.formInfo.show_conditions.expressions.forEach((function(t){e.frontNodesList.forEach((function(i){if(i.key===t.key){var n="MULTISELECT"===i.type||"CHECKBOX"===i.type||"MEMBERS"===i.type||"TREESELECT"===i.type,o=e.checkBetweenList(i.type);e.listInfo.push({condition:t.condition,key:t.key,value:n?t.value.split(","):t.value,choiceList:i.choice,type:t.type,multiSelect:n,betweenList:o})}}))})),this.conditionType=this.formInfo.show_conditions.type):(this.listInfo=[{condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")}],this.conditionType="and"),this.fieldList=[],this.frontNodesList.forEach((function(t){t.key===e.formInfo.key||["CUSTOMTABLE","FILE","RICHTEXT","TABLE","DATETIMERANGE","MEMBERS"].some((function(e){return e===t.type}))||e.fieldList.push(t)})),this.fieldList.forEach((function(t){"RPC"===t.source_type&&e.getRpcData(t)})),this.isNecessaryToWatch({fields:this.fieldList},"workflow")},getRpcData:function(e){var t=this;this.$store.dispatch("apiRemote/getRpcData",e).then((function(t){e.choice=t.data})).catch((function(e){(0,o.errorHandler)(e,t)}))},checkBetweenList:function(e){return["MULTISELECT","CHECKBOX","MEMBERS","TREESELECT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"===e.typeName||"notissuperset"===e.typeName})):["DATE","DATETIME","DATETIMERANGE","INT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"!==e.typeName&&"notissuperset"!==e.typeName})):this.globalChoise.methods.filter((function(e){return"=="===e.typeName||"!="===e.typeName}))},clearCondition:function(){this.listInfo=[{condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")}]},changeName:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=this.fieldList.filter((function(e){return e.key===t[0]}))[0],o="MULTISELECT"===n.type||"CHECKBOX"===n.type||"MEMBERS"===n.type||"TREESELECT"===n.type,a=this.checkBetweenList(n.type);t[2].type=n.type,t[2].value=o?[]:"",t[2].betweenList=a,t[2].condition="","SELECT"===n.type||"MULTISELECT"===n.type||"RADIO"===n.type||"CHECKBOX"===n.type||"MEMBERS"===n.type||"TREESELECT"===n.type?(t[2].choiceList=[],n.choice.forEach((function(e){t[2].choiceList.push({key:e.key,name:e.name})})),t[2].multiSelect=o):t[2].choiceList=""},addNode:function(e,t){var i={condition:"",key:"",value:"",choiceList:"",type:"STRING",multiSelect:!1,betweenList:this.checkBetweenList("STRING")};this.listInfo.splice(t+1,0,i)},deleteNode:function(e,t){1!==this.listInfo.length&&this.listInfo.splice(t,1)},checkList:function(){return this.checkStatus=this.listInfo.some((function(e){return!(e.key&&e.condition&&(Array.isArray(e.value)?e.value.length:e.value))})),this.checkStatus}}}},WSG0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i("oCYn")),o=a(i("C65D"));function a(e){return e&&e.__esModule?e:{default:e}}var s=n.default.extend(o.default);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:"title",formData:[],context:{schemes:{}}},t=new s({el:document.createElement("div"),propsData:{isShow:!1,title:e.title,formData:e.formData,context:e.context},data:{isShow:!1}});t.viewmodel=t.$mount();var i=document.body;return i.appendChild(t.viewmodel.$el),t.isShow=!0,t.$on("update:isShow",(function(e){e||(t.isShow=!1)})),t.viewmodel}},WgRI:function(e,t,i){"use strict";i.r(t);var n=i("bYAj"),o=i("5R1Y");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("CmE3");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"1396a2b8",null);r.options.__file="src/components/form/selectTree/Tree.vue",t.default=r.exports},WhZk:function(e,t,i){},Wl5c:function(e,t,i){"use strict";i.r(t);var n=i("iUdy"),o=i("b0Dy");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"dc6980f0",null);r.options.__file="src/views/commonComponent/fieldComponent/customtable.vue",t.default=r.exports},WuEG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form",{ref:"taskForm",attrs:{model:e.item.sopsContent,rules:e.rules,"label-width":200,"form-type":"vertical"}},[e.editTask?e._e():[i("bk-form-item",{attrs:{label:e.$t("m.newCommon['创建方式']"),required:!0}},[i("bk-radio-group",{on:{change:e.handleCreateWayChange},model:{value:e.item.sopsContent.createWay,callback:function(t){e.$set(e.item.sopsContent,"createWay",t)},expression:"item.sopsContent.createWay"}},[i("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"template"}},[e._v(e._s(e.$t('m.newCommon["手动创建"]')))]),e._v(" "),i("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"task"}},[e._v(e._s(e.$t('m.newCommon["关联未执行的任务"]')))]),e._v(" "),i("bk-radio",{staticClass:"bk-form-radio",attrs:{disabled:e.disabled,value:"started_task"}},[e._v(e._s(e.$t('m.newCommon["关联已执行的任务"]')))])],1)],1),e._v(" "),"template"===e.item.sopsContent.createWay?i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height",property:"id","error-display-type":"normal"}},[i("bk-select",{attrs:{searchable:"","ext-cls":"form-item-inline-width mr5",loading:e.loading.templateList,disabled:"RETRY"===e.typeInfo||e.disabled,clearable:!1},on:{selected:e.onSelectTpl},model:{value:e.item.sopsContent.id,callback:function(t){e.$set(e.item.sopsContent,"id",t)},expression:"item.sopsContent.id"}},e._l(e.templateList,(function(e,t){return i("bk-option",{key:t,attrs:{name:e.name,id:e.id}})})),1),e._v(" "),e.item.sopsContent.id?i("bk-select",{attrs:{loading:e.loading.plan,disabled:e.disabled,multiple:"","ext-cls":"form-item-inline-width mr0",placeholder:e.$t("m['选择执行方案，默认选择全部任务节点']")},on:{selected:e.onplanSelect},model:{value:e.item.sopsContent.planId,callback:function(t){e.$set(e.item.sopsContent,"planId",t)},expression:"item.sopsContent.planId"}},[e._l(e.planList,(function(t){return i("bk-option",{key:t.id,staticClass:"sops-plan-option",attrs:{id:t.id,name:t.name}},[i("span",[e._v(e._s(t.name))]),e._v(" "),i("span",{staticClass:"preview-sops-plan",on:{click:function(t){return t.stopPropagation(),e.jumpToSopsSelectSchemePage.apply(null,arguments)}}},[i("i",{staticClass:"bk-icon icon-eye"}),e._v("\n                            "+e._s(e.$t('m.flowManager["预览"]'))+"\n                        ")])])})),e._v(" "),i("div",{staticClass:"add-sops-scheme",attrs:{slot:"extension"},on:{click:e.jumpToSopsSelectSchemePage},slot:"extension"},[i("i",{staticClass:"bk-icon icon-plus"}),e._v("\n                        "+e._s(e.$t("m.newCommon['创建执行方案']"))+"\n                    ")])],2):e._e(),e._v(" "),e.item.sopsContent.id?i("div",{staticClass:"reload-template-plan",on:{click:e.onReloadPlanBtnClick}},[i("i",{staticClass:"bk-icon icon-refresh"}),e._v("\n                    "+e._s(e.$t('m.newCommon["刷新"]'))+"\n                ")]):e._e()],1):i("bk-form-item",{attrs:{label:"标准运维的任务选择",required:!0,property:"sopsTaskId"}},[i("bk-select",{attrs:{loading:e.loading.sopsTaskList,disabled:e.disabled,searchable:""},on:{change:e.onSopsTaskChange},model:{value:e.item.sopsContent.sopsTask.id,callback:function(t){e.$set(e.item.sopsContent.sopsTask,"id",t)},expression:"item.sopsContent.sopsTask.id"}},e._l(e.sopsTaskList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),e.item.sopsContent.sopsTask.id?i("div",{staticClass:"preview-sops-task",on:{click:function(t){return t.stopPropagation(),e.jumpToSops.apply(null,arguments)}}},[i("i",{staticClass:"bk-icon icon-eye"}),e._v("\n                    "+e._s(e.$t('m.flowManager["预览"]'))+"\n                ")]):e._e()],1)]],2),e._v(" "),e.formLoading?e._e():i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.configLoading},expression:"{ isLoading: configLoading }"}],staticClass:"form-wrapper"},[i("h3",{staticClass:"setion-title"},[e._v(e._s(e.$t('m.newCommon["参数配置"]')))]),e._v(" "),e.showRenderForm?i("render-form",{ref:"renderForm",attrs:{"form-option":e.formOptions,constants:e.item.sopsContent.constants,context:e.item.sopsContent.context,hooked:e.hookedVarList},on:{configLoadingChange:function(t){e.configLoading=t}},scopedSlots:e._u([{key:"tagHook",fn:function(t){var n=t.scheme;return[i("div",{staticClass:"hook-area"},[i("bk-checkbox",{attrs:{disabled:e.disabled||e.disabledRenderForm,value:!!e.hookedVarList[n.tag_code]},on:{change:function(t){return e.onHookChange(t,n)}}},[e._v("\n                        "+e._s(e.$t('m.tickets["引用变量"]'))+"\n                    ")]),e._v(" "),e.hookedVarList[n.tag_code]?i("div",{staticClass:"var-select"},[i("bk-select",{class:{"quote-error":e.quoteErrors.includes(n.tag_code)},attrs:{disabled:e.disabled||e.disabledRenderForm,clearable:!1,value:e.item.sopsContent.formData[n.tag_code].replace(/^\$\{/,"").replace(/\}$/,"")},on:{selected:function(t){return e.onSelectVar(t,n)}}},e._l(e.quoteVars,(function(t){return i("bk-option",{key:t.key,attrs:{id:t.key,name:t.name}},[e._v("\n                                "+e._s(t.name)+"\n                            ")])})),1),e._v(" "),e.quoteErrors.includes(n.tag_code)?i("span",{staticClass:"quote-error-text"},[e._v(e._s(e.$t('m.tickets["请选择变量"]')))]):e._e(),e._v(" "),e.item.sopsContent.constants.find((function(e){return e.key===n.tag_code})).changed?e._e():i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.$t("m.tickets['配置有更新']"),expression:"$t(`m.tickets['配置有更新']`)",modifiers:{top:!0}}],staticClass:"bk-icon icon-info update-tips"})],1):e._e()],1)]}}],null,!1,3285194288),model:{value:e.item.sopsContent.formData,callback:function(t){e.$set(e.item.sopsContent,"formData",t)},expression:"item.sopsContent.formData"}}):i("no-data")],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},WvBE:function(e,t,i){},WzOL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("QbLZ")),o=r(i("u8Ap")),a=i("L2JU"),s=i("CeR/");function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"triggerFields",components:{memberSelect:o.default},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{keyList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,a.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.keyList=e}},created:function(){this.item.value&&(this.keyList=this.triggerVariables,this.getConditionList())},methods:{getConditionList:function(){var e=this,t=this.keyList.filter((function(t){return t.key===e.item.key}))[0];["SELECT","RADIO","MULTISELECT","CHECKBOX"].some((function(e){return e===t.type}))&&(this.$set(this.item,"loading",!0),this.$set(this.item,"options",[]),"DATADICT"===t.source_type?this.$store.dispatch("datadict/get_data_by_key",{key:t.source_uri,field_key:t.key}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):"API"===t.source_type?this.$store.dispatch("apiRemote/get_data_workflow",{kv_relation:t.kv_relation,api_instance_id:t.api_instance_id}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):"RPC"===t.source_type?this.$store.dispatch("apiRemote/getRpcData",{meta:t.meta,source_uri:t.source_uri}).then((function(t){e.item.options=t.data.map((function(e){return{key:e.key,name:e.name}}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.item.loading=!1})):(this.item.options=t.choice.map((function(e){return{key:e.key,name:e.name}})),this.item.loading=!1))}}}},X5Hi:function(e,t,i){"use strict";i("cjoU")},XDfz:function(e,t,i){"use strict";i.r(t);var n=i("RgGx"),o=i("c6BP");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("yhLn");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"4bfee756",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/hiddenConditions.vue",t.default=r.exports},XUL0:function(e,t,i){"use strict";i.r(t);var n=i("kSST"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},Xffr:function(e,t,i){"use strict";i("9h1A")},XvPQ:function(e,t,i){"use strict";i("cXfe")},"Y6/M":function(e,t,i){"use strict";i.r(t);var n=i("RPzc"),o=i("CjxG");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("NBCF");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"30763339",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/dataSource.vue",t.default=r.exports},Y9oG:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("gDS+")),o=l(i("14Xm")),a=l(i("D3Ub")),s=l(i("OE89")),r=l(i("efIh")),c=i("CeR/");function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TREESELECT",components:{exportTree:s.default},mixins:[r.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,required:!0,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],treeSlectInfo:{show:!1,treeDataList:[],info:{}}}},computed:{},watch:{"item.val":function(){var e=this;this.treeSlectInfo.treeDataList.forEach((function(t){e.treeData(t)})),this.conditionField(this.item,this.fields)}},mounted:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$nextTick((function(){e.getTreeInfo(),e.conditionField(e.item,e.fields)}));case 1:case"end":return t.stop()}}),t,e)})))()},methods:{getTreeInfo:function(){var e=this,t={},i="";"RPC"===this.item.source_type?(i="apiRemote/getRpcData",t={source_uri:this.item.source_uri}):"DATADICT"===this.item.source_type&&(i="dictdata/getTreeInfo",t={key:this.item.source_uri,view_type:"tree"}),this.$store.dispatch(i,t).then((function(t){e.treeSlectInfo.treeDataList=t.data,e.item.choice=t.data,e.treeSlectInfo.treeDataList.forEach((function(t){e.treeData(t)}))})).catch((function(t){(0,c.errorHandler)(t,e)}))},showTree:function(){var e=this;if(!this.disabled){this.item.checkValue=!1,this.treeSlectInfo.show=!this.treeSlectInfo.show;var t="";this.fields.forEach((function(i,n){i.id===e.item.id&&(t=n)})),t===this.fields.length-1&&document.getElementById("bkPreview")&&setTimeout((function(){document.getElementById("bkPreview").scrollTop+=100}),100)}},closeTree:function(){this.treeSlectInfo.show=!1},toggleInfo:function(e){var t=this;this.treeSlectInfo.treeDataList.forEach((function(e){t.recordCheckFn(e)})),e.checkInfo=!0,this.treeSlectInfo.treeDataList=JSON.parse((0,n.default)(this.treeSlectInfo.treeDataList)),this.treeSlectInfo.info=e,this.item.val=this.treeSlectInfo.info.id,this.closeTree()},treeData:function(e){var t=this;if(e.showChildren=!1,e.checkInfo=!1,e.has_children=!!e.children.length,String(this.item.val)===String(e.id)){e.checkInfo=!0,this.treeSlectInfo.info=e;var i=[];this.treeSlectInfo.info.route&&this.treeSlectInfo.info.route.length&&this.treeSlectInfo.info.route.forEach((function(e){i.push(e.name)})),i.push(this.treeSlectInfo.info.name),this.treeSlectInfo.info.showName=i.join(" / ")}e.has_children&&e.children.length&&e.children.forEach((function(i){i.parent_id===e.id&&(e.showChildren=!0),t.treeData(i)}))},recordCheckFn:function(e){var t=this;e.checkInfo=!1,e.children&&e.children.length&&e.children.forEach((function(e){t.recordCheckFn(e)}))},toggleChildren:function(e){e.showChildren=!e.showChildren,this.treeSlectInfo.treeDataList=JSON.parse((0,n.default)(this.treeSlectInfo.treeDataList))}}}},YAe6:function(e,t,i){},YB4E:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-send-message"},[e.show?i("bk-tab",{attrs:{active:e.activeName},on:{"tab-change":e.changPanel}},e._l(e.itemInfo.sub_components,(function(t,n){return i("bk-tab-panel",e._b({key:n,attrs:{"test-posi-id":t.key}},"bk-tab-panel",t,!1),[i("template",{slot:"label"},[i("bk-checkbox",{staticStyle:{float:"left",margin:"12px 8px 0 0"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"panel.checked"}}),e._v(" "),i("i",{staticClass:"bk-icon",class:[t.icon]}),e._v(" "),i("span",{staticClass:"panel-name"},[e._v(e._s(t.label))])],1),e._v(" "),e._l(e.itemInfo.sub_components,(function(t,o){return e.activeName===t.name?i("div",{key:o},e._l(t.field_schema,(function(a,s){return i("div",{key:s,staticClass:"mb20",attrs:{"test-posi-id":a.key}},[i("bk-form-item",{key:n,attrs:{label:a.name,required:a.required,desc:a.tips}},[i("change-conductor",{attrs:{index:n,"item-info":a,origin:"message"},on:{"change-panel-status":function(i){return e.changePanelStatus(t,o)}}})],1)],1)})),0):e._e()}))],2)})),1):e._e()],1)},o=[];n._withStripped=!0},YSn7:function(e,t,i){"use strict";i("EvQG")},Z0RM:function(e,t,i){"use strict";i("eMS/")},ZFr9:function(e,t,i){"use strict";i("AMCF")},ZGcU:function(e,t,i){"use strict";i("nUMf")},"Za/z":function(e,t,i){"use strict";i.r(t);var n=i("tL1K"),o=i("34/K");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"770ffb0c",null);r.options.__file="src/views/commonComponent/fieldComponent/int.vue",t.default=r.exports},ZsJz:function(e,t,i){"use strict";i.r(t);var n=i("H2GU"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},a6LX:function(e,t,i){"use strict";i.r(t);var n=i("CskW"),o=i("1fnQ");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("fAFy");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"227cb390",null);r.options.__file="src/views/service/editService/ChooseServiceTemplateDialog.vue",t.default=r.exports},aDD8:function(e,t,i){"use strict";i.r(t);var n=i("PAo4"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},aNPh:function(e,t,i){"use strict";i.r(t);var n=i("afae"),o=i("BFl6");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("59Gz");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"4666d064",null);r.options.__file="src/views/processManagement/publicTrigger/addTrigger.vue",t.default=r.exports},aQoq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=b(i("P2sY")),o=b(i("m1cH")),a=b(i("14Xm")),s=b(i("gDS+")),r=b(i("D3Ub")),c=b(i("NGZu")),l=b(i("c6Q5")),u=b(i("uK6t")),d=b(i("1Eew")),f=b(i("rMih")),p=b(i("VflG")),m=b(i("bcjM")),h=b(i("PIEm")),v=b(i("s4tT")),g=i("CeR/");function b(e){return e&&e.__esModule?e:{default:e}}t.default={name:"autoNode",components:{getParam:c.default,postParam:l.default,responseDataNode:u.default,nodeCondition:d.default,addField:f.default,commonTriggerList:m.default,dealPerson:h.default,BasicCard:v.default},mixins:[p.default],props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}},state:{type:[String,Number],default:function(){return""}}},data:function(){return{isLoading:!0,lineInfo:{template:"",condition_type:"",name:"",checkName:!1,between:"and",expressions:[{type:"and",expressions:[{condition:"",key:"",name:"",value:"",choiceList:"",type:"string",organization:{assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1}}]}]},formInfo:{workflow:"",name:"",type:"TASK",api_info:{remote_system_id:"",remote_api_id:"",req_params:{},req_body:{},rsp_data:"data.info,data.result",need_poll:!1,succeed_conditions:{expressions:[],type:"and"},end_conditions:{poll_interval:1,poll_time:3}},variables:{inputs:[],outputs:[]},processors_type:"",processors:""},processorsInfo:{type:"",value:""},checkStatus:{processors:!1},organizaInfo:{processorsShow:!1,assignorShow:!1},fieldList:[],excludeRoleTypeList:[],apiDetail:{},apiList:[],apiSysList:[],secondClick:!1,stateList:[],clickSecond:!1,sliderInfo:{title:this.$t('m.treeinfo["添加变量"]'),show:!1,width:700},showTabData:{},changeInfo:{workflow:"",id:"",key:"",name:"",type:"STRING",desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],is_builtin:!1,source_type:"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:""}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.configur;case 2:return t.next=4,e.flowInfo;case 4:return e.formInfo.name=e.configur.name,e.getRelatedFields(),e.getExcludeRoleTypeList(),e.configur.processors_type&&(e.formInfo.processors_type=e.configur.processors_type,e.formInfo.processors="PERSON"===e.formInfo.processors_type?e.configur.processors.split(","):e.configur.processors),e.processorsInfo={type:e.configur.processors_type,value:e.configur.processors},e.configur.api_info&&(e.formInfo.api_info=JSON.parse((0,s.default)(e.configur.api_info))),t.next=12,e.getRemoteSystemData();case 12:return t.next=14,e.getApiTableList(e.formInfo.api_info.remote_system_id);case 14:case"end":return t.stop()}}),t,e)})))()},getExcludeRoleTypeList:function(){var e=[];e=this.configur.is_builtin?["BY_ASSIGNOR","STARTER","VARIABLE"]:["OPEN"],"DISTRIBUTE_THEN_PROCESS"!==this.configur.distribute_type&&"DISTRIBUTE_THEN_CLAIM"!==this.configur.distribute_type&&e.push("BY_ASSIGNOR"),this.flowInfo.is_biz_needed||e.push("CMDB"),this.excludeRoleTypeList=["EMPTY","API"].concat((0,o.default)(e))},submitNode:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i,n,o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.apiFz();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(e.checkLineInfo()){t.next=7;break}return t.abrupt("return");case 7:if(e.formInfo.workflow=e.flowInfo.id,(i=JSON.parse((0,s.default)(e.formInfo))).is_draft=!1,i.processors_type="",i.processors="",!e.$refs.processors||e.$refs.processors.verifyValue()){t.next=15;break}return e.checkStatus.processors=!0,t.abrupt("return");case 15:if(e.$refs.processors&&(n=e.$refs.processors.getValue(),i.processors_type=n.type,i.processors=n.value),o=e.configur.id,!e.clickSecond){t.next=19;break}return t.abrupt("return");case 19:e.clickSecond=!0,e.$store.dispatch("deployCommon/updateNode",{params:i,id:o}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$emit("closeConfigur",!0)}),(function(t){(0,g.errorHandler)(t,e)})).finally((function(){e.clickSecond=!1}));case 21:case"end":return t.stop()}}),t,e)})))()},getRelatedFields:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={workflow:e.flowInfo.id,state:e.configur.id,field:""},t.next=3,e.$store.dispatch("apiRemote/get_related_fields",i).then((function(t){e.stateList=t.data})).catch((function(t){(0,g.errorHandler)(t,e)}));case 3:case"end":return t.stop()}}),t,e)})))()},closeNode:function(){this.$emit("closeConfigur",!1)},closeShade:function(){this.sliderInfo.show=!1},getRemoteSystemData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={project_key:e.$store.state.project.id},t.next=3,e.$store.dispatch("apiRemote/get_all_remote_system",i).then((function(t){e.apiSysList=t.data.filter((function(e){return e.is_activated}))})).catch((function(t){(0,g.errorHandler)(t,e)}));case 3:case"end":return t.stop()}}),t,e)})))()},getApiTableList:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var o;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o={remote_system:e||""},t.isLoading=!0,i.next=4,t.$store.dispatch("apiRemote/get_remote_api",o).then((function(e){t.apiList=e.data.filter((function(e){return e.is_activated})),t.configur.api_info&&(t.apiDetail=(0,n.default)({},t.apiList.filter((function(e){return e.id===t.configur.api_info.remote_api_id}))[0]))})).catch((function(e){(0,g.errorHandler)(e,t)})).finally((function(){t.isLoading=!1}));case 4:case"end":return i.stop()}}),i,t)})))()},changeMethod:function(e,t){var i=this;return(0,r.default)(a.default.mark((function t(){var o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.lineInfo={template:"",condition_type:"",name:"",checkName:!1,between:"and",expressions:[{type:"and",expressions:[{condition:"",key:"",name:"",value:"",choiceList:"",type:"string",organization:{assignorPerson:[],assignorTree:{}},organizaInfo:{assignorShow:!1}}]}]},i.formInfo.variables={inputs:[],outputs:[]},i.formInfo.api_info.need_poll=!1,i.formInfo.api_info.succeed_conditions={expressions:[],type:"and"},i.formInfo.api_info.end_conditions={poll_interval:1,poll_time:3},i.configur.api_info&&i.configur.api_info.remote_api_id===e&&(i.formInfo.api_info=JSON.parse((0,s.default)(i.configur.api_info))),o=i.apiList.filter((function(t){return t.id===e}))[0],t.next=9,(0,n.default)({},o);case 9:i.apiDetail=t.sent;case 10:case"end":return t.stop()}}),t,i)})))()},changeCode:function(e,t){this.formInfo.api_info.remote_api_id="",this.formInfo.api_info.req_params={},this.formInfo.api_info.req_body={},this.formInfo.api_info.rsp_data="",this.getApiTableList(e)},checkLineInfo:function(){return!this.formInfo.api_info.need_poll||(this.lineInfo.expressions.forEach((function(e){e.checkInfo=e.expressions.some((function(e){return!e.condition.toString()||!e.key.toString()||!e.value.toString()}))})),this.lineInfo.expressions.some((function(e){return e.checkInfo}))?(this.$bkMessage({message:this.$t('m.treeinfo["请完善轮询配置！"]'),theme:"warning"}),!1):(this.formInfo.api_info.succeed_conditions={expressions:[],type:this.lineInfo.between},this.formInfo.api_info.succeed_conditions.expressions=this.lineInfo.expressions.map((function(e){var t={type:e.type,expressions:[]};return t.expressions=e.expressions.map((function(e){return{key:e.key.split(",").map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),condition:e.condition,value:"number"===e.type?Number(e.value):"boolean"===e.type?!!Number(e.value):e.value,type:e.type,source:"global",choiceList:[]}})),t})),this.formInfo.api_info.end_conditions.poll_interval.toString()&&this.formInfo.api_info.end_conditions.poll_time.toString()?(this.formInfo.api_info.end_conditions.poll_interval=Number(this.formInfo.api_info.end_conditions.poll_interval),this.formInfo.api_info.end_conditions.poll_time=Number(this.formInfo.api_info.end_conditions.poll_time),!0):(this.$bkMessage({message:this.$t('m.treeinfo["请完善轮询间隔、次数！"]'),theme:"warning"}),!1)))},apiFz:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i,n,o;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.formInfo.name){t.next=3;break}return e.$bkMessage({message:e.$t('m.treeinfo["请填写节点名称！"]'),theme:"warning"}),t.abrupt("return",!1);case 3:if(e.formInfo.api_info.remote_system_id&&e.formInfo.api_info.remote_api_id){t.next=6;break}return e.$bkMessage({message:e.$t('m.treeinfo["请选取接口！"]'),theme:"warning"}),t.abrupt("return",!1);case 6:if(!e.$refs.getParam){t.next=13;break}if((i=e.$refs.getParam.paramTableData.filter((function(e){return e.is_necessary}))).forEach((function(e,t){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?!!e.value:!!e.value_key})),!i.filter((function(e){return!e.isSatisfied}))[0]){t.next=13;break}return e.$bkMessage({message:e.$t('m.treeinfo["请输入GET参数！"]'),theme:"warning"}),t.abrupt("return",!1);case 13:if(!e.$refs.postParam){t.next=21;break}if((n=e.$refs.postParam.bodyTableData.filter((function(e){return e.is_necessary&&"object"!==e.type&&"array"!==e.type}))).forEach((function(e,t){e.isCheck=!0,e.isSatisfied="CUSTOM"===e.source_type?e.value.toString():!!e.value_key})),!n.filter((function(e){return!e.isSatisfied}))[0]){t.next=21;break}return e.$refs.postParam.bodyTableData.forEach((function(e){e.showChildren=!0,e.isShow=!0})),e.$bkMessage({message:e.$t('m.treeinfo["请输入POST参数！"]'),theme:"warning"}),t.abrupt("return",!1);case 21:if(e.$refs.getParam){t.next=25;break}t.t0={},t.next=28;break;case 25:return t.next=27,e.listTojson(e.$refs.getParam.paramTableData);case 27:t.t0=t.sent;case 28:if(e.formInfo.api_info.req_params=t.t0,e.$refs.postParam){t.next=33;break}t.t1={},t.next=36;break;case 33:return t.next=35,e.treeToJson(e.$refs.postParam.bodyTableData.filter((function(e){return!e.level})));case 35:t.t1=t.sent;case 36:if(e.formInfo.api_info.req_body=t.t1,(o=e.$refs.responseDataNode?e.$refs.responseDataNode.responseTableData.filter((function(e){return e.isSelectedKey})):[]).length){t.next=40;break}return t.abrupt("return",!0);case 40:if(o.every((function(e){return!!e.isSelectedValue}))){t.next=47;break}return e.$refs.responseDataNode&&e.$refs.responseDataNode.responseTableData.forEach((function(e){e.showChildren=!0,e.isShow=!0})),e.$bkMessage({message:e.$t('m.treeinfo["勾选全局变量后，请提供变量名"]'),theme:"warning"}),o.forEach((function(e,t){e.isCheck=!0,e.isSatisfied=e.isSelectedValue})),t.abrupt("return",!1);case 47:return e.formInfo.variables.outputs=o.map((function(e){var t={name:"",ref_path:"",type:e.type,source:"global"};return t.name=JSON.parse((0,s.default)(e.isSelectedValue)),t.ref_path=e.ancestorsList_str.split(",").map((function(e){return e=e.replace(/^\d+\_/,"")})).join("."),t})),e.formInfo.api_info.rsp_data=e.formInfo.variables.outputs.map((function(e){return e.ref_path})).join(","),t.abrupt("return",!0);case 50:case"end":return t.stop()}}),t,e)})))()},listTojson:function(e){var t={};return e.length&&e.forEach((function(e){t[e.name]="CUSTOM"===e.source_type?e.value:"${params_"+e.value_key+"}"})),t},addNewItem:function(e){this.showTabData=e,this.sliderInfo.show=!0}}}},aYIO:function(e,t,i){"use strict";i.r(t);var n=i("WuEG"),o=i("sshH");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("jmL5");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"fc036204",null);r.options.__file="src/views/commonComponent/fieldComponent/sopsTemplate.vue",t.default=r.exports},aezY:function(e,t,i){},afae:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-add-trigger"},[i("div",{staticClass:"bk-service-name"},[i("h1",[i("span",{staticClass:"is-outline"}),e._v(e._s(e.$t('m.trigger["基础信息"]')))])]),e._v(" "),i("div",{staticClass:"bk-trigger-basic"},[i("bk-form",{ref:"triggerBasic",attrs:{"label-width":170,model:e.formData,"ext-cls":"bk-basic-form","form-type":"vertical",rules:e.rules}},[i("bk-form-item",{attrs:{label:e.$t("m.trigger['触发器名称']"),"data-test-id":"trigger-input-name",required:!0,property:"name"}},[i("bk-input",{attrs:{placeholder:e.$t("m.trigger['请输入触发器名称']")},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.trigger['是否启用']")}},[i("bk-switcher",{attrs:{"data-test-id":"triggers_switcher_isUseTrigger",size:"small"},model:{value:e.formData.is_enabled,callback:function(t){e.$set(e.formData,"is_enabled",t)},expression:"formData.is_enabled"}})],1),e._v(" "),e.originInfoToTrigger.id?e._e():[i("bk-form-item",{attrs:{label:e.$t("m.trigger['基础模型']")}},[i("bk-select",{attrs:{searchable:"",loading:e.formData.variableLoading,disabled:e.formData.moduleTypeDisabled,"font-size":"medium"},on:{selected:e.giveTableVariables},model:{value:e.formData.moduleType,callback:function(t){e.$set(e.formData,"moduleType",t)},expression:"formData.moduleType"}},e._l(e.moduleTypes,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1)],e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.trigger['触发器描述']")}},[i("bk-input",{attrs:{placeholder:e.$t("m.trigger['请输入触发器描述']"),type:"textarea",rows:3,maxlength:100},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1)],2),e._v(" "),i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.handleClickOutSide,expression:"handleClickOutSide"}],staticClass:"bk-basic-type"},[i("p",{staticClass:"bk-type-icon"},[i("i",{staticClass:"bk-itsm-icon",class:[e.iconInfo.key]})]),e._v(" "),i("p",{staticClass:"bk-type-name"},[e._v(e._s(e.iconInfo.name))]),e._v(" "),i("div",{staticClass:"bk-type-change",class:{"bk-show":e.iconInfo.status},attrs:{"data-test-id":"trigger_div_changeType"},on:{click:e.handleClick}},[i("span",[e._v(e._s(e.$t("m.trigger['点击更换']")))])]),e._v(" "),e.iconInfo.status?i("ul",{staticClass:"bk-icon-list"},e._l(e.iconList,(function(t,n){return i("li",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.name,expression:"item.name"}],key:n,on:{click:function(i){return e.changeIcon(t)}}},[i("i",{staticClass:"bk-itsm-icon",class:[t.key],staticStyle:{"font-size":"24px"}})])})),0):e._e()])],1),e._v(" "),i("div",{staticClass:"bk-service-name"},[i("h1",[i("span",{staticClass:"is-outline"}),e._v(e._s(e.$t("m.trigger['触发机制']")))])]),e._v(" "),i("div",{staticClass:"bk-trigger-made"},[i("bk-form",{ref:"triggerMade",attrs:{"label-width":170,model:e.formData,"form-type":"vertical",rules:e.rules}},[i("bk-form-item",{staticStyle:{width:"300px"},attrs:{label:e.$t("m.trigger['触发事件']"),"data-test-id":"trigger-select-triggerEvent",required:!0,property:"signal"}},[i("bk-select",{attrs:{"data-test-id":"triggers_select_choiceEvent",placeholder:e.$t("m.trigger['请选择触发事件']")},model:{value:e.formData.signal,callback:function(t){e.$set(e.formData,"signal",t)},expression:"formData.signal"}},e._l(e.triggerEventList,(function(t,n){return i("bk-option-group",{key:n,attrs:{name:t.name}},e._l(t.children,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"trigger-div-triggerRules",label:e.$t("m.trigger['触发规则']"),required:!0}},[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.contentLoading},expression:"{ isLoading: contentLoading }"}],staticStyle:{"min-height":"300px"}},[e._l(e.rulesList,(function(t,n){return i("div",{key:n,staticClass:"bk-trigger-rule mb10"},[i("div",{staticClass:"bk-rule-title"},[i("div",{staticStyle:{float:"left","margin-right":"10px"}},[t.showContent?i("i",{staticClass:"bk-icon icon-down-shape icon-cus",on:{click:function(i){return e.showContent(t)}}}):i("i",{staticClass:"bk-icon icon-right-shape icon-cus",on:{click:function(i){return e.showContent(t)}}})]),e._v(" "),t.nameChange?i("div",{staticClass:"bk-name-input"},[i("bk-input",{staticStyle:{width:"260px",display:"inline-block"},attrs:{clearable:!0},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"item.name"}}),e._v(" "),i("span",{staticClass:"bk-input-submit",on:{click:function(i){return i.stopPropagation(),e.handleClickName(t,"submit")}}},[e._v(e._s(e.$t("m.trigger['确认']")))]),e._v(" "),i("span",{staticClass:"bk-input-submit",on:{click:function(i){return i.stopPropagation(),e.handleClickName(t,"close")}}},[e._v(e._s(e.$t("m.trigger['取消']")))])],1):i("span",{staticClass:"bk-title-name",on:{click:function(i){return i.stopPropagation(),e.changeName(t)}}},[e._v("\n                                "+e._s(t.name||e.$t("m.trigger['规则']")+"-"+(n+1))+"\n                            ")]),e._v(" "),1!==e.rulesList.length?[i("i",{staticClass:"bk-icon icon-close icon-nodelete",on:{click:function(t){return t.stopPropagation(),e.deleteRule(n)}}})]:[i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top-start",value:e.$t("m.trigger['规则不能为空']"),expression:"$t(`m.trigger['规则不能为空']`)",modifiers:{"top-start":!0}}],staticClass:"bk-icon icon-close icon-nodelete",attrs:{"data-test-id":"trigger_i_closeTriggerRule"}})],e._v(" "),i("div",{staticClass:"bk-condition-switch"},[i("span",{staticClass:"mr5"},[e._v(e._s(e.$t("m.trigger['条件触发']")))]),e._v(" "),i("bk-switcher",{attrs:{"data-test-id":"triggers_switcher_conditionTriggered",size:"small"},model:{value:t.triggerStatus,callback:function(i){e.$set(t,"triggerStatus",i)},expression:"item.triggerStatus"}})],1)],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showContent,expression:"item.showContent"}]},[t.triggerStatus?i("trigger-condition",{attrs:{"trigger-rules":t.triggerRules}}):e._e(),e._v(" "),i("response-condition",{attrs:{signal:e.formData.signal,"response-way-list":e.responseWayList,"response-list":t.responseList}})],1)])})),e._v(" "),i("p",{staticClass:"bk-add-rules",on:{click:e.addRule}},[i("i",{staticClass:"bk-icon icon-plus-circle"}),i("span",{attrs:{"data-test-id":"trigger_span_addTriggerRules"}},[e._v(e._s(e.$t("m.trigger['添加规则']")))])])],2)])],1)],1),e._v(" "),i("div",{staticClass:"bk-submit-trigger"},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"trigger_button_submitTrigger",title:e.$t("m.trigger['确认']"),disabled:e.btnLoading},on:{click:function(t){return e.submitTrigger(!1)}}},[e._v("\n            "+e._s(e.$t("m.trigger['确认']"))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"trigger_button_submitTrigger",title:e.$t("m.trigger['保持草稿']"),disabled:e.btnLoading},on:{click:function(t){return e.submitTrigger(!0)}}},[e._v("\n            "+e._s(e.$t("m.trigger['保持草稿']"))+"\n        ")]),e._v(" "),i("bk-button",{attrs:{theme:"default","data-test-id":"trigger_button_KeepDraft",disabled:e.btnLoading,title:e.$t("m.trigger['取消']")},on:{click:e.closeTrigger}},[e._v("\n            "+e._s(e.$t("m.trigger['取消']"))+"\n        ")])],1)])},o=[];n._withStripped=!0},alqI:function(e,t,i){"use strict";i("YAe6")},aorS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-table",{attrs:{data:e.item.val,size:"small"}},[e._l(e.item.choice,(function(t){return[i("bk-table-column",{key:t.key,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){return[i("bk-input",{attrs:{clearable:!0,disabled:e.disabled},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[title.key]"}})]}}],null,!0)})]})),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.user['操作']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("bk-button",{attrs:{theme:"primary",disabled:e.disabled,text:""},on:{click:e.addOne}},[e._v("\n                        "+e._s(e.$t('m.newCommon["添加"]'))+"\n                    ")]),e._v(" "),i("bk-button",{attrs:{theme:"primary",disabled:e.disabled,text:""},on:{click:function(i){return e.deleteOne(t)}}},[e._v("\n                        "+e._s(e.$t('m.newCommon["删除"]'))+"\n                    ")])]}}],null,!1,1291864603)})],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},ayEi:function(e,t,i){"use strict";i("oN1V")},"b/Aw":function(e,t,i){"use strict";i.r(t);var n=i("nuXq"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},b0Dy:function(e,t,i){"use strict";i.r(t);var n=i("SO4U"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"b1K/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,n,o){var a=sessionStorage.getItem("cursorIndex"),s=a&&JSON.parse(a);if(!e||!e.selectionStart&&0!==e.selectionStart||s.name!==t)return i+n;var r=s.start,c=s.end,l=e.scrollTop;return o.$nextTick((function(){e.selectionStart=r+n.length,e.selectionEnd=r+n.length,e.scrollTop=l,e.focus()})),i.substr(0,r)+n+i.substr(c)}},b1uY:function(e,t,i){"use strict";i("QcZ3")},bIVE:function(e,t,i){"use strict";i.r(t);var n=i("Ieu/"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},bYAj:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"child-node"},e._l(e.treeDataList,(function(t,n){return i("li",{key:n,staticClass:"vue-tree-item"},[i("div",{class:["tree-node",{down:t.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:t.checkInfo}],style:e.pLeft,on:{click:function(i){return e.toggle(t)}}},[t.showChildren?i("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}):i("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}),e._v(" "),i("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),i("span",{staticClass:"name-text",attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),t.checkInfo?i("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]),e._v(" "),i("collapse-transition",[t.showChildren&&t.children?[i("Tree",{attrs:{"tree-data-list":t.children,"tree-index":e.treeIndex+1},on:{toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})),0)},o=[];n._withStripped=!0},bcjM:function(e,t,i){"use strict";i.r(t);var n=i("PwIM"),o=i("ZsJz");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("OkKR");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"441ea35b",null);r.options.__file="src/views/processManagement/taskTemplate/components/commonTriggerList.vue",t.default=r.exports},bddw:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("FQeJ")),o=i("ygAv"),a=i("CeR/");i("p77/"),i("9RMS"),i("/l/C"),i("LEOp");var s=l(i("v/C2")),r=l(i("FIf5")),c=i("Tt5C");function l(e){return e&&e.__esModule?e:{default:e}}i("9MOC");["javascript","java","python","shell","powershell","markdown"].forEach((function(e){r.default.registerLanguage(e,i("8gVO")("./"+e))})),t.default={name:"RichTextEditor",components:{FullScreen:n.default,Editor:c.Editor,viewer:c.Viewer},model:{prop:"value",event:"change"},props:{value:{type:String,default:""},options:{type:Object,default:function(){}},id:{type:[String,Number],required:!0},fullTitle:{type:String,default:""},isPreview:{type:Boolean,default:!1}},data:function(){return{isFull:!1,height:250,editorOptions:{viewer:!0,hideModeSwitch:!1,usageStatistics:!1,language:"zh-CN",plugins:[[s.default,{hljs:r.default}]]}}},watch:{value:function(e){var t=this.$refs.toastuiEditor&&this.$refs.toastuiEditor.editor;t&&t.setHtml(e,!0)}},mounted:function(){window.addEventListener("resize",this.handleScreenChange)},beforeDestroy:function(){window.removeEventListener("resize",this.handleScreenChange)},methods:{getHtml:function(){return this.$refs.toastuiEditor.invoke("getHtml")},onEditorLoad:function(){try{var e=this.$refs.toastuiEditor.getRootElement().querySelector(".te-mode-switch-section");e.classList.add("cus-change-mode"),e.querySelector(".te-switch-button.markdown").innerText=this.$t('m.common["Markdown模式"]'),e.querySelector(".te-switch-button.wysiwyg").innerText=this.$t('m.common["富文本模式"]')}catch(e){(0,a.errorHandler)(e)}},onEditorBlur:function(){var e=this.getHtml(),t=(0,o.appendTargetAttrToHtml)(e);this.$emit("change",t)},setHeight:function(e){this.height=e},getFullScreenContentHeight:function(){return document.body.clientHeight-50},handleScreenChange:function(){if(this.isFull){var e=this.getFullScreenContentHeight();this.setHeight(e)}},openFullScreen:function(){this.isFull=!0,this.handleScreenChange()},closeFullSreen:function(){this.isFull=!1,this.setHeight(250)}}}},bxCg:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-trigger-condition"},[i("div",{staticClass:"bk-condition-name"},[i("span",[e._v(e._s(e.$t("m.trigger['触发条件']")))])]),e._v(" "),i("div",{staticClass:"bk-condition-content",on:{click:function(t){e.triggerRules.checkStatus=!1}}},[i("ul",{staticClass:"bk-content-step"},[e._l(e.triggerRules.list,(function(t,n){return i("li",{key:n,staticClass:"bk-content-li"},[i("ul",{staticClass:"bk-content-item",class:{"bk-more-margin":1!==t.itemList.length}},e._l(t.itemList,(function(n,o){return i("li",{key:o,staticClass:"bk-content-item-li",class:{"bk-none-margin":t.itemList.length-1===o}},[1!==t.itemList.length?[o!==t.itemList.length-1?i("div",{staticClass:"bk-content-type",on:{click:function(i){return e.changeBetween(t)}}},[i("span",[e._v(e._s("all"===t.type?e.$t("m.trigger['且']"):e.$t("m.trigger['或']")))]),e._v(" "),i("i",{staticClass:"bk-icon icon-down-shape"})]):e._e(),e._v(" "),i("div",{staticClass:"bk-item-line"}),e._v(" "),0===o?i("div",{staticClass:"bk-item-line-none bk-item-none"}):e._e(),e._v(" "),o===t.itemList.length-1?i("div",{staticClass:"bk-item-line-none bk-item-none-bottom"}):e._e()]:e._e(),e._v(" "),i("bk-select",{staticStyle:{width:"190px"},attrs:{"ext-cls":"bk-item-float",clearable:!1,searchable:""},on:{change:function(t){return e.changeContent(n)}},model:{value:n.key,callback:function(t){e.$set(n,"key",t)},expression:"node.key"}},e._l(e.keyList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),i("bk-select",{staticStyle:{width:"140px"},attrs:{"ext-cls":"bk-item-float",clearable:!1,searchable:""},on:{selected:function(t){return e.changeCondition(n)}},model:{value:n.condition,callback:function(t){e.$set(n,"condition",t)},expression:"node.condition"}},e._l(n.conditionList,(function(e){return i("bk-option",{key:e.name,attrs:{id:e.name,name:e.label}})})),1),e._v(" "),"none"!==n.conditionType?[i("trigger-field",{staticStyle:{width:"170px",float:"left","margin-right":"8px"},attrs:{item:n}})]:e._e(),e._v(" "),i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addLine(t,n,o)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===t.itemList.length},on:{click:function(i){return e.deleteLine(t,n,o)}}})])],2)})),0),e._v(" "),i("i",{staticClass:"bk-icon icon-close-circle-shape",class:{"bk-no-delete":1===e.triggerRules.list.length},on:{click:function(i){return e.deleteGroup(t,n)}}}),e._v(" "),i("div",{staticClass:"bk-content-type",on:{click:e.handleBetween}},[i("span",[e._v(e._s("all"===e.triggerRules.type?e.$t("m.trigger['且']"):e.$t("m.trigger['或']")))]),e._v(" "),i("i",{staticClass:"bk-icon icon-down-shape"})]),e._v(" "),i("div",{staticClass:"bk-item-line"}),e._v(" "),0===n?i("div",{staticClass:"bk-item-line-none bk-item-none"}):e._e(),e._v(" "),1!==t.itemList.length?i("div",{staticClass:"bk-content-line"}):e._e()])})),e._v(" "),i("li",{staticClass:"bk-content-add"},[i("span",{on:{click:e.addGroup}},[i("i",{staticClass:"bk-icon icon-plus-circle mr5"}),i("span",[e._v(e._s(e.$t("m.trigger['添加']")))])]),e._v(" "),i("div",{staticClass:"bk-item-line"}),e._v(" "),i("div",{staticClass:"bk-item-line-none",class:{"bk-item-over-line":e.triggerRules.checkStatus}})])],2),e._v(" "),i("div",{staticClass:"bk-content-line"}),e._v(" "),e.triggerRules.checkStatus?i("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['请填写完整的触发条件']")))]):e._e()])])},o=[];n._withStripped=!0},"c+QL":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-response-content"},[i("div",{on:{click:function(t){e.item.contentStatus=!1}}},[i("bk-form",{ref:"conductorForm",attrs:{"form-type":"horizontal","label-width":200}},["api"===e.item.wayInfo.key?[i("api-call",{attrs:{item:e.item}})]:"modify_field"===e.item.wayInfo.key?[i("modify-field",{attrs:{"field-schema":e.item.wayInfo.field_schema}})]:[e._l(e.item.wayInfo.field_schema,(function(e,t){return["SUBCOMPONENT"===e.type?[i("send-message",{key:t,attrs:{"item-info":e}})]:[i("bk-form-item",{key:t,attrs:{"ext-cls":e.required?"bk-field-schema mb20":"bk-field-schema no-require-item mb20",label:e.name,required:e.required,desc:e.tips}},[i("change-conductor",{attrs:{"item-info":e}})],1)]]}))],e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.trigger['执行方式']"),required:!0,"ext-cls":"bk-field-schema mb20"}},[i("bk-radio-group",{model:{value:e.item.performData.runMode,callback:function(t){e.$set(e.item.performData,"runMode",t)},expression:"item.performData.runMode"}},[i("bk-radio",{attrs:{value:"BACKEND","ext-cls":"mr50 pr10"}},[e._v(e._s(e.$t("m.trigger['后台自动执行']")))]),e._v(" "),e.isShowFrontendTrigger?i("bk-radio",{attrs:{value:"MANUAL"}},[e._v(e._s(e.$t("m.trigger['前台按钮触发']")))]):e._e()],1)],1),e._v(" "),"MANUAL"===e.item.performData.runMode?[i("bk-form-item",{attrs:{required:!0,label:e.$t("m.trigger['按钮名称']"),"ext-cls":"bk-field-schema mb20"}},[i("bk-input",{staticStyle:{width:"260px"},attrs:{clearable:!0},model:{value:e.item.performData.displayName,callback:function(t){e.$set(e.item.performData,"displayName",t)},expression:"item.performData.displayName"}})],1),e._v(" "),i("bk-form-item",{attrs:{required:!0,label:e.$t("m.trigger['触发次数']"),"ext-cls":"bk-field-schema"}},[i("bk-radio-group",{model:{value:e.item.performData.repeat,callback:function(t){e.$set(e.item.performData,"repeat",t)},expression:"item.performData.repeat"}},[i("bk-radio",{attrs:{value:"one","ext-cls":"mr50 pr10"}},[e._v(e._s(e.$t("m.trigger['一次']")))]),e._v(" "),i("bk-radio",{attrs:{value:"more"}},[e._v(e._s(e.$t("m.trigger['不限']")))])],1)],1)]:e._e()],2),e._v(" "),e.item.contentStatus?i("p",{staticClass:"bk-error-info"},[e._v(e._s(e.$t("m.trigger['您还有内容未填写，请确认。']")))]):e._e()],1)])},o=[];n._withStripped=!0},c6BP:function(e,t,i){"use strict";i.r(t);var n=i("WP3n"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},c6Q5:function(e,t,i){"use strict";i.r(t);var n=i("d4I9"),o=i("qCK4");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Ho96");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"0d4b5cae",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/postParam.vue",t.default=r.exports},cHGj:function(e,t,i){},cPmg:function(e,t,i){},cXfe:function(e,t,i){},ciLR:function(e,t,i){"use strict";i.r(t);var n=i("xY5K"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},cjoU:function(e,t,i){},d4I9:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[i("bk-table",{attrs:{data:e.tableList,size:"small"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"bk-more"},[i("span",{style:{paddingLeft:20*t.row.level+"px"}},[t.row.has_children?i("span",{class:["bk-icon","tree-expanded-icon",t.row.showChildren?"icon-down-shape":"icon-right-shape"],on:{click:function(i){return e.changeState(t.row)}}}):i("span",{staticClass:"bk-icon bk-more-icon"}),e._v(" "),i("span",[e._v(e._s(t.row.key||"--"))])])])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['类型']"),prop:"type"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['是否必须']")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.desc}},[e._v(e._s(t.row.desc||"--"))])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isStatic&&"object"!==t.row.type&&"array"!==t.row.type?[e._v("\n                    "+e._s(t.row.customValue||"--")+"\n                ")]:e.isCustom&&"object"!==t.row.type&&"array"!==t.row.type?[i("bk-input",{attrs:{type:"string"===t.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.customValue,callback:function(i){e.$set(t.row,"customValue",i)},expression:"props.row.customValue"}})]:["object"!==t.row.type&&"array"!==t.row.type?[i("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"15px"}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:t.row.source_type,callback:function(i){e.$set(t.row,"source_type",i)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),t.row.source_type&&"CUSTOM"!==t.row.source_type?i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},[i("bk-select",{class:{"bk-border-error":t.row.isCheck&&!t.row.value_key.toString()},attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:t.row.value_key,callback:function(i){e.$set(t.row,"value_key",i)},expression:"props.row.value_key"}},[e._l(e.stateList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),e._v(" "),"addField"!==e.entry?[i("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"extension"},on:{click:function(i){return e.addNewItem(t.row)}},slot:"extension"},[i("i",{staticClass:"bk-icon icon-plus-circle"}),e._v(e._s(e.$t('m.treeinfo["添加变量"]'))+"\n                                    ")])]:e._e()],2)],1):i("div",{staticStyle:{width:"140px",position:"absolute",top:"4px",right:"15px"}},["string"===t.row.type||"number"===t.row.type?[i("bk-input",{class:{"bk-border-error":t.row.isCheck&&!t.row.value.toString()},attrs:{type:"string"===t.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}})]:e._e(),e._v(" "),"boolean"===t.row.type?[i("bk-radio-group",{model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}},[i("bk-radio",{attrs:{value:e.trueSatatus}},[e._v("true")]),e._v(" "),i("bk-radio",{attrs:{value:e.falseSatatus}},[e._v("false")])],1)]:e._e()],2)]:e._e(),e._v(" "),e.isStatic||"array"!==t.row.lastType?e._e():i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addChildren(t.row)}}}),e._v(" "),"array"===t.row.lastType?i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":e.countSon(t.row)},on:{click:function(i){return e.deletChildren(t.row)}}}):e._e()])]]}}])})],1)],1)},o=[];n._withStripped=!0},dGg1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CUSTOM_FORM_TEMPLATE={config:{mode:"sideslider"},schemes:{base_text_scheme:{type:"text",attrs:{styles:{label:["border"],value:["highlight","border"]},desc:"通用描述文字"}},table_text_scheme:{type:"text",attrs:{styles:{label:["border"],value:["highlight","border"]}}},base_table_scheme:{type:"table",attrs:{column:[{name:"操作",type:"text",key:"column1"},{name:"关联相关内容",key:"column2",scheme:"table_text_scheme",attrs:{}},{name:"申请期限",type:"text",key:"column3",attrs:{sort:!0}}]}},sub_table_scheme:{type:"table",attrs:{column:[{name:"关联内容-类型",key:"column1",scheme:"base_text_scheme"},{name:"类型值",key:"column2",scheme:"table_text_scheme"}]}},sub2_table_scheme:{type:"table",attrs:{column:[{name:"主机",key:"column1",scheme:"base_text_scheme"}]}}},form_data:[{label:"业务：",scheme:"base_text_scheme",value:"蓝鲸",desc:"覆盖 scheme 中通用描述文字",children:[{label:"子业务1：",scheme:"base_text_scheme",value:"test1"},{label:"子业务2：",scheme:"base_text_scheme",value:"test2"}]},{label:"提单人：",scheme:"base_text_scheme",value:""},{label:"提单时间：",scheme:"base_text_scheme",value:""}]}},dTVR:function(e,t,i){"use strict";i.r(t);var n=i("9te6"),o=i("q+QX");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("FFUD");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7a1e88dd",null);r.options.__file="src/views/service/editService/lineConfigue/templateNode.vue",t.default=r.exports},dU2m:function(e,t,i){"use strict";i.r(t);var n=i("0vGa"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},dV6M:function(e,t,i){"use strict";i.r(t);var n=i("MQva"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},db1v:function(e,t,i){"use strict";i.r(t);var n=i("HE0t"),o=i("hv+2");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Xffr");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"8f3c1170",null);r.options.__file="src/components/form/selectTree/index.vue",t.default=r.exports},dbV7:function(e,t,i){var n=i("Y7ZC");n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},dwwr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("CeR/");t.default={name:"inheritState",props:{workflow:{type:[String,Number],default:function(){return""}},state:{type:[String,Number],default:function(){return""}},showTabList:{type:Array,default:function(){return[]}},configur:{type:Object,default:function(){return{}}}},data:function(){return{isDataLoading:!1,trueStatus:!0,falseStatus:!1,dataList:[],checkList:[]}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.getTicketTables()},methods:{getTicketTables:function(){var e=this,t=this.workflow;this.isDataLoading=!0,this.$store.dispatch("basicModule/get_ticket_tables",{params:{},id:t}).then((function(t){e.dataList=t.data.fields,e.dataList.forEach((function(t){e.globalChoise.field_type.forEach((function(i){t.type===i.typeName&&e.$set(t,"typeName",i.name)})),e.$set(t,"is_readonly",!1),e.$set(t,"is_disabled",!1),e.showTabList.forEach((function(e){t.key===e.key&&(t.is_readonly=e.is_readonly,t.is_disabled=!0)})),"priority"===t.key&&(t.is_readonly=!0)})),e.configur.is_first_state&&(e.dataList=e.dataList.filter((function(e){return"current_status"!==e.key}))),e.$nextTick((function(){e.dataList.forEach((function(t){t.is_disabled&&e.$refs.table.toggleRowSelection(t,!0)}))}))})).catch((function(t){(0,n.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},handleSelectAll:function(e){this.checkList=e},handleSelect:function(e,t){this.checkList=e},disabledFn:function(e,t){return!this.showTabList.some((function(t){return t.key===e.key}))}}}},eCUP:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-field-preview",attrs:{id:"bkPreview"}},[i("bk-form",{attrs:{"label-width":200,"form-type":"vertical","ext-cls":"bk-ext-form"}},[e._l(e.fields,(function(t,n){return[t.showFeild?i("div",{key:n,class:{"bk-field-line":"COL_12"===t.layout,"bk-field-half":"COL_6"===t.layout}},[i("CW-"+t.type,{tag:"component",attrs:{item:t,fields:e.fields,"is-preview":e.isPreview,"is-file-preview":e.isFilePreview}})],1):e._e()]}))],2)],1)},o=[];n._withStripped=!0},eEXZ:function(e,t,i){},eKnG:function(e,t,i){},eL66:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("4d7F")),o=r(i("14Xm")),a=r(i("D3Ub")),s=i("CeR/");function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TaskConfigPanel",components:{},props:{serviceInfo:{type:Object,default:function(){return{}}}},data:function(){return{taskConfigRule:{taskId:[{required:!0,message:this.$t("m.taskTemplate['请选择任务模板']"),trigger:"blur"}],createNodeId:[{required:!0,message:this.$t("m['请选择可创建任务节点']"),trigger:"blur"}],dealNodeId:[{required:!0,message:this.$t("m['请选择可处理任务的节点']"),trigger:"blur"}]},taskTemplateList:[],normalNodeList:[],taskConditionList:[],selectedDealNodeIds:[],useTask:!1,nodeListLoading:!1}},computed:{taskSettings:function(){if(this.serviceInfo.extras&&this.serviceInfo.extras.task_settings){var e=this.serviceInfo.extras.task_settings;if(Array.isArray(e))return this.serviceInfo.extras.task_settings}return[]}},created:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.initTaskCondition(),e.getTaskTemplateList(),t.next=4,e.getNodeList();case 4:e.handleDealNodeChange();case 5:case"end":return t.stop()}}),t,e)})))()},methods:{initTaskCondition:function(){var e=this;if(this.serviceInfo.extras&&this.serviceInfo.extras.task_settings){var t=this.serviceInfo.extras.task_settings;Array.isArray(t)?(this.taskConditionList=t.map((function(e){var t={taskId:e.task_schema_id,createNodeId:e.create_task_state,dealNodeId:e.execute_task_state,others:[],dealLoading:!1,dealList:[]};return e.execute_can_create&&t.others.push(1),e.need_task_finished&&t.others.push(2),t})),this.taskConditionList.forEach((function(t){e.getCanDealNodeList(t.createNodeId,t)})),this.useTask=!!t.length):(0,s.errorHandler)("taskSettings not Array",this)}},getTaskTemplateList:function(){var e=this;return this.$store.dispatch("taskTemplate/getTemplateList",{is_draft:!1}).then((function(t){e.taskTemplateList=t.data.filter((function(t){return!(!e.serviceInfo.is_biz_needed&&"SOPS"===t.component_type)}))})).catch((function(t){(0,s.errorHandler)(t,e)}))},getNodeList:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.nodeListLoading=!0,t.abrupt("return",e.$store.dispatch("deployCommon/getStates",{workflow:e.serviceInfo.workflow_id}).then((function(t){e.normalNodeList=t.data.filter((function(e){return!e.is_builtin&&"ROUTER-P"!==e.type&&"COVERAGE"!==e.type}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.nodeListLoading=!1})));case 2:case"end":return t.stop()}}),t,e)})))()},getCanDealNodeList:function(e,t){var i=this;if(e){this.$set(t,"dealLoading",!0);var n={id:e,include_self:!0};return this.$store.dispatch("deployCommon/getOrderedStates",n).then((function(e){t.dealList=e.data})).catch((function(e){(0,s.errorHandler)(e,i)})).finally((function(){i.$set(t,"dealLoading",!1)}))}},getAllDealNodeIds:function(){this.selectedDealNodeIds=this.taskConditionList.map((function(e){return e.dealNodeId})).filter((function(e){return!!e}))},handleDealNodeChange:function(){var e=this;this.getAllDealNodeIds(),this.normalNodeList.forEach((function(t){t.disabled=!1,e.selectedDealNodeIds.includes(t.id)&&(t.disabled=!0)}))},onAddCondition:function(){this.taskConditionList.push({taskId:"",createNodeId:"",dealNodeId:"",others:[1,2]})},onDelCondition:function(e){this.taskConditionList.splice(e,1),0===this.taskConditionList.length&&(this.useTask=!1)},validate:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.useTask){t.next=2;break}return t.abrupt("return",!0);case 2:return i=e.$refs.taskForms.map((function(e){return e.validate()})),t.abrupt("return",n.default.all(i));case 4:case"end":return t.stop()}}),t,e)})))()},getPostParams:function(){return this.useTask?this.taskConditionList.map((function(e){return{create_task_state:e.createNodeId,task_schema_id:e.taskId,execute_task_state:e.dealNodeId,need_task_finished:-1!==e.others.indexOf(2),execute_can_create:-1!==e.others.indexOf(1)}})):[]},handleUseTaskChange:function(e){e&&!this.taskConditionList.length&&this.onAddCondition()}}}},"eMS/":function(e,t,i){},eOfU:function(e,t,i){"use strict";i.r(t);var n=i("RQEQ"),o=i("f3v2");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"6dc6a100",null);r.options.__file="src/views/commonComponent/fieldComponent/datetime.vue",t.default=r.exports},eQfd:function(e,t,i){"use strict";i.r(t);var n=i("eCUP"),o=i("gt7i");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("R6Sx");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"84051ab6",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/fieldPreview.vue",t.default=r.exports},efIh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),o=s(i("D3Ub")),a=i("CeR/");function s(e){return e&&e.__esModule?e:{default:e}}t.default={methods:{getFieldOptions:function(e){var t=this;return(0,o.default)(n.default.mark((function i(){var o;return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=[],i.t0=e.source_type,i.next="CUSTOM"===i.t0?4:"API"===i.t0?6:"DATADICT"===i.t0?9:"RPC"===i.t0?17:24;break;case 4:return o=e.choice,i.abrupt("break",24);case 6:return o=[],e.choice.forEach((function(e){o.push({key:String(e.id||e.key),name:e.name,can_delete:Boolean(e.can_delete)})})),i.abrupt("break",24);case 9:if(o=[],!e.choice.some((function(e){return e.can_delete}))){i.next=13;break}return o=e.choice,i.abrupt("break",24);case 13:if("TREESELECT"===e.type){i.next=16;break}return i.next=16,t.$store.dispatch("datadict/get_data_by_key",{key:e.source_uri,field_key:e.key,service:e.service,current_status:e.ticket_status}).then((function(i){o=i.data.map((function(i){var n={key:i.key,name:i.name};return"current_status"===e.key&&t.$set(n,"isOver",i.is_over),n}))})).catch((function(e){(0,a.errorHandler)(e,t)}));case 16:return i.abrupt("break",24);case 17:if(o=[],!e.choice.some((function(e){return e.can_delete}))){i.next=21;break}return o=e.choice,i.abrupt("break",24);case 21:return i.next=23,t.$store.dispatch("apiRemote/getRpcData",e).then((function(e){o=e.data})).catch((function(e){(0,a.errorHandler)(e,t)}));case 23:return i.abrupt("break",24);case 24:return i.abrupt("return",o);case 25:case"end":return i.stop()}}),i,t)})))()},judgeValue:function(e,t){if(e)return t.some((function(t){return-1!==e.toString().indexOf(t.key)}))},conditionField:function(e,t){for(var i=0;i<t.length;i++)if(!t[i].show_type&&(t[i].hasOwnProperty("show_conditions")||t[i].hasOwnProperty("show_result")&&!t[i].show_result)){if(t[i].show_conditions.expressions&&t[i].show_conditions.expressions.length)for(var n=0;n<t[i].show_conditions.expressions.length;n++)if(e.key===t[i].show_conditions.expressions[n].key&&e.key===t[i].key&&null===t[i].value)t[i].showFeild=!0;else if(e.key===t[i].show_conditions.expressions[n].key){if(1===t[i].show_conditions.expressions.length)t[i].showFeild=this.conditionSwitch(e,t[i].show_conditions.expressions[n]);else if("and"===t[i].show_conditions.type){for(var o=[],a=0;a<t[i].show_conditions.expressions.length;a++)for(var s=0;s<t.length;s++)if(t[i].show_conditions.expressions[a].key===t[s].key){var r=this.conditionSwitch(t[s],t[i].show_conditions.expressions[a]);o.push(r)}t[i].showFeild=o.every((function(e){return!!e}))}else{for(var c=[],l=0;l<t[i].show_conditions.expressions.length;l++)for(var u=0;u<t.length;u++)if(t[i].show_conditions.expressions[l].key===t[u].key){var d=this.conditionSwitch(t[u],t[i].show_conditions.expressions[l]);c.push(d)}t[i].showFeild=c.some((function(e){return!!e}))}t[i].showFeild=!t[i].showFeild}}else t[i].showFeild=!0},conditionSwitch:function(e,t){var i=!1,n=["CHECKBOX","MEMBERS","MULTISELECT","TREESELECT"];switch(t.condition){case"==":if(n.some((function(t){return t===e.type})))i=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}))&&e.val.length===t.value.length;else i=e.val===t.value||Number(e.val)===Number(t.value);break;case"!=":if(n.some((function(t){return t===e.type}))){var o=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)}));i=o.some((function(e){return!!e}))?o.some((function(e){return!!e})):e.val.length!==t.value.length}else i=e.val!==t.value&&Number(e.val)!==Number(t.value);break;case">":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)>this.timeStamp(t.value):Number(e.val)>Number(t.value);break;case"<":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)<this.timeStamp(t.value):Number(e.val)<Number(t.value);break;case">=":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)>=this.timeStamp(t.value):Number(e.val)>=Number(t.value);break;case"<=":i="DATE"===e.type||"DATETIME"===e.type?this.timeStamp(e.val)<=this.timeStamp(t.value):Number(e.val)<=Number(t.value);break;case"issuperset":i=t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}));break;case"notissuperset":i=!t.value.split(",").map((function(t){return-1===e.val.indexOf(t)})).every((function(e){return!e}));break;default:i=!0}return i},timeStamp:function(e){var t=e.replace(/-/g,"/");return new Date(t).getTime()}}}},eofb:function(e,t,i){"use strict";i.r(t);var n=i("dwwr"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},ew6e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i("P2sY")),o=f(i("QbLZ")),a=f(i("14Xm")),s=f(i("gDS+")),r=f(i("D3Ub")),c=f(i("PaSM")),l=f(i("uz2X")),u=f(i("8zq1")),d=i("CeR/");function f(e){return e&&e.__esModule?e:{default:e}}t.default={name:"addTrigger",components:{triggerCondition:l.default,responseCondition:u.default},mixins:[c.default],props:{projectId:String,triggerInfo:{type:Object,default:function(){return{}}},originInfoToTrigger:{type:Object,default:function(){return{}}}},data:function(){return{contentLoading:!1,formData:{name:"",is_enabled:!0,desc:"",signal:"",moduleType:"",moduleTypeDisabled:!1,variableLoading:!1},triggerEventList:[],iconList:[{key:"icon-icon-notice-new",name:"",typeName:"message"},{key:"icon-icon-user-new",name:"",typeName:"user"},{key:"icon-icon-status-new",name:"",typeName:"status"},{key:"icon-icon-api-new",name:"",typeName:"api"}],iconInfo:{status:!1,key:"icon-icon-notice-new",name:"",typeName:""},responseWayList:[],rulesList:[],ruleItem:{name:"",historyName:"",nameChange:!1,triggerStatus:!1,showContent:!0,triggerRules:{type:"all",list:[{type:"all",itemList:[{key:"",condition:"",value:"",conditionList:[],type:"STRING"}]}]},responseList:[{way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1}]},backInfo:{responseList:[],triggerInfo:{}},btnLoading:!1,triggerAllRules:[],rules:{},moduleTypes:[]}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){this.initData(),this.rules.name=this.checkCommonRules("name").name,this.rules.signal=this.checkCommonRules("select").select},methods:{initData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i,n,o,r,c,l,u;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n in i=JSON.parse((0,s.default)(e.ruleItem)),e.rulesList.push(i),e.iconList.forEach((function(t){switch(t.key){case"icon-icon-notice-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"message"===e.typeName})).name;break;case"icon-icon-user-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"user"===e.typeName})).name;break;case"icon-icon-status-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"status"===e.typeName})).name;break;case"icon-icon-api-new":t.name=e.globalChoise.trigger_icon.find((function(e){return"api"===e.typeName})).name}})),e.iconInfo.key=e.iconList[0].key,e.iconInfo.name=e.iconList[0].name,e.iconInfo.typeName=e.iconList[0].typeName,e.triggerEventList=[],e.globalChoise.trigger_signals){for(r in o={key:n,name:e.globalChoise.trigger_categories[n],children:[]},e.globalChoise.trigger_signals[n])o.children.push({key:r,name:e.globalChoise.trigger_signals[n][r]});e.triggerEventList.push(o)}if(!e.originInfoToTrigger.id){t.next=21;break}return c=e.originInfoToTrigger.sender,l=e.originInfoToTrigger.type,u={workflow:e.originInfoToTrigger.id},"task_schemas"===l&&(u.stage=e.originInfoToTrigger.stage,delete u.workflow),"states"===l&&(u.state=e.originInfoToTrigger.sender),t.next=16,e.$store.dispatch("trigger/getTriggerVariables",{id:c,type:l,params:u}).then((function(t){e.$store.commit("trigger/changeTriggerVariables",t.data)}));case 16:e.triggerEventList=e.triggerEventList.filter((function(t){return t.key===e.originInfoToTrigger.filter})),e.triggerEventList[0].children=e.triggerEventList[0].children.filter((function(t){return-1!==e.originInfoToTrigger.signal.indexOf(t.key)})),1===e.triggerEventList.length&&1===e.triggerEventList[0].children.length&&(e.formData.signal=e.triggerEventList[0].children[0].key),t.next=22;break;case 21:e.$store.commit("trigger/changeTriggerVariables",e.globalChoise.ticket_variables);case 22:return e.getModuleTypes(),t.next=25,e.getResponseList();case 25:e.triggerInfo.id&&(e.contentLoading=!0,e.getData());case 26:case"end":return t.stop()}}),t,e)})))()},getModuleTypes:function(){var e=this;this.$store.dispatch("basicModule/get_tables",{all:!0}).then((function(t){e.moduleTypes=t.data})).catch((function(t){(0,d.errorHandler)(t,e)}))},getData:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i,n,o,r;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.iconList.find((function(t){return t.typeName===e.triggerInfo.icon})),e.iconInfo.key=i.key,e.iconInfo.name=i.name,e.iconInfo.typeName=i.typeName,e.formData.name=e.triggerInfo.name,e.formData.is_enabled=e.triggerInfo.is_enabled,e.formData.desc=e.triggerInfo.desc,e.formData.signal=e.triggerInfo.signal,e.triggerInfo.source_table_id&&(e.formData.moduleType=e.triggerInfo.source_table_id,e.formData.moduleTypeDisabled=!0,e.giveTableVariables(e.triggerInfo.source_table_id)),t.next=11,e.getTriggerRules();case 11:n=e.triggerAllRules.filter((function(t){return t.trigger_id===e.triggerInfo.id})),e.rulesList=[],o=0;case 14:if(!(o<n.length)){t.next=24;break}return(r=JSON.parse((0,s.default)(e.ruleItem))).triggerStatus=n[o].by_condition||!!n[o].condition,r.triggerStatus&&(r.triggerRules=e.conditionValue(n[o].condition)),r.triggerRules.id=n[o].id,t.next=21,e.responseValue(n[o].action_schemas,r);case 21:o++,t.next=14;break;case 24:e.contentLoading=!1;case 25:case"end":return t.stop()}}),t,e)})))()},conditionValue:function(e){var t=this,i={type:"",list:[]};for(var n in e)i.type=n,e[n].forEach((function(e){var n={};for(var o in e)n.type=o,n.itemList=[],e[o].forEach((function(e){var i={key:e.key,condition:e.operator,meta:e.meta,value:["CHECKBOX","MULTISELECT","MEMBERS","MULTI_MEMBERS","MEMBER"].some((function(t){return t===e.field_type}))?e.value.split(","):e.value,conditionList:[],type:e.field_type};i.conditionList=t.globalChoise.trigger_methods[e.field_type.toLowerCase()],n.itemList.push(i)}));i.list.push(n)}));return i},responseValue:function(e,t){var i=this;return(0,r.default)(a.default.mark((function n(){var o;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={id__in:e.join(",")},n.next=3,i.$store.dispatch("trigger/getResponseListById",o).then((function(e){var n,o=e.data;t.responseList=[],t.name=o[0].name,o.forEach((n=(0,r.default)(a.default.mark((function e(n){var o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o={id:n.id,way:"",wayInfo:{},performData:{runMode:"BACKEND",displayName:"",repeat:"one"},isLoading:!1}).way=n.component_type,o.wayInfo=JSON.parse((0,s.default)(i.responseWayList.find((function(e){return e.key===n.component_type})))),"api"===o.way?o.wayInfo.field_schema.forEach((function(e){n.params.forEach((function(t){e.key===t.key&&i.$set(e,"value",t.value)}))})):o.wayInfo.field_schema.forEach((function(e){"SUBCOMPONENT"===e.type?n.params.forEach((function(t){t.key===e.key&&e.sub_components.forEach((function(e){t.sub_components.forEach((function(t){t.key===e.key&&(e.checked=!0,e.field_schema.forEach((function(e){t.params.forEach((function(t){e.key===t.key&&(e.referenceType=t.ref_type,e.value=t.value)}))})))}))}))})):n.params.forEach((function(t){e.key===t.key&&(i.$set(e,"value",t.value),i.$set(e,"ref_type",t.ref_type))}))})),o.performData.runMode=n.operate_type,o.performData.displayName=n.display_name,o.performData.repeat=n.can_repeat?"more":"one",t.responseList.push(o);case 8:case"end":return e.stop()}}),e,i)}))),function(e){return n.apply(this,arguments)})),i.rulesList.push(t)})).catch((function(e){(0,d.errorHandler)(e,i)}));case 3:case"end":return n.stop()}}),n,i)})))()},getResponseFields:function(e){var t=this;return(0,r.default)(a.default.mark((function i(){var n;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n={source_uri:e.source_uri,trigger_source_id:t.originInfoToTrigger.id,trigger_source_type:"workflow"},i.next=3,t.$store.dispatch("apiRemote/getRpcData",n).then((function(t){e.choice=t.data.map((function(e){return(0,o.default)({},e,{showFeild:!0,value:""})}))})).catch((function(e){(0,d.errorHandler)(e,t)}));case 3:case"end":return i.stop()}}),i,t)})))()},handleClick:function(){this.iconInfo.status=!0},handleClickOutSide:function(){this.iconInfo.status=!1},changeIcon:function(e){this.iconInfo.key=e.key,this.iconInfo.name=e.name,this.iconInfo.typeName=e.typeName,this.iconInfo.status=!1},addRule:function(){var e=JSON.parse((0,s.default)(this.ruleItem));this.rulesList.push(e)},deleteRule:function(e){1!==this.rulesList.length&&this.rulesList.splice(e,1)},changeName:function(e){e.historyName=e.name,e.nameChange=!0},handleClickName:function(e,t){e.nameChange=!1,"close"===t&&(e.name=e.historyName)},showContent:function(e){e.showContent=!e.showContent},submitTrigger:function(e){var t=this;this.$refs.triggerBasic.validate().then((function(i){t.$refs.triggerMade.validate().then((function(i){if(!t.checkInfo()){var n={name:t.formData.name,source_type:"basic",source_id:0,signal:t.formData.signal,source_table_id:t.formData.moduleType,sender:0,is_draft:e,is_enabled:t.formData.is_enabled,icon:t.iconInfo.typeName,desc:t.formData.desc,project_key:t.$store.state.project.id};t.originInfoToTrigger.id&&(n.source_type=t.originInfoToTrigger.source,n.source_id=n.sender=t.originInfoToTrigger.id,n.sender=t.originInfoToTrigger.sender),t.projectId&&(n.project_key=t.projectId),t.triggerInfo.id?t.putTrigger(n):t.creatTrigger(n)}}))}))},checkInfo:function(){var e=this,t=!1;return this.rulesList.forEach((function(i){i.triggerStatus&&i.triggerRules.list.forEach((function(e){e.itemList.forEach((function(e){"non_empty"===e.condition?i.triggerRules.checkStatus=""===e.key||""===e.value:i.triggerRules.checkStatus=""===e.key||""===e.condition||""===e.value}))})),i.responseList.forEach((function(t){e.$set(t,"wayStatus",!t.way),t.wayInfo.field_schema&&("api"===t.wayInfo.key?t.wayInfo.field_schema.forEach((function(e){"api_source"===e.key?t.contentStatus=t.contentStatus?t.contentStatus:!e.apiId:e.apiContent.bodyTableData.forEach((function(e){"array"!==e.type&&"object"!==e.type&&(t.contentStatus=t.contentStatus?t.contentStatus:"CUSTOM"===e.source_type?""===e.value:""===e.value_key)}))})):t.wayInfo.field_schema.forEach((function(e){"SUBCOMPONENT"===e.type&&e.sub_components&&e.sub_components.length?(t.contentStatus=!e.sub_components.some((function(e){return e.checked})),t.contentStatus||e.sub_components.forEach((function(e){e.checked&&e.field_schema.forEach((function(e){e.required&&("MEMBERS"===e.type||"MULTI_MEMBERS"===e.type?t.contentStatus=t.contentStatus?t.contentStatus:e.value.some((function(e){return Array.isArray(e.value)?!e.value.length:!e.value})):t.contentStatus=t.contentStatus?t.contentStatus:!e.value)}))}))):e.required&&("MEMBERS"===e.type||"MULTI_MEMBERS"===e.type?t.contentStatus=t.contentStatus?t.contentStatus:e.value.some((function(e){return Array.isArray(e.value)?!e.value.length:!e.value})):t.contentStatus=t.contentStatus?t.contentStatus:"field_value"===e.key?!(e.itemInfo[0].value||e.itemInfo[0].val):!e.value)})),"MANUAL"!==t.performData.runMode||t.contentStatus||(t.contentStatus=!t.performData.displayName))})),t=i.triggerRules.checkStatus||i.responseList.some((function(e){return e.contentStatus||e.wayStatus}))})),t},closeTrigger:function(){this.$emit("closeTrigger")},creatTrigger:function(e){var t=this;this.btnLoading=!0,this.$store.dispatch("trigger/createTriggerRule",e).then((function(e){t.backInfo.triggerInfo=e.data;var i=t.responseParams();t.createRespond(i)})).catch((function(e){(0,d.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},putTrigger:function(e){var t=this;this.btnLoading=!0;var i=this.triggerInfo.id;this.$store.dispatch("trigger/putTriggerRule",{params:e,id:i}).then((function(e){t.backInfo.triggerInfo=e.data;var i=t.responseParams();t.createRespond(i)})).catch((function(e){(0,d.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},createRespond:function(e){var t=this,i=e,n=this.originInfoToTrigger.id;this.$store.dispatch("trigger/createRespond",{id:n,params:i}).then((function(e){t.backInfo.responseList=e.data,t.createTriggerCondition()})).catch((function(e){(0,d.errorHandler)(e,t),t.btnLoading=!1})).finally((function(){}))},responseParams:function(){var e=this,t=[];return this.rulesList.forEach((function(i){i.responseList.forEach((function(n){var o={};n.id&&(o.id=n.id),o.name=i.name,o.display_name=n.performData.displayName,o.operate_type=n.performData.runMode,o.can_repeat="more"===n.performData.repeat,o.component_type=n.wayInfo.key,o.params=[],"api"===n.wayInfo.key?o.params=e.responseApiInfo(n):n.wayInfo.field_schema.forEach((function(t){if("SUBCOMPONENT"===t.type){var i={key:t.key,sub_components:[]};t.sub_components.forEach((function(t){if(t.checked){var n={key:t.key,params:[]};t.field_schema.forEach((function(t){var i={key:t.key,value:e.formattingValue(t),ref_type:t.referenceType};n.params.push(i)})),i.sub_components.push(n)}})),o.params.push(i)}else{var n={key:t.key,value:e.formattingValue(t),ref_type:t.referenceType};o.params.push(n)}})),t.push(o)}))})),t},responseApiInfo:function(e){var t=this,i=[];return e.wayInfo.field_schema.forEach((function(e){if("api_source"===e.key)i.push({key:e.key,value:e.apiId});else{var n={key:e.key,value:{}};n.value=t.treeToJson(e.apiContent.bodyTableData.filter((function(e){return!e.level}))),i.push(n)}})),i},treeToJson:function(e){var t={},i=function e(t,i,o,a){if(i.key)if("array"===i.type){if("array"===a)for(var s in t.push([]),i.children)e(t[t.length-1],i.children[s],1,"array");if("object"===a){var r={};for(var c in r[i.key]=[],(0,n.default)(t,r),i.children)e(t[i.key],i.children[c],1,"array")}}else if("object"===i.type){var l={};if("array"===a)for(var u in t.push(l),i.children)e(t[t.length-1],i.children[u],1,"object");if("object"===a)for(var d in l[i.key]={},(0,n.default)(t,l),i.children)e(t[i.key],i.children[d],1,"object")}else{if("number"===i.type&&(i.value=Number(i.value)),"array"===a){var f={is_leaf:"object"!==i.type&&"array"!==i.type,ref_type:"CUSTOM"===i.source_type?"custom":"reference",value:"CUSTOM"===i.source_type?i.value:i.value_key};t.push(f)}if("object"===a){var p={};p[i.key]={is_leaf:"object"!==i.type&&"array"!==i.type,ref_type:"CUSTOM"===i.source_type?"custom":"reference",value:"CUSTOM"===i.source_type?i.value:i.value_key},(0,n.default)(t,p)}}};for(var o in e)i(t,e[o],0,"object");return t},formattingValue:function(e){var t="";return"receivers"===e.key||"MEMBERS"===e.type||"MEMBER"===e.type?(t=[],e.value.forEach((function(e){var i={ref_type:"VARIABLE"===e.key?"reference":"custom",value:{member_type:e.key,members:Array.isArray(e.value)?e.value.join(","):e.value}};t.push(i)}))):t="VARIABLE"===e.value?Array.isArray(e.insertValue)?e.insertValue.join(","):e.insertValue:e.itemInfo&&e.itemInfo[0].id?e.itemInfo[0].value||e.itemInfo[0].val:e.value,t},createTriggerCondition:function(){var e=this,t=this.conditionParams(),i=this.backInfo.triggerInfo.id;this.$store.dispatch("trigger/batchTriggerCondition",{params:t,id:i}).then((function(t){e.$bkMessage({message:e.triggerInfo.id?e.$t("m.common['保存成功']"):e.$t("m.trigger['创建成功']"),theme:"success"}),e.closeTrigger(),e.$emit("getList")})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){e.btnLoading=!1}))},conditionParams:function(){var e=this,t=[],i=0;return this.rulesList.forEach((function(n,o){var a={condition:{},name:n.name,by_condition:n.triggerStatus,action_schemas:[]};n.triggerRules.id&&(a.id=n.triggerRules.id),n.triggerStatus?(a.condition[n.triggerRules.type]=[],n.triggerRules.list.forEach((function(e){var t={};t[e.type]=[],e.itemList.forEach((function(i){var n={key:i.key,value:Array.isArray(i.value)?i.value.join(","):i.value,field_type:i.type,operator:i.condition,type:"custom"};t[e.type].push(n)})),a.condition[n.triggerRules.type].push(t)}))):a.condition="",n.responseList.forEach((function(t,n){a.action_schemas.push(e.backInfo.responseList[i+n])})),i+=n.responseList.length,t.push(a)})),t},getTriggerRules:function(){var e=this;return(0,r.default)(a.default.mark((function t(){var i;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={trigger_id:e.triggerInfo.id},t.next=3,e.$store.dispatch("trigger/getTriggerRules",i).then((function(t){e.triggerAllRules=t.data})).catch((function(t){(0,d.errorHandler)(t,e)})).finally((function(){}));case 3:case"end":return t.stop()}}),t,e)})))()},getResponseList:function(){var e=this;return(0,r.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("trigger/getResponseList").then(function(){var t=(0,r.default)(a.default.mark((function t(i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.responseWayList=i.data,e.originInfoToTrigger.id&&"task"!==e.originInfoToTrigger.source?e.responseWayList.forEach((function(t){var i;t.field_schema.forEach((i=(0,r.default)(a.default.mark((function t(i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("RPC"!==i.source_type){t.next=3;break}return t.next=3,e.getResponseFields(i);case 3:case"end":return t.stop()}}),t,e)}))),function(e){return i.apply(this,arguments)}))})):e.responseWayList=e.responseWayList.filter((function(e){return"modify_field"!==e.key&&"modify_specified_state_processor"!==e.key}));case 2:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){(0,d.errorHandler)(t,e)}));case 2:case"end":return t.stop()}}),t,e)})))()},giveTableVariables:function(e){var t=this;this.formData.variableLoading=!0,this.$store.dispatch("basicModule/get_trigger_tables",e).then((function(e){var i=e.data.fields;i.forEach((function(e){e.name+=t.$t("m.trigger['（基础模型）']")})),t.$store.commit("trigger/changeTriggerVariables",t.globalChoise.ticket_variables.concat(i))})).catch((function(e){(0,d.errorHandler)(e,t)})).finally((function(){t.formData.variableLoading=!1}))}}}},"f+2m":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{"full-screen-wrap":e.isFull}},[e.isFull?i("div",{staticClass:"full-screen-header"},[i("span",{staticClass:"full-screen-title"},[e._v(e._s(e.title))]),e._v(" "),i("div",{staticClass:"full-exit-btn",on:{click:function(t){return t.stopPropagation(),e.onClose.apply(null,arguments)}}},[i("i",{staticClass:"bk-itsm-icon icon-order-close"}),e._v(" "),i("span",{staticClass:"exit-text"},[e._v(e._s(e.$t("m.common['退出全屏']")))])])]):e._e(),e._v(" "),i("div",{staticClass:"full-screen-content"},[e._t("default")],2)])},o=[];n._withStripped=!0},f1Q0:function(e,t,i){"use strict";i.r(t);var n=i("Lbk4"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},f3v2:function(e,t,i){"use strict";i.r(t);var n=i("NesJ"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},f5Dy:function(e,t,i){"use strict";i.r(t);var n=i("WzOL"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},fAFy:function(e,t,i){"use strict";i("U33Y")},fJAq:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-input-params"},[i("bk-table",{attrs:{data:e.paramTableData,size:"small"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['名称']"),"min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"bk-more"},[i("span",{style:{paddingLeft:20*t.row.level+"px"}},[t.row.has_children?i("span",{class:["bk-icon","tree-expanded-icon",t.row.showChildren?"icon-down-shape":"icon-right-shape"],on:{click:function(i){return e.changeState(t.row)}}}):i("span",{staticClass:"bk-icon bk-more-icon"}),e._v(" "),i("span",[e._v(e._s(t.row.key||"--"))])])])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['必选']"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.is_necessary?e.$t('m.treeinfo["是"]'):e.$t('m.treeinfo["否"]'))+"\n            ")]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['备注']"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.desc}},[e._v(e._s(t.row.desc||"--"))])]}}])}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return["object"!==t.row.type&&"array"!==t.row.type?[i("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",left:"10px"}},[i("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:t.row.source_type,callback:function(i){e.$set(t.row,"source_type",i)},expression:"props.row.source_type"}},e._l(e.sourceTypeList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),t.row.source_type&&"CUSTOM"!==t.row.source_type?i("div",{staticStyle:{width:"120px",position:"absolute",top:"5px",right:"10px"}},[i("bk-select",{attrs:{clearable:!1,searchable:""},model:{value:t.row.value_key,callback:function(i){e.$set(t.row,"value_key",i)},expression:"props.row.value_key"}},e._l(e.variableList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1):i("div",{staticStyle:{width:"120px",position:"absolute",top:"4px",right:"10px"}},["string"===t.row.type||"number"===t.row.type?[i("bk-input",{attrs:{type:"string"===t.row.type?"text":"number",placeholder:e.$t("m.treeinfo['请输入参数值']")},model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}})]:e._e(),e._v(" "),"boolean"===t.row.type?[i("bk-radio-group",{model:{value:t.row.value,callback:function(i){e.$set(t.row,"value",i)},expression:"props.row.value"}},[i("bk-radio",{attrs:{value:e.trueSatatus}},[e._v("true")]),e._v(" "),i("bk-radio",{attrs:{value:e.falseSatatus}},[e._v("false")])],1)]:e._e()],2)]:e._e()]}}])}),e._v(" "),i("bk-table-column",{attrs:{width:"60","class-name":"last-add-row-column"},scopedSlots:e._u([{key:"default",fn:function(t){return["array"===t.row.lastType?i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addChildren(t.row)}}}),e._v(" "),"array"===t.row.lastType?i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":e.countSon(t.row)},on:{click:function(i){return e.deletChildren(t.row)}}}):e._e()]):e._e()]}}])})],1)],1)},o=[];n._withStripped=!0},fJfp:function(e,t,i){},fOTe:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Sideslider",components:{RenderView:function(){return Promise.resolve().then(i.bind(null,"FCVG"))}},props:{title:{type:String,default:""},formData:{type:Array,default:function(){return[]}},context:{type:Object,default:function(){return{schemes:{}}}},width:{type:[String,Number],default:800}},data:function(){return{isShow:!0}}}},"fc+3":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("14Xm")),o=d(i("D3Ub")),a=d(i("gDS+")),s=d(i("dTVR")),r=d(i("BWJp")),c=d(i("PaSM")),l=d(i("bcjM")),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}t.default={components:{templateNode:s.default,commonTriggerList:l.default},mixins:[r.default,c.default],props:{customLine:{type:Object,default:function(){return{}}},flowInfo:{type:Object,default:function(){return{}}}},data:function(){return{isDataLoading:!1,secondClick:!1,booleanList:[{id:"1",name:"true"},{id:"0",name:"false"}],widthStatus:0,scrollTopStatus:0,lineInfo:{template:"",condition_type:"",name:"",checkName:!1,between:!0,expressions:[{type:"and",expressions:[{condition:"",key:"",value:"",choiceList:"",type:"STRING",betweenList:[]}]}]},templateList:[],fieldList:[],globalTypeList:["SELECT","MULTISELECT","RADIO","CHECKBOX","MEMBERS","TREESELECT"],rules:{}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo},openFunction:function(){return this.$store.state.openFunction}},watch:{fieldList:{handler:function(e,t){this.dealList()},deep:!0}},mounted:function(){var e=this;this.initData(),this.rules.name=this.checkCommonRules("name").name,this.rules.value=this.checkCommonRules("select").select,this.rules.key=this.rules.value,this.rules.condition=this.rules.value,this.$store.state.common.slideTimeout=setInterval((function(){e.$refs.lienHeight?e.scrollTopStatus=e.$refs.lienHeight.offsetHeight+60>document.body.offsetHeight:clearInterval(e.$store.state.common.slideTimeout)}),100)},methods:{initData:function(){var e=this;this.widthStatus=0;var t=["START","END","ROUTER-P","COVERAGE"];t.some((function(t){return e.customLine.nodeInfo.from_state.type===t}))&&(this.widthStatus+=1),t.some((function(t){return e.customLine.nodeInfo.to_state.type===t}))&&(this.widthStatus+=1),this.lineInfo.name=this.customLine.lineValue.name===this.$t("m.treeinfo['默认']")?"":this.customLine.lineValue.name,this.lineInfo.condition_type=this.customLine.lineValue.condition_type,this.lineInfo.between=this.customLine.lineValue.condition.type,this.lineInfo.expressions=JSON.parse((0,a.default)(this.customLine.lineValue.condition.expressions)),this.lineInfo.expressions.forEach((function(e){e.expressions.forEach((function(e){"BOOLEAN"===e.type&&(e.value=e.value?"1":"0")}))})),this.getFieldList(),this.getBetweenTemplate()},checkBetweenList:function(e){return["MULTISELECT","CHECKBOX","MEMBERS","TREESELECT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"===e.typeName||"notissuperset"===e.typeName})):["DATE","DATETIME","DATETIMERANGE","INT"].some((function(t){return t===e}))?this.globalChoise.methods.filter((function(e){return"issuperset"!==e.typeName&&"notissuperset"!==e.typeName})):this.globalChoise.methods.filter((function(e){return"=="===e.typeName||"!="===e.typeName}))},getBetweenTemplate:function(){var e=this,t={workflow:this.customLine.lineValue.workflow};this.$store.dispatch("deployCommon/getLineTemplate",t).then((function(t){e.templateList=t.data.items})).catch((function(t){(0,u.errorHandler)(t,e)}))},getRpcData:function(e){var t=this;return(0,o.default)(n.default.mark((function i(){return n.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.$store.dispatch("apiRemote/getRpcData",e).then((function(t){e.choice=t.data})).catch((function(e){(0,u.errorHandler)(e,t)}));case 2:case"end":return i.stop()}}),i,t)})))()},getFieldList:function(){var e=this,t=this.customLine.lineValue.id;this.isDataLoading=!0,this.$store.dispatch("deployCommon/getLineField",{id:t}).then((function(t){e.fieldList=t.data,e.fieldList.forEach((function(t){"RPC"===t.source_type&&e.getRpcData(t)})),e.isNecessaryToWatch({fields:e.fieldList},"workflow"),e.dealList()})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.isDataLoading=!1}))},dealList:function(){var e=this;this.lineInfo.expressions.forEach((function(t){e.$set(t,"checkInfo",!1),t.expressions.forEach((function(t){t.type=t.type||"STRING",t.choiceList="",e.$set(t,"betweenList",[]),t.betweenList=e.checkBetweenList(t.type),"SELECT"!==t.type&&"MULTISELECT"!==t.type&&"RADIO"!==t.type&&"CHECKBOX"!==t.type&&"MEMBERS"!==t.type&&"TREESELECT"!==t.type&&"INT"!==t.type||e.fieldList.forEach((function(i){i.key===t.key&&(t.choiceList=[],i.choice.forEach((function(e){t.choiceList.push({id:e.key,name:e.name})})),"MULTISELECT"!==t.type&&"CHECKBOX"!==t.type&&"MEMBERS"!==t.type&&"TREESELECT"!==t.type||(t.value=Array.isArray(t.value)?t.value:t.value.split(",")),e.$set(t,"multiSelect",!("SELECT"===t.type||"RADIO"===t.type)))}))}))}))},changeTemplate:function(e,t){var i=this.templateList.filter((function(e){return e.id===t.id}))[0];this.lineInfo.condition_type="by_field",this.lineInfo.between=i.data.type,this.lineInfo.expressions=i.data.expressions,this.lineInfo.name=i.name},changeCondition:function(){this.lineInfo.template="",this.lineInfo.expressions=[{type:"and",checkInfo:!1,expressions:[{condition:"",key:"",value:"",choiceList:"",type:"STRING",betweenList:this.checkBetweenList("STRING")}]}]},changeName:function(){var e=arguments,t=this.fieldList.filter((function(t){return e[0]===t.key}))[0];arguments[2].meta=t.meta;var i=arguments[2];i.source=i.source||"field",i.type=t.type,this.globalTypeList.some((function(e){return e===i.type}))?(i.choiceList=t.choice.map((function(e){return{id:e.key,name:e.name}})),this.$set(i,"multiSelect",!("SELECT"===i.type||"RADIO"===i.type))):(i.choiceList="",this.$set(i,"multiSelect",!1)),i.value=i.multiSelect?[]:"";var n=this.checkBetweenList(i.type);this.$set(arguments[2],"betweenList",n),i.condition=""},addCondition:function(){var e={type:"and",checkInfo:!1,expressions:[{condition:"",key:"",value:"",choiceList:"",type:"STRING",betweenList:this.checkBetweenList("STRING")}]};this.lineInfo.expressions.push(e)},delteCondition:function(e,t){1!==this.lineInfo.expressions.length&&this.lineInfo.expressions.splice(t,1)},addNode:function(e,t){var i={condition:"",key:"",value:"",choiceList:"",type:"STRING",betweenList:this.checkBetweenList("STRING")};e.expressions.splice(t+1,0,i)},deleteNode:function(e,t){1!==e.expressions.length&&e.expressions.splice(t,1)},submitLine:function(){var e=this;if("by_field"===this.lineInfo.condition_type&&(this.lineInfo.expressions.forEach((function(e){e.checkInfo=e.expressions.some((function(e){return!(e.condition&&e.key&&(Array.isArray(e.value)?e.value.length:e.value))}))})),this.lineInfo.expressions.some((function(e){return e.checkInfo}))))return;this.$refs.lineForm.validate().then((function(t){e.submitFn()}),(function(e){console.warn(e)}))},submitFn:function(){var e=this;if(!this.secondClick){this.secondClick=!0;var t={name:this.lineInfo.name,condition_type:this.lineInfo.condition_type,condition:{expressions:[],type:this.lineInfo.between},from_state:this.customLine.lineValue.from_state,to_state:this.customLine.lineValue.to_state,workflow:this.customLine.lineValue.workflow};this.lineInfo.expressions.forEach((function(e,i){t.condition.expressions.push({checkInfo:e.checkInfo,expressions:[],type:e.type})})),this.lineInfo.expressions.forEach((function(i,n){i.expressions.forEach((function(i){t.condition.expressions[n].expressions.push({choiceList:[],condition:i.condition,key:i.key,source:i.source,type:i.type,value:e.formattingData(i),meta:i.meta})}))}));var i=this.customLine.lineValue.id;this.$store.dispatch("deployCommon/updateLine",{lineParams:t,id:i}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["配置成功！"]'),theme:"success"}),e.$emit("submitLine",t.data)})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))}},closeLine:function(){this.$emit("closeLine")},deleteLine:function(){this.$emit("deleteLine")},submitTemplate:function(){var e=this;this.lineInfo.expressions.forEach((function(t,i){t.expressions.forEach((function(t){t.value=e.formattingData(t)}))}));var t={workflow:this.customLine.lineValue.workflow,name:this.lineInfo.name,data:{expressions:this.lineInfo.expressions,type:this.lineInfo.between}};if(this.lineInfo.template&&(t.id=this.lineInfo.template),this.lineInfo.name&&!this.secondClick){this.secondClick=!0;var i=this.lineInfo.template?"deployCommon/updateLineTemplate":"deployCommon/submitLineTemplate";this.$store.dispatch(i,{params:t}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功！"]'),theme:"success"})})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.secondClick=!1}))}}}}},fdTw:function(e,t,i){"use strict";i("AIvP")},feoz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[i("full-screen",{attrs:{"is-full":e.isFull,title:e.fullTitle},on:{onClose:e.closeFullSreen}},[e.isPreview?i("viewer",{attrs:{"initial-value":e.value,height:e.height+"px"}}):i("editor",{ref:"toastuiEditor",attrs:{height:e.height+"px","initial-edit-type":"wysiwyg","preview-style":"vertical","initial-value":e.value,options:e.editorOptions},on:{load:e.onEditorLoad,blur:e.onEditorBlur}}),e._v(" "),e.isFull?e._e():i("i",{staticClass:"bk-itsm-icon icon-order-open",on:{click:function(t){return t.stopPropagation(),e.openFullScreen.apply(null,arguments)}}})],1)],1)},o=[];n._withStripped=!0},fkix:function(e,t,i){"use strict";i.r(t);var n=i("NXOa"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},fmQd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}],staticClass:"bk-add-field"},[i("bk-form",{ref:"fieldForm",staticClass:"bk-add-field bk-form-vertical",attrs:{"label-width":200,"form-type":e.formAlign,model:e.formInfo,rules:e.rules}},[Object.keys(e.sospInfo).length?[i("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{label:e.$t("m.treeinfo['前置节点']"),required:!0,property:"prevId","error-display-type":"normal","ext-cls":"bk-mt0-item"}},[i("bk-select",{attrs:{searchable:""},model:{value:e.formInfo.prevId,callback:function(t){e.$set(e.formInfo,"prevId",t)},expression:"formInfo.prevId"}},e._l(e.prevNodeList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1)]:e._e(),e._v(" "),i("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{"data-test-id":"field-input-fieldName",label:e.$t("m.treeinfo['字段名']"),required:!0,property:"name","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin"}},[i("bk-input",{attrs:{maxlength:"120",disabled:"TABLE"===e.changeInfo.source&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入字段显示名']")},on:{change:e.fieldNameChange,input:e.putKey},model:{value:e.formInfo.name,callback:function(t){e.$set(e.formInfo,"name",t)},expression:"formInfo.name"}})],1),e._v(" "),i("bk-form-item",{style:{marginTop:"vertical"===e.formAlign?0:"20px"},attrs:{label:e.$t("m.treeinfo['唯一标识']"),required:!0,property:"key","error-display-type":"normal","ext-cls":"bk-halfline-item"}},[i("bk-input",{attrs:{placeholder:e.$t("m.treeinfo['请输入唯一标识']"),disabled:"number"==typeof e.changeInfo.id||e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source},model:{value:e.formInfo.key,callback:function(t){e.$set(e.formInfo,"key",t)},expression:"formInfo.key"}})],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"field-select-fieldType",label:e.$t("m.treeinfo['字段类型']"),required:!0,property:"type","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item"}},[i("bk-select",{attrs:{clearable:!1,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,searchable:""},on:{selected:e.changeType},model:{value:e.formInfo.type,callback:function(t){e.$set(e.formInfo,"type",t)},expression:"formInfo.type"}},e._l(e.fieldTypeList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['校验方式']"),required:!0,"error-display-type":"normal","ext-cls":"bk-halfline-item bk-mt20-item"}},[i("bk-select",{attrs:{clearable:!1,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,searchable:""},on:{selected:e.changeRegex},model:{value:e.formInfo.regex,callback:function(t){e.$set(e.formInfo,"regex",t)},expression:"formInfo.regex"}},e._l(e.regexList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),"ASSOCIATED_FIELD_VALIDATION"!==e.formInfo.regex||e.isEditPublic?e._e():i("div",{staticClass:"bk-form-item bk-relate-conditions",staticStyle:{width:"100%"}},[i("div",{staticClass:"bk-form-content",staticStyle:{"margin-left":"0"}},[i("p",{staticClass:"bk-form-p"},[e._v(e._s(e.$t('m.newCommon["字段间关系"]')))]),e._v(" "),i("bk-radio-group",{model:{value:e.formInfo.regex_config.rule.type,callback:function(t){e.$set(e.formInfo.regex_config.rule,"type",t)},expression:"formInfo.regex_config.rule.type"}},[i("bk-radio",{attrs:{value:"and","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['且']")))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t("m.treeinfo['或']")))])],1)],1),e._v(" "),e._l(e.formInfo.regex_config.rule.expressions,(function(t,n){return i("div",{key:n,staticClass:"bk-between-form"},[i("p",{staticClass:"current-field"},[e._v(e._s(e.$t('m.newCommon["当前字段"]')))]),e._v(" "),i("bk-select",{staticStyle:{width:"120px"},attrs:{"ext-cls":"field-valid-select",clearable:!1},model:{value:t.condition,callback:function(i){e.$set(t,"condition",i)},expression:"expression.condition"}},e._l(e.betweenList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),i("bk-select",{staticStyle:{width:"210px"},attrs:{"ext-cls":"field-valid-select",clearable:!1},on:{change:function(i){return e.onRegexFieldChange(i,t)}},model:{value:t.key,callback:function(i){e.$set(t,"key",i)},expression:"expression.key"}},e._l(e.regexFieldList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),i("div",{staticClass:"bk-between-operate"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(t){return e.addExpression()}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.formInfo.regex_config.rule.expressions.length},on:{click:function(t){return e.deleteExpression(n)}}})])],1)}))],2),e._v(" "),"CUSTOM"===e.formInfo.regex?[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['正则规则']"),required:!0,property:"key","error-display-type":"normal","ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item"}},[i("bk-input",{attrs:{disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入正则规则']")},model:{value:e.formInfo.customRegex,callback:function(t){e.$set(e.formInfo,"customRegex",t)},expression:"formInfo.customRegex"}})],1)]:e._e()],2),e._v(" "),i("bk-form",{ref:"dataForm",staticClass:"bk-form-vertical",attrs:{"label-width":200,"form-type":e.formAlign,model:e.formInfo}},[e.showType.sourceList.some((function(t){return t===e.formInfo.type}))?[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['数据源']"),required:!0,"ext-cls":"bk-mt20-item"}},[i("data-source",{ref:"dataSource",attrs:{"form-info":e.formInfo,"prc-data":e.prcData,"change-info":e.assignValue,"api-info":e.apiInfo.api_info,"dictionary-data":e.dictionaryData},on:{changeApiInfo:e.changeApiInfo,getRpcData:e.getRpcData}})],1),e._v(" "),"DATADICT"!==e.formInfo.source_type&&"RPC"!==e.formInfo.source_type||"RPC"===e.formInfo.source_type&&e.prcTable.length?[e._l(e.globalChoise.source_type,(function(t,n){return[t.typeName===e.formInfo.source_type?i("bk-form-item",{key:n,attrs:{label:t.name,desc:t.desc,required:!0,"ext-cls":"bk-mt20-item"}},[e.isShowDataSourcebtn?i("bk-button",{staticClass:"configuration-data-source",attrs:{disabled:e.isDisabled,theme:"primary",title:"配置数据源",outline:!0},on:{click:e.openDataSource}},[e._v("配置数据源")]):e._e(),e._v(" "),i("bk-dialog",{attrs:{width:"960",title:"API"===e.formInfo.source_type?"配置接口数据":"配置自定义数据",theme:"primary","mask-close":!1},model:{value:e.isShowDataSource,callback:function(t){e.isShowDataSource=t},expression:"isShowDataSource"}},[i("data-content",{ref:"dataContent",refInFor:!0,attrs:{"form-info":e.formInfo,workflow:e.workflow,state:e.state,"change-info":e.assignValue,"api-detail":e.apiDetail,"api-info":e.apiInfo.api_info,"kv-relation":e.apiInfo.kv_relation,"prc-table":e.prcTable,"field-info":e.fieldInfo}})],1)],1):e._e()]}))]:e._e()]:e._e(),e._v(" "),"CUSTOMTABLE"===e.formInfo.type?[i("bk-form-item",{attrs:{"data-test-id":"field_form_custom",label:e.$t("m.treeinfo['自定义数据']"),required:!0,"ext-cls":"bk-mt20-item"}},[i("div",{on:{click:function(t){e.checkStatus.customTableStatus=!1}}},[i("custom-table-data",{attrs:{"custom-table-info":e.customTableInfo}}),e._v(" "),e.checkStatus.customTableStatus?i("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.treeinfo["请填写正确格式的自定义数据"]')))]):e._e()],1),e._v(" "),(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key?i("div",{staticClass:"bk-form-disabled"}):e._e()])]:e._e(),e._v(" "),"FILE"===e.formInfo.type?[i("bk-form-item",{attrs:{"ext-cls":"bk-input-position bk-mt20-item",label:e.$t("m.treeinfo['上传附件模板']")}},[i("bk-button",{attrs:{theme:"default",title:e.$t("m.treeinfo['点击上传']")}},[e._v("\n                    "+e._s(e.$t("m.treeinfo['点击上传']"))+"\n                ")]),e._v(" "),i("input",{staticClass:"bk-input-file",attrs:{type:"file"},domProps:{value:e.fileVal},on:{change:e.handleFile}}),e._v(" "),i("ul",{staticClass:"bk-file-list"},e._l(e.fileList,(function(t,n){return i("li",{key:n},[i("span",{staticClass:"bk-file-success"},[i("i",{staticClass:"bk-icon icon-check-1"})]),e._v(" "),i("span",[e._v(e._s(t.name))]),e._v(" "),i("span",{staticClass:"bk-file-delete",on:{click:function(i){return e.deleteFile(t,n)}}},[e._v("×")])])})),0),e._v(" "),!e.changeInfo.is_builtin&&"TABLE"!==e.changeInfo.source||"bk_biz_id"===e.formInfo.key?e._e():i("div",{staticClass:"bk-form-disabled"})],1)]:e._e(),e._v(" "),e.showType.belongDefaultList.some((function(t){return e.formInfo.type===t}))?[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['默认值']"),"ext-cls":"bk-mt20-item"}},[i("default-value",{attrs:{"form-info":e.formInfo,"field-info":e.fieldInfo,"dictionary-data":e.dictionaryData,"change-info":e.changeInfo,"api-info":e.apiInfo,"check-status":e.checkStatus,label:e.$t("m.treeinfo['默认值']")}})],1)]:e._e(),e._v(" "),e.addOrigin.isOther&&"publicField"===e.addOrigin.addOriginInfo.type?e._e():[i("bk-form-item",{attrs:{"ext-cls":"bk-halfline-item bk-halfline-margin bk-mt20-item",label:e.$t("m.treeinfo['布局要求']"),required:!0}},[i("bk-radio-group",{model:{value:e.formInfo.layout,callback:function(t){e.$set(e.formInfo,"layout",t)},expression:"formInfo.layout"}},[e._l(e.globalChoise.layout_type,(function(t,n){return[i("bk-radio",{key:n,attrs:{"ext-cls":"mr20",value:t.typeName,disabled:e.showType.layoutList.some((function(t){return t===e.formInfo.type}))}},[e._v("\n                            "+e._s(t.name)+"\n                        ")])]}))],2)],1),e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-halfline-item bk-mt20-item",label:e.$t("m.treeinfo['字段必填']"),required:!0}},[i("bk-radio-group",{model:{value:e.formInfo.validate,callback:function(t){e.$set(e.formInfo,"validate",t)},expression:"formInfo.validate"}},[e._l(e.globalChoise.validate_type,(function(t,n){return[i("bk-radio",{key:n,attrs:{"ext-cls":"mr20",value:t.typeName,disabled:"title"===e.changeInfo.key||e.changeInfo.is_builtin||"bk_biz_id"===e.formInfo.key}},[e._v("\n                            "+e._s(t.name)+"\n                        ")])]}))],2)],1)],e._v(" "),i("bk-form-item",{attrs:{"ext-cls":"bk-tanble-height bk-mt20-item",label:e.$t("m.treeinfo['填写说明']")}},[i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.desc,expression:"formInfo.desc",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble bk-halfline-item bk-halfline-margin field-input-tips",attrs:{placeholder:e.$t("m.treeinfo['请输入字段填写说明']"),disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key},domProps:{value:e.formInfo.desc},on:{input:function(t){t.target.composing||e.$set(e.formInfo,"desc",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),i("p",{staticClass:"field-tips-checkbox",staticStyle:{"margin-left":"335px"}},[i("bk-checkbox",{attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key},model:{value:e.formInfo.is_tips,callback:function(t){e.$set(e.formInfo,"is_tips",t)},expression:"formInfo.is_tips"}},[e._v("\n                    "+e._s(e.$t('m.treeinfo["添加额外提示说明"]'))+"\n                ")])],1)]),e._v(" "),e.formInfo.is_tips?[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['字段释疑']"),required:!0,"ext-cls":"bk-mt20-item"}},[i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.formInfo.tips,expression:"formInfo.tips",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble bk-halfline-item bk-halfline-margin",attrs:{disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入，用于鼠标经过提示']")},domProps:{value:e.formInfo.tips},on:{input:function(t){t.target.composing||e.$set(e.formInfo,"tips",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),i("p",{staticClass:"bk-label-tips"},[i("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.formInfo.tips||e.$t("m.treeinfo['字段释疑填填看哦']"),expression:"(formInfo.tips || $t(`m.treeinfo['字段释疑填填看哦']`))",modifiers:{top:!0}}]},[e._v("\n                        "+e._s(e.$t('m.treeinfo["效果预览"]'))+"\n                    ")])]),e._v(" "),"TABLE"===e.changeInfo.source||e.changeInfo.is_builtin?i("div",{staticClass:"bk-form-disabled"}):e._e()])]:e._e(),e._v(" "),e.addOrigin.isOther&&"publicField"===e.addOrigin.addOriginInfo.type||!e.changeInfo.meta||"APPROVE_RESULT"===e.changeInfo.meta.code?e._e():[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['是否设置字段隐藏条件']"),"ext-cls":"bk-mt20-item"}},[i("bk-switcher",{attrs:{size:"small",disabled:"title"===e.changeInfo.key},model:{value:e.formInfo.show_type,callback:function(t){e.$set(e.formInfo,"show_type",t)},expression:"formInfo.show_type"}})],1),e._v(" "),e.formInfo.show_type?[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['隐藏条件']"),desc:e.$t("m.treeinfo['字段默认为显示。当满足以下配置条件时，该字段将会被隐藏。']"),"ext-cls":"bk-mt20-item"}},[i("hidden-conditions",{ref:"hiddenConditions",attrs:{"template-info":e.templateInfo,"template-stage":e.templateStage,"add-origin":e.addOrigin,workflow:e.workflow,state:e.state,"form-info":e.formInfo}})],1)]:e._e()]],2),e._v(" "),i("div",{staticClass:"operate-btns mt20"},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"field_button_submit",title:e.$t("m.treeinfo['提交']"),loading:e.secondClick},on:{click:e.checkInfo}},[e._v("\n            "+e._s(e.$t("m.treeinfo['提交']"))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"field_button_cancel",title:e.$t("m.treeinfo['取消']"),disabled:e.secondClick},on:{click:e.onCancelClick}},[e._v("\n            "+e._s(e.$t("m.treeinfo['取消']"))+"\n        ")])],1)],1)},o=[];n._withStripped=!0},fqZO:function(e,t,i){},fwY8:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"lienHeight",staticClass:"bk-configu-line"},[i("div",{staticClass:"bk-line-graph"},[i("div",{staticClass:"bk-line-div",class:{"bk-line-small":2===e.widthStatus,"bk-line-big":1===e.widthStatus}},[i("template-node",{attrs:{node:e.customLine.nodeInfo.from_state}}),e._v(" "),i("div",{staticClass:"bk-line-style"},[e._m(0),e._v(" "),i("span",{staticClass:"bk-line-word"},[e._v(" "+e._s(e.lineInfo.name||"--")+" ")]),e._v(" "),i("span",{staticClass:"bk-line-squrea"})]),e._v(" "),i("template-node",{attrs:{node:e.customLine.nodeInfo.to_state}})],1)]),e._v(" "),i("bk-form",{ref:"lineForm",attrs:{"label-width":200,model:e.lineInfo,"form-type":"vertical",rules:e.rules}},[e.customLine.isOnly?e._e():[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['关系模板']"),desc:e.$t("m.treeinfo['（使用模版可以快速填写）']")}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},on:{selected:e.changeTemplate},model:{value:e.lineInfo.template,callback:function(t){e.$set(e.lineInfo,"template",t)},expression:"lineInfo.template"}},e._l(e.templateList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"lineConfig-select-condition",label:e.$t("m.treeinfo['流转条件']"),required:!0}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},on:{selected:e.changeCondition},model:{value:e.lineInfo.condition_type,callback:function(t){e.$set(e.lineInfo,"condition_type",t)},expression:"lineInfo.condition_type"}},e._l(e.globalChoise.condition_type,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1)],e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"lineConfig-select-relation",label:e.$t("m.treeinfo['关系名称']"),property:"name",required:!0}},[i("bk-input",{attrs:{maxlength:"120",placeholder:e.$t("m.treeinfo['请输入关系名称']")},model:{value:e.lineInfo.name,callback:function(t){e.$set(e.lineInfo,"name","string"==typeof t?t.trim():t)},expression:"lineInfo.name"}})],1)],2),e._v(" "),"default"!==e.lineInfo.condition_type?[i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isDataLoading},expression:"{ isLoading: isDataLoading }"}]},[i("bk-form",{ref:"conditionForm",attrs:{"label-width":200,model:e.lineInfo,"ext-cls":"bk-line-form","form-type":"vertical"}},[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['条件组间关系']"),desc:e.$t("m.treeinfo['当所有条件组都满足且/或的条件时，节点才会流转']"),"ext-cls":"mb10 mt10"}},[i("bk-radio-group",{model:{value:e.lineInfo.between,callback:function(t){e.$set(e.lineInfo,"between",t)},expression:"lineInfo.between"}},[i("bk-radio",{staticClass:"mr10",attrs:{value:"and"}},[e._v(e._s(e.$t('m.treeinfo["且"]')))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t('m.treeinfo["或"]')))])],1)],1),e._v(" "),e._l(e.lineInfo.expressions,(function(t,n){return i("div",{key:n,staticClass:"bk-form-content"},[i("p",{staticClass:"bk-between-title"},[e._v(e._s("and"===e.lineInfo.between?e.$t("m.treeinfo['且']"):e.$t('m.treeinfo["或"]'))+e._s(e.$t('m.treeinfo["-条件组"]'))+e._s(n+1))]),e._v(" "),i("div",{staticClass:"bk-between-info"},[i("p",[i("span",{staticClass:"bk-between-span"},[e._v(e._s(e.$t('m.treeinfo["字段间关系"]')))]),e._v(" "),i("bk-radio-group",{staticStyle:{width:"auto"},model:{value:t.type,callback:function(i){e.$set(t,"type",i)},expression:"item.type"}},[i("bk-radio",{staticClass:"mr10",attrs:{value:"and"}},[e._v(e._s(e.$t('m.treeinfo["且"]')))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t('m.treeinfo["或"]')))])],1)],1),e._v(" "),e._l(t.expressions,(function(n,o){return i("div",{key:o,staticClass:"bk-between-form",on:{click:function(e){t.checkInfo=!1}}},[i("bk-form-item",{attrs:{"data-test-id":"lineConfig-select-fieldList","ext-cls":"bk-width210 no-label"}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},on:{selected:function(t){for(var i=arguments.length,o=Array(i);i--;)o[i]=arguments[i];return e.changeName.apply(void 0,o.concat([n]))}},model:{value:n.key,callback:function(t){e.$set(n,"key",t)},expression:"node.key"}},e._l(e.fieldList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1),e._v(" "),n.betweenList?[i("bk-form-item",{attrs:{"data-test-id":"lineConfig-select-betweenList","ext-cls":"bk-width100 no-label"}},[i("bk-select",{attrs:{clearable:!1,searchable:"","font-size":"medium"},model:{value:n.condition,callback:function(t){e.$set(n,"condition",t)},expression:"node.condition"}},e._l(n.betweenList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1)]:e._e(),e._v(" "),i("bk-form-item",{attrs:{"data-test-id":"lineConfig-select-choiceList",label:"","ext-cls":"bk-width195 no-label"}},["global"!==n.source?[e.globalTypeList.some((function(e){return n.type===e}))?[n.choiceList.length?i("bk-select",{attrs:{multiple:n.multiSelect,searchable:"","font-size":"medium"},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}},e._l(n.choiceList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1):i("bk-input",{attrs:{clearable:!0,type:"INT"===n.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入条件值']")},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}})]:"DATE"===n.type||"DATETIME"===n.type?[i("bk-date-picker",{attrs:{placeholder:"选择日期时间",type:"DATETIME"===n.type?"datetime":"date"},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}})]:[i("bk-input",{attrs:{clearable:!0,type:"INT"===n.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入条件值']")},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}}),e._v(" "),n.meta&&n.meta.unit?i("span",{staticClass:"buttonIcon"},[e._v("%")]):e._e()]]:e._e(),e._v(" "),"global"===n.source?["BOOLEAN"===n.type?[i("bk-select",{attrs:{searchable:"","font-size":"medium"},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}},e._l(e.booleanList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:[i("bk-input",{attrs:{clearable:!0,type:"INT"===n.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入比较值']")},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}})]]:e._e()],2),e._v(" "),i("div",{staticClass:"bk-between-operat"},[i("span",{staticClass:"bk-itsm-icon icon-flow-add",attrs:{"data-test-id":"lineConfig-span-addNode"},on:{click:function(i){return e.addNode(t,o)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===t.expressions.length},attrs:{"data-test-id":"lineConfig-i-deleteNode"},on:{click:function(i){return e.deleteNode(t,o)}}})])],2)})),e._v(" "),1!==e.lineInfo.expressions.length?i("i",{staticClass:"bk-icon icon-close",on:{click:function(i){return e.delteCondition(t,n)}}}):e._e()],2),e._v(" "),t.checkInfo?i("p",{staticClass:"bk-error-msg"},[e._v(e._s(e.$t('m.treeinfo["关系组内的数据不能为空"]')))]):e._e()])}))],2)],1),e._v(" "),i("p",{staticClass:"bk-add-between"},[i("span",{attrs:{"data-test-id":"lineConfig-span-addCondition"},on:{click:e.addCondition}},[i("i",{staticClass:"bk-icon icon-plus-circle"}),e._v(e._s(e.$t('m.treeinfo["添加条件组"]'))+"\n            ")])])]:e._e(),e._v(" "),e.openFunction.TRIGGER_SWITCH?i("div",{class:{"bk-line-padding":e.scrollTopStatus}},[i("common-trigger-list",{attrs:{origin:"transition","source-id":e.customLine.lineValue.workflow,sender:e.customLine.lineValue.id,table:e.flowInfo.table}})],1):e._e(),e._v(" "),i("div",{staticClass:"mt20",class:{"bk-line-btn":e.scrollTopStatus}},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"lineConfig-button-submit",title:e.$t("m.treeinfo['确认']"),loading:e.secondClick},on:{click:e.submitLine}},[e._v("\n            "+e._s(e.$t('m.treeinfo["确认"]'))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default",title:e.$t("m.treeinfo['取消']"),disabled:e.secondClick},on:{click:e.closeLine}},[e._v("\n            "+e._s(e.$t('m.treeinfo["取消"]'))+"\n        ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default",title:e.$t("m.treeinfo['删除']"),disabled:e.secondClick},on:{click:e.deleteLine}},[e._v("\n            "+e._s(e.$t('m.treeinfo["删除"]'))+"\n        ")]),e._v(" "),"by_field"===e.lineInfo.condition_type?i("bk-button",{staticStyle:{float:"right"},attrs:{theme:"default",title:e.lineInfo.template?e.$t("m.treeinfo['更新模板']"):e.$t("m.treeinfo['存为模版']"),disabled:e.secondClick},on:{click:e.submitTemplate}},[e._v("\n            "+e._s(e.lineInfo.template?e.$t("m.treeinfo['更新模板']"):e.$t("m.treeinfo['存为模版']"))+"\n        ")]):e._e()],1)],2)},o=[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"bk-line-line"},[t("span",{staticClass:"bk-line-info"})])}];n._withStripped=!0},"g9b+":function(e,t,i){"use strict";i.r(t);var n=i("pPAs"),o=i("x+JR");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("kyjx");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"dcf341e4",null);r.options.__file="src/views/commonComponent/fieldComponent/complexMembers.vue",t.default=r.exports},gLev:function(e,t,i){"use strict";i.r(t);var n=i("JbQy"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},gSHn:function(e,t,i){"use strict";i.r(t);var n=i("eL66"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},gYYX:function(e,t,i){"use strict";i("Kvpm")},go9q:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("bk-sideslider",{attrs:{"is-show":e.isShow,"quick-close":!0,title:e.title,width:e.width,"ext-cls":"ui-sideslider"},on:{"update:isShow":function(t){e.isShow=t},"update:is-show":function(t){e.isShow=t}}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("render-view",{attrs:{"form-data":e.formData,context:e.context}})],1)])},o=[];n._withStripped=!0},"gr+U":function(e,t,i){"use strict";i.r(t);var n=i("vXIu"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},gr1D:function(e,t,i){},gt7i:function(e,t,i){"use strict";i.r(t);var n=i("JXR1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},gy7N:function(e,t,i){"use strict";i.r(t);var n=i("K2+b"),o=i("t9cD");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("YSn7");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7fd2953f",null);r.options.__file="src/views/commonComponent/fieldComponent/cascade.vue",t.default=r.exports},h1eg:function(e,t,i){"use strict";i.r(t);var n=i("Y9oG"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},hA3y:function(e,t,i){"use strict";i.r(t);var n=i("hiyp"),o=i("jvs4");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("kicn");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"bc8ef742",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/responseData.vue",t.default=r.exports},hAcJ:function(e,t,i){"use strict";i.r(t);var n=i("zfNu"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},hHxK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("QbLZ")),o=r(i("q9fp")),a=i("L2JU"),s=r(i("b1K/"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"changeConductor",components:{memberInfo:o.default},props:{itemInfo:{type:Object,default:function(){return{}}},origin:{type:String,default:"normal"},index:{type:Number}},data:function(){return{precision:0,insertValue:"",variableList:[]}},computed:(0,n.default)({globalChoise:function(){return this.$store.state.common.configurInfo}},(0,a.mapState)("trigger",{triggerVariables:function(e){return e.triggerVariables}})),watch:{triggerVariables:function(e){this.variableList=e}},created:function(){if(("SELECT"===this.itemInfo.type||"MULTISELECT"===this.itemInfo.type)&&this.itemInfo.use_variable&&!this.itemInfo.choice.some((function(e){return"VARIABLE"===e.key}))){this.itemInfo.choice.push({key:"VARIABLE",name:"引用变量"});var e="MULTISELECT"===this.itemInfo.type?[]:"";this.$set(this.itemInfo,"insertValue",e)}this.$set(this.itemInfo,"referenceType",this.itemInfo.referenceType||"custom"),this.itemInfo.ref_type?(this.itemInfo.referenceType=this.itemInfo.ref_type,"reference"===this.itemInfo.ref_type?"SELECT"!==this.itemInfo.type&&"MULTISELECT"!==this.itemInfo.type||(this.itemInfo.insertValue="MULTISELECT"===this.itemInfo.type?this.itemInfo.value.split(","):this.itemInfo.value,this.itemInfo.value="VARIABLE"):"MULTISELECT"===this.itemInfo.type&&(this.itemInfo.value=this.itemInfo.value?this.itemInfo.value.split(","):[])):"MULTISELECT"===this.itemInfo.type&&(this.itemInfo.value=this.itemInfo.value?this.itemInfo.value.split(","):[])},mounted:function(){this.variableList=this.triggerVariables},methods:{changeInsert:function(e){this.itemInfo.value=(0,s.default)(this.$el.querySelector(".bk-form-textarea, .bk-form-input"),"conductorId"+this.index,this.itemInfo.value,"${"+e+"}",this),this.itemInfo.referenceType="import",this.insertValue=""},changeImport:function(){this.itemInfo.referenceType="reference"},changeMessagePanel:function(e,t){e&&"message"===this.origin&&this.$emit("change-panel-status")}}}},hZSR:function(e,t,i){"use strict";i("i5S3")},hftF:function(e,t,i){"use strict";i.r(t);var n=i("zBzD"),o=i("sRDs");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("/bFB"),i("QGI/");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"402cdce6",null);r.options.__file="src/components/renderview/tags/TagTable.vue",t.default=r.exports},hiyp:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[i("div",{staticClass:"bk-params-title"},[e._v("\n        "+e._s(e.$t('m.treeinfo["返回数据"]'))+"\n    ")]),e._v(" "),i("div",{staticClass:"bk-param-three"},[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['选取数组']"),required:!0}},[i("div",{staticClass:"bk-form-content bk-dialog-input"},[i("div",{ref:"cascader"},[[i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther0,expression:"closeOther0"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-border-red":e.checkInfo.assignors,"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[i("span",{class:{"bk-color-tree":e.organization.assignorTree.name}},[e._v(e._s(e.organization.assignorTree.name||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-border-red":e.checkInfo.assignors,"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(0)}}},[i("span",{class:{"bk-color-tree":e.organization.assignorTree.name}},[e._v(e._s(e.organization.assignorTree.name||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),i("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[0]?i("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[0]+"%"}},[i("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.organization.assignorPerson,"is-key-value":0},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])]),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['关键字字段']"),required:!0}},[i("div",{staticClass:"bk-form-content bk-dialog-input"},[i("div",{ref:"cascader"},[[i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther1,expression:"closeOther1"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[i("span",{class:{"bk-color-tree":e.settingKeyName}},[e._v(e._s(e.settingKeyName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(1)}}},[i("span",{class:{"bk-color-tree":e.settingKeyName}},[e._v(e._s(e.settingKeyName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),i("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[1]?i("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[1]+"%"}},[i("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.selectInfo.selectkeylist,"is-key-value":1},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])]),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['显示字段']"),required:!0}},[i("div",{staticClass:"bk-form-content bk-dialog-input"},[i("div",{ref:"cascader"},[[i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeOther2,expression:"closeOther2"}],staticClass:"bk-search-tree",staticStyle:{width:"100%",float:"left"}},[[(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key?i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key}},[i("span",{class:{"bk-color-tree":e.settingValueName}},[e._v(e._s(e.settingValueName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]):i("div",{staticClass:"bk-search-tree-wrapper",class:{"bk-back-color":(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key},on:{click:function(t){return t.stopPropagation(),e.showTree(2)}}},[i("span",{class:{"bk-color-tree":e.settingValueName}},[e._v(e._s(e.settingValueName||e.$t('m.treeinfo["请选择"]')))]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})])],e._v(" "),i("transition",{attrs:{name:"fade"}},[e.organizaInfo.assignorShow[2]?i("div",{staticClass:"bk-search-tree-content",style:{width:50*e.maxLevelTree[2]+"%"}},[i("export-tree",{attrs:{disabled:(e.changeInfo.is_builtin||e.formInfo.isModule)&&"bk_biz_id"!==e.formInfo.key,"tree-data-list":e.selectInfo.selectvaluelist,"is-key-value":2},on:{toggle:e.assignorToggle,toggleChildren:e.toggleChildren}})],1):e._e()])],2)]],2)])])],1)])},o=[];n._withStripped=!0},hjSG:function(e,t,i){"use strict";i("F1Y2")},hjbl:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-basic-node"},[i("basic-card",[i("basic-info",{ref:"basic",attrs:{"node-info":e.configur,"node-tag-list":e.nodeTagList,"is-loading":e.isLoading,"flow-info":e.flowInfo},on:{baseFormInfoChange:e.baseFormInfoChange}}),e._v(" "),i("field-config",{ref:"field",attrs:{"is-show-title":!0,"flow-info":e.flowInfo,configur:e.configur}}),e._v(" "),i("common-trigger-list",{ref:"commonTriggerList",attrs:{origin:"state","node-type":e.configur.type,"source-id":e.flowInfo.id,sender:e.configur.id,table:e.flowInfo.table}}),e._v(" "),i("div",{staticClass:"bk-node-btn mt20"},[i("bk-button",{staticClass:"mr10",attrs:{theme:"primary","data-test-id":"basicNode-button-submit",title:e.$t("m.treeinfo['确定']"),loading:e.secondClick},on:{click:e.submitNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['确定']"))+"\n            ")]),e._v(" "),i("bk-button",{staticClass:"mr10",attrs:{theme:"default","data-test-id":"basicNode-button-close",title:e.$t("m.treeinfo['取消']"),loading:e.secondClick},on:{click:e.closeNode}},[e._v("\n                "+e._s(e.$t("m.treeinfo['取消']"))+"\n            ")])],1)],1)],1)},o=[];n._withStripped=!0},"hk/f":function(e,t,i){"use strict";i.r(t);var n=i("tJou"),o=i("C6tm");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("rujD");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"526c82ea",null);r.options.__file="src/components/CodeEditor.vue",t.default=r.exports},hmS1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("m1cH")),o=l(i("gDS+")),a=l(i("GQeE")),s=l(i("14Xm")),r=l(i("D3Ub")),c=l(i("VflG"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"postParam",mixins:[c.default],props:{changeInfo:{type:Object,default:function(){return{}}},apiDetail:{type:Object,default:function(){}},stateList:{type:Array,default:function(){return[]}},isStatic:{type:Boolean,default:function(){return!1}},isCustom:{type:Boolean,default:!1},bodyValue:{type:Object,default:function(){}},entry:{type:String,default:function(){return""}},formInfo:{type:Object,default:function(){return{}}}},data:function(){return{trueSatatus:!0,falseSatatus:!1,lala:{value:"111",offsetTop:""},bodyTableData:[],paramTableData:[],checkInfo:{name:"",road:""},sourceTypeList:[{id:1,key:"CUSTOM",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"FIELDS",name:this.$t('m.treeinfo["引用变量"]')}],paramTableInfo:{value:"",placeholder:this.$t('m.treeinfo["请选择数据来源"]')}}},computed:{tableList:function(){return this.bodyTableData.filter((function(e){return e.isShow}))}},watch:{apiDetail:function(e,t){this.initData()}},mounted:function(){var e=this;return(0,r.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.isStatic;case 2:return t.next=4,e.bodyValue;case 4:return t.next=6,e.initData();case 6:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){this.bodyTableDataChange()},bodyTableDataChange:function(){var e=this;return(0,r.default)(s.default.mark((function t(){var i;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,a.default)(e.apiDetail.req_body).length){t.next=5;break}e.apiDetail.treeDataList=[{has_children:!1,showChildren:!0,checkInfo:!1,key:"root",is_necessary:!0,type:"object",desc:e.$t('m.treeinfo["初始化数据"]'),parentInfo:"",children:[]}],e.apiDetail.bodyTableData=[],t.next=12;break;case 5:return t.next=7,e.jsonschemaToList({root:JSON.parse((0,o.default)(e.apiDetail.req_body))});case 7:return e.apiDetail.treeDataList=t.sent,e.isStatic||e.isCustom?e.apiDetail.treeDataList=e.jsonValueToTree(e.bodyValue,JSON.parse((0,o.default)(e.apiDetail.treeDataList))):e.changeInfo.api_info&&e.changeInfo.api_info.remote_api_id===e.apiDetail.id&&(e.apiDetail.treeDataList=e.jsonValueToTree(e.changeInfo.api_info.req_body,JSON.parse((0,o.default)(e.apiDetail.treeDataList)))),t.next=11,e.treeToTableList(JSON.parse((0,o.default)(e.apiDetail.treeDataList[0].children)));case 11:e.apiDetail.bodyTableData=t.sent;case 12:return t.next=14,JSON.parse((0,o.default)(e.apiDetail.bodyTableData));case 14:return i=t.sent,t.next=17,i.forEach((function(e){e.isCheck=!1,e.isSatisfied=!1,e.el=null,e.customValue=e.value||"",e.name=e.key||"",e.children=[],e.source_type=e.source_type||"CUSTOM",e.value=void 0!==e.value?e.value:"",e.value_key=void 0!==e.value_key&&e.value_key.toString()?e.value_key:""}));case 17:return t.next=19,e.recordChildren(i);case 19:return t.next=21,i;case 21:e.bodyTableData=t.sent;case 22:case"end":return t.stop()}}),t,e)})))()},recordChildren:function(e,t){for(var i=e.map((function(e){return e.level})),o=Math.max.apply(Math,(0,n.default)(i)),a=function(t){e.filter((function(e){return e.level===t})).forEach((function(t){!function(e,t){e.filter((function(e){return e.level===t.level-1&&e.primaryKey===t.parentPrimaryKey&&e.ancestorsList.toString()===t.ancestorsList.slice(0,-1).toString()}))[0].children.push(t)}(e,t)}))},s=o;s>(t||0);s--)a(s)},changeState:function(e){e.showChildren=!e.showChildren,e.children.forEach((function(t){t.isShow=e.showChildren})),e.showChildren||this.closeChildren(e)},closeChildren:function(e){var t=this;e.children.forEach((function(e){e.isShow=!1,e.has_children&&(e.showChildren=!1,t.closeChildren(e))}))},changeType:function(e){},countChildren:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){var n,o;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,o=function e(t){if(t.children&&t.children.length)for(var i=0;i<t.children.length;i++)n++,e(t.children[i])},t.next=4,o(e);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},cleanValue:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){var n,a;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse((0,o.default)(e)),a=function e(t){if(t.value="",t.source_type="CUSTOM",t.children&&t.children.length)for(var i=0;i<t.children.length;i++)e(t.children[i])},t.next=4,a(n);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),i,t)})))()},countSon:function(e){return 1===this.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0].children.length},addChildren:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){var a,r,c,l,u,d;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=t.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0],c=t.bodyTableData.indexOf(r)+1,i.next=4,t.countChildren(r);case 4:return l=i.sent,i.next=7,t.cleanValue(r.children[0]);case 7:return u=i.sent,i.next=10,t.treeToTableList(JSON.parse((0,o.default)([].concat((0,n.default)(r.children),[u]))),r.level+1,r.primaryKey,"array",r.ancestorsList);case 10:return d=i.sent,i.next=13,d.forEach((function(e){e.children=[]}));case 13:return r.children=d.filter((function(e){return e.level===r.level+1})),i.next=16,t.recordChildren(d,r.level+1);case 16:(a=t.bodyTableData).splice.apply(a,[c,l].concat((0,n.default)(d)));case 17:case"end":return i.stop()}}),i,t)})))()},deletChildren:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){var n,o,a;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.countSon(e)){i.next=2;break}return i.abrupt("return");case 2:if(!((n=t.bodyTableData.filter((function(t){return t.level===e.level-1&&t.primaryKey===e.parentPrimaryKey}))[0].children).length<=1)){i.next=5;break}return i.abrupt("return");case 5:return n.splice(n.indexOf(e),1),o=t.bodyTableData.indexOf(e),i.next=9,t.countChildren(e);case 9:a=i.sent,t.bodyTableData.splice(o,a+1);case 11:case"end":return i.stop()}}),i,t)})))()},changeField:function(e,t){var i=this;return(0,r.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e,i)})))()},addNewItem:function(e){this.$emit("addNewItem",e)}}}},ho2g:function(e,t,i){"use strict";i("msl8")},"hv+2":function(e,t,i){"use strict";i.r(t);var n=i("OjZH"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},i5S3:function(e,t,i){},iUdy:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-table",{attrs:{data:e.item.val,size:"small"}},[e._l(e.item.meta.columns,(function(t){return[i("bk-table-column",{key:t.key,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){return["input"===t.display?[i("bk-input",{attrs:{clearable:!0,disabled:e.disabled},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[columnItem.key]"}})]:e._e(),e._v(" "),"select"===t.display?[i("bk-select",{attrs:{searchable:"","font-size":"medium","popover-min-width":180,disabled:e.disabled},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[columnItem.key]"}},e._l(t.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"multiselect"===t.display?[i("bk-select",{attrs:{searchable:"",multiple:"","popover-min-width":180,"font-size":"medium",disabled:e.disabled,"show-select-all":""},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[columnItem.key]"}},e._l(t.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"date"===t.display?[i("bk-date-picker",{attrs:{transfer:!0,disabled:e.disabled},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[columnItem.key]"}})]:e._e(),e._v(" "),"datetime"===t.display?[i("bk-date-picker",{attrs:{transfer:!0,disabled:e.disabled,type:"datetime"},model:{value:n.row[t.key],callback:function(i){e.$set(n.row,t.key,i)},expression:"props.row[columnItem.key]"}})]:e._e()]}}],null,!0)})]})),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.user['操作']"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("bk-button",{attrs:{theme:"primary",text:"",disabled:e.disabled},on:{click:e.addOne}},[e._v("\n                        "+e._s(e.$t('m.newCommon["添加"]'))+"\n                    ")]),e._v(" "),i("bk-button",{attrs:{theme:"primary",text:"",disabled:e.disabled},on:{click:function(i){return e.deleteOne(t)}}},[e._v("\n                        "+e._s(e.$t('m.newCommon["删除"]'))+"\n                    ")])]}}],null,!1,2789035803)})],2)],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},iesT:function(e,t,i){"use strict";i.r(t);var n=i("bddw"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},ioCs:function(e,t,i){"use strict";i.r(t);var n=i("11QV"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"j/2n":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-data-content",on:{click:e.closeError}},["CUSTOM"===e.formInfo.source_type?e._l(e.fieldInfo.list,(function(t,n){return i("div",{key:n,staticClass:"bk-custom-line",class:{mb20:n!==e.fieldInfo.list.length-1}},[i("div",{staticClass:"bk-costom-form"},[i("bk-input",{attrs:{maxlength:120,"ext-cls":"bk-custom-input",clearable:!0,disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入选项名']")},on:{blur:function(i){return e.putChar(t,n)}},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"item.name"}}),e._v(" "),"TABLE"===e.formInfo.type?[i("bk-checkbox",{staticStyle:{float:"left","margin-right":"10px","line-height":"32px"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:t.required,callback:function(i){e.$set(t,"required",i)},expression:"item.required"}},[e._v("\n                        "+e._s(e.$t("m.treeinfo['必填']"))+"\n                    ")])]:e._e(),e._v(" "),i("bk-input",{attrs:{"ext-cls":"bk-custom-input",disabled:(e.changeInfo.is_builtin||"TABLE"===e.changeInfo.source||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code)&&"bk_biz_id"!==e.formInfo.key,placeholder:e.$t("m.treeinfo['请输入选项ID']")},model:{value:t.key,callback:function(i){e.$set(t,"key",i)},expression:"item.key"}}),e._v(" "),i("div",{staticClass:"bk-custom-icon"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",class:{"bk-no-delete":e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code},on:{click:function(i){return e.addDataLine(t,n)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.fieldInfo.list.length||e.changeInfo.meta&&"APPROVE_RESULT"===e.changeInfo.meta.code},on:{click:function(i){return e.deleteDataLine(t,n)}}})])],2),e._v(" "),i("div",{staticClass:"bk-field-error-tip"},[t.nameCheck?i("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.deployPage["名称不能为空且不能重复"]')))]):[t.keyCheck?i("p",{staticClass:"bk-field-error"},[e._v(e._s(e.$t('m.deployPage["名称ID为英文数字及下划线且不能重复"]')))]):e._e()]],2)])})):e._e(),e._v(" "),"API"===e.formInfo.source_type?[e.apiInfo.remote_system_id&&e.apiInfo.remote_api_id?i("div",{staticClass:"bk-api-param"},[e.apiDetail.req_params&&e.apiDetail.req_params.length&&e.apiDetail.req_params[0].name?i("div",{staticClass:"bk-param"},[i("get-param",{ref:"getParam",attrs:{entry:"addField","form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e(),e._v(" "),e.apiDetail.req_body&&Object.keys(e.apiDetail.req_body).length&&e.apiDetail.req_body.properties&&Object.keys(e.apiDetail.req_body.properties).length?i("div",{staticClass:"bk-param"},[i("post-param",{ref:"postParam",attrs:{entry:"addField","form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e(),e._v(" "),e.apiDetail.rsp_data&&Object.keys(e.apiDetail.rsp_data).length&&e.apiDetail.rsp_data.properties&&Object.keys(e.apiDetail.rsp_data.properties).length?i("div",{staticClass:"bk-param"},[i("response-data",{ref:"responseData",attrs:{"remote-api-iid":e.apiInfo.remote_api_id,"change-info":e.changeInfo,"form-info":e.formInfo,"state-list":e.stateList,"api-detail":e.apiDetail}})],1):e._e()]):e._e()]:e._e(),e._v(" "),"RPC"===e.formInfo.source_type?[e.prcTable.length?i("div",{staticClass:"bk-api-param"},[i("div",{staticClass:"bk-param"},[i("get-rpc-param",{ref:"getRpcParam",attrs:{"form-info":e.formInfo,"change-info":e.changeInfo,"state-list":e.stateList,"prc-table":e.prcTable}})],1)]):e._e()]:e._e()],2)},o=[];n._withStripped=!0},j7Oh:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("QbLZ")),o=c(i("14Xm")),a=c(i("D3Ub")),s=c(i("efIh")),r=c(i("2Vgw"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"INPUTSELECT",mixins:[s.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[],addStatus:!1,tempChoice:{name:"",key:""}}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!e.item.val&&e.item.value&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 6:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.options=e.item.choice=t.sent;case 3:case"end":return t.stop()}}),t,e)})))()},selected:function(){var e=this;this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(t){e.fields.forEach((function(e){t===e.key&&(e.val=e.value="")}))}))},giveDefaultKey:function(){var e=this;this.tempChoice.name&&!this.tempChoice.key&&(this.tempChoice.key="",(0,r.default)(this.tempChoice.name,{style:r.default.STYLE_NORMAL,heteronym:!1}).forEach((function(t){e.tempChoice.key+=""+t})),this.tempChoice.key=this.tempChoice.key.toUpperCase().replace(/\ /g,"_"),this.tempChoice.key.length>=32&&(this.tempChoice.key=this.tempChoice.key.substr(0,32)))},confirmAdd:function(){this.tempChoice.name&&(this.addStatus=!1,this.options.push((0,n.default)({},this.tempChoice,{can_delete:!0})),this.item.val=this.tempChoice.key,this.tempChoice.name=this.tempChoice.key="")},cancelAdd:function(){this.addStatus=!1,this.tempChoice.name=this.tempChoice.key=""},handleDeleteOption:function(e){e===this.item.val&&(this.item.val=""),this.options=this.options.filter((function(t){return t.key!==e}))}}}},"jF+y":function(e,t,i){"use strict";i.r(t);var n=i("nwLY"),o=i("+fOZ");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("oDdV");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7c85693d",null);r.options.__file="src/views/service/editService/flowCanvas/NodeTemplate.vue",t.default=r.exports},jFOa:function(e,t,i){"use strict";i.r(t);var n=i("UYcT"),o=i("eofb");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"5776b98d",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/components/inheritState.vue",t.default=r.exports},jRUZ:function(e,t,i){},jXnR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-change-conductor"},["STRING"===e.itemInfo.type?[i("bk-input",{directives:[{name:"cursorIndex",rawName:"v-cursorIndex",value:"conductorId"+e.index,expression:"'conductorId' + index"}],staticStyle:{width:"260px"},attrs:{placeholder:e.$t("m.trigger['20个字符以内']")},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),"SELECT"===e.itemInfo.type?[i("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",clearable:!1,searchable:""},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},e._l(e.itemInfo.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"MULTISELECT"===e.itemInfo.type?[i("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",clearable:!1,searchable:"",multiple:""},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},e._l(e.itemInfo.choice,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e(),e._v(" "),"MEMBERS"===e.itemInfo.type||"MULTI_MEMBERS"===e.itemInfo.type?e._l(e.itemInfo.value,(function(t,n){return i("div",{key:n,staticClass:"bk-send-recipient",class:{"bk-none-margin":e.itemInfo.value.length-1===n}},[i("member-info",{attrs:{"item-info":e.itemInfo,"recipient-item":t,"recipient-index":n}})],1)})):e._e(),e._v(" "),"TEXT"===e.itemInfo.type?[i("bk-input",{directives:[{name:"cursorIndex",rawName:"v-cursorIndex",value:"conductorId"+e.index,expression:"'conductorId' + index"}],attrs:{type:"textarea","ext-cls":"bk-remindway-form",rows:6},on:{blur:e.changeMessagePanel},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),"RADIO"===e.itemInfo.type?[i("bk-radio-group",{model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},[e._l(e.itemInfo.choice,(function(t,n){return[i("bk-radio",{key:n,attrs:{value:t.key,"ext-cls":"mr50"}},[e._v(e._s(t.name))])]}))],2)]:e._e(),e._v(" "),"CHECKBOX"===e.itemInfo.type?[i("bk-checkbox-group",{model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}},[e._l(e.itemInfo.choice,(function(t,n){return[i("bk-checkbox",{key:n,attrs:{value:t.key,"ext-cls":"mr10"}},[e._v(e._s(t.name))])]}))],2)]:e._e(),e._v(" "),"INT"===e.itemInfo.type?[i("bk-input",{attrs:{clearable:!0,precision:e.precision,type:"number"},model:{value:e.itemInfo.value,callback:function(t){e.$set(e.itemInfo,"value",t)},expression:"itemInfo.value"}})]:e._e(),e._v(" "),"STRING"===e.itemInfo.type||"TEXT"===e.itemInfo.type?[i("div",{staticClass:"bk-select-btn"},[i("bk-button",{staticClass:"bk-form-btn plus-cus",attrs:{theme:"default",title:e.$t("m.slaContent['插入变量']"),icon:"plus"}},[e._v("\n                "+e._s(e.$t('m.slaContent["插入变量"]'))+"\n            ")]),e._v(" "),i("bk-select",{attrs:{"ext-cls":"bk-select-btn-opacity",searchable:""},on:{selected:e.changeInsert},model:{value:e.insertValue,callback:function(t){e.insertValue=t},expression:"insertValue"}},e._l(e.variableList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)],1)]:e._e(),e._v(" "),"VARIABLE"===e.itemInfo.value?[i("bk-select",{staticStyle:{width:"260px"},attrs:{"ext-cls":"bk-insert-info",searchable:"",multiple:Array.isArray(e.itemInfo.insertValue)},on:{selected:e.changeImport},model:{value:e.itemInfo.insertValue,callback:function(t){e.$set(e.itemInfo,"insertValue",t)},expression:"itemInfo.insertValue"}},e._l(e.variableList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:e._e()],2)},o=[];n._withStripped=!0},jmL5:function(e,t,i){"use strict";i("eEXZ")},jppy:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("rMih"),a=(n=o)&&n.__esModule?n:{default:n},s=i("ygAv");t.default={name:"sopsGetParam",components:{addField:a.default},props:{quoteVars:Array,constantDefaultValue:Object,context:{type:Object,default:function(){return{}}},constants:{type:Array,default:function(){return[]}},isStaticData:{type:Array,default:function(){return[]}},configur:{type:Object,default:function(){return{}}},flowInfo:{type:Object,default:function(){return{}}},stateList:{type:Array,default:function(){return[]}},isStatic:{type:Boolean,default:function(){return!1}},hookedVarList:Object,isHook:{type:Boolean,default:function(){return!0}},isEdit:{type:Boolean,default:function(){return!0}}},data:function(){return{disabled:!1,ticketDisable:!1,disabledRenderForm:!1,configLoading:!1,quoteErrors:[],renderKey:"",formData:{},formOptions:{showRequired:!0,showGroup:!0,showLabel:!0,showHook:this.isHook,showDesc:!0,formEdit:!this.disabled&&!this.disabledRenderForm&&this.isEdit},fieldList:[],checkInfo:{name:"",road:""},biz:[{name:this.$t('m.treeinfo["业务"]'),custom_type:"",source_type:"custom",value:"--",key:1}],changeInfo:{workflow:"",id:"",key:"",name:"",type:"STRING",desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],is_builtin:!1,source_type:"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:""},sourceTypeList:[{id:1,key:"custom",name:this.$t('m.treeinfo["自定义"]')},{id:2,key:"component_inputs",name:this.$t('m.treeinfo["引用变量"]')}],sliderInfo:{title:this.$t('m.treeinfo["添加变量"]'),show:!1,width:700},showTabData:{},sopsTableInfo:[]}},computed:{},watch:{constants:function(){this.renderKey=(new Date).getTime()},isEdit:function(){this.renderKey=(new Date).getTime()}},mounted:function(){var e=this;this.isStatic&&(this.sopsTableInfo=[],this.isStaticData.forEach((function(t){var i={name:t.name,value:t.value};e.sopsTableInfo.push(i)})))},methods:{onHookChange:function(e,t){this.$emit("onChangeHook",t.tag_code,e);var i=this.constants.find((function(e){return e.key===t.tag_code}));if(i.is_quoted=e,e)this.formData[t.tag_code]="";else{this.formData[t.tag_code]=i?(0,s.deepClone)(this.constantDefaultValue[t.tag_code]):"";var n=this.quoteErrors.findIndex((function(e){return e===t.tag_code}));n>-1&&this.quoteErrors.splice(n,1)}},changeTicketformDisable:function(e){this.$set(this.$refs.renderForm.formOption,"formEdit",e)},onSelectVar:function(e,t){this.formData[t.tag_code]="${"+e+"}"},getRenderFormValidate:function(){return this.$refs.renderForm.validate()},getRelatedFields:function(){this.$parent.getRelatedFields()},addNewItem:function(e){this.showTabData=e,this.sliderInfo.show=!0,this.$refs["selectSops"+e.key].close()},closeShade:function(){this.sliderInfo.show=!1},showNew:function(e,t){this.paramTableShow.forEach((function(i){i.key===e.key&&(i.value=t.data.key)}))}}}},jub7:function(e,t,i){"use strict";i.r(t);var n=i("Kbo1"),o=i("0rd9");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"1aab0702",null);r.options.__file="src/views/commonComponent/fieldComponent/link.vue",t.default=r.exports},jvs4:function(e,t,i){"use strict";i.r(t);var n=i("4lVZ"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},jzyo:function(e,t,i){"use strict";i.r(t);var n=i("282m"),o=i("0Aq+");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("mBQM");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"1055f363",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/autoNode.vue",t.default=r.exports},k85c:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("UsFA"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"RenderView",components:{ViewItem:a.default},props:{formData:{type:Array,default:function(){return[]}},context:{type:Object,default:function(){return{}}}},provide:function(){var e=this;return{getContext:function(){return e.context}}},data:function(){return{isRootRenderView:null,value:{}}},created:function(){this.initRenderView()},methods:{getScheme:function(e){return this.context.schemes[e.scheme]?this.context.schemes[e.scheme]:{}},initRenderView:function(){for(var e=this,t=!1;!t&&e.$parent;)"render-view"===e.$parent.$options._componentTag?t=!0:e=e.$parent;this.isRootRenderView=!t}}}},kAUb:function(e,t,i){"use strict";i.r(t);var n=i("Hk/7"),o=i("E3ky");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("b1uY");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"c53949da",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/sopsNode.vue",t.default=r.exports},kAVo:function(e,t,i){"use strict";i("olgb")},kJ3o:function(e,t,i){},kQq5:function(e,t,i){"use strict";i.r(t);var n=i("mE3A"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},kSST:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),o=s(i("D3Ub")),a=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"SELECT",mixins:[a.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{options:[]}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)},"item.choice":function(e,t){"API"!==this.item.source_type&&"DATADICT"!==this.item.source_type&&"RPC"!==this.item.source_type||t.length===e.length||this.getOption()}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!e.item.val&&e.item.value&&(e.item.val=e.item.value),t.next=3,e.getOption();case 3:i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 6:case"end":return t.stop()}}),t,e)})))()},methods:{getOption:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item);case 2:e.options=e.item.choice=t.sent;case 3:case"end":return t.stop()}}),t,e)})))()},selected:function(){var e=this;this.item.related_fields&&this.item.related_fields.be_relied&&this.item.related_fields.be_relied.forEach((function(t){e.fields.forEach((function(e){t===e.key&&(e.val=e.value="")}))}))}}}},kicn:function(e,t,i){"use strict";i("fJfp")},kiqS:function(e,t,i){},kjRb:function(e,t,i){"use strict";i.r(t);var n=i("KElf"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},kvAC:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,"ext-cls":"bk-ext-item",desc:e.item.tips,"desc-type":"icon"}},[i("div",{staticClass:"member-form-item",on:{click:function(t){e.item.checkValue=!1}}},[i("member-select",{class:{"bk-border-error":e.item.checkValue},attrs:{disabled:e.item.is_readonly&&!e.isCurrent||e.item.evaluDisable||e.disabled,placeholder:e.item.desc},on:{change:e.onMemberSelectChange},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),i("business-card",{attrs:{item:e.item}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},kyjx:function(e,t,i){"use strict";i("LFqy")},lAAG:function(e,t,i){"use strict";i.r(t);var n=i("vWOQ"),o=i("9psX");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("X5Hi");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"fbe1abfa",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/customTableData.vue",t.default=r.exports},lMr9:function(e,t,i){},lR6s:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("2eEL"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"Tree",components:{collapseTransition:a.default},props:{treeDataList:{type:Array,default:[]},treeIndex:{type:Number,default:0}},data:function(){return{pLeft:"padding-left:"+15*(this.treeIndex+1)+"px; padding-right: 10px;"}},methods:{toggleChildren:function(e){this.$emit("toggleChildren",e)},toggle:function(e){this.$emit("toggle",e)}}}},lWSq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("14Xm")),o=c(i("D3Ub")),a=c(i("efIh")),s=c(i("u8Ap")),r=c(i("EP+X"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MEMBERS",components:{memberSelect:s.default,businessCard:r.default},mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{selectedItems:[]}},watch:{"item.val":function(e){this.selectedItems=e?e.split(","):[]}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.selectedItems=e.item.val?e.item.val.split(","):[],e.conditionField(e.item,e.fields);case 2:case"end":return t.stop()}}),t,e)})))()},methods:{onMemberSelectChange:function(e){this.item.val=e.join(",")}}}},lXJ6:function(e,t,i){"use strict";i.r(t);var n=i("fwY8"),o=i("yX+q");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("BcAi");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"142c083e",null);r.options.__file="src/views/service/editService/lineConfigue/index.vue",t.default=r.exports},lnc2:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",{staticClass:"member-field"},[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,"ext-cls":"bk-ext-item",desc:e.item.tips,"desc-type":"icon"}},[i("div",{staticClass:"member-form-item",on:{click:function(t){e.item.checkValue=!1}}},[i("member-select",{class:{"bk-border-error":e.item.checkValue},attrs:{multiple:!1,disabled:e.item.is_readonly},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),i("business-card",{staticStyle:{"margin-top":"3px"},attrs:{item:e.item}})],1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},m6ij:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.flowDataLoading},expression:"{ isLoading: flowDataLoading }"}],class:[e.isShowNodeConfig?"process-step-node-conf":"process-step"]},[e.flowDataLoading?e._e():[e.isShowNodeConfig?i("div",[i("div",{staticClass:"node-type"},[e._v(e._s(e.nodeType)+"\n                "),i("i",{staticClass:"bk-itsm-icon icon-itsm-icon-three-one close-node-conf",on:{click:e.closeConfigur}})]),e._v(" "),"NORMAL"===e.configur.type?i("basic-node",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e(),e._v(" "),"TASK"===e.configur.type?i("autoNode",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e(),e._v(" "),"TASK-SOPS"===e.configur.type?i("sopsNode",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e(),e._v(" "),"TASK-DEVOPS"===e.configur.type?i("devopsNode",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e(),e._v(" "),"SIGN"===e.configur.type?i("signNode",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e(),e._v(" "),"APPROVAL"===e.configur.type?i("approval-node",{attrs:{"flow-info":e.flowInfo,configur:e.configur},on:{closeConfigur:e.closeConfigur}}):e._e()],1):i("second-flow",{ref:"flowInfo",attrs:{"add-list":e.nodeList,"line-list":e.lineList,"flow-info":e.flowInfo},on:{handleNodeClick:e.handleNodeClick}})]],2)},o=[];n._withStripped=!0},mBA7:function(e,t,i){"use strict";i("+VvI")},mBQM:function(e,t,i){"use strict";i("Jdd0")},mE3A:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("rfXi")),o=r(i("R5iJ")),a=r(i("CXV/")),s=r(i("W3y+"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"bk-upload",props:{name:{type:String,default:"upload_file"},multiple:{type:Boolean,default:!0},accept:{type:String,default:"*"},delayTime:{type:Number,default:0},url:{required:!0,type:String},size:{type:[Number,Object],default:function(){return{maxFileSize:5,maxImgSize:1}}},handleResCode:{type:Function,default:function(e){return 0===e.code}},header:[Array,Object],tip:{type:String,default:""},validateName:{type:RegExp},withCredentials:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{dragText:"支持的附件格式：txt，log，pdf，doc，ppt，xls，docx，pptx，xlsx，zip，jpg，png，每个文件不超过200Mb",clickText:"点击上传",showDialog:!0,fileList:[],width:0,barEl:null,fileIndex:null,speed:0,total:0,unit:"kb/s",isdrag:!1,progress:0,uploadIcon:s.default}},watch:{fileIndex:function(e){null!==e&&e<this.fileList.length&&this.uploadFile(this.fileList[e],e)}},methods:{filesize:function(e){var t=e/1e3;if(t<1)return e.toFixed(3)+" KB";var i=t.toString().indexOf(".");return t.toString().slice(0,i+2)+" MB"},selectFile:function(e){var t=this,i=(0,n.default)(e.target.files);if(i.length){i.forEach((function(e,i){var n={name:e.name,originSize:e.size,size:e.size/1e3,maxFileSize:null,maxImgSize:null,type:e.type,fileHeader:"",origin:e,base64:"",status:"",done:!1,responseData:"",speed:null,errorMsg:"",progress:""},o=n.type.indexOf("/"),a=n.type.slice(0,o),s=n.type.indexOf("application/x-photoshop")>-1;n.fileHeader=a,"number"==typeof t.size?(n.maxFileSize=t.size,n.maxImgSize=t.size):(n.maxFileSize=t.size.maxFileSize,n.maxImgSize=t.size.maxImgSize),("image"===a||s)&&t.handleImage(n,e),("image"!==a||!s)&&n.size>1e3*n.maxFileSize&&(n.errorMsg="文件不能超过"+n.maxFileSize+"MB"),t.validateName&&(t.validateName.test(n.name)||(n.errorMsg="文件名不合法")),t.fileList.push(n)}));var o=this.fileList.length,a=this.fileIndex;o-1===a?this.uploadFile(this.fileList[a],a):this.fileIndex=0,e.target.value=""}},hideFileList:function(){var e=this;this.delayTime&&setTimeout((function(){e.fileList=[]}),this.delayTime)},uploadFile:function(e){var t=this;if(e.errorMsg)return this.fileIndex+=1,void(e.progress="100%");var i=new FormData,n=new XMLHttpRequest;i.append(this.name,e.origin),this.isdrag=!1,e.xhr=n,n.onreadystatechange=function(){if(4===n.readyState){try{var i=JSON.parse(n.responseText);200===n.status&&t.handleResCode(i)?(e.done=!0,e.responseData=i,t.$emit("on-success",e,t.fileList)):(e.errorMsg=i.message,t.$emit("on-error",e,t.fileList))}catch(t){e.progress="100%",e.errorMsg=error.message}t.fileIndex+=1,t.unit="kb/s",t.total=0,e.status="done",t.fileIndex===t.fileList.length&&(t.$emit("on-done",t.fileList),t.hideFileList())}};if(n.upload.addEventListener("progress",(function(i){if(i.lengthComputable){var n=Math.round(100*i.loaded/i.total),o=Math.round(i.loaded/1e3);e.progress=n+"%",t.speed=o-t.total,t.total=o,t.unit="kb/s",t.speed>1e3&&(t.speed=Math.round(t.speed/1e3),t.unit="mb/s"),t.$emit("on-progress",i,e,t.fileList)}e.status="running"}),!1),n.withCredentials=this.withCredentials,n.open("POST",this.url,!0),this.header)if(Array.isArray(this.header))this.header.forEach((function(e){var i=t.header.name,o=t.header.value;n.setRequestHeader(i,o)}));else{var o=this.header.name,a=this.header.value;n.setRequestHeader(o,a)}n.send(i)},handleImage:function(e,t){var i=this;if(!/image\/(jpg|png|jpeg)$/.test(e.type))return e.errorMsg="只允许上传JPG|PNG|JPEG格式的图片",!1;if(e.size>1e3*e.maxImgSize)return e.errorMsg="图片大小不能超过"+e.maxImgSize+"MB",!1;var n=new FileReader;return n.onload=function(t){i.smallImage(n.result,e)},n.readAsDataURL(t),!0},smallImage:function(e,t){var i=new Image,n=document.createElement("canvas"),o=n.getContext("2d");i.onload=function(){var e=i.width,a=i.height,s=e,r=a;(e>42||a>42)&&(e/a>1?(s=42,r=Math.round(a/e*42)):(s=42,r=42)),n.width=s,n.height=r,o.clearRect(0,0,s,r),o.drawImage(i,0,0,s,r),t.base64=n.toDataURL()},i.src=e},getIcon:function(e){if(e.base64)return e.base64;for(var t=!1,i=["zip","rar","tar","gz"],n=0;n<i.length;n++)if(e.type.indexOf(i[n])>-1){t=!0;break}return t?o.default:a.default},deleteFile:function(e,t){t.xhr&&t.xhr.abort(),this.fileList.splice(e,1);var i=this.fileList.length;i||(this.fileIndex=null),0===e&&i&&(this.fileIndex=0,this.uploadFile(this.fileList[0]))}},mounted:function(){var e=this,t=this.$refs.uploadel;t.addEventListener("dragenter",(function(t){e.isdrag=!0})),t.addEventListener("dragleave",(function(t){e.isdrag=!1})),t.addEventListener("dragend",(function(t){e.isdrag=!1}))}}},mLx0:function(e,t,i){},mW7z:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("P2sY"),a=(n=o)&&n.__esModule?n:{default:n},s=i("CeR/");t.default={name:"dataSource",components:{},mixins:[],props:{formInfo:{type:Object,default:function(){return{}}},prcData:{type:Object,default:function(){return{}}},dictionaryData:{type:Object,default:function(){return{}}},apiInfo:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}}},data:function(){return{typeClass:"",isApiLoading:!1,isSystemLoading:!1,sourceList:[],apiSysList:[],apiPortList:[]}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},watch:{"formInfo.type":function(){this.initData(),this.getSourceList()}},mounted:function(){this.initData(),this.getSourceList()},methods:{initData:function(){this.typeClass="API"===this.formInfo.source_type?"bk-threeline-item bk-halfline-margin":"bk-halfline-item bk-halfline-margin",this.getApiSystemList(),"API"===this.formInfo.source_type&&this.apiInfo.remote_system_id&&this.getApiPortList(this.apiInfo.remote_system_id)},getSourceList:function(){var e=this.globalChoise.source_type;"TABLE"===this.formInfo.type?this.sourceList=e.filter((function(e){return"CUSTOM"===e.typeName})):"TREESELECT"===this.formInfo.type?this.sourceList=e.filter((function(e){return"DATADICT"===e.typeName||"RPC"===e.typeName})):this.sourceList=this.globalChoise.source_type},getApiSystemList:function(){var e=this,t={project_key:this.$store.state.project.id||"public"};this.isSystemLoading=!0,this.$store.dispatch("apiRemote/get_all_remote_system",t).then((function(t){e.apiSysList=t.data.filter((function(e){return e.is_activated}))})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.isSystemLoading=!1}))},getApiPortList:function(e){var t=this,i={remote_system:e||""};this.isApiLoading=!0,this.$store.dispatch("apiRemote/get_remote_api",i).then((function(e){t.apiPortList=e.data.filter((function(e){return e.is_activated}));var i=t.apiPortList.filter((function(e){return String(e.id)===String(t.apiInfo.remote_api_id)}))[0],n=(0,a.default)({},i);t.$emit("changeApiInfo",n)})).catch((function(e){(0,s.errorHandler)(e,t)})).finally((function(){t.isApiLoading=!1}))},changeApiPort:function(e){this.apiInfo.rsp_data="",this.apiInfo.req_params={},this.apiInfo.req_body={};var t=this.apiPortList.filter((function(t){return String(t.id)===String(e)}))[0],i=(0,a.default)({},t);this.$emit("changeApiInfo",i)},changeSource:function(e){this.typeClass="API"===this.formInfo.source_type?"bk-threeline-item bk-halfline-margin":"bk-halfline-item bk-halfline-margin"},changeApiSystem:function(e){this.apiInfo.remote_api_id="",this.apiInfo.rsp_data="",this.apiInfo.req_params={},this.apiInfo.req_body={},this.getApiPortList(e)},changeRpc:function(e){var t=this.prcData.list.filter((function(t){return t.key===e}))[0].req_params;this.$emit("getRpcData",t)},checkSouce:function(){var e=!1;return"DATADICT"===this.formInfo.source_type?e=!this.dictionaryData.check:"API"===this.formInfo.source_type?e=!this.apiInfo.remote_system_id||!this.apiInfo.remote_api_id:"RPC"===this.formInfo.source_type&&(e=!this.prcData.check),e&&this.$bkMessage({theme:"warning",message:this.$t('m.treeinfo["请选择正确的数据源"]')}),e}}}},ml4i:function(e,t,i){"use strict";i.r(t);var n=i("hHxK"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},msl8:function(e,t,i){},mwWM:function(e,t,i){"use strict";i("kiqS")},nUMf:function(e,t,i){},nUUp:function(e,t,i){},nVin:function(e,t,i){"use strict";i.r(t);var n=i("nmi9"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},nbv9:function(e,t,i){"use strict";i("aezY")},nmi9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("QbLZ")),o=r(i("NPk7")),a=r(i("hftF")),s=i("ygAv");function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ViewItem",components:{TagText:o.default,TagTable:a.default,RenderView:function(){return Promise.resolve().then(i.bind(null,"FCVG"))}},inject:["getContext"],props:{scheme:{type:Object,default:function(){return{}}},form:{type:Object,default:function(){return{}}},isTop:{type:Boolean,default:!1},topIndex:{type:Number}},data:function(){return{crumbsList:[],childrenViewConfig:{form_data:[]}}},computed:{componentType:function(){return"Tag"+this.scheme.type.replace(/^[a-z]/,(function(e){return e.toUpperCase()}))},currentDisplatCrumbs:function(){return this.crumbsList[this.crumbsList.length-1]||{label:"默认",form_data:[]}}},created:function(){this.appendCrumbsItem(this.form.label,this.form)},methods:{getAttrs:function(e){return(0,n.default)({},this.scheme.attrs,e)},appendCrumbsItem:function(e,t){this.crumbsList.push({label:e,form_data:(0,s.deepClone)(t)}),this.updateChildViewConfig()},getScheme:function(e){var t=this.getContext().schemes;return t[e.scheme]?t[e.scheme]:{}},onCrumbsClick:function(e){this.crumbsList=this.crumbsList.filter((function(t,i){return i<=e})),this.updateChildViewConfig()},updateChildViewConfig:function(){this.childrenViewConfig={form_data:(0,s.deepClone)(this.currentDisplatCrumbs.form_data)}}}}},nrD6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),o=s(i("D3Ub")),a=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"RADIO",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{}},watch:{"item.val":function(){this.conditionField(this.item,this.fields)}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.item.value&&!e.item.val&&(e.item.val=e.item.value),t.next=3,e.getFieldOptions(e.item);case 3:e.item.choice=t.sent,i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.conditionField(e.item,e.fields);case 7:case"end":return t.stop()}}),t,e)})))()},methods:{}}},nuXq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("2eEL"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"BasicCard",components:{collapseTransition:a.default},props:{showFoldTitle:{type:Boolean,default:!1},foldTitle:{type:String,default:""},firstUnfold:{type:Boolean,default:!0},cardLabel:{type:String,default:""},cardDesc:{type:String,default:""}},data:function(){return{showMore:!0}},watch:{isFold:{handler:function(){this.showMore=this.firstUnfold},immediate:!0}}}},nwLY:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeNode,expression:"closeNode"},{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{placement:"auto",content:e.node.name,theme:"light"},expression:"{\n        placement: 'auto',\n        content: node.name,\n        theme: 'light'\n    }"}],staticClass:"bk-flow-location",class:{"bk-error-flow":e.node.nodeInfo&&e.node.nodeInfo.errorInfo},on:{mousedown:function(t){return e.moveDoneFn(e.node)},mousemove:e.moveFn,mouseup:function(t){return e.onNodeClick(e.node,t)},contextmenu:function(t){return t.preventDefault(),e.rightClickNode(e.node,t)},mouseout:function(t){return e.hoverNode(e.node)}}},["START"===e.node.type?i("div",{staticClass:"startpoint",attrs:{"data-test-id":"startNode"}},[e._v("\n        "+e._s(e.$t("m.treeinfo['开始']"))+"\n    ")]):e._e(),e._v(" "),"END"===e.node.type?i("div",{staticClass:"endpoint",attrs:{"data-test-id":"endNode"}},[e._v("\n        "+e._s(e.$t('m.treeinfo["结束"]'))+"\n    ")]):e._e(),e._v(" "),e._l(e.typeList,(function(t,n){return[e.node.type===t.type?[i("div",{key:n,staticClass:"common-node",attrs:{"data-test-id":"nodeTemplate-common-node-"+n+"-"+t.type},on:{click:function(t){return e.clickNode(e.node,t)}}},[i("span",{staticClass:"common-auto-icon",class:{"bk-is-draft":e.node.nodeInfo&&e.node.nodeInfo.is_draft},on:{click:function(t){return t.stopPropagation(),e.openconfigu.apply(null,arguments)}}},["TASK"!==t.type?i("i",{staticClass:"bk-itsm-icon",class:t.iconStyle}):i("span",{staticStyle:{"font-size":"11px","font-weight":"bold"}},[e._v("API")])]),e._v(" "),i("span",{staticClass:"bk-more-word",attrs:{title:e.node.name||e.$t("m.treeinfo['新增节点']")}},[e._v(e._s(e.node.name||e.$t("m.treeinfo['新增节点']")))]),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-edit-bold"}),e._v(" "),e.node.nodeInfo&&e.node.nodeInfo.is_builtin?e._e():i("span",{staticClass:"bk-node-delete",on:{click:function(t){return t.stopPropagation(),e.clickDelete(e.node)},mouseup:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[e._v("×")]),e._v(" "),!e.toolStatus&&e.node.nodeInfo&&e.node.nodeInfo.is_builtin?i("div",{staticClass:"bk-toop-info"},[i("p",[i("span",[e._v(e._s(e.$t("m.treeinfo['单击：']")))]),e._v(e._s(e.$t("m.treeinfo['快速配置节点']")))]),e._v(" "),i("p",[i("span",[e._v(e._s(e.$t("m.treeinfo['右键：']")))]),e._v(e._s(e.$t("m.treeinfo['调出快速添加节点菜单']")))]),e._v(" "),i("i",{staticClass:"bk-icon icon-close",on:{click:function(t){return t.stopPropagation(),e.closeTool.apply(null,arguments)}}}),e._v(" "),i("i",{staticClass:"bk-squrae"})]):e._e()])]:e._e()]})),e._v(" "),"ROUTER-P"===e.node.type?i("div",{staticClass:"common-branch"},[i("i",{staticClass:"bk-itsm-icon icon-flow-convergence"}),e._v(" "),i("span",{staticClass:"bk-node-delete",on:{click:function(t){return t.stopPropagation(),e.clickDelete(e.node)}}},[e._v("×")])]):e._e(),e._v(" "),"COVERAGE"===e.node.type?i("div",{staticClass:"common-branch"},[i("i",{staticClass:"bk-itsm-icon icon-flow-branch"}),e._v(" "),i("span",{staticClass:"bk-node-delete",on:{click:function(t){return t.stopPropagation(),e.clickDelete(e.node)}}},[e._v("×")])]):e._e(),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.node.showMore&&"START"!==e.node.type&&"END"!==e.node.type,expression:"node.showMore && node.type !== 'START' && node.type !== 'END'"}],staticClass:"bk-flow-fast"},[i("div",{staticClass:"bk-engine-node"},[i("ul",e._l(e.clickList,(function(t,n){return i("li",{key:n,staticClass:"tool",attrs:{"data-test-id":"nodeTemplate-li-addNodeTemplate"+n,title:t.name},on:{click:function(i){return i.stopPropagation(),e.addNormal(e.node,t)}}},[i("i",{staticClass:"bk-itsm-icon",class:[t.iconStyle,{"bk-font-style":["icon-icon-artificial","icon-api-node","icon-task-icon","con-copy-new","icon-sign-node","icon-approval-node","icon-devops-task-icon"].includes(t.iconStyle)}]})])})),0)]),e._v(" "),i("div",{staticClass:"bk-engine-word"},[i("span",{staticClass:"bk-canvas-span bk-engine-configur",class:{"bk-engine-builtin":"ROUTER-P"===e.node.type||"COVERAGE"===e.node.type},on:{click:function(t){return t.stopPropagation(),e.openconfigu.apply(null,arguments)}}},[e._v(e._s(e.$t('m.treeinfo["配置"]')))]),e._v(" "),i("span",{staticClass:"bk-canvas-span bk-engine-delete",class:{"bk-engine-builtin":e.node.nodeInfo&&e.node.nodeInfo.is_builtin},on:{click:function(t){return t.stopPropagation(),e.clickDelete(e.node)}}},[e._v(e._s(e.$t('m.treeinfo["删除"]')))])])])],2)},o=[];n._withStripped=!0},nxpg:function(e,t,i){"use strict";i.r(t);var n=i("7TlO"),o=i("Ha+5");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"1657c233",null);r.options.__file="src/views/commonComponent/fieldComponent/date.vue",t.default=r.exports},"o+k2":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"child-node"},[e.treeDataList.length?e._l(e.treeDataList,(function(t,n){return i("li",{key:n,staticClass:"vue-tree-item"},[!e.isKeyValue&&t.children&&t.children.length||e.isKeyValue?i("div",{class:["tree-node",{down:t.showChildren,"set-frist-pLeft":e.treeIndex+1===1,active:t.checkInfo}],style:e.pLeft,on:{click:function(i){return i.stopPropagation(),e.toggle(t)}}},[t.showChildren||"object"!==t.type?e._e():i("i",{staticClass:"bk-icon icon-right-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}),e._v(" "),t.showChildren&&"object"===t.type?i("i",{staticClass:"bk-icon icon-down-shape",class:{"bk-padding":!t.has_children},on:{click:function(i){return i.stopPropagation(),e.toggleChildren(t)}}}):e._e(),e._v(" "),i("i",{staticClass:"bk-icon icon-folder-open-shape"}),e._v(" "),i("span",{staticClass:"name-text",attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),t.checkInfo?i("i",{staticClass:"bk-icon icon-check-1",staticStyle:{float:"right","margin-top":"11px"}}):e._e()]):e._e(),e._v(" "),i("collapse-transition",["object"===t.type&&t.showChildren&&t.children?[i("exportTree",{attrs:{"tree-data-list":t.children,"tree-index":e.treeIndex+1,"is-key-value":e.isKeyValue},on:{selectItem:e.selectItem,toggle:e.toggle,toggleChildren:e.toggleChildren}})]:e._e()],2)],1)})):[e.isKeyValue?e._e():i("li",{staticClass:"vue-tree-item"},[i("div",{staticClass:"tree-node set-frist-pLeft"},[i("span",{staticClass:"name-text"},[e._v(e._s(e.$t('m.deployPage["暂无数据"]')))])])])]],2)},o=[];n._withStripped=!0},"o1/R":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i("14Xm")),o=c(i("D3Ub")),a=c(i("efIh")),s=c(i("u8Ap")),r=c(i("EP+X"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"MEMBER",components:{memberSelect:s.default,businessCard:r.default},mixins:[a.default],props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1}},data:function(){return{selectedItems:[]}},watch:{"item.val":function(){this.item.val&&(this.selectedItems=this.item.val?[this.item.val]:[]),this.conditionField(this.item,this.fields)},selectedItems:{handler:function(e,t){this.item.val=this.selectedItems.join(",")}}},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.selectedItems=e.item.val?[e.item.val]:[],e.conditionField(e.item,e.fields);case 2:case"end":return t.stop()}}),t,e)})))()}}},o3v5:function(e,t,i){"use strict";i("Ga10")},oBdi:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Palette",data:function(){return{devsopDisable:window.RUN_VER}}}},oDdV:function(e,t,i){"use strict";i("5zZ0")},"oL/I":function(e,t,i){},oN1V:function(e,t,i){},odgA:function(e,t,i){"use strict";i("rvnp")},ohl0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("14Xm")),o=s(i("D3Ub")),a=s(i("efIh"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"CHECKBOX",mixins:[a.default],props:{item:{type:Object,required:!0,default:function(){}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{loading:!1,selects:[]}},watch:{"item.val":function(e){this.selects=""===e?[]:e.split(","),this.conditionField(this.item,this.fields)},"item.choice":{handler:function(){this.resetCheckboxGroupData()},deep:!0}},created:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFieldOptions(e.item,e.isPreview);case 2:e.item.choice=t.sent,i=e.judgeValue(e.item.val,e.item.choice),e.item.val=i?e.item.val:"",e.selects=""===e.item.val?[]:e.item.val.split(","),e.conditionField(e.item,e.fields),e.item.value&&!e.item.val&&(e.item.val=e.item.value);case 8:case"end":return t.stop()}}),t,e)})))()},methods:{selected:function(e){this.item.val=e.join(","),this.item.checkValue=!1},resetCheckboxGroupData:function(){var e=this,t=this.item.key;this.$refs[t]&&(this.$refs[t].checkboxItems=[],this.loading=!0,this.$nextTick((function(){e.loading=!1})))}}}},oiO8:function(e,t,i){},olgb:function(e,t,i){},"p/z7":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"member-content"},[i("bk-select",{class:{"member-select":!0,"half-member-select":e.recipientItem.key},attrs:{searchable:""},on:{selected:e.getSecondLevelList},model:{value:e.recipientItem.key,callback:function(t){e.$set(e.recipientItem,"key",t)},expression:"recipientItem.key"}},e._l(e.recipientKeyList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),"ORGANIZATION"!==e.recipientItem.key?["VARIABLE"===e.recipientItem.key?[i("bk-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},attrs:{searchable:""},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}},e._l(e.variableList,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1)]:"PERSON"===e.recipientItem.key&&Array.isArray(e.recipientItem.value)?[i("member-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}})]:"GENERAL"!==e.recipientItem.key&&"CMDB"!==e.recipientItem.key||!Array.isArray(e.recipientItem.value)?e._e():[i("bk-select",{staticStyle:{float:"left",width:"50%","margin-right":"6px"},attrs:{loading:e.recipientItem.isLoading,"show-select-all":"",multiple:"",searchable:""},model:{value:e.recipientItem.value,callback:function(t){e.$set(e.recipientItem,"value",t)},expression:"recipientItem.value"}},e._l(e.recipientItem.secondLevelList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]]:e._e(),e._v(" "),"ORGANIZATION"===e.recipientItem.key?[i("div",{directives:[{name:"bk-clickoutside",rawName:"v-bk-clickoutside",value:e.closeTree,expression:"closeTree"}],staticClass:"bk-search-tree",staticStyle:{float:"left",width:"50%","margin-right":"6px"}},[i("div",{staticClass:"bk-search-tree-wrapper",on:{click:function(t){return t.stopPropagation(),e.showTree("view")}}},[i("span",{class:{"bk-color-tree":e.roles.viewtree.name}},[e._v("\n                    "+e._s(e.roles.viewtree.showName||e.$t('m.serviceConfig["请选择"]'))+"\n                ")]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]),e._v(" "),i("transition",{attrs:{name:"common-fade"}},[e.roles.viewTreeOpen?i("div",{staticClass:"bk-search-tree-content"},[i("export-tree",{attrs:{"tree-data-list":e.roles.viewTreeDataList},on:{toggle:e.toggleInfo,toggleChildren:function(t){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return e.toggleChildren.apply(void 0,n.concat(["view"]))}}})],1):e._e()])],1)]:e._e(),e._v(" "),"MULTI_MEMBERS"===e.itemInfo.type?i("div",{staticClass:"bk-between-operat"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:e.addRecipient}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.itemInfo.value.length},on:{click:e.deleteRecipient}})]):e._e()],2)},o=[];n._withStripped=!0},pLYB:function(e,t,i){"use strict";i("Rg1I")},pPAs:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("div",{staticClass:"bk-form-width"},[i("bk-select",{attrs:{clearable:!1,disabled:e.disabled,searchable:""},on:{selected:e.getSecondLevelList},model:{value:e.formData.levelOne,callback:function(t){e.$set(e.formData,"levelOne",t)},expression:"formData.levelOne"}},e._l(e.firstLevelList,(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1)],1),e._v(" "),"ORGANIZATION"!==e.formData.levelOne?["VARIABLE"===e.formData.levelOne?i("div",{staticClass:"bk-form-width"},[i("bk-select",{attrs:{loading:e.isLoading,disabled:e.disabled,"show-select-all":"",multiple:"",searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.frontMemberField,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.key,name:e.name}})})),1)],1):"PERSON"===e.formData.levelOne?i("div",{staticClass:"bk-form-width"},[i("member-select",{attrs:{disabled:e.disabled},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})],1):"CMDB"===e.formData.levelOne?i("div",{staticClass:"bk-form-width"},[i("bk-select",{attrs:{loading:e.isLoading,"show-select-all":"",multiple:"",searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.secondLevelList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1):"GENERAL"===e.formData.levelOne?i("div",{staticClass:"bk-form-width"},[i("bk-select",{attrs:{loading:e.isLoading,disabled:e.disabled,searchable:""},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}},e._l(e.secondLevelList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1):e._e()]:e._e(),e._v(" "),"ORGANIZATION"===e.formData.levelOne?i("div",{staticClass:"bk-form-width"},[i("select-tree",{attrs:{list:e.organizationList},model:{value:e.formData.levelSecond,callback:function(t){e.$set(e.formData,"levelSecond",t)},expression:"formData.levelSecond"}})],1):e._e()],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2):e._e()},o=[];n._withStripped=!0},pRHh:function(e,t,i){"use strict";i.r(t);var n=i("CBo5"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},pV0w:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(i("4d7F")),o=p(i("14Xm")),a=p(i("QbLZ")),s=p(i("gDS+")),r=p(i("D3Ub")),c=p(i("PRQd")),l=p(i("u8Ap")),u=p(i("bcjM")),d=p(i("s4tT")),f=i("CeR/");function p(e){return e&&e.__esModule?e:{default:e}}t.default={name:"signNode",components:{BasicCard:d.default,fieldConfig:c.default,memberSelect:l.default,commonTriggerList:u.default},props:{flowInfo:{type:Object,default:function(){return{}}},configur:{type:Object,default:function(){return{}}}},data:function(){return{secondClick:!1,getConditionFlag:!1,formInfo:{name:"",is_sequential:!1,processors:[]},finishCondition:{expressions:[{expressions:[],type:"and"}],type:"or"},allCondition:[],betweenList:[{id:1,name:">=",key:">="},{id:2,name:">",key:">"},{id:3,name:"=",key:"=="},{id:4,name:"<=",key:"<="},{id:5,name:"<",key:"<"}],passRateExpression:{key:"",condition:">=",value:"",source:"global",type:"INT",meta:{code:"PROCESS_COUNT",unit:"INT"},tooltipInfo:{disabled:!0,content:"",placements:["top"]}},emptyExpression:{key:"",condition:">=",value:"",source:"global",type:"INT",meta:{code:"",unit:"INT"},tooltipInfo:{disabled:!1,content:this.$t("m.treeinfo['请先选择条件']"),placements:["top"]}},nodeInfoRule:{name:[{required:!0,message:this.$t("m.newCommon['请输入节点名称']"),trigger:"blur"}],processors:[{validator:function(e){return e.length},message:this.$t("m.newCommon['请选择处理人']"),trigger:"blur"}]},finishConditionRule:{key:[{required:!0,message:this.$t("m.systemConfig['请输入']"),trigger:"blur"}],value:[{required:!0,message:this.$t("m.systemConfig['请输入']"),trigger:"blur"}]}}},computed:{globalChoise:function(){return this.$store.state.cdeploy.configurInfo},openFunction:function(){return this.$store.state.openFunction}},watch:{"formInfo.processors":function(){this.setAllTooltip()}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,r.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAllConditions();case 2:e.formInfo.name=e.configur.name,e.formInfo.is_sequential=e.configur.is_sequential,e.formInfo.processors=e.configur.processors?e.configur.processors.split(","):[],e.configur.finish_condition&&e.configur.finish_condition.expressions?(e.finishCondition=JSON.parse((0,s.default)(e.configur.finish_condition)),e.finishCondition.expressions.forEach((function(e){e.expressions=e.expressions.map((function(e){return(0,a.default)({},e,{tooltipInfo:{disabled:!0,content:"",placements:["top"]}})}))}))):(e.passRateExpression.key=e.allCondition.find((function(e){return"PROCESS_COUNT"===e.meta.code})).key,e.finishCondition.expressions[0].expressions.push(JSON.parse((0,s.default)(e.passRateExpression))),e.giveTooltip(e.passRateExpression));case 6:case"end":return t.stop()}}),t,e)})))()},setAllTooltip:function(){var e=this;this.finishCondition.expressions.forEach((function(t){t.expressions.forEach((function(t){e.giveTooltip(t)}))}))},getAllConditions:function(){var e=this;return(0,r.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.configur.id,e.getConditionFlag=!0,t.next=4,e.$store.dispatch("apiRemote/get_sign_conditions",i).then((function(t){e.allCondition=t.data})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.getConditionFlag=!1}));case 4:case"end":return t.stop()}}),t,e)})))()},selectCondition:function(e,t,i,n){var o=this;0===n&&0===i&&"PROCESS_COUNT"===t.meta.code?this.$bkInfo({type:"warning",title:this.$t("m.treeinfo['确定更改“处理人数”？']"),subTitle:this.$t("m.treeinfo['若更改该条件，则忽略处理人数，条件满足即结束']"),cancelFn:function(){t.key=o.allCondition.find((function(e){return"PROCESS_COUNT"===e.meta.code})).key},confirmFn:function(){o.changeCondition(t)}}):this.changeCondition(t)},changeCondition:function(e){e.meta.code=this.allCondition.find((function(t){return t.key===e.key})).meta.code,e.meta.unit=this.allCondition.find((function(t){return t.key===e.key})).meta.unit||"INT",this.giveTooltip(e)},giveTooltip:function(e){return e.key?"PASS_RATE"===e.meta.code||"REJECT_RATE"===e.meta.code||this.formInfo.processors.length?(e.tooltipInfo.disabled=!0,void(e.tooltipInfo.content="")):(e.tooltipInfo.disabled=!1,void(e.tooltipInfo.content=this.$t("m.treeinfo['请先选择处理人']"))):(e.tooltipInfo.disabled=!1,void(e.tooltipInfo.content=this.$t("m.treeinfo['请先选择条件']")))},submitNode:function(){var e=this;return(0,r.default)(o.default.mark((function t(){var i;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=[e.$refs.nodeInfoForm.validate()],e.$refs.finishConditionForms&&e.$refs.finishConditionForms.length&&(i=i.concat(e.$refs.finishConditionForms.map((function(e){return e.validate()})))),t.next=4,n.default.all(i).then((function(){var t={is_draft:!1,workflow:e.flowInfo.id,type:e.configur.type,is_terminable:!1,processors_type:"PERSON"};t.name=e.formInfo.name,t.is_sequential=e.formInfo.is_sequential,t.processors=e.formInfo.processors.join(",");var i=e.$refs.field.showTabList;t.fields=i.map((function(e){return e.id})),e.finishCondition.expressions.forEach((function(e){e.expressions.forEach((function(e){delete e.tooltipInfo}))})),t.finish_condition=e.finishCondition;var n=e.configur.id;e.secondClick||(e.secondClick=!0,e.$store.dispatch("deployCommon/updateNode",{params:t,id:n}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$emit("closeConfigur",!0)})).catch((function(t){(0,f.errorHandler)(t,e)})).finally((function(){e.secondClick=!1})))})).catch((function(e){console.log(e)}));case 4:case"end":return t.stop()}}),t,e)})))()},closeNode:function(){this.$emit("closeConfigur",!1)},operateExpression:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",i=arguments[2],n=arguments[3],o=arguments[4];if("del"===t){if(1===e.expressions.length)return;0===n&&0===i&&"PROCESS_COUNT"===o.meta.code?this.$bkInfo({type:"warning",title:this.$t("m.treeinfo['确定删除“处理人数”？']"),subTitle:this.$t("m.treeinfo['若删除该条件，则忽略处理人数，条件满足即结束']"),confirmFn:function(){e.expressions.splice(i,1)}}):e.expressions.splice(i,1)}else e.expressions.push(JSON.parse((0,s.default)(this.emptyExpression)))},operateGroup:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",i=arguments[1];"del"===t?1===this.finishCondition.expressions.length?this.$bkInfo({type:"warning",title:this.$t("m.treeinfo['确定删除唯一的条件组？']"),subTitle:this.$t("m.treeinfo['若删除，则必须所有人处理完成才结束']"),confirmFn:function(){e.finishCondition.expressions.splice(i,1)}}):this.finishCondition.expressions.splice(i,1):this.finishCondition.expressions.push({expressions:[JSON.parse((0,s.default)(this.emptyExpression))],type:"and"})}}}},pnfo:function(e,t,i){"use strict";i.r(t);var n=i("ucVW"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},ptjD:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"customTableData",props:{customTableInfo:{type:Object,default:function(){return{}}}},data:function(){return{typeList:[{id:"input",name:this.$t('m.treeinfo["输入框"]')},{id:"select",name:this.$t('m.treeinfo["单选框"]')},{id:"multiselect",name:this.$t('m.treeinfo["多选框"]')},{id:"datetime",name:this.$t('m.treeinfo["时间"]')},{id:"date",name:this.$t('m.treeinfo["日期"]')}],trueStatus:!0,falseStatus:!1}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},mounted:function(){},methods:{addTableData:function(e,t){this.customTableInfo.list.splice(t+1,0,{name:"",display:"input",choice:"",required:!1})},reduceTableData:function(e,t){1!==this.customTableInfo.list.length&&this.customTableInfo.list.splice(t,1)}}}},"q+QX":function(e,t,i){"use strict";i.r(t);var n=i("Ox22"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},q9Lf:function(e,t,i){},q9fp:function(e,t,i){"use strict";i.r(t);var n=i("p/z7"),o=i("5Pf/");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("mBA7");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"d2a8f436",null);r.options.__file="src/views/processManagement/publicTrigger/common/memberInfo.vue",t.default=r.exports},qCK4:function(e,t,i){"use strict";i.r(t);var n=i("hmS1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},qFWE:function(e,t,i){"use strict";i.r(t);var n=i("oBdi"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},qJoz:function(e,t,i){"use strict";i.r(t);var n=i("SioU"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},qVGl:function(e,t,i){"use strict";i.r(t);var n=i("THJS"),o=i("LJsK");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("LWgf");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"2ec90604",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/defaultValue.vue",t.default=r.exports},qg2T:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:["tag-text",{"active-link":e.hasChildren}],on:{click:e.onClick}},[Array.isArray(e.value)?i("div",e._l(e.value,(function(t,n){return i("p",{key:n,staticClass:"text-block"},[t.label?i("label",{staticClass:"label"},[e._v("\n                "+e._s(t.label)+"\n                "),t.desc||e.desc?i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.desc||e.desc,expression:"item.desc || desc"}],staticClass:"bk-itsm-icon icon-itsm-icon-help"}):e._e()]):e._e(),e._v(" "),i("span",{staticClass:"value"},[e._v(e._s(t.value))])])})),0):i("p",[e.label?i("label",{staticClass:"label"},[e._v("\n            "+e._s(e.label)+"\n            "),e.desc?i("i",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.desc,expression:"desc"}],staticClass:"bk-itsm-icon icon-itsm-icon-help"}):e._e()]):e._e(),e._v(" "),i("span",{staticClass:"value"},[e._v(e._s(e.value))])])])},o=[];n._withStripped=!0},qgII:function(e,t,i){"use strict";i.r(t);var n=i("FbwU"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},qi5P:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"bk-form-content",staticStyle:{position:"relative"}},[i("custom-upload",{ref:"upload",attrs:{name:"field_file",multiple:!0,"with-credentials":!0,disabled:e.disabled,tip:"",size:200,url:e.url},on:{"on-success":e.uploadSuccess,"on-error":e.uploadErr,"on-progress":e.uploadProgress,"on-done":e.uploadDone}}),e._v(" "),i("ul",e._l(e.datas,(function(t,n){return i("li",{directives:[{name:"show",rawName:"v-show",value:!t.errorMsg,expression:"!file.errorMsg"}],key:n,staticClass:"upload_p",staticStyle:{"word-break":"break-word"}},[i("span",[e._v(e._s(t.name))]),e._v(" "),i("span",{staticClass:"bk-icon icon-delete",staticStyle:{color:"#3c96ff","margin-left":"10px",cursor:"pointer"},on:{click:function(i){return e.deleteFile(t)}}})])})),0)],1)]),e._v(" "),e.tempFileList.length>0?i("div",{staticClass:"bk-form-item"},[i("label",{staticClass:"bk-label"},[e._v(e._s(e.$t('m.newCommon["模板下载"]'))+"：")]),e._v(" "),i("div",{staticClass:"bk-form-content"},e._l(e.tempFileList,(function(t,n){return i("ul",{key:n},[i("li",{staticClass:"bk-icon icon-download bk-tab-cursor fa-file",on:{click:function(i){return e.downloadFile(t)}}},[e._v(" "+e._s(t.name)+"\n                    ")])])})),0)]):e._e(),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},qyUP:function(e,t,i){"use strict";i.r(t);var n=i("tMVz"),o=i("XUL0");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"c80aad7e",null);r.options.__file="src/views/commonComponent/fieldComponent/select.vue",t.default=r.exports},rLYG:function(e,t,i){"use strict";i.r(t);var n=i("tWYx"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},rMih:function(e,t,i){"use strict";i.r(t);var n=i("fmQd"),o=i("ioCs");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("scHs");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"210dfe2e",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/addField/index.vue",t.default=r.exports},rfBv:function(e,t,i){"use strict";i("9nYo")},rujD:function(e,t,i){"use strict";i("LgrT")},rv5B:function(e,t,i){},rvnp:function(e,t,i){},s31z:function(e,t,i){},s4tT:function(e,t,i){"use strict";i.r(t);var n=i("1GnK"),o=i("b/Aw");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("TlxU");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"abf56246",null);r.options.__file="src/components/common/layout/BasicCard.vue",t.default=r.exports},s8s0:function(e,t,i){"use strict";i.r(t);var n=i("hjbl"),o=i("u3L/");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("rfBv");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"0d19982e",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/basicNode.vue",t.default=r.exports},sF2c:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-get-param"},[e.isStatic?i("bk-table",{attrs:{data:e.sopsTableInfo,"ext-cls":"bk-editor-table"}},[i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['字段名']"),prop:"name"}}),e._v(" "),i("bk-table-column",{attrs:{label:e.$t("m.treeinfo['参数值']"),width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.value||"--"))])]}}],null,!1,3905507693)})],1):e._e(),e._v(" "),i("div",{staticClass:"sops-form"},[i("render-form",{key:e.renderKey,ref:"renderForm",attrs:{"form-option":e.formOptions,constants:e.constants,context:e.context,hooked:e.hookedVarList},on:{configLoadingChange:function(t){e.configLoading=t}},scopedSlots:e._u([{key:"tagHook",fn:function(t){var n=t.scheme;return[i("div",{staticClass:"hook-area"},[i("bk-checkbox",{attrs:{disabled:e.disabled||e.disabledRenderForm,value:!!e.hookedVarList[n.tag_code]},on:{change:function(t){return e.onHookChange(t,n)}}},[e._v("\n                        "+e._s(e.$t('m.tickets["引用变量"]'))+"\n                    ")]),e._v(" "),e.hookedVarList[n.tag_code]?i("div",{staticClass:"var-select"},[i("bk-select",{attrs:{disabled:e.disabled||e.disabledRenderForm,clearable:!1,value:e.formData[n.tag_code].replace(/^\$\{/,"").replace(/\}$/,"")},on:{selected:function(t){return e.onSelectVar(t,n)}}},e._l(e.stateList,(function(t){return i("bk-option",{key:t.key,attrs:{id:t.key,name:t.name}},[e._v("\n                                "+e._s(t.name)+"\n                            ")])})),1)],1):e._e()],1)]}}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1),e._v(" "),e.sliderInfo.show&&!1===e.isStatic?i("div",{staticClass:"bk-add-slider"},[i("bk-sideslider",{attrs:{"is-show":e.sliderInfo.show,title:e.sliderInfo.title,width:e.sliderInfo.width},on:{"update:isShow":function(t){return e.$set(e.sliderInfo,"show",t)},"update:is-show":function(t){return e.$set(e.sliderInfo,"show",t)}}},[i("div",{staticClass:"p20",attrs:{slot:"content"},slot:"content"},[i("add-field",{attrs:{"change-info":e.changeInfo,"sosp-info":e.showTabData,workflow:e.flowInfo.id,state:e.configur.id},on:{closeShade:e.closeShade,getRelatedFields:e.getRelatedFields}})],1)])],1):e._e()],1)},o=[];n._withStripped=!0},sFvT:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{searchable:"","search-with-pinyin":!0,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc,"font-size":"medium"},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},[e._l(e.options,(function(t){return i("bk-option",{key:t.key,staticClass:"custom-option",attrs:{id:t.key,name:t.name}},[i("span",[e._v(e._s(t.name))]),e._v(" "),t.can_delete?i("i",{staticClass:"bk-icon icon-close",on:{click:function(i){return i.stopPropagation(),e.handleDeleteOption(t.key)}}}):e._e()])})),e._v(" "),i("div",{attrs:{slot:"extension"},slot:"extension"},[i("div",{staticClass:"plus-content",on:{click:function(t){e.addStatus=!e.addStatus}}},[i("i",{staticClass:"bk-icon icon-plus-circle"}),e._v("新增\n                ")]),e._v(" "),e.addStatus?i("div",{staticClass:"add-status"},[i("bk-form-item",{attrs:{label:"name"}},[i("bk-input",{on:{blur:e.giveDefaultKey},model:{value:e.tempChoice.name,callback:function(t){e.$set(e.tempChoice,"name",t)},expression:"tempChoice.name"}})],1),e._v(" "),i("bk-form-item",{attrs:{label:"key"}},[i("bk-input",{model:{value:e.tempChoice.key,callback:function(t){e.$set(e.tempChoice,"key",t)},expression:"tempChoice.key"}})],1),e._v(" "),i("p",{staticClass:"operations"},[i("span",{class:{disabled:!e.tempChoice.name},on:{click:e.confirmAdd}},[e._v(e._s(e.$t("m.task['确认']")))]),e._v(" "),i("span",{on:{click:e.cancelAdd}},[e._v(e._s(e.$t("m.task['取消']")))])])],1):e._e()])],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},sRDs:function(e,t,i){"use strict";i.r(t);var n=i("OkDz"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},scHs:function(e,t,i){"use strict";i("EYXk")},sjGJ:function(e,t,i){"use strict";i.r(t);var n=i("HksE"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},sshH:function(e,t,i){"use strict";i.r(t);var n=i("PGA1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"t9X+":function(e,t,i){var n={"./cascade.vue":"gy7N","./checkbox.vue":"/KdC","./complexMembers.vue":"g9b+","./customForm.vue":"IDfM","./customtable.vue":"Wl5c","./date.vue":"nxpg","./datetime.vue":"eOfU","./devopsTemplate.vue":"SUIt","./editor.vue":"0njq","./file.vue":"070I","./inputSelect.vue":"VrAx","./int.vue":"Za/z","./link.vue":"jub7","./member.vue":"MBfY","./members.vue":"/Hw/","./multiselect.vue":"4K0D","./radio.vue":"TNjk","./select.vue":"qyUP","./sopsTemplate.vue":"aYIO","./string.vue":"z1yn","./table.vue":"Q3ZP","./text.vue":"u14n","./tree.vue":"+QRE"};function o(e){var t=a(e);return i(t)}function a(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=a,e.exports=o,o.id="t9X+"},t9cD:function(e,t,i){"use strict";i.r(t);var n=i("5/Zn"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},tJou:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this.$createElement;return(this._self._c||e)("section",{staticClass:"code-editor"})},o=[];n._withStripped=!0},tL1K:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{staticClass:"bk-form-int",attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{clearable:!0,type:"number",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",e._n(t))},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):e.isErrMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["已超出最大值!"]')))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},tMVz:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-select",{class:{"bk-border-error":e.item.checkValue},attrs:{searchable:"",disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc,"font-size":"medium"},on:{selected:e.selected,toggle:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},e._l(e.options,(function(e){return i("bk-option",{key:e.key,attrs:{id:e.key,name:e.name}})})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},tNV3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAA5CAYAAABZClfIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU1NzFFNzcxRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU1NzFFNzcyRjUzQzExRTdBMkU1QUQxMkE2RTNCRDUwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTU3MUU3NkZGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTU3MUU3NzBGNTNDMTFFN0EyRTVBRDEyQTZFM0JENTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5558DUAAAHDUlEQVR42uycS2wbVRSGj9/vxInfsRMnsZu6DVBUXhIEVWwQgg1s6AYkBGIBEkVl1RXqigUgFq0qVNHCBpCg6mPBAomKDWyQAInSiDRJEzuOHceJ83BiO3H84Py3TpqWksaJp4md+aWra8+MZ3w/nznnzLkzVpTLZdqufv1z4Ch3x7gd4maixlCG21/cPu07HLpcix0qfvnjn/tuxAfbCPQp7t5raTKR1WIilUrZEKSLpRLNLWRpdn4Rb0899UjP+/faTqPe/HjV27TotwA60O4ij6OFGk1eZytNTM3Szejksd+uDQ4w8M+3s7+7Ya/6FMUmQD/B3Rm33Upo45Mpmpyep9xyvu4hK3j0ep2W3DYrtTlbKLuUB/TTDHyYgf9UK9ibtWgHdxctJr0OVj0wEqOZdIYcLU3kYvAKhaKuYSOOZXLLFI5PUTqTo1CXl5aW86rZdOYCA3+Ggfc/ENgMWsXddxq1qj3U7aNYcoZS7Nf28xeCz24ktTSZaSgSo7HEtBjf34ORZv4RrjDwpxn4VLX7U1ZcR3mdC6H/Wbaqj9lwnwt1eymfL1AkPs3+urXhQN+CbSKfy07RiWmaX8jQATYuNrIgzmoGrt0K7Gqs+lXuPuj0Osls0NON0RiZDDpqd9uoUdXGQbK12UyDkQkqlUt0MOCDm3yWV53bCmzFukbrAuQdyxj0Q9x9ZWe/jCg9PJaglWKRAh2euvfR91N3u5u0Gg39czNGBr2OevweLH6drftEzS2bQTdzd5mt2Njjd9Nkap6mZtPU5XWRXquhRpdKqaSezjbKFwo0GI6To7WJfLfO5o+Yzcu1hA2z/UatUgUPsJ9eZj89Ep0UmYfNaqG9IhhVkM/i2fQijbEP72xzkN1qEWwY+GNbga24R479IbeX9nd6SMsHHBiNk0ajJvjtvSYkAV4OmICdmltga/eQxWQw8qorDNx3X6vdqDbCO3iRux86PHYFN2HRiek5OhjsEIFxr2ooEqf5xSwd2t8pyhPXBsK0vFL4nVcd6TscylbtRhg0UpxvORIL0DOcS8f50rWdX+9l0LcDppoD5rjw5weDPlIqlY/zqq+Zm6Iq2PwBnBqXDDptswgMKwWR+lg573TbW2ivSwRM/+2AaeI0ONTVhlWvIGhWa9lf8g4fRkDEjm/wDpWc3gV8bpJVCZg67R0BE7k4gibrBBvra5uCzRse5+7oPs4ljewuUGBKs38K8KmjVqvqDgq+v6QB02lbC5hIB102ZMl0njn2bQibNzjC3Se4aLG3WEQRZmxiSlyON5mNdQd6MbtEMYaNXip5XTZh1UPsZlEdDHa4qdlixKX8pUrc+y/sSupygTdUIa0r8NXhDU7zzAYD+Vz1dTle4gwLRtI/PCbeo4/Ep8RySQImu1dNJWCWSmVRJWQ3A59yuXJBeBs2L8AvcVGn1TiwIa6+oxMpATzAv1S9XY4jvnR4HNTLKSqE3s/+VCnROJD+IWBy+kfRRArFKuoN+EitUqLE8X2lUrpWYj3DX+RJBERNxS/DBxn1OpFPViOL0UAGvXZXQDcb9eI0R1+NcuwOFrK5qo9n5HGDW6fXIRigBM1n1fN8Qp3m1e9iDvINFJj2+d3s3K1rH0ShCTWQaieE4YLW76ceNZmao3AsWfXn4AE8divn4a61ZRNTc3QzmsDLN2HZJ8UMy12A4OjRqhGfLg2V3m000b1ZeRxWWshkKTmTPgmf7a/HTKOeZDEJvh1KGcUDDNwyAhm2DFuWDFuGLUuGLcOWYcva3bBRG0CJsd6FMWCGalfDRnVtcQvVst0mjMEowaR2TWGjoDWbzojbbetV2aVlMQaMZVfDdjusoqY7GI5Rtg6B4ztjthxjwFhqLXVNfzn22b3BduofHqfrw2Pilluz0bDrn7MpFkvCdcCiARpjkGJWR13rHeLmlUdDflE0T87MiwlXPAy0m4VgiJmVLq9T1J+lmgZUS7FTfFk8i4ImS86zZdgybFky7HqUeicPjtskRmNJzDxToVCUdqAqFTltTSLj2KmbjnYUNkDPL+ao0+cWMKQU7u6aSKbEo4S4iWbPuRFYtMdpkxz0qmXjWInUnOyz5QApsZytTZRIzohTXGohJuBY7h28NQ4+O18ql3bkTkgEK/jtcDQhOfDVAOlvsz/wceLJYNYiYI/klvKhnYCNrKDb5xKtkYW7YlkRuJEf8W8x5XKZZEmT3lb+jecqYJ9fXikU8XyjrNoL/8QDvvzynLLvcOg6vzg7Mp6s+sZ3WRsLPEdj4m9JzoLzajZynM39av9QlOIcsWWXsn3XEU/OEnjy65/BV8SoVbCV52o+4/aOVqNW4gkoFNSlmGVuVGGSBMEQT0PnVwpIQb4AaLbq3B2wV8XQe7l7m9sL3Lq5aWSMmxb+CzCMYAgfXXHRa/pXgAEAdjq+qfD3Of4AAAAASUVORK5CYII="},tNmS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"task-form"},[i("div",{staticClass:"use-task-config"},[i("span",{staticClass:"mr5"},[e._v(e._s(e.$t("m.trigger['是否启用']")))]),e._v(" "),i("bk-switcher",{attrs:{"data-test-id":"taskConfig-switcher-isUse"},on:{change:e.handleUseTaskChange},model:{value:e.useTask,callback:function(t){e.useTask=t},expression:"useTask"}})],1),e._v(" "),e.useTask?e._l(e.taskConditionList,(function(t,n){return i("bk-form",{key:n,ref:"taskForms",refInFor:!0,staticClass:"mt10",attrs:{model:t,rules:e.taskConfigRule,"form-type":"vertical"}},[i("div",{staticClass:"task-condition clearfix"},[i("div",{staticClass:"condition-item"},[i("bk-form-item",{attrs:{"data-test-id":"taskConfig-select-taskTemplate",label:e.$t("m.taskTemplate['任务模板']"),required:!0,property:"taskId"}},[i("bk-select",{attrs:{placeholder:e.$t("m.basicModule['请选择']")+e.$t("m.taskTemplate['任务模板']"),"ext-cls":"bk-form-width",searchable:"",clearable:""},model:{value:t.taskId,callback:function(i){e.$set(t,"taskId",i)},expression:"oneCondition.taskId"}},e._l(e.taskTemplateList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1)],1),e._v(" "),i("div",{staticClass:"condition-item"},[i("bk-form-item",{attrs:{"data-test-id":"taskConfig-select-createdTaskNode",label:e.$t("m.tickets['可创建任务节点']"),required:!0,property:"createNodeId"}},[i("bk-select",{attrs:{placeholder:e.$t("m.tickets['请选择可创建任务节点']"),"ext-cls":"bk-form-width",loading:e.nodeListLoading,searchable:"",clearable:""},on:{change:function(i){return e.getCanDealNodeList(i,t)}},model:{value:t.createNodeId,callback:function(i){e.$set(t,"createNodeId",i)},expression:"oneCondition.createNodeId"}},e._l(e.normalNodeList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name,disabled:e.disabled}})})),1)],1)],1),e._v(" "),i("div",{staticClass:"condition-item"},[i("bk-form-item",{attrs:{"data-test-id":"taskConfig-select-processTaskNode",label:e.$t("m.tickets['可处理任务的节点']"),required:!0,property:"dealNodeId"}},[i("bk-select",{attrs:{placeholder:e.$t("m.tickets['请选择可处理任务的节点']"),"ext-cls":"bk-form-width",loading:t.dealLoading,searchable:"",clearable:""},on:{change:e.handleDealNodeChange},model:{value:t.dealNodeId,callback:function(i){e.$set(t,"dealNodeId",i)},expression:"oneCondition.dealNodeId"}},e._l(t.dealList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)],1)],1),e._v(" "),i("div",{staticClass:"condition-checkbox"},[i("bk-checkbox-group",{model:{value:t.others,callback:function(i){e.$set(t,"others",i)},expression:"oneCondition.others"}},[i("p",[i("bk-checkbox",{attrs:{value:1}},[e._v(e._s(e.$t("m.taskTemplate['处理任务的节点也可以创建任务']")))])],1),e._v(" "),i("p",{staticClass:"mt10"},[i("bk-checkbox",{attrs:{value:2}},[e._v(e._s(e.$t("m.taskTemplate['下一个节点流转是否必须等待任务处理完成']")))])],1)])],1),e._v(" "),i("div",{staticClass:"row-operating"},[i("span",{attrs:{"data-test-id":"trigger_span_add"},on:{click:e.onAddCondition}},[e._v("+")]),e._v(" "),i("span",{attrs:{"data-test-id":"trigger_span_delete"},on:{click:function(t){return e.onDelCondition(n)}}},[e._v("-")])])])])})):e._e()],2)},o=[];n._withStripped=!0},tQ05:function(e,t,i){"use strict";i.r(t);var n=i("G0Vx"),o=i("Abqk");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("nbv9");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"57e0bb5c",null);r.options.__file="src/views/managePage/billCom/fieldInfo.vue",t.default=r.exports},tWYx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i("4d7F")),o=h(i("P2sY")),a=h(i("gDS+")),s=h(i("14Xm")),r=h(i("D3Ub")),c=i("CeR/"),l=h(i("PaSM")),u=i("ygAv"),d=h(i("db1v")),f=h(i("SAMo")),p=h(i("a6LX")),m=h(i("O4mU"));function h(e){return e&&e.__esModule?e:{default:e}}var v=[{name:"单行文本",icon:"icon-apps",type:"STRING"},{name:"多行文本",icon:"icon-apps",type:"TEXT"},{name:"数字",icon:"icon-apps",type:"INT"},{name:"日期",icon:"icon-apps",type:"DATE"},{name:"时间",icon:"icon-apps",type:"DATETIME"},{name:"表格",icon:"icon-apps",type:"TABLE"},{name:"单选下拉框",icon:"icon-apps",type:"SELECT"},{name:"可输入单选下拉框",icon:"icon-apps",type:"INPUTSELECT"},{name:"多选下拉框",icon:"icon-apps",type:"MULTISELECT"},{name:"复选框",icon:"icon-apps",type:"CHECKBOX"},{name:"单选框",icon:"icon-apps",type:"RADIO"},{name:"单选人员选择",icon:"icon-apps",type:"MEMBER"},{name:"多选人员选择",icon:"icon-apps",type:"MEMBERS"},{name:"富文本",icon:"icon-apps",type:"RICHTEXT"},{name:"附件上传",icon:"icon-apps",type:"FILE"},{name:"自定义表格",icon:"icon-apps",type:"CUSTOMTABLE"},{name:"树形选择",icon:"icon-apps",type:"TREESELECT"},{name:"链接",icon:"icon-apps",type:"LINK"},{name:"自定义表单",icon:"icon-apps",type:"CUSTOM-FORM"}],g=[{name:"选择推荐服务模板",key:"recom",icon:"icon-apps"},{name:"从已有的服务复制",key:"created",icon:"icon-apps"},{name:"自定义表单",key:"custom",icon:"icon-apps"}];t.default={name:"ServiceFormStep",components:{SelectTree:d.default,ServiceForm:f.default,ChooseServiceTemplateDialog:p.default,FormEditItem:m.default},mixins:[l.default],props:{type:{type:String,default:"new"},serviceId:{type:[String,Number],default:""},serviceInfo:{type:Object,default:function(){return{}}},createTicketNodeId:Number},data:function(){return{isCreateService:!1,fieldsLibrary:v,serviceFormCreateWays:g,publicFields:[],isSubmitting:!1,isDropdownShow:!1,showFieldOption:!1,isBasicFormEditting:!0,isShowChooseSerTempDialog:!1,currCreateFormWay:{},ticketNodeForm:[],ticketNodeDetail:{},formLoading:!1,detailLoading:!1,crtForm:"",active:"library-fields",formData:{name:"",desc:"",key:"",catalog_id:""},rules:{},dirList:[],serviceTypeList:[],pending:{deleteField:!1,saveField:!1},serviceTemplateDisable:!1,isShowField:!1,isShowRightEdit:!1,addFieldStatus:!0,dragLine:{base:0,move:0,startX:null,maxLength:0,canMove:!1},fieldIndex:"",fieldlist:[],fieldsLibrarylist:v,servcieList:[]}},computed:{catalogDisplayName:function(){return this.serviceInfo.bounded_catalogs?this.serviceInfo.bounded_catalogs.join("/"):""}},watch:{isBasicFormEditting:{handler:function(e){e&&this.getServiceDirectory()},immediate:!0}},created:function(){this.rules.name=this.checkCommonRules("name").name,this.rules.name.push({validator:this.handleRepeatServiceName,message:this.$t("m['服务名称重复，请重新输入']"),trigger:"blur"}),this.rules.directory_id=this.checkCommonRules("required").required,this.rules.key=this.checkCommonRules("required").required,this.showFieldOption="edit"===this.type&&!!this.serviceInfo.source,this.isBasicFormEditting="new"===this.type,this.serviceTemplateDisable=""!==this.serviceId},mounted:function(){var e=this;return(0,r.default)(s.default.mark((function t(){var i,n,o,a,r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.getAllServcie(),e.getPublicFieldList(),e.getServiceTypes(),i=e.serviceInfo,n=i.name,o=i.desc,a=i.catalog_id,r=i.key,e.formData.name=n,e.formData.desc=o,e.formData.catalog_id=a,e.formData.key=r,"edit"===e.type?(e.getCreateTicketNodeForm(),e.getCreateTicketNodeDetail()):(e.isCreateService=!0,e.formData.catalog_id=e.$route.query.catalog_id||"");case 9:case"end":return t.stop()}}),t,e)})))()},methods:{getAllServcie:function(){var e=this,t={project_key:this.$store.state.project.id,catalog_id:1};this.$store.dispatch("catalogService/getServices",t).then((function(t){e.servcieList=t.data||[]}))},handleRepeatServiceName:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",!t.servcieList.find((function(t){return t.name===e})));case 1:case"end":return i.stop()}}),i,t)})))()},handleDragLine:function(e){document.addEventListener("mouseup",this.handleMouseUp,!1),document.addEventListener("mousemove",this.handleLineMouseMove,!1);var t=document.querySelector(".edit-service-field");this.dragLine.maxLength=t.clientWidth,this.dragLine.startX=e.pageX,this.dragLine.canMove=!0},handleMouseUp:function(e){document.removeEventListener("mouseup",this.handleMouseUp,!1),document.removeEventListener("mousemove",this.handleLineMouseMove,!1),this.dragLine.base=this.dragLine.move,this.dragLine.canMove=!1},handleLineMouseMove:function(e){var t=this;if(this.dragLine.canMove){var i=document.querySelector(".edit-service-field"),n=this.dragLine,o=n.startX,a=n.base,s=e.pageX-o,r=a+s;s>0&&600-r<=500||window.requestAnimationFrame((function(){t.dragLine.move=r,i.style.width="calc(600px - "+r+"px)"}))}},onFormEditClick:function(e){this.isShowRightEdit=!0,this.crtForm=e.id},onEditConfirm:function(e){this.$refs.serviceForm.onEditConfirm(e),this.isShowRightEdit=!1},onEditCancel:function(){"add"===this.crtForm?this.cancelAddField():this.crtForm="",this.isShowRightEdit=!1},getAddFieldStatus:function(e){this.addFieldStatus=e},getPublicFieldList:function(){var e=this;this.$store.dispatch("publicField/get_template_common_fields",{project_key:this.$store.state.project.id}).then((function(t){e.fieldlist=t.data,e.publicFields=t.data})).catch((function(t){(0,c.errorHandler)(t,e)}))},filterFiled:function(e,t,i){if(""!==e){var n=t.filter((function(t){var i=RegExp(e);if(t.name.match(i))return t}));this[""+i]=n}else this[""+i]=t},handleSearchLibrary:function(e){this.filterFiled(e,this.fieldsLibrarylist,"fieldsLibrary")},handleSearchField:function(e){this.filterFiled(e,this.fieldlist,"publicFields")},getServiceTypes:function(){var e=this;this.$store.dispatch("getCustom").then((function(t){e.serviceTypeList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)}))},getCreateTicketNodeForm:function(){var e=this;this.formLoading=!0,this.$store.dispatch("deployCommon/getFieldList",{workflow:this.serviceInfo.workflow_id,state:this.createTicketNodeId}).then((function(t){t.data.forEach((function(e){e.checkValue=!1,e.val=e.hasOwnProperty("default")?(0,u.deepClone)(e.default):"",e.showFeild=!0})),e.ticketNodeForm=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.formLoading=!1}))},getCreateTicketNodeDetail:function(){var e=this;this.detailLoading=!0,this.$store.dispatch("deployCommon/getOneStateInfo",{id:this.createTicketNodeId}).then((function(t){e.ticketNodeDetail=t.data})).finally((function(){e.detailLoading=!1}))},onBasicFormSubmit:function(){var e=this;this.isSubmitting||this.$refs.basicForm.validate().then((0,r.default)(s.default.mark((function t(){var i;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=JSON.parse((0,a.default)(e.formData))).id=e.serviceId||void 0,i.project_key=e.$store.state.project.id,e.isSubmitting=!0,"edit"!==e.type){t.next=9;break}return t.next=7,e.updateServiceInfo(i);case 7:t.next=11;break;case 9:return t.next=11,e.createService(i);case 11:e.isSubmitting=!1;case 12:case"end":return t.stop()}}),t,e)}))))},onBasicFormCancel:function(){var e=this;"new"===this.type?(this.isCreateService=!1,this.$bkInfo({type:"warning",title:this.$t('m.slaContent["确认返回？"]'),confirmFn:function(){e.goBackToServiceList()},cancelFn:function(){e.isCreateService=!0}})):this.isBasicFormEditting=!1},goBackToServiceList:function(){this.$router.push({name:"projectServiceList",query:{project_id:this.$store.state.project.id,catalog_id:this.$route.query.catalog_id}})},createService:function(e){var t=this;this.$store.dispatch("serviceEntry/createService",e).then((function(e){t.$bkMessage({message:t.$t('m.deployPage["保存成功"]'),theme:"success"}),t.$router.push({name:"projectServiceEdit",params:{type:"edit",step:"basic"},query:{serviceId:e.data.id,project_id:t.$store.state.project.id}}),t.isBasicFormEditting=!1})).catch((function(e){(0,c.errorHandler)(e,t)}))},updateServiceInfo:function(e){var t=this;this.$store.dispatch("serviceEntry/updateService",e).then((function(e){t.$bkMessage({message:t.$t('m.serviceConfig["修改成功"]'),theme:"success"}),t.isBasicFormEditting=!1,t.$emit("updateServiceInfo",e.data)})).catch((function(e){(0,c.errorHandler)(e,t)}))},getServiceDirectory:function(){var e=this;return(0,r.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("serviceCatalog/getTreeData",{show_deleted:!0,project_key:e.$store.state.project.id}).then((function(t){e.dirList=t.data[0]&&t.data[0].children?t.data[0].children:t.data})).catch((function(t){(0,c.errorHandler)(t,e)}));case 2:case"end":return t.stop()}}),t,e)})))()},onCreateFormWayCLick:function(e){var t=this;return(0,r.default)(s.default.mark((function i(){var n;return s.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.isBasicFormEditting){i.next=9;break}return i.prev=1,i.next=4,t.$refs.basicForm.validate();case 4:i.next=9;break;case 6:return i.prev=6,i.t0=i.catch(1),i.abrupt("return",console.warn(i.t0));case 9:"recom"===(n=e.key)||"created"===n?(t.isShowChooseSerTempDialog=!0,t.currCreateFormWay=e):t.updateServiceSource("custom");case 11:case"end":return i.stop()}}),i,t,[[1,6]])})))()},createServicePopoverShow:function(){this.isDropdownShow=!0},createServicePopoverHide:function(){this.isDropdownShow=!1},dragUpdateList:function(e,t){if(t){var i=this.ticketNodeForm.findIndex((function(e){return e.id===t.id}));this.ticketNodeForm.splice(i,1),this.ticketNodeForm.splice(e,0,t),"COL_6"===t.layout&&this.saveHalfRowDragPos(t)}else this.$bkMessage({message:this.$t('m["请先保存字段"]'),offsetY:80})},onAddFormClick:function(e){var t={workflow:"",id:"",key:"",name:"",type:e.type,desc:"",layout:"COL_12",validate_type:"REQUIRE",choice:[],is_builtin:!1,source_type:"CUSTOM",source_uri:"",regex:"EMPTY",custom_regex:"",is_tips:!1,tips:"",meta:{},default:""};this.addField(t)},addField:function(e){if(""===this.crtForm){this.isShowRightEdit=!0;var t=(0,o.default)((0,u.deepClone)(e),{id:"add"});this.ticketNodeForm.push(t),this.crtForm="add"}else this.$bkMessage({message:this.$t('m["请先将字段属性关闭"]')})},cancelAddField:function(){var e=this.ticketNodeForm.findIndex((function(e){return"add"===e.id}));this.ticketNodeForm.splice(e,1),this.crtForm=""},fieldClone:function(e){var t=this.ticketNodeForm.findIndex((function(t){return t.id===e.id})),i=(0,o.default)((0,u.deepClone)(e),{id:"add"});this.ticketNodeForm.splice(t+1,0,i),this.crtForm="add"},fieldDelete:function(e){var t=this;"add"!==e.id?(this.$bkInfo({type:"warning",title:this.$t('m.treeinfo["确认删除此字段？"]'),subTitle:this.$t('m.treeinfo["字段一旦删除，此字段将不在可用。请谨慎操作。"]'),confirmFn:function(){if(!t.pending.deleteField){t.pending.deleteField=!0,t.crtForm="";var i={id:e.id,params:{state_id:t.createTicketNodeId}};t.$store.dispatch("deployCommon/deleteField",i).then((function(i){t.$bkMessage({message:t.$t('m.systemConfig["删除成功"]'),theme:"success"});var n=t.ticketNodeForm.findIndex((function(t){return t.id===e.id}));t.ticketNodeForm.splice(n,1)})).catch((function(e){(0,c.errorHandler)(e,t)})).finally((function(){t.pending.deleteField=!1}))}}}),this.isShowRightEdit=!1):this.onEditCancel()},saveField:function(e){var t=this.ticketNodeForm.findIndex((function(t){return t.id===e.id}));e.checkValue=!1,e.showFeild=!0,e.val=e.hasOwnProperty("default")?(0,u.deepClone)(e.default):"",t>-1?this.ticketNodeForm.splice(t,1,e):this.ticketNodeForm.splice(-1,1,e),this.crtForm=""},saveHalfRowDragPos:function(e){var t="TABLE"===e.source?"cdeploy/changeNewModuleField":"cdeploy/changeNewField";this.$store.dispatch(t,{params:e,id:e.id})},updateServiceSource:function(e){var t=this;this.getCreateTicketNodeForm(),this.$store.dispatch("service/updateServiceSource",{id:this.serviceId,params:{source:e}}).then((function(){t.serviceInfo.source=e})).catch((function(e){(0,c.errorHandler)(e,t)}))},validate:function(){var e=this;return(0,r.default)(s.default.mark((function t(){var i,o,a,r,l,u,d,f,p,m,h,v,g,b,_,y,k,I;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isBasicFormEditting){t.next=3;break}return t.next=3,e.$refs.basicForm.validate();case 3:if(e.formLoading||e.detailLoading||!e.$refs.serviceForm){t.next=8;break}return i=e.ticketNodeDetail,o=i.assignors,a=i.assignors_type,r=i.can_deliver,l=i.delivers,u=i.delivers_type,d=i.distribute_type,f=i.extras,p=i.is_draft,m=i.is_terminable,h=i.name,v=i.processors,g=i.processors_type,b=i.tag,_=i.type,y=i.workflow,k=e.ticketNodeForm.filter((function(e){return"number"==typeof e.id})).map((function(e){return e.id})),I={assignors:o,assignors_type:a,can_deliver:r,delivers:l,delivers_type:u,distribute_type:d,extras:f,is_draft:p,is_terminable:m,name:h,processors:v,processors_type:g,tag:b,type:_,workflow:y,fields:k},t.abrupt("return",e.$store.dispatch("deployCommon/updateNode",{params:I,id:e.createTicketNodeId}).then((function(t){e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"})}),(function(t){return(0,c.errorHandler)(t,e),n.default.reject(t)})));case 8:case"end":return t.stop()}}),t,e)})))()},handleShowField:function(){this.isShowField=!this.isShowField}}}},tgnH:function(e,t,i){"use strict";i.r(t);var n=i("22U7"),o=i("pnfo");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("yAjJ");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"ca0bee1e",null);r.options.__file="src/components/task/DevopsPreview.vue",t.default=r.exports},u14n:function(e,t,i){"use strict";i.r(t);var n=i("DjpW"),o=i("pRHh");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"6faa4032",null);r.options.__file="src/views/commonComponent/fieldComponent/text.vue",t.default=r.exports},"u3L/":function(e,t,i){"use strict";i.r(t);var n=i("9xhR"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},uFXv:function(e,t,i){"use strict";i("FqMa")},uK6t:function(e,t,i){"use strict";i.r(t);var n=i("NoEz"),o=i("xpPb");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("R1Hl");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"23468bb5",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/autoComponents/responseDataNode.vue",t.default=r.exports},uR5J:function(e,t,i){"use strict";i.r(t);var n=i("xsd2"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},ucVW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"DevopsPreview",components:{},props:{stages:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{isFullScreen:!1}},methods:{openFullScreen:function(){this.isFullScreen=!0,this.$bkMessage({message:this.$t('m.common["按 ESC 键退出全屏"]')}),document.addEventListener("keydown",this.handlerKeyDown)},onCloseFullScreen:function(){this.isFullScreen=!1},handlerKeyDown:function(e){27===e.keyCode&&(this.onCloseFullScreen(),document.removeEventListener("keydown",this.handlerKeyDown))},getPath:function(e,t){if(0===t)return"M 60 2 L 55 2 Q 50 2 50 7 L 50 60 Q 50 62 45 62 L 0 62";var i=56*(e.containers[t-1].elements.length+1);return"M 50 2 L 50 "+(i-10)+" Q 50 "+(i-5)+" 45 "+(i-5)+" L 0 "+(i-5)},getSvgStyle:function(e,t){if(0===t)return"";var i=56*(e.containers[t-1].elements.length+1)-27;return i?"top: "+-i+"px;":""},isElementCanExecute:function(e){if(!e.additionalOptions||!e.additionalOptions.runCondition)return!0;var t=e.additionalOptions,i=t.runCondition,n=t.customVariables;if(!t.enable)return!1;switch(i){case"CUSTOM_VARIABLE_MATCH":return n.every((function(e){return!!e.value}));case"CUSTOM_VARIABLE_MATCH_NOT_RUN":return!n.every((function(e){return!!e.value}));default:return!0}}}}},udFb:function(e,t,i){},ughI:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOM_FORM_DEFAULT_VALUE=void 0;var n,o=i("gDS+"),a=(n=o)&&n.__esModule?n:{default:n};t.CUSTOM_FORM_DEFAULT_VALUE=(0,a.default)({schemes:{},form_data:[]},null,4)},ujts:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild&&!e.loading?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height","desc-type":"icon"}},[i("bk-checkbox-group",{ref:e.item.key,attrs:{value:e.selects},on:{change:e.selected}},e._l(e.item.choice,(function(t){return i("bk-checkbox",{key:t.key,attrs:{value:t.key,disabled:e.disabled,"ext-cls":"mr20"}},[e._v(e._s(t.name)+"\n            ")])})),1),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},ukIK:function(e,t,i){"use strict";i.r(t);var n=i("jXnR"),o=i("ml4i");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("ZGcU");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"5bb8abd5",null);r.options.__file="src/views/processManagement/publicTrigger/components/changeConductor.vue",t.default=r.exports},upyM:function(e,t,i){"use strict";i("6aJY")},"uv/p":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=i("GQeE"),a=(n=o)&&n.__esModule?n:{default:n};t.default={name:"FormViewItem",props:{fields:Array,form:Object,crtForm:[String,Number],addFieldStatus:Boolean},computed:{deleteDisabled:function(){return this.form.is_builtin&&-1===["impact","urgency","priority","current_status"].indexOf(this.form.key)}},beforeCreate:function(){var e=this,t=function(){var e={},t=i("t9X+");return t.keys().forEach((function(i){var n=t(i).default;e["CW-"+n.name]=n})),e}();(0,a.default)(t).forEach((function(i){e.$options.components[i]=t[i]}))},methods:{onDeleteClick:function(e){this.deleteDisabled||this.$emit("onFormDeleteClick",e)}}}},uxNy:function(e,t,i){"use strict";i("cHGj")},uy81:function(e,t,i){"use strict";i.r(t);var n=i("4J33"),o=i("qFWE");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("upyM");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"f0b16c2c",null);r.options.__file="src/views/service/editService/flowCanvas/Palette.vue",t.default=r.exports},uz2X:function(e,t,i){"use strict";i.r(t);var n=i("bxCg"),o=i("dU2m");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("Acdu");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"6dc69096",null);r.options.__file="src/views/processManagement/publicTrigger/components/triggerCondition.vue",t.default=r.exports},uzkr:function(e,t,i){"use strict";i("WvBE")},"v5D/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("QbLZ")),o=d(i("14Xm")),a=d(i("D3Ub")),s=d(i("+qVm")),r=d(i("MEtw")),c=d(i("UhCq")),l=d(i("BVcZ")),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"ServiceEdit",components:{NavTitle:s.default,ServiceFormStep:r.default,ServiceProcessStep:c.default,ServiceSettingStep:l.default},props:{type:{type:String,default:"new"},step:{type:String,default:"basic"},serviceId:{type:[String,Number],default:""}},data:function(){return{serviceLoading:"edit"===this.type,flowInfoLoading:!1,isSubmitting:!1,serviceInfo:{},flowInfo:{},isShowNodeConfig:!1}},computed:{currStep:function(){return["basic","process","setting"].indexOf(this.step)+1},prevStepBtnName:function(){return 1===this.currStep?this.$t("m['返回']"):this.$t('m.treeinfo["上一步"]')},nextStepBtnName:function(){return this.currStep<3?this.$t("m.common['下一步']"):this.$t('m.newCommon["提交"]')},stepList:function(){var e=void 0,t=void 0,i=void 0;"new"!==this.type&&(e="done",t="done"),"new"!==this.type&&this.serviceInfo.is_valid&&(i="done");var n=[{title:this.$t("m.tickets['服务表单']"),icon:1,status:e},{title:this.$t("m.tickets['服务流程']"),icon:2,status:t},{title:this.$t("m.taskTemplate['高级配置']"),icon:3,status:i}];return n[this.currStep-1].status=void 0,n}},watch:{$route:function(e,t){e.params.type!==t.params.type&&this.initData()}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return(0,a.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("edit"!==e.type){t.next=4;break}return t.next=3,e.getServiceDetail();case 3:e.getFlowDetailInfo();case 4:case"end":return t.stop()}}),t,e)})))()},getServiceDetail:function(){var e=this;return this.serviceLoading=!0,this.$store.dispatch("service/getServiceDetail",this.serviceId).then((function(t){e.serviceInfo=t.data})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.serviceLoading=!1}))},getFlowDetailInfo:function(){var e=this;this.flowInfoLoading=!0,this.$store.dispatch("design/getFlowDetail",{params:this.serviceInfo.workflow_id}).then((function(t){e.flowInfo=t.data})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.flowInfoLoading=!1}))},updateServiceInfo:function(e){this.serviceInfo=e},setConfigStatus:function(e){this.isShowNodeConfig=e},onBackIconClick:function(){this.$router.push({name:"projectServiceList",query:{project_id:this.$store.state.project.id,catalog_id:this.$route.query.catalog_id}})},onStepChange:function(e){"new"!==this.type&&this.$router.push({name:"projectServiceEdit",params:{type:"edit",step:["basic","process","setting"][e-1]},query:{serviceId:this.serviceId,project_id:this.$store.state.project.id}})},onPrevStepClick:function(){1===this.currStep?this.$router.push({name:"projectServiceList",query:(0,n.default)({project_id:this.$store.state.project.id},this.$route.query)}):this.$router.push({name:"projectServiceEdit",params:{type:"edit",step:2===this.currStep?"basic":"process"},query:(0,n.default)({},this.$route.query)})},onNextStepClick:function(){var e=this;this.isSubmitting=!0;var t={basic:"serviceFormStep",process:"serviceProcessStep",setting:"serviceSettingStep"}[this.step];this.$refs[t].validate().then((function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i.data||!1!==i.data.result)if("setting"!==e.step){var o="basic"===e.step?"process":"setting";"basic"!==e.step||e.serviceInfo.source||e.$refs[t].updateServiceSource("custom"),e.$router.push({name:"projectServiceEdit",params:{type:"edit",step:o},query:(0,n.default)({},e.$route.query)})}else e.$bkMessage({message:e.$t('m.treeinfo["保存成功"]'),theme:"success"}),e.$router.push({name:"projectServiceList",query:{project_id:e.$store.state.project.id,catalog_id:e.$route.query.catalog_id}})})).finally((function(){e.isSubmitting=!1}))}}}},v9ex:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"half-row-form"},[i("div",{staticClass:"row-form-view"},[e._l(e.localForms,(function(t,n){return[i("draggable",{key:n,staticClass:"form-drag-wrap",attrs:{handle:".view-form","data-rowindex":e.rowIndex,value:t,group:{name:"view-form",put:e.halfRowFormPut}},on:{add:function(t){return e.$emit("onHalfRowDragToHalfRow",t)}}},e._l(t,(function(t){return i("div",{key:t.id,staticClass:"half-form-item",attrs:{"data-id":t.id}},[i("form-view-item",{attrs:{fields:e.fields,form:t,"add-field-status":e.addFieldStatus,"crt-form":e.crtForm},on:{onFormEditClick:function(t){return e.$emit("onFormEditClick",t)},onFormCloneClick:function(t){return e.$emit("onFormCloneClick",t)},onFormDeleteClick:function(t){return e.$emit("onFormDeleteClick",t)}}},[i("div",{staticClass:"view-form",attrs:{slot:"draggable"},slot:"draggable"},[i("i",{staticClass:"bk-itsm-icon icon-move-new"})])])],1)})),0)]}))],2)])},o=[];n._withStripped=!0},vHDd:function(e,t,i){"use strict";i.r(t);var n=i("7Hjg"),o=i("OZnK");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("UNHF");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"610047b1",null);r.options.__file="src/views/processManagement/processDesign/nodeConfigue/devopsNode.vue",t.default=r.exports},vSlL:function(e,t,i){"use strict";i("F5gn")},vWOQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bk-customtable-data"},e._l(e.customTableInfo.list,(function(t,n){return i("div",{key:n,staticClass:"bk-custom-line",class:{mb10:n!==e.customTableInfo.list.length-1}},[i("bk-input",{attrs:{"ext-cls":"bk-custom-input",clearable:!0,placeholder:e.$t("m.treeinfo['请输入名称']")},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"item.name"}}),e._v(" "),i("bk-checkbox",{staticStyle:{float:"left","margin-right":"10px","line-height":"32px"},attrs:{"true-value":e.trueStatus,"false-value":e.falseStatus},model:{value:t.required,callback:function(i){e.$set(t,"required",i)},expression:"item.required"}},[e._v("\n            "+e._s(e.$t("m.treeinfo['必填']"))+"\n        ")]),e._v(" "),i("bk-select",{attrs:{"ext-cls":"bk-custom-small",clearable:!1,searchable:""},model:{value:t.display,callback:function(i){e.$set(t,"display",i)},expression:"item.display"}},e._l(e.typeList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.choice,expression:"item.choice",modifiers:{trim:!0}}],staticClass:"bk-form-textarea bk-textarea-tanble",staticStyle:{width:"180px","min-height":"32px"},attrs:{placeholder:e.$t("m.treeinfo['请输入，Enter分隔']"),disabled:"select"!==t.display&&"multiselect"!==t.display},domProps:{value:t.choice},on:{input:function(i){i.target.composing||e.$set(t,"choice",i.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),i("div",{staticClass:"bk-custom-icon"},[i("i",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addTableData(t,n)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===e.customTableInfo.list.length},on:{click:function(i){return e.reduceTableData(t,n)}}})])],1)})),0)},o=[];n._withStripped=!0},vXIu:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("GQeE")),o=l(i("QbLZ")),a=l(i("gDS+")),s=i("CeR/"),r=l(i("EstQ")),c=l(i("tgnH"));function l(e){return e&&e.__esModule?e:{default:e}}function u(){return{required:!0,message:r.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}}var d={project_id:[u()],pipeline_id:[u()]};t.default={name:"DEVOPS_TEMPLATE",components:{DevopsPreview:c.default},props:{item:{type:Object,required:!0,default:function(){}},basicInfomation:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{projectLoading:!1,pipelineLoading:!1,pipelineStartLoading:!1,pipelineDetailLoading:!1,showPipelineVariable:!0,showPipelineStages:!0,defaultRules:{project_id:[{required:!0,message:r.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}],pipeline_id:[{required:!0,message:r.default.t('m.treeinfo["字段必填"]'),trigger:"blur"}]},rules:{project_id:[u()],pipeline_id:[u()]},projectList:[],pipelineList:[],pipelineStartInfo:{},pipelineVariableList:[],pipelineStages:[]}},created:function(){this.item.devopsContent||this.$set(this.item,"devopsContent",{project_id:"",pipeline_id:"",variables:{}})},mounted:function(){if(this.getDevopsUserProjectList(),this.item.value){var e=this.item.value,t=e.pipeline_id,i=e.project_id;this.item.devopsContent={project_id:i,pipeline_id:t,variables:JSON.parse((0,a.default)((0,o.default)({},this.item.value,{project_id:void 0,pipeline_id:void 0})))},this.getDevopsPipelineList(i),this.getDevopsPipelineStartInfo(),this.getDevopsPipelineDetail()}},methods:{getDevopsUserProjectList:function(){var e=this;this.projectLoading=!0,this.$store.dispatch("ticket/getDevopsUserProjectList",{ticket_id:this.basicInfomation.id}).then((function(t){e.projectList=t.data})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.projectLoading=!1}))},getDevopsPipelineList:function(e){var t=this;this.pipelineLoading=!0,this.$store.dispatch("ticket/getDevopsPipelineList",{project_id:e}).then((function(e){t.pipelineList=e.data})).catch((function(e){(0,s.errorHandler)(e,t)})).finally((function(){t.pipelineLoading=!1}))},getDevopsPipelineStartInfo:function(){var e=this;this.pipelineStartLoading=!0;var t=this.item.devopsContent,i=t.project_id,n=t.pipeline_id;this.$store.dispatch("ticket/getDevopsPipelineStartInfo",{project_id:i,pipeline_id:n}).then((function(t){e.pipelineStartInfo=t.data,e.pipelineVariableList=t.data.properties;var i=e.item.devopsContent.variables;t.data.properties.forEach((function(t){i.hasOwnProperty(t.id)||e.$set(i,t.id,t.defaultValue||"")})),e.resetFormRules()})).catch((function(t){(0,s.errorHandler)(t,e)})).finally((function(){e.pipelineStartLoading=!1}))},getDevopsPipelineDetail:function(){var e=this;this.pipelineDetailLoading=!0;var t=this.item.devopsContent,i=t.project_id,n=t.pipeline_id;this.$store.dispatch("ticket/getDevopsPipelineDetail",{project_id:i,pipeline_id:n}).then((function(t){e.pipelineStages=t.data.stages||[]})).finally((function(){e.pipelineDetailLoading=!1}))},handleProjectChange:function(e){this.pipelineList=[],this.pipelineStartInfo={},this.pipelineVariableList=[],this.item.devopsContent.pipeline_id="",this.item.devopsContent.variables={},this.resetFormRules(),this.getDevopsPipelineList(e)},handlePipelineChange:function(){this.pipelineStartInfo={},this.pipelineVariableList=[],this.item.devopsContent.variables={},this.resetFormRules(),this.getDevopsPipelineStartInfo(),this.getDevopsPipelineDetail()},resetFormRules:function(){var e=this,t={};(0,n.default)(this.item.devopsContent.variables).forEach((function(i){e.pipelineVariableList.find((function(e){return e.id===i})).required&&(t[i]=[u()])})),this.rules=(0,o.default)({},d,t)},validate:function(){this.$refs.devopsForm.validate(),this.$refs.devopsVariable.validate();var e=this.item.devopsContent,t=e.project_id,i=e.pipeline_id,o=e.variables,a=(0,n.default)(o).every((function(e){return!!o[e]}));return a||(this.showPipelineVariable=!0),!!t&&!!i&&a}}}},vdTl:function(e,t,i){},vef3:function(e,t,i){"use strict";i("AMUZ")},vfXS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"ext-cls":"bk-line-height","desc-type":"icon"}},[i("bk-radio-group",{on:{change:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}},[e._l(e.item.choice,(function(t){return[i("bk-radio",{key:t.key,attrs:{disabled:e.disabled,value:t.key,"ext-cls":"mr20"}},[e._v(e._s(t.name))])]}))],2),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},vqU0:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.item.showFeild?i("div",[i("bk-form-item",{attrs:{label:e.item.name,required:"REQUIRE"===e.item.validate_type,desc:e.item.tips,"desc-type":"icon"}},[i("bk-input",{class:{"bk-border-error":e.item.checkValue},attrs:{maxlength:e.maxLength,disabled:e.item.is_readonly&&!e.isCurrent||e.disabled,placeholder:e.item.desc},on:{focus:function(t){e.item.checkValue=!1}},model:{value:e.item.val,callback:function(t){e.$set(e.item,"val",t)},expression:"item.val"}}),e._v(" "),e.item.checkValue?[e.item.checkMessage?i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.checkMessage))]):i("p",{staticClass:"bk-task-error"},[e._v(e._s(e.item.name)+e._s(e.$t('m.newCommon["为必填项！"]')))])]:e._e()],2)],1):e._e()},o=[];n._withStripped=!0},wegR:function(e,t,i){"use strict";i.r(t);var n=i("Jje2"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},wuvY:function(e,t,i){"use strict";i("gr1D")},"x+JR":function(e,t,i){"use strict";i.r(t);var n=i("zCbU"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},xY5K:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i("14Xm")),o=d(i("D3Ub")),a=d(i("PIEm")),s=d(i("GtMo")),r=d(i("s4tT")),c=d(i("bcjM")),l=d(i("LEca")),u=i("CeR/");function d(e){return e&&e.__esModule?e:{default:e}}var f=[{id:0,name:"00:00"},{id:1,name:"01:00"},{id:2,name:"02:00"},{id:3,name:"03:00"},{id:4,name:"04:00"},{id:5,name:"05:00"},{id:6,name:"06:00"},{id:7,name:"07:00"},{id:8,name:"08:00"},{id:9,name:"09:00"},{id:10,name:"10:00"},{id:11,name:"11:00"},{id:12,name:"12:00"},{id:13,name:"13:00"},{id:14,name:"14:00"},{id:15,name:"15:00"},{id:16,name:"16:00"},{id:17,name:"17:00"},{id:18,name:"18:00"},{id:19,name:"19:00"},{id:20,name:"20:00"},{id:21,name:"21:00"},{id:22,name:"22:00"},{id:23,name:"23:00"}];t.default={name:"ServiceSettingStep",components:{DealPerson:a.default,BasicCard:r.default,collapseTransition:s.default,commonTriggerList:c.default,TaskConfigPanel:l.default},props:{serviceInfo:{type:Object,default:function(){return{}}},flowInfo:{type:Object,default:function(){return{}}}},data:function(){return{frequencyList:f,showMoreConfig:!1,revokeWayList:[{name:"不支持撤回",id:"not_support",key:0},{name:this.$t("m.treeinfo['提单后，单据未被处理流转前，提单人可以撤回']"),id:"before_flow",key:2},{name:this.$t("m.treeinfo['任何节点，提单人都可撤回单据']"),id:"all_node",key:1},{name:this.$t("m.treeinfo['指定节点前可以撤回']"),id:"specify_node",key:3}],displayRangeTypes:["OPEN","ORGANIZATION","GENERAL","API"],notifyList:[{name:this.$t('m.treeinfo["企业微信"]'),type:"WEIXIN"},{name:this.$t('m.treeinfo["邮件"]'),type:"EMAIL"},{name:this.$t('m.treeinfo["SMS短信"]'),type:"SMS"}],nodeListLoading:!1,nodeList:[],formData:{visibleRange:{type:"OPEN",value:""},revokeWay:"before_flow",revokeState:0,otherSettings:[],notify_rule:"ONCE",notify_freq:"",notify:["WEIXIN","EMAIL"],is_auto_approve:!1},superviseTypes:["PERSON","GENERAL","STARTER"],supervisePerson:{type:"STARTER",value:""},slaValidateMsg:[],slaValidateDialogShow:!1}},computed:{openFunction:function(){return this.$store.state.openFunction},processId:function(){return this.serviceInfo.workflow_id}},watch:{"formData.revokeWay":function(e){"specify_node"!==e||this.nodeList.length||this.getNodeList()}},mounted:function(){this.initData()},methods:{initData:function(){var e=this.serviceInfo,t=e.notify,i=e.display_type,n=e.display_role,o=e.supervisor,a=e.revoke_config,s=e.can_ticket_agency,r=e.is_supervise_needed,c=e.notify_rule,l=e.notify_freq,u=e.supervise_type;try{var d=this.revokeWayList.find((function(e){return e.key===a.type}));this.formData.revokeWay=d?d.id:"not_support",this.formData.revokeState=a.state}catch(e){console.log(e)}this.formData.is_auto_approve=this.flowInfo.is_auto_approve,this.formData.visibleRange={type:i,value:n},this.formData.otherSettings=[],s&&this.formData.otherSettings.push("can_ticket_agency"),r&&this.formData.otherSettings.push("is_supervise_needed"),this.formData.notify=(t||[]).map((function(e){return e.type})),this.formData.notify.length&&(this.formData.notify_rule=c,this.formData.notify_freq=Number(l)/3600),this.supervisePerson={type:"EMPTY"===u?"STARTER":u,value:o}},getNodeList:function(){var e=this;this.nodeListLoading=!0,this.$store.dispatch("deployCommon/getStates",{workflow:this.serviceInfo.workflow_id}).then((function(t){e.nodeList=t.data.filter((function(e){return!e.is_builtin&&"ROUTER-P"!==e.type&&"COVERAGE"!==e.type}))})).catch((function(t){(0,u.errorHandler)(t,e)})).finally((function(){e.nodeListLoading=!1}))},saveAndActionService:function(e){var t=this;return this.$store.dispatch("service/saveAndActionService",{id:this.serviceInfo.id,params:e}).catch((function(e){(0,u.errorHandler)(e,t)})).finally((function(){t.nodeListLoading=!1}))},goToServiceList:function(){this.$router.push({name:"projectServiceList",query:{project_id:this.$store.state.project.id}})},validate:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i,o,a,s,r,c,l,u,d,f,p,m,h;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i={workflow_config:{supervise_type:"EMPTY",supervisor:"",revoke_config:{type:0,state:0},is_auto_approve:e.formData.is_auto_approve}},o=i.workflow_config,!e.$refs.displayRange||e.$refs.displayRange.verifyValue()){t.next=4;break}return t.abrupt("return",!1);case 4:if(!e.$refs.taskConfigPanel){t.next=7;break}return t.next=7,e.$refs.taskConfigPanel.validate();case 7:return e.$refs.displayRange&&(a=e.$refs.displayRange.getValue(),i.display_type=a.type,i.display_role=a.value||void 0),o.is_auto_approve=e.formData.is_auto_approve,s=e.formData,r=s.revokeWay,c=s.revokeState,l=s.otherSettings,u=s.notify,"not_support"===r?o.is_revocable=!1:(o.is_revocable=!0,d=e.revokeWayList.find((function(e){return e.id===r})).key,o.revoke_config={type:d,state:"specify_node"===r?c:0}),i.can_ticket_agency=l.some((function(e){return"can_ticket_agency"===e})),o.is_supervise_needed=l.some((function(e){return"is_supervise_needed"===e})),e.$refs.supervisePerson&&o.is_supervise_needed&&(f=e.$refs.supervisePerson.getValue(),p=f.type,m=f.value,"STARTER"!==p&&(o.supervise_type=p,o.supervisor=m)),o.notify=e.notifyList.filter((function(e){return u.some((function(t){return e.type===t}))})),o.notify_freq=0,o.notify_rule="ONCE",e.$refs.taskConfigPanel&&(o.extras={},o.extras.task_settings=e.$refs.taskConfigPanel.getPostParams()),t.next=20,e.saveAndActionService(i);case 20:return h=t.sent,t.next=23,e.$store.dispatch("service/slaValidate",e.serviceInfo.id);case 23:if(h.result){t.next=27;break}return e.slaValidateMsg=h.data.messages,e.slaValidateDialogShow=!0,t.abrupt("return",{data:{result:!1}});case 27:return t.abrupt("return",!0);case 28:case"end":return t.stop()}}),t,e)})))()}}}},"xl+m":function(e,t,i){"use strict";i.r(t);var n=i("YB4E"),o=i("1hFm");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("6StV");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"f26cbc46",null);r.options.__file="src/views/processManagement/publicTrigger/components/sendMessage.vue",t.default=r.exports},xnXd:function(e,t,i){},xpPb:function(e,t,i){"use strict";i.r(t);var n=i("HtfW"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},xsd2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("jWXv")),o=l(i("rfXi")),a=l(i("m1cH")),s=l(i("PIEm")),r=l(i("PaSM")),c=i("CeR/");function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"basicInfo",components:{dealPerson:s.default},mixins:[r.default],props:{flowInfo:{type:Object,default:function(){return{}}},nodeInfo:{type:Object,default:function(){return{}}},nodeTagList:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:function(){return!1}}},data:function(){return{formInfo:{name:"",tag:"",distribute_type:"",ticket_key:"",ticket_type:"",can_deliver:!1},trueStatus:!0,falseStatus:!1,assignorsInfo:{type:"",value:""},excludeProcessor:[],assignorExclude:["BY_ASSIGNOR","EMPTY","OPEN","VARIABLE","API"],deliversExclude:["BY_ASSIGNOR","EMPTY","STARTER","VARIABLE","API","ASSIGN_LEADER","STARTER_LEADER"],assignorsTypeList:["DISTRIBUTE_THEN_PROCESS","DISTRIBUTE_THEN_CLAIM"],processorsInfo:{type:"",value:""},deliversInfo:{type:"",value:""},billStatusList:[{type:"keep",name:this.$t('m.treeinfo["延续上个节点"]')},{type:"custom",name:this.$t('m.treeinfo["自定义"]')}],secondLevelList:[],ticketKeyLoading:!1,sceneList:[],prompt:[{id:"DISTRIBUTE_THEN_PROCESS",prompt:this.$t('m.treeinfo["指该节点动作需要通过派单人分派到指定处理人或者处理角色，被分派到的处理人再进行处理。"]')},{id:"PROCESS",prompt:this.$t('m.treeinfo["单据直接流入到配置好的处理人/角色处理。当有多个处理人时，任何一位处理完成即可流入下个环节。"]')},{id:"CLAIM_THEN_PROCESS",prompt:this.$t('m.treeinfo["指配置好的处理人/角色人员需要主动认领任务。当处理人只有1位时，会自动认领。处理人有2人及以上时，需要主动认领至自己的待办任务中。"]')},{id:"DISTRIBUTE_THEN_CLAIM",prompt:this.$t('m.treeinfo["单据需要派单人进行指派到组或者多人，然后被指派对象进行主动认领。认领完成后才会到自己的待办任务列表中。"]')}],rules:{},checkStatus:{name:!1,assignors:!1,processors:!1,delivers:!1}}},computed:{globalChoise:function(){return this.$store.state.common.configurInfo}},watch:{formInfo:{deep:!0,handler:function(e){this.$emit("baseFormInfoChange",e)}}},mounted:function(){this.initData(),this.getExcludeRoleTypeList(),this.rules.name=this.commonRules.name},methods:{initData:function(){var e=this;this.sceneList=[],this.globalChoise.distribute_type.forEach((function(t){e.nodeInfo.is_builtin?e.sceneList=[{typeName:"PROCESS",name:e.$t('m.treeinfo["直接处理"]')}]:e.sceneList.push({typeName:t.typeName,name:t.name})})),this.formInfo.name=this.nodeInfo.name,this.formInfo.tag=this.nodeInfo.tag||"",this.formInfo.distribute_type=this.nodeInfo.distribute_type,this.assignorsTypeList.some((function(t){return t===e.formInfo.distribute_type}))&&(this.assignorsInfo={type:this.nodeInfo.assignors_type,value:this.nodeInfo.assignors}),this.processorsInfo={type:this.nodeInfo.processors_type,value:this.nodeInfo.processors},this.formInfo.ticket_type=this.nodeInfo.extras.ticket_status?this.nodeInfo.extras.ticket_status.type:"keep",this.formInfo.ticket_key=this.nodeInfo.extras.ticket_status?this.nodeInfo.extras.ticket_status.name:"","custom"===this.formInfo.ticket_type&&this.getSecondLevelList(),this.formInfo.can_deliver=this.nodeInfo.can_deliver,this.formInfo.can_deliver&&(this.deliversInfo={type:this.nodeInfo.delivers_type,value:this.nodeInfo.delivers})},getExcludeRoleTypeList:function(){var e=[],t=this.nodeInfo.is_first_state;e=this.nodeInfo.is_builtin?["BY_ASSIGNOR","STARTER","VARIABLE"]:["OPEN"],t&&e.push("STARTER_LEADER"),"DISTRIBUTE_THEN_PROCESS"!==this.nodeInfo.distribute_type&&"DISTRIBUTE_THEN_CLAIM"!==this.nodeInfo.distribute_type&&e.push("BY_ASSIGNOR"),this.flowInfo.is_biz_needed||(e.push("CMDB"),this.deliversExclude.push("CMDB")),this.excludeProcessor=["EMPTY","API"].concat((0,a.default)(e))},changeDistribute:function(e){this.getExcludeRoleTypeList(),this.excludeProcessor=(0,o.default)(new n.default([].concat((0,a.default)(this.excludeProcessor),["BY_ASSIGNOR","VARIABLE"]))),"DISTRIBUTE_THEN_PROCESS"!==e&&"DISTRIBUTE_THEN_CLAIM"!==e||(this.excludeProcessor=this.excludeProcessor.filter((function(e){return"BY_ASSIGNOR"!==e}))),"PROCESS"===e&&(this.excludeProcessor=this.excludeProcessor.filter((function(e){return"VARIABLE"!==e}))),this.assignorsInfo={type:"",value:""}},handleTicket:function(e){this.formInfo.ticket_key="","custom"===e&&(this.secondLevelList.length||this.getSecondLevelList())},getSecondLevelList:function(){var e=this;this.ticketKeyLoading=!0,this.$store.dispatch("ticketStatus/getOverallTicketStatuses").then((function(t){e.secondLevelList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.ticketKeyLoading=!1}))},backBasicInfo:function(){this.checkBasic();var e={};if(e.name=this.formInfo.name,this.checkStatus.name=!this.formInfo.name,e.tag=this.formInfo.tag,e.distribute_type=this.formInfo.distribute_type,e.assignors_type="EMPTY",e.assignors="",this.$refs.assignors){var t=this.$refs.assignors.getValue();e.assignors_type=t.type,e.assignors=t.value,this.checkStatus.assignors=!this.$refs.assignors.verifyValue()}if(e.processors_type="",e.processors="",this.$refs.processors){var i=this.$refs.processors.getValue();e.processors_type=i.type,e.processors=i.value,this.checkStatus.processors=!this.$refs.processors.verifyValue()}if(e.ticket_type=this.formInfo.ticket_type,e.ticket_key="custom"===this.formInfo.ticket_type?this.formInfo.ticket_key:"",e.can_deliver=this.formInfo.can_deliver,e.delivers_type="EMPTY",e.delivers="",this.$refs.delivers){var n=this.$refs.delivers.getValue();e.delivers_type=n.type,e.delivers=n.value,this.checkStatus.delivers=!this.$refs.delivers.verifyValue()}return e},checkBasic:function(){this.$refs.basicForm.validate().then((function(e){}),(function(e){console.error(e)}))}}}},y7UH:function(e,t,i){"use strict";i.r(t);var n=i("IdEF"),o=i("gLev");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("uxNy");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"7d32ab83",null);r.options.__file="src/views/service/editService/flowCanvas/secondFlow.vue",t.default=r.exports},yAjJ:function(e,t,i){"use strict";i("Slck")},ySJU:function(e,t,i){"use strict";i("mLx0")},yWHG:function(e,t,i){},"yX+q":function(e,t,i){"use strict";i.r(t);var n=i("fc+3"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},ybrk:function(e,t,i){"use strict";i.r(t);var n=i("feoz"),o=i("iesT");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("BPSA");var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"4ecdf868",null);r.options.__file="src/components/form/richTextEditor/richTextEditor.vue.vue",t.default=r.exports},yhLn:function(e,t,i){"use strict";i("cPmg")},ymPp:function(e,t,i){"use strict";i.r(t);var n=i("7DqX"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t.default=o.a},"z+Fq":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data"},[t("img",{attrs:{src:this.imgUrl}}),this._v(" "),t("p",[this._v("\n        "+this._s(this.text||this.$t('m.treeinfo["暂无数据"]'))+"\n    ")])])},o=[];n._withStripped=!0},"z/5e":function(e,t,i){e.exports={default:i("Nxk6"),__esModule:!0}},"z/kA":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i("gDS+")),o=l(i("u8Ap")),a=l(i("ybrk")),s=l(i("hk/f")),r=i("dGg1"),c=i("CeR/");function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"defaultValue",components:{memberSelect:o.default,RichTextEditor:a.default,CodeEditor:s.default},props:{formInfo:{type:Object,default:function(){return{}}},fieldInfo:{type:Object,default:function(){return{}}},dictionaryData:{type:Object,default:function(){return{}}},changeInfo:{type:Object,default:function(){return{}}},label:{type:String,default:""},checkStatus:{type:Object,default:function(){return{}}}},data:function(){return{selectList:[],updateStatus:!1,typeList:["MULTISELECT","CHECKBOX","MEMBERS","MEMBER"],precision:0}},watch:{"formInfo.source_type":function(){var e=this;this.updateStatus&&(this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),this.formInfo.source_type!==this.changeInfo.source_type&&(this.updateStatus=!0,this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||(this.formInfo.default_value="")},"formInfo.type":function(){var e=this;this.updateStatus&&(this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),this.formInfo.type!==this.changeInfo.type&&(this.updateStatus=!0,this.formInfo.default_value=this.typeList.some((function(t){return t===e.formInfo.type}))?[]:""),"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||(this.formInfo.default_value="")},"formInfo.default_value":function(){"CUSTOM-FORM"===this.formInfo.type&&(this.checkStatus.customFormStatus=!1)}},mounted:function(){this.changeInfo.id&&"DATADICT"===this.changeInfo.source_type&&this.getDictionList(this.changeInfo.source_uri),""!==this.formInfo.default_value&&this.getSelectList(this.formInfo.default_value)},methods:{getSelectList:function(e){this.selectList=[],e&&("CUSTOM"===this.formInfo.source_type?this.selectList=this.fieldInfo.list.filter((function(e){return e.key&&e.name})):"DATADICT"===this.formInfo.source_type?this.dictionaryData.check&&this.getDictionList(this.dictionaryData.check):"API"!==this.formInfo.source_type&&"RPC"!==this.formInfo.source_type||this.getApiList())},getDictionList:function(e){var t=this,i={key:e};this.$store.dispatch("datadict/get_data_by_key",i).then((function(e){t.selectList=e.data})).catch((function(e){(0,c.errorHandler)(e,t)}))},downCustomFormTempalte:function(){var e=document.createElement("a"),t=+new Date;e.download="bk_itsm_custom_form_template_"+t+".json",e.href="data:text/plain,"+(0,n.default)(r.CUSTOM_FORM_TEMPLATE,null,4),e.click()},getApiList:function(){}}}},z1yn:function(e,t,i){"use strict";i.r(t);var n=i("vqU0"),o=i("wegR");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("KHd+"),r=Object(s.a)(o.default,n.a,n.b,!1,null,"be297c54",null);r.options.__file="src/views/commonComponent/fieldComponent/string.vue",t.default=r.exports},z7tL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.formInfo.api_info&&e.lineInfo.expressions?i("div",{staticClass:"bk-polling"},[i("div",{staticClass:"bk-service-name mt20"},[i("div",{staticClass:"mt20"},[i("bk-switcher",{attrs:{size:"small"},model:{value:e.formInfo.api_info.need_poll,callback:function(t){e.$set(e.formInfo.api_info,"need_poll",t)},expression:"formInfo.api_info.need_poll"}})],1)]),e._v(" "),i("div",{staticClass:"bk-line-form"},[e.formInfo.api_info.need_poll?[i("div",{staticClass:"bk-service-name"},[i("h1",{staticStyle:{"padding-left":"10px"}},[i("span",[e._v(e._s(e.$t('m.treeinfo["条件组间关系"]')))]),e._v(" "),i("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.top",value:e.$t("m.treeinfo['当所有条件组都满足且/或的条件组时，轮询才会结束']"),expression:"$t(`m.treeinfo['当所有条件组都满足且/或的条件组时，轮询才会结束']`)",modifiers:{top:!0}}],staticClass:"top-middle"},[i("i",{staticClass:"bk-itsm-icon icon-icon-info"})])])]),e._v(" "),i("div",{staticClass:"bk-hidden-conditions"},[i("div",{staticClass:"bk-form-content",staticStyle:{"margin-left":"0"}},[i("bk-radio-group",{model:{value:e.lineInfo.between,callback:function(t){e.$set(e.lineInfo,"between",t)},expression:"lineInfo.between"}},[i("bk-radio",{attrs:{value:"and","ext-cls":"mr20"}},[e._v(e._s(e.$t("m.treeinfo['且']")))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t("m.treeinfo['或']")))])],1)],1)])]:e._e(),e._v(" "),e.formInfo.api_info.need_poll&&e.lineInfo.expressions&&e.lineInfo.expressions.length?[e._l(e.lineInfo.expressions,(function(t,n){return i("div",{key:n,staticClass:"bk-form-content"},[i("p",{staticClass:"bk-between-title"},[e._v(e._s("and"===e.lineInfo.between?e.$t("m.treeinfo['且']"):e.$t('m.treeinfo["或"]'))+e._s(e.$t('m.treeinfo["-条件组"]'))+e._s(n+1))]),e._v(" "),i("div",{staticClass:"bk-between-info"},[i("p",[i("span",{staticClass:"bk-between-span"},[e._v(e._s(e.$t('m.treeinfo["字段间关系"]')))]),e._v(" "),i("bk-radio-group",{staticStyle:{width:"auto"},model:{value:t.type,callback:function(i){e.$set(t,"type",i)},expression:"item.type"}},[i("bk-radio",{staticClass:"mr10",attrs:{value:"and"}},[e._v(e._s(e.$t('m.treeinfo["且"]')))]),e._v(" "),i("bk-radio",{attrs:{value:"or"}},[e._v(e._s(e.$t('m.treeinfo["或"]')))])],1)],1),e._v(" "),e._l(t.expressions,(function(n,o){return i("div",{key:o,staticClass:"bk-between-form",on:{click:function(e){t.checkInfo=!1}}},[i("div",{staticStyle:{width:"210px",float:"left","margin-right":"10px",background:"white"}},[i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeOther,expression:"closeOther"}],staticClass:"bk-search-tree bk-form-width"},[i("div",{staticClass:"bk-search-tree-wrapper",on:{click:function(t){return t.stopPropagation(),e.showTree(n)}}},[i("span",{class:{"bk-color-tree":n.organization&&n.organization.assignorTree.name}},[e._v("\n                                        "+e._s(n.organization&&n.organization.assignorTree.name?n.organization.assignorTree.name:e.$t('m.treeinfo["请选择"]'))+"\n                                    ")]),e._v(" "),i("i",{staticClass:"bk-select-angle bk-icon icon-framework"})]),e._v(" "),i("transition",{attrs:{name:"common-fade"}},[n.organizaInfo&&n.organizaInfo.assignorShow?i("div",{staticClass:"bk-search-tree-content"},[i("export-tree",{attrs:{"tree-data-list":n.organization.assignorPerson},on:{toggle:function(t){for(var i=arguments.length,o=Array(i);i--;)o[i]=arguments[i];return e.assignorToggle.apply(void 0,o.concat([n]))},toggleChildren:function(t){for(var i=arguments.length,o=Array(i);i--;)o[i]=arguments[i];return e.toggleChildren.apply(void 0,o.concat([n]))}}})],1):e._e()])],1)]),e._v(" "),i("bk-select",{staticStyle:{width:"100px",float:"left","margin-right":"10px"},attrs:{searchable:"","font-size":"medium"},model:{value:n.condition,callback:function(t){e.$set(n,"condition",t)},expression:"node.condition"}},e._l(e.globalChoiseFilter(e.globalChoise.methods,n.type),(function(e){return i("bk-option",{key:e.typeName,attrs:{id:e.typeName,name:e.name}})})),1),e._v(" "),i("div",{staticStyle:{width:"195px",float:"left","margin-right":"10px"}},["boolean"===n.type?[i("bk-select",{attrs:{searchable:"","font-size":"medium"},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}},e._l(e.booleanList,(function(e){return i("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1)]:[i("bk-input",{attrs:{clearable:!0,type:"INT"===n.type?"number":"text",placeholder:e.$t("m.treeinfo['请输入比较值']")},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"node.value"}})]],2),e._v(" "),i("div",{staticClass:"bk-between-operat"},[i("span",{staticClass:"bk-itsm-icon icon-flow-add",on:{click:function(i){return e.addNode(t,o)}}}),e._v(" "),i("i",{staticClass:"bk-itsm-icon icon-flow-reduce",class:{"bk-no-delete":1===t.expressions.length},on:{click:function(i){return e.deleteNode(t,o)}}})])],1)})),e._v(" "),1!==e.lineInfo.expressions.length?i("i",{staticClass:"bk-icon icon-close",on:{click:function(i){return e.delteCondition(t,n)}}}):e._e()],2)])})),e._v(" "),i("div",{class:{"bk-line-padding":e.scrollTopStatus}},[i("p",{staticClass:"bk-add-between"},[i("span",{on:{click:e.addCondition}},[i("i",{staticClass:"bk-icon icon-plus-circle"}),e._v(e._s(e.$t('m.treeinfo["添加条件组"]'))+"\n                    ")])])])]:e._e()],2),e._v(" "),e.formInfo.api_info.need_poll?i("div",{staticClass:"bk-polling-configu",staticStyle:{width:"650px"}},[i("bk-form",{attrs:{"label-width":200,"form-type":"vertical",model:e.formInfo}},[i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['轮询间隔']"),"ext-cls":"bk-polling-item"}},[i("bk-input",{attrs:{clearable:!0,type:"number",min:1,placeholder:e.$t("m.treeinfo['请输入间隔时间']")},model:{value:e.formInfo.api_info.end_conditions.poll_interval,callback:function(t){e.$set(e.formInfo.api_info.end_conditions,"poll_interval",t)},expression:"formInfo.api_info.end_conditions.poll_interval"}},[i("template",{slot:"append"},[i("div",{staticClass:"group-text"},[e._v(e._s(e.$t('m.treeinfo["秒"]')))])])],2)],1),e._v(" "),i("bk-form-item",{attrs:{label:e.$t("m.treeinfo['轮询次数']"),"ext-cls":"bk-polling-item bk-polling-right"}},[i("bk-input",{attrs:{clearable:!0,type:"number",min:1,placeholder:e.$t("m.treeinfo['请输入轮询次数']")},model:{value:e.formInfo.api_info.end_conditions.poll_time,callback:function(t){e.$set(e.formInfo.api_info.end_conditions,"poll_time",t)},expression:"formInfo.api_info.end_conditions.poll_time"}})],1)],1)],1):e._e()]):e._e()},o=[];n._withStripped=!0},zBzD:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tag-table"},[e.hiddenLabel?e._e():i("label",{staticClass:"table-label"},[e._v(e._s(e.label))]),e._v(" "),i("bk-table",{ref:"tagTable",attrs:{data:e.form.value,border:!0}},e._l(e.column,(function(t){return i("bk-table-column",{key:t.key,attrs:{label:t.name,prop:t.key},scopedSlots:e._u([{key:"default",fn:function(n){return[i("ViewItem",{attrs:{scheme:e.getScheme(t,n.row[t.key]),form:n.row[t.key]}})]}}],null,!0)})})),1)],1)},o=[];n._withStripped=!0},zCbU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i("u8Ap")),o=s(i("db1v")),a=i("CeR/");function s(e){return e&&e.__esModule?e:{default:e}}t.default={name:"COMPLEX-MEMBERS",components:{SelectTree:o.default,memberSelect:n.default},props:{item:{type:Object,default:function(){return{}}},fields:{type:Array,default:function(){return[]}},isCurrent:{type:Boolean,default:!1},checkValue:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{isLoading:!1,formData:{levelOne:"",levelSecond:[]},secondLevelList:[],organizationList:[]}},computed:{firstLevelList:function(){var e=this.$store.state.common.configurInfo.processor_type,t=["OPEN","STARTER","BY_ASSIGNOR","EMPTY","VARIABLE","CMDB","ORGANIZATION"];return e.filter((function(e){return!t.some((function(t){return t===e.typeName}))}))}},mounted:function(){this.formData.levelOne="PERSON",this.getSecondLevelList(this.formData.levelOne)},methods:{getSecondLevelList:function(e){this.formData.levelSecond=[],this.secondLevelList=[],"ORGANIZATION"===e?(this.formData.levelSecond="",this.getOrganization()):"PERSON"===e?this.secondLevelList=[]:"GENERAL"===e?(this.formData.levelSecond="",this.secondListFn(e)):this.secondListFn(e)},secondListFn:function(e){var t=this;e&&(this.isLoading=!0,this.$store.dispatch("deployCommon/getSecondUser",{role_type:e,project_key:this.$store.state.project.id}).then((function(i){var n=i.data,o=[];"GENERAL"===e?n.forEach((function(e){o.push({id:String(e.id),name:e.name+"("+e.count+")",disabled:0===e.count})})):n.forEach((function(e){o.push({id:String(e.id),name:e.name})})),t.secondLevelList=o})).catch((function(e){(0,a.errorHandler)(e,t)})).finally((function(){t.isLoading=!1})))},getOrganization:function(){var e=this;this.$store.dispatch("cdeploy/getTreeInfo").then((function(t){e.organizationList=t.data})).catch((function(t){(0,a.errorHandler)(t,e)}))}}}},zXeT:function(e,t,i){},zdoL:function(e,t,i){},zfNu:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i("GQeE")),o=r(i("gDS+")),a=r(i("QbLZ")),s=r(i("5hmv"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"FILE",components:{customUpload:s.default},props:{item:{type:Object,required:!0,default:function(){}},idInfo:{type:Object,required:!1,default:function(){return null}},isCurrent:{type:Boolean,default:!1},isFilePreview:{type:Boolean,default:!1},isBuild:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data:function(){return{datas:[],uploadFileList:[],tempFileList:[],historyList:[],url:this.isFilePreview?"":window.SITE_URL+"api/misc/upload_file/",tempObj:{}}},mounted:function(){this.item.val=[],this.choiceToList()},methods:{choiceToList:function(){for(var e in this.item.choice)this.tempFileList.push((0,a.default)({},this.item.choice[e],{key:e}));if(this.item.value){var t=JSON.parse(this.item.value);for(var i in t)this.historyList.push((0,a.default)({},t[i],{key:i}));this.datas=this.historyList.concat([]),this.item.val="";var n=[];this.datas.forEach((function(e){var t={};t[e.key]={path:e.path,name:e.name},n.push((0,o.default)(t))})),this.item.val=n.join(",")}},downloadFile:function(e){var t=e.key;this.isBuild?window.open(window.SITE_URL+"api/ticket/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=version&flow_id="+this.item.version_id):this.isCurrent?window.open(window.SITE_URL+"api/ticket/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=template"):window.open(window.SITE_URL+"api/workflow/fields/"+this.item.id+"/download_file/?unique_key="+t+"&file_type=template")},uploadErr:function(e,t){},uploadSuccess:function(e,t){var i=this;this.datas=t,this.uploadFileList=t,this.item.val=this.item.value="",t.forEach((function(e){if(!e.errorMsg&&e.responseData.data)for(var t in e.responseData.data.succeed_files)i.$set(i.tempObj,t,e.responseData.data.succeed_files[t])})),this.historyList.length&&(this.datas=this.datas.concat(this.historyList),this.historyList.forEach((function(e){i.tempObj[e.key]={path:e.path,name:e.name}}))),this.item.val=this.item.value=(0,o.default)(this.tempObj)},uploadProgress:function(e,t,i){this.$store.commit("changeFileStatus",!0)},uploadDone:function(e){this.$store.commit("changeFileStatus",!1)},deleteFile:function(e){if(this.datas.splice(this.datas.indexOf(e),1),this.historyList.length&&this.historyList.some((function(t){return t.key===e.key})))for(var t in this.historyList=this.historyList.filter((function(t){return t.key!==e.key})),this.tempObj)t===e.key&&delete this.tempObj[t];else for(var i in this.tempObj)for(var a in e.responseData.data.succeed_files)i===a&&delete this.tempObj[i];var s=this.uploadFileList.indexOf(e);-1!==s&&this.$refs.upload.deleteFile(s,e),(0,n.default)(this.tempObj).length?this.item.val=(0,o.default)(this.tempObj):this.item.val=""}}}},zmPZ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i("14Xm")),o=u(i("D3Ub")),a=u(i("gDS+")),s=u(i("u8Ap")),r=u(i("db1v")),c=i("CeR/"),l=i("ygAv");function u(e){return e&&e.__esModule?e:{default:e}}t.default={name:"dealPerson",components:{SelectTree:r.default,memberSelect:s.default},props:{value:{type:Object,default:function(){return{type:"",value:[]}}},specifyIdList:{type:Array,default:function(){return[]}},excludeRoleTypeList:{type:Array,default:function(){return[]}},showRoleTypeList:{type:Array,default:function(){return[]}},nodeInfo:{type:Object,default:function(){return{}}},formType:{type:String,default:""},shortcut:{type:Boolean,default:!1},requiredMsg:{type:String,default:""}},data:function(){return{showError:!1,initLoaing:!1,isLoading:!1,organizationLoading:!1,formData:{levelOne:"",levelSecond:[]},allUserlist:[],firstLevelList:[],secondLevelList:[],organizationList:[],frontMemberField:[],secondLevelRange:{},noSecondTypeList:["EMPTY","OPEN","STARTER","BY_ASSIGNOR","STARTER_LEADER"]}},computed:{targetSpecifyIdList:function(){var e=this,t=this.specifyIdList.find((function(t){return t.type===e.formData.levelOne}));return t?t.list:[]}},watch:{value:{handler:function(e,t){(0,a.default)(e)!==(0,a.default)(t)&&this.initData()},deep:!0},showRoleTypeList:{handler:function(){this.initData()},deep:!0},excludeRoleTypeList:{handler:function(){this.initData()},deep:!0}},created:function(){this.setDeaultSecondLeve(this.value.type)},mounted:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.initData();case 1:case"end":return t.stop()}}),t,e)})))()},methods:{initData:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var i,o;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.initLoaing=!0,t.next=3,e.getRoleGroup();case 3:i=e.value.type,e.firstLevelList.find((function(e){return e.id===i}))&&(o="ORGANIZATION"===i||"ASSIGN_LEADER"===i?e.value.value:e.value.value?e.value.value.split(",").filter((function(e){return""!==e})):[],e.formData={levelOne:i,levelSecond:o}),i&&e.getSecondLevelList(i),e.initLoaing=!1;case 7:case"end":return t.stop()}}),t,e)})))()},getRoleGroup:function(){var e=this;if(!this.allUserlist.length)return this.$store.dispatch("deployCommon/getUser",{is_processor:!0,project_key:this.$store.state.project.id}).then((function(t){e.allUserlist=t.data,e.getFirstLevelList(t.data)})).catch((function(t){(0,c.errorHandler)(t,e)}));this.getFirstLevelList(this.allUserlist)},getFirstLevelList:function(e){var t=this;this.firstLevelList=e.filter((function(e){return t.excludeRoleTypeList.length?!t.excludeRoleTypeList.includes(e.type):!t.showRoleTypeList.length||t.showRoleTypeList.includes(e.type)})).map((function(e){return{id:e.type,name:e.name}}))},setDeaultSecondLeve:function(e){switch(e){case"ORGANIZATION":case"ASSIGN_LEADER":this.formData.levelSecond="";break;default:this.formData.levelSecond=[]}this.secondLevelList=[]},getSecondLevelList:function(e){this.noSecondTypeList.includes(e)||("ORGANIZATION"===e?this.getOrganization():"ASSIGN_LEADER"===e?this.getPreStates():"VARIABLE"===e?this.getFrontNodesList():this.secondListFn(e))},onFirstLevelChange:function(e){this.$set(this.formData,"levelSecond",[]),this.setDeaultSecondLeve(e),this.getSecondLevelList(e)},secondListFn:function(e){var t=this;if(e){var i={role_type:e,project_key:this.$store.state.project.id||this.$route.query.project.id};this.shortcut&&(i.scope="shortcut"),this.isLoading=!0,this.$store.dispatch("deployCommon/getSecondUser",i).then((function(i){var n=[];n=i.data.map((function(i){if("GENERAL"===e){var n=t.shortcut?"":"("+i.count+")";return{id:String(i.id),name:i.name+n,disabled:0===i.count}}return"API"===e?{id:i.role_key,name:i.name}:{id:String(i.id),name:i.name}})),t.targetSpecifyIdList.length&&"GENERAL"!==e&&(n=n.filter((function(e){return t.targetSpecifyIdList.some((function(t){return String(t)===e.id}))}))),t.secondLevelList=n})).catch((function(e){(0,c.errorHandler)(e,t)})).finally((function(){t.isLoading=!1}))}},getOrganization:function(){var e=this;this.organizationLoading=!0,this.$store.dispatch("cdeploy/getTreeInfo").then((function(t){e.organizationList=t.data})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.organizationLoading=!1}))},getFrontNodesList:function(){var e=this;this.isLoading=!0;var t={workflow:this.nodeInfo.workflow,state:this.nodeInfo.id,exclude_self:!0};return this.$store.dispatch("apiRemote/get_related_fields",t).then((function(t){e.secondLevelList=t.data.filter((function(e){return"MEMBERS"===e.type&&"REQUIRE"===e.validate_type||"MEMBER"===e.type&&"REQUIRE"===e.validate_type})).map((function(e){return{id:e.key,name:e.name}}))})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.isLoading=!1}))},getPreStates:function(){var e=this;this.isLoading=!0,this.$store.dispatch("deployCommon/getPreStates",{id:this.nodeInfo.id}).then((function(t){e.secondLevelList=t.data.filter((function(e){return!["ROUTER-P","COVERAGE"].includes(e.type)})).map((function(e){return{id:e.id,name:e.name}}))})).catch((function(t){(0,c.errorHandler)(t,e)})).finally((function(){e.isLoading=!1}))},verifyValue:function(){var e=!1;return e=this.formData.levelOne&&!this.noSecondTypeList.includes(this.formData.levelOne)?(0,l.isEmpty)(this.formData.levelOne)||(0,l.isEmpty)(this.formData.levelSecond):(0,l.isEmpty)(this.formData.levelOne),this.showError=e,!e},getValue:function(){var e=this.formData.levelSecond;return Array.isArray(this.formData.levelSecond)&&(e=e.join(",")),{value:e||"",type:this.formData.levelOne}}}}},zwsV:function(e,t,i){"use strict";i("T7kK")}}]);